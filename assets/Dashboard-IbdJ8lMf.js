import{k as W,l as O,u as $,r as a,q as V,w as Y,c as z,g as G,j as e,L as J,e as K,f as L,d,m as Q,a as X,n as Z}from"./index-hWs3_Azh.js";import{T as ee,c as te,u as se}from"./imageCompressor-gIYipDSI.js";import{S as D}from"./shopping-bag-xQUV8D0K.js";import{c as o}from"./createLucideIcon-C4OtHORO.js";const ae=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],re=o("copy",ae);const ne=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],le=o("external-link",ne);const ie=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],oe=o("log-out",ie);const de=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ce=o("plus",de);const me=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],pe=o("settings",me),je=()=>{const{store:s,setStore:h,loading:q,refreshStore:ue}=W(),{user:A}=O(),E=$(),[g,_]=a.useState([]),[x,c]=a.useState(!1),[B,m]=a.useState(!1),[y,j]=a.useState(!1),[f,b]=a.useState(""),[p,v]=a.useState(""),[S,N]=a.useState(""),[w,C]=a.useState(""),[l,k]=a.useState("#6366f1"),[i,M]=a.useState(null);a.useEffect(()=>{s&&(I(),b(s.name||""),v(s.handle||""),N(s.description||""),C(s.whatsapp||""),k(s.themeColor||"#6366f1"))},[s]),a.useEffect(()=>{document.documentElement.style.setProperty("--primary",l)},[l]);const I=async()=>{const t=V(z(d,"products"),Y("storeId","==",s.id)),r=await G(t);_(r.docs.map(n=>({id:n.id,...n.data()})))},R=async t=>{if(!t)return null;const r=await te(t,400,.8);return await se(r)},U=async t=>{t.preventDefault(),j(!0);try{let r=s?.logo||null;i&&(r=await R(i));const n={name:f,handle:p.toLowerCase().replace(/\s+/g,"-"),description:S,whatsapp:w,themeColor:l,logo:r,ownerId:A.uid,updatedAt:new Date().toISOString()};if(s?.id)await K(L(d,"stores",s.id),n,{merge:!0}),h({...s,...n});else{const F=await Q(z(d,"stores"),{...n,createdAt:new Date().toISOString()});h({id:F.id,...n})}c(!1),m(!1),document.documentElement.style.setProperty("--primary",l)}catch(r){console.error("Error saving store:",r),alert("Error saving settings")}finally{j(!1)}},T=async t=>{window.confirm("Delete this product?")&&(await Z(L(d,"products",t)),I())},H=()=>{X.signOut(),E("/")};if(q)return e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading..."});if(!s&&!x)return e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"2rem"},children:e.jsxs("div",{className:"glass glass-card",style:{textAlign:"center",maxWidth:"400px"},children:[e.jsx(D,{size:48,color:"var(--primary)",style:{marginBottom:"1rem"}}),e.jsx("h3",{children:"No store found"}),e.jsx("p",{style:{color:"var(--text-muted)",margin:"1rem 0"},children:"You haven't created a store yet. Let's set it up!"}),e.jsx("button",{onClick:()=>c(!0),className:"btn btn-primary",children:"Create Your Store"})]})});if(x||B)return e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"2rem"},children:e.jsxs("form",{onSubmit:U,className:"glass glass-card",style:{width:"100%",maxWidth:"500px"},children:[e.jsx("h2",{style:{marginBottom:"1.5rem"},children:"Store Settings"}),e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"1.5rem"},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{className:"glass",style:{width:"80px",height:"80px",borderRadius:"50%",margin:"0 auto 0.5rem",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:i||s?.logo?e.jsx("img",{src:i?URL.createObjectURL(i):s.logo,style:{width:"100%",height:"100%",objectFit:"cover"},alt:"Logo"}):e.jsx(D,{color:"var(--text-muted)"})}),e.jsxs("label",{className:"btn btn-secondary",style:{padding:"0.4rem 0.8rem",fontSize:"0.75rem"},children:["Change Logo",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:t=>M(t.target.files[0])})]})]})}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"label",children:"Store Name"}),e.jsx("input",{className:"input",placeholder:"e.g. My Awesome Shop",value:f,onChange:t=>b(t.target.value),required:!0})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"label",children:"Unique Store Handle (URL name)"}),e.jsx("input",{className:"input",placeholder:"e.g. footballhouse",value:p,onChange:t=>v(t.target.value),required:!0}),e.jsxs("span",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:["This will be your link: ministore.com/s/",p||"your-handle"]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"label",children:"Store Description (Short)"}),e.jsx("textarea",{className:"input",placeholder:"e.g. Handmade jewelry and accessories",value:S,onChange:t=>N(t.target.value),rows:"2"})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"label",children:"WhatsApp Number (with country code)"}),e.jsx("input",{className:"input",placeholder:"e.g. 919876543210",value:w,onChange:t=>C(t.target.value),required:!0})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"label",children:"Theme Color"}),e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsx("input",{type:"color",className:"input",style:{width:"60px",height:"40px",padding:"2px"},value:l,onChange:t=>k(t.target.value)}),e.jsx("span",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:l})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{type:"submit",className:"btn btn-primary",style:{flex:1},disabled:y,children:y?"Saving...":"Save Settings"}),e.jsx("button",{type:"button",onClick:()=>{c(!1),m(!1)},className:"btn btn-secondary",children:"Cancel"})]})]})});const P=s.handle||s.id,u=window.location.origin+"/#/s/"+P;return e.jsxs("div",{style:{padding:"2rem 5%"},children:[e.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"3rem",flexWrap:"wrap",gap:"1rem"},children:[e.jsxs("div",{style:{display:"flex",gap:"1.5rem",alignItems:"center"},children:[s.logo&&e.jsx("img",{src:s.logo,style:{width:"64px",height:"64px",borderRadius:"12px",objectFit:"cover"},alt:"Store Logo"}),e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"2rem",marginBottom:"0.25rem"},children:s.name}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",background:"rgba(255,255,255,0.05)",padding:"0.4rem 0.8rem",borderRadius:"20px"},children:[e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:u}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(u),alert("Copied!")},style:{background:"none",border:"none",cursor:"pointer",display:"flex"},children:e.jsx(re,{size:12,color:"var(--text-muted)"})}),e.jsx("a",{href:u,target:"_blank",rel:"noreferrer",style:{display:"flex"},children:e.jsx(le,{size:12,color:"var(--primary)"})})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsxs("button",{onClick:()=>m(!0),className:"btn btn-secondary",children:[e.jsx(pe,{size:18})," Settings"]}),e.jsxs("button",{onClick:H,className:"btn btn-secondary",children:[e.jsx(oe,{size:18})," Logout"]})]})]}),e.jsxs("section",{style:{marginBottom:"3rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsx("h2",{children:"Your Products"}),e.jsxs(J,{to:"/dashboard/add",className:"btn btn-primary",children:[e.jsx(ce,{size:18})," Add Product"]})]}),g.length===0?e.jsx("div",{className:"glass glass-card",style:{textAlign:"center",padding:"3rem"},children:e.jsx("p",{style:{color:"var(--text-muted)"},children:"No products yet. Start adding items to your store."})}):e.jsx("div",{className:"grid grid-cols-2",style:{gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))"},children:g.map(t=>e.jsxs("div",{className:"glass glass-card",style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsx("img",{src:t.image,alt:t.name,style:{width:"100%",height:"200px",objectFit:"cover",borderRadius:"8px"}}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.25rem"},children:[e.jsx("h3",{style:{fontSize:"1.1rem"},children:t.name}),t.category&&e.jsx("span",{style:{fontSize:"0.7rem",background:"rgba(255,255,255,0.1)",padding:"0.2rem 0.5rem",borderRadius:"10px",color:"var(--text-muted)",textTransform:"capitalize"},children:t.category})]}),e.jsxs("p",{style:{color:"var(--primary)",fontWeight:"700"},children:["â‚¹",t.price]})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx("button",{onClick:()=>T(t.id),style:{background:"none",border:"none",cursor:"pointer",color:"var(--error)"},children:e.jsx(ee,{size:18})})})]},t.id))})]})]})};export{je as default};
