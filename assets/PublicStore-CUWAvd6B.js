import{r as n,j as e,o as U,i as K,f as V,d as A,q as E,c as M,w as D,g as N}from"./index-hWs3_Azh.js";import{S as X}from"./shopping-bag-xQUV8D0K.js";import{c as I}from"./createLucideIcon-C4OtHORO.js";import{a as Y,i as B,u as _,P as G,b as J,c as Q,L as Z,m as F,M as H}from"./proxy-D1iGTGdu.js";const ee=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]],te=I("arrow-down-wide-narrow",ee);const re=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],se=I("funnel",re);const ne=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],oe=I("search",ne);function T(r,s){if(typeof r=="function")return r(s);r!=null&&(r.current=s)}function ie(...r){return s=>{let o=!1;const l=r.map(u=>{const d=T(u,s);return!o&&typeof d=="function"&&(o=!0),d});if(o)return()=>{for(let u=0;u<l.length;u++){const d=l[u];typeof d=="function"?d():T(r[u],null)}}}}function ae(...r){return n.useCallback(ie(...r),r)}class le extends n.Component{getSnapshotBeforeUpdate(s){const o=this.props.childRef.current;if(o&&s.isPresent&&!this.props.isPresent){const l=o.offsetParent,u=B(l)&&l.offsetWidth||0,d=B(l)&&l.offsetHeight||0,i=this.props.sizeRef.current;i.height=o.offsetHeight||0,i.width=o.offsetWidth||0,i.top=o.offsetTop,i.left=o.offsetLeft,i.right=u-i.width-i.left,i.bottom=d-i.height-i.top}return null}componentDidUpdate(){}render(){return this.props.children}}function ce({children:r,isPresent:s,anchorX:o,anchorY:l,root:u}){const d=n.useId(),i=n.useRef(null),w=n.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:C}=n.useContext(Y),v=r.props?.ref??r?.ref,h=ae(i,v);return n.useInsertionEffect(()=>{const{width:g,height:p,top:m,left:x,right:y,bottom:b}=w.current;if(s||!i.current||!g||!p)return;const S=o==="left"?`left: ${x}`:`right: ${y}`,t=l==="bottom"?`bottom: ${b}`:`top: ${m}`;i.current.dataset.motionPopId=d;const a=document.createElement("style");C&&(a.nonce=C);const c=u??document.head;return c.appendChild(a),a.sheet&&a.sheet.insertRule(`
          [data-motion-pop-id="${d}"] {
            position: absolute !important;
            width: ${g}px !important;
            height: ${p}px !important;
            ${S}px !important;
            ${t}px !important;
          }
        `),()=>{c.contains(a)&&c.removeChild(a)}},[s]),e.jsx(le,{isPresent:s,childRef:i,sizeRef:w,children:n.cloneElement(r,{ref:h})})}const de=({children:r,initial:s,isPresent:o,onExitComplete:l,custom:u,presenceAffectsLayout:d,mode:i,anchorX:w,anchorY:C,root:v})=>{const h=_(pe),g=n.useId();let p=!0,m=n.useMemo(()=>(p=!1,{id:g,initial:s,isPresent:o,custom:u,onExitComplete:x=>{h.set(x,!0);for(const y of h.values())if(!y)return;l&&l()},register:x=>(h.set(x,!1),()=>h.delete(x))}),[o,h,l]);return d&&p&&(m={...m}),n.useMemo(()=>{h.forEach((x,y)=>h.set(y,!1))},[o]),n.useEffect(()=>{!o&&!h.size&&l&&l()},[o]),i==="popLayout"&&(r=e.jsx(ce,{isPresent:o,anchorX:w,anchorY:C,root:v,children:r})),e.jsx(G.Provider,{value:m,children:r})};function pe(){return new Map}const P=r=>r.key||"";function q(r){const s=[];return n.Children.forEach(r,o=>{n.isValidElement(o)&&s.push(o)}),s}const fe=({children:r,custom:s,initial:o=!0,onExitComplete:l,presenceAffectsLayout:u=!0,mode:d="sync",propagate:i=!1,anchorX:w="left",anchorY:C="top",root:v})=>{const[h,g]=J(i),p=n.useMemo(()=>q(r),[r]),m=i&&!h?[]:p.map(P),x=n.useRef(!0),y=n.useRef(p),b=_(()=>new Map),S=n.useRef(new Set),[t,a]=n.useState(p),[c,k]=n.useState(p);Q(()=>{x.current=!1,y.current=p;for(let j=0;j<c.length;j++){const f=P(c[j]);m.includes(f)?(b.delete(f),S.current.delete(f)):b.get(f)!==!0&&b.set(f,!1)}},[c,m.length,m.join("-")]);const R=[];if(p!==t){let j=[...p];for(let f=0;f<c.length;f++){const z=c[f],$=P(z);m.includes($)||(j.splice(f,0,z),R.push(z))}return d==="wait"&&R.length&&(j=R),k(q(j)),a(p),null}const{forceRender:L}=n.useContext(Z);return e.jsx(e.Fragment,{children:c.map(j=>{const f=P(j),z=i&&!h?!1:p===c||m.includes(f),$=()=>{if(S.current.has(f))return;if(S.current.add(f),b.has(f))b.set(f,!0);else return;let W=!0;b.forEach(O=>{O||(W=!1)}),W&&(L?.(),k(y.current),i&&g?.(),l&&l())};return e.jsx(de,{isPresent:z,initial:!x.current||o?void 0:!1,custom:s,presenceAffectsLayout:u,mode:d,root:v,onExitComplete:z?void 0:$,anchorX:w,anchorY:C,children:j},f)})})},ge=()=>{const{storeId:r}=U(),[s,o]=n.useState(null),[l,u]=n.useState([]),[d,i]=n.useState(!0),[w,C]=n.useState(""),[v,h]=n.useState("all"),[g,p]=n.useState("newest");n.useEffect(()=>{m()},[r]);const m=async()=>{try{let t=await K(V(A,"stores",r)),a=null,c=r;if(t.exists())a=t.data();else{const k=E(M(A,"stores"),D("handle","==",r)),R=await N(k);R.empty||(t=R.docs[0],a=t.data(),c=t.id)}if(a){o({id:c,...a}),document.documentElement.style.setProperty("--primary",a.themeColor||"#6366f1");const k=E(M(A,"products"),D("storeId","==",c)),R=await N(k);u(R.docs.map(L=>({id:L.id,...L.data()})))}}catch(t){console.error(t)}finally{i(!1)}},x=t=>{const a=`Hi ${s.name}, I want to order:

*${t.name}*
Price: ₹${t.price}

Link: ${window.location.href}`,c=encodeURIComponent(a);window.location.href=`https://wa.me/${s.whatsapp}?text=${c}`},y=["all",...new Set(l.map(t=>t.category).filter(Boolean))],S=[...l.filter(t=>{const a=t.name.toLowerCase().includes(w.toLowerCase())||t.description&&t.description.toLowerCase().includes(w.toLowerCase()),c=v==="all"||t.category===v;return a&&c})].sort((t,a)=>{if(g==="price-asc")return parseFloat(t.price)-parseFloat(a.price);if(g==="price-desc")return parseFloat(a.price)-parseFloat(t.price);if(g==="newest"){const c=t.createdAt?new Date(t.createdAt).getTime():0;return(a.createdAt?new Date(a.createdAt).getTime():0)-c}return 0});return d?e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading Store..."}):s?e.jsxs("div",{style:{minHeight:"100vh",background:"var(--background)"},children:[e.jsx("header",{className:"glass",style:{padding:"1rem 5%",position:"sticky",top:0,zIndex:100,borderBottom:"1px solid var(--surface-border)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",maxWidth:"1200px",margin:"0 auto",gap:"1rem"},children:[e.jsxs("h1",{style:{fontSize:"1.25rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[s.logo?e.jsx("img",{src:s.logo,style:{width:"32px",height:"32px",borderRadius:"6px",objectFit:"cover"},alt:"Logo"}):e.jsx(X,{size:24,color:"var(--primary)"}),e.jsx("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"150px"},children:s.name})]}),e.jsxs("div",{style:{position:"relative",flex:1,maxWidth:"300px"},children:[e.jsx(oe,{size:16,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",className:"input",placeholder:"Search catalog...",style:{paddingLeft:"2.5rem",borderRadius:"20px",fontSize:"0.875rem",height:"36px"},value:w,onChange:t=>C(t.target.value)})]})]})}),e.jsxs("div",{style:{background:`linear-gradient(135deg, ${s.themeColor}33, transparent)`,padding:"4rem 5%",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem"},children:[s.logo&&e.jsx(F.img,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},src:s.logo,style:{width:"100px",height:"100px",borderRadius:"20px",objectFit:"cover",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},alt:"Store Logo"}),e.jsxs("div",{children:[e.jsxs("h2",{style:{fontSize:"2.5rem",marginBottom:"0.5rem"},children:["Welcome to ",s.name]}),e.jsx("p",{style:{color:"var(--text-muted)"},children:"Browse our catalog and order directly on WhatsApp"})]})]}),y.length>1&&e.jsx("div",{style:{padding:"1rem 5%",display:"flex",gap:"0.75rem",overflowX:"auto",maxWidth:"1200px",margin:"0 auto",scrollbarWidth:"none",alignItems:"center"},children:y.map(t=>e.jsx("button",{onClick:()=>h(t),className:`btn ${v===t?"btn-primary":"btn-secondary"}`,style:{padding:"0.5rem 1.25rem",fontSize:"0.875rem",whiteSpace:"nowrap",textTransform:"capitalize"},children:t},t))}),e.jsx("div",{style:{padding:"0 5%",maxWidth:"1200px",margin:"1rem auto 0",display:"flex",justifyContent:"flex-end",gap:"1rem"},children:e.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(se,{size:16,color:"var(--text-muted)"}),e.jsxs("select",{value:g,onChange:t=>p(t.target.value),className:"input",style:{padding:"0.5rem",paddingRight:"2rem",borderRadius:"8px",border:"1px solid var(--surface-border)",background:"rgba(255,255,255,0.05)",color:"var(--text)",cursor:"pointer",appearance:"none"},children:[e.jsx("option",{value:"newest",style:{color:"#000000",background:"#ffffff"},children:"Latest Arrivals"}),e.jsx("option",{value:"price-asc",style:{color:"#000000",background:"#ffffff"},children:"Price: Low to High"}),e.jsx("option",{value:"price-desc",style:{color:"#000000",background:"#ffffff"},children:"Price: High to Low"})]}),e.jsx(te,{size:14,style:{position:"absolute",right:"10px",pointerEvents:"none",color:"var(--text-muted)"}})]})}),e.jsx("main",{style:{padding:"2rem 5%",maxWidth:"1200px",margin:"0 auto"},children:S.length===0?e.jsx("div",{style:{textAlign:"center",padding:"4rem",color:"var(--text-muted)"},children:"No products found matching your search."}):e.jsx("div",{className:"grid grid-cols-2",style:{gridTemplateColumns:"repeat(auto-fill, minmax(160px, 1fr))",gap:"1rem"},children:e.jsx(fe,{children:S.map(t=>e.jsxs(F.div,{layout:!0,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"glass glass-card",style:{display:"flex",flexDirection:"column",padding:"0.75rem",gap:"0.75rem"},children:[e.jsxs("div",{style:{position:"relative",overflow:"hidden",borderRadius:"8px",aspectRatio:"1/1"},children:[e.jsx("img",{src:t.image,alt:t.name,style:{width:"100%",height:"100%",objectFit:"cover"}}),t.createdAt&&new Date(t.createdAt)>new Date(Date.now()-10080*60*1e3)&&e.jsx("span",{style:{position:"absolute",top:"8px",right:"8px",background:"var(--primary)",color:"#fff",fontSize:"0.7rem",padding:"2px 6px",borderRadius:"4px",fontWeight:"bold"},children:"NEW"})]}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h3",{style:{fontSize:"0.9rem",marginBottom:"0.25rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.name}),e.jsxs("p",{style:{color:"var(--primary)",fontWeight:"700",fontSize:"1.1rem"},children:["₹",t.price]})]}),e.jsxs("button",{onClick:()=>x(t),className:"btn btn-primary",style:{width:"100%",padding:"0.5rem",fontSize:"0.875rem",background:"#22c55e"},children:[e.jsx(H,{size:16})," Order"]})]},t.id))})})}),e.jsx("a",{href:`https://wa.me/${s.whatsapp}`,style:{position:"fixed",bottom:"2rem",right:"2rem",background:"#22c55e",color:"white",padding:"1rem",borderRadius:"50%",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",display:"flex",zIndex:1e3},children:e.jsx(H,{size:24})})]}):e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Store not found"})};export{ge as default};
