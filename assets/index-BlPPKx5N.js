var gT=i=>{throw TypeError(i)};var Gy=(i,t,e)=>t.has(i)||gT("Cannot "+e);var Te=(i,t,e)=>(Gy(i,t,"read from private field"),e?e.call(i):t.get(i)),ks=(i,t,e)=>t.has(i)?gT("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),Jn=(i,t,e,n)=>(Gy(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e),Ns=(i,t,e)=>(Gy(i,t,"access private method"),e);var yT=(i,t,e,n)=>({set _(s){Jn(i,t,s,e)},get _(){return Te(i,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();function ix(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var $y={exports:{}},ju={};var vT;function QM(){if(vT)return ju;vT=1;var i=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(n,s,a){var l=null;if(a!==void 0&&(l=""+a),s.key!==void 0&&(l=""+s.key),"key"in s){a={};for(var c in s)c!=="key"&&(a[c]=s[c])}else a=s;return s=a.ref,{$$typeof:i,type:n,key:l,ref:s!==void 0?s:null,props:a}}return ju.Fragment=t,ju.jsx=e,ju.jsxs=e,ju}var _T;function JM(){return _T||(_T=1,$y.exports=QM()),$y.exports}var L=JM(),Wy={exports:{}},kt={};var bT;function ZM(){if(bT)return kt;bT=1;var i=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),v=Symbol.iterator;function b(H){return H===null||typeof H!="object"?null:(H=v&&H[v]||H["@@iterator"],typeof H=="function"?H:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,S={};function C(H,et,ct){this.props=H,this.context=et,this.refs=S,this.updater=ct||w}C.prototype.isReactComponent={},C.prototype.setState=function(H,et){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,et,"setState")},C.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function R(){}R.prototype=C.prototype;function I(H,et,ct){this.props=H,this.context=et,this.refs=S,this.updater=ct||w}var B=I.prototype=new R;B.constructor=I,E(B,C.prototype),B.isPureReactComponent=!0;var F=Array.isArray;function j(){}var P={H:null,A:null,T:null,S:null},D=Object.prototype.hasOwnProperty;function M(H,et,ct){var dt=ct.ref;return{$$typeof:i,type:H,key:et,ref:dt!==void 0?dt:null,props:ct}}function V(H,et){return M(H.type,et,H.props)}function O(H){return typeof H=="object"&&H!==null&&H.$$typeof===i}function G(H){var et={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(ct){return et[ct]})}var U=/\/+/g;function gt(H,et){return typeof H=="object"&&H!==null&&H.key!=null?G(""+H.key):et.toString(36)}function Pt(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(j,j):(H.status="pending",H.then(function(et){H.status==="pending"&&(H.status="fulfilled",H.value=et)},function(et){H.status==="pending"&&(H.status="rejected",H.reason=et)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function W(H,et,ct,dt,Et){var Tt=typeof H;(Tt==="undefined"||Tt==="boolean")&&(H=null);var wt=!1;if(H===null)wt=!0;else switch(Tt){case"bigint":case"string":case"number":wt=!0;break;case"object":switch(H.$$typeof){case i:case t:wt=!0;break;case p:return wt=H._init,W(wt(H._payload),et,ct,dt,Et)}}if(wt)return Et=Et(H),wt=dt===""?"."+gt(H,0):dt,F(Et)?(ct="",wt!=null&&(ct=wt.replace(U,"$&/")+"/"),W(Et,et,ct,"",function(Js){return Js})):Et!=null&&(O(Et)&&(Et=V(Et,ct+(Et.key==null||H&&H.key===Et.key?"":(""+Et.key).replace(U,"$&/")+"/")+wt)),et.push(Et)),1;wt=0;var ye=dt===""?".":dt+":";if(F(H))for(var se=0;se<H.length;se++)dt=H[se],Tt=ye+gt(dt,se),wt+=W(dt,et,ct,Tt,Et);else if(se=b(H),typeof se=="function")for(H=se.call(H),se=0;!(dt=H.next()).done;)dt=dt.value,Tt=ye+gt(dt,se++),wt+=W(dt,et,ct,Tt,Et);else if(Tt==="object"){if(typeof H.then=="function")return W(Pt(H),et,ct,dt,Et);throw et=String(H),Error("Objects are not valid as a React child (found: "+(et==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":et)+"). If you meant to render a collection of children, use an array instead.")}return wt}function K(H,et,ct){if(H==null)return H;var dt=[],Et=0;return W(H,dt,"","",function(Tt){return et.call(ct,Tt,Et++)}),dt}function tt(H){if(H._status===-1){var et=H._result;et=et(),et.then(function(ct){(H._status===0||H._status===-1)&&(H._status=1,H._result=ct)},function(ct){(H._status===0||H._status===-1)&&(H._status=2,H._result=ct)}),H._status===-1&&(H._status=0,H._result=et)}if(H._status===1)return H._result.default;throw H._result}var ut=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var et=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(et))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)},At={map:K,forEach:function(H,et,ct){K(H,function(){et.apply(this,arguments)},ct)},count:function(H){var et=0;return K(H,function(){et++}),et},toArray:function(H){return K(H,function(et){return et})||[]},only:function(H){if(!O(H))throw Error("React.Children.only expected to receive a single React element child.");return H}};return kt.Activity=m,kt.Children=At,kt.Component=C,kt.Fragment=e,kt.Profiler=s,kt.PureComponent=I,kt.StrictMode=n,kt.Suspense=h,kt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,kt.__COMPILER_RUNTIME={__proto__:null,c:function(H){return P.H.useMemoCache(H)}},kt.cache=function(H){return function(){return H.apply(null,arguments)}},kt.cacheSignal=function(){return null},kt.cloneElement=function(H,et,ct){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var dt=E({},H.props),Et=H.key;if(et!=null)for(Tt in et.key!==void 0&&(Et=""+et.key),et)!D.call(et,Tt)||Tt==="key"||Tt==="__self"||Tt==="__source"||Tt==="ref"&&et.ref===void 0||(dt[Tt]=et[Tt]);var Tt=arguments.length-2;if(Tt===1)dt.children=ct;else if(1<Tt){for(var wt=Array(Tt),ye=0;ye<Tt;ye++)wt[ye]=arguments[ye+2];dt.children=wt}return M(H.type,Et,dt)},kt.createContext=function(H){return H={$$typeof:l,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:a,_context:H},H},kt.createElement=function(H,et,ct){var dt,Et={},Tt=null;if(et!=null)for(dt in et.key!==void 0&&(Tt=""+et.key),et)D.call(et,dt)&&dt!=="key"&&dt!=="__self"&&dt!=="__source"&&(Et[dt]=et[dt]);var wt=arguments.length-2;if(wt===1)Et.children=ct;else if(1<wt){for(var ye=Array(wt),se=0;se<wt;se++)ye[se]=arguments[se+2];Et.children=ye}if(H&&H.defaultProps)for(dt in wt=H.defaultProps,wt)Et[dt]===void 0&&(Et[dt]=wt[dt]);return M(H,Tt,Et)},kt.createRef=function(){return{current:null}},kt.forwardRef=function(H){return{$$typeof:c,render:H}},kt.isValidElement=O,kt.lazy=function(H){return{$$typeof:p,_payload:{_status:-1,_result:H},_init:tt}},kt.memo=function(H,et){return{$$typeof:d,type:H,compare:et===void 0?null:et}},kt.startTransition=function(H){var et=P.T,ct={};P.T=ct;try{var dt=H(),Et=P.S;Et!==null&&Et(ct,dt),typeof dt=="object"&&dt!==null&&typeof dt.then=="function"&&dt.then(j,ut)}catch(Tt){ut(Tt)}finally{et!==null&&ct.types!==null&&(et.types=ct.types),P.T=et}},kt.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},kt.use=function(H){return P.H.use(H)},kt.useActionState=function(H,et,ct){return P.H.useActionState(H,et,ct)},kt.useCallback=function(H,et){return P.H.useCallback(H,et)},kt.useContext=function(H){return P.H.useContext(H)},kt.useDebugValue=function(){},kt.useDeferredValue=function(H,et){return P.H.useDeferredValue(H,et)},kt.useEffect=function(H,et){return P.H.useEffect(H,et)},kt.useEffectEvent=function(H){return P.H.useEffectEvent(H)},kt.useId=function(){return P.H.useId()},kt.useImperativeHandle=function(H,et,ct){return P.H.useImperativeHandle(H,et,ct)},kt.useInsertionEffect=function(H,et){return P.H.useInsertionEffect(H,et)},kt.useLayoutEffect=function(H,et){return P.H.useLayoutEffect(H,et)},kt.useMemo=function(H,et){return P.H.useMemo(H,et)},kt.useOptimistic=function(H,et){return P.H.useOptimistic(H,et)},kt.useReducer=function(H,et,ct){return P.H.useReducer(H,et,ct)},kt.useRef=function(H){return P.H.useRef(H)},kt.useState=function(H){return P.H.useState(H)},kt.useSyncExternalStore=function(H,et,ct){return P.H.useSyncExternalStore(H,et,ct)},kt.useTransition=function(){return P.H.useTransition()},kt.version="19.2.3",kt}var AT;function Z_(){return AT||(AT=1,Wy.exports=ZM()),Wy.exports}var z=Z_();const tk=ix(z);var Ky={exports:{}},zu={},Yy={exports:{}},Xy={};var ET;function ek(){return ET||(ET=1,(function(i){function t(W,K){var tt=W.length;W.push(K);t:for(;0<tt;){var ut=tt-1>>>1,At=W[ut];if(0<s(At,K))W[ut]=K,W[tt]=At,tt=ut;else break t}}function e(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var K=W[0],tt=W.pop();if(tt!==K){W[0]=tt;t:for(var ut=0,At=W.length,H=At>>>1;ut<H;){var et=2*(ut+1)-1,ct=W[et],dt=et+1,Et=W[dt];if(0>s(ct,tt))dt<At&&0>s(Et,ct)?(W[ut]=Et,W[dt]=tt,ut=dt):(W[ut]=ct,W[et]=tt,ut=et);else if(dt<At&&0>s(Et,tt))W[ut]=Et,W[dt]=tt,ut=dt;else break t}}return K}function s(W,K){var tt=W.sortIndex-K.sortIndex;return tt!==0?tt:W.id-K.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;i.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();i.unstable_now=function(){return l.now()-c}}var h=[],d=[],p=1,m=null,v=3,b=!1,w=!1,E=!1,S=!1,C=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function B(W){for(var K=e(d);K!==null;){if(K.callback===null)n(d);else if(K.startTime<=W)n(d),K.sortIndex=K.expirationTime,t(h,K);else break;K=e(d)}}function F(W){if(E=!1,B(W),!w)if(e(h)!==null)w=!0,j||(j=!0,G());else{var K=e(d);K!==null&&Pt(F,K.startTime-W)}}var j=!1,P=-1,D=5,M=-1;function V(){return S?!0:!(i.unstable_now()-M<D)}function O(){if(S=!1,j){var W=i.unstable_now();M=W;var K=!0;try{t:{w=!1,E&&(E=!1,R(P),P=-1),b=!0;var tt=v;try{e:{for(B(W),m=e(h);m!==null&&!(m.expirationTime>W&&V());){var ut=m.callback;if(typeof ut=="function"){m.callback=null,v=m.priorityLevel;var At=ut(m.expirationTime<=W);if(W=i.unstable_now(),typeof At=="function"){m.callback=At,B(W),K=!0;break e}m===e(h)&&n(h),B(W)}else n(h);m=e(h)}if(m!==null)K=!0;else{var H=e(d);H!==null&&Pt(F,H.startTime-W),K=!1}}break t}finally{m=null,v=tt,b=!1}K=void 0}}finally{K?G():j=!1}}}var G;if(typeof I=="function")G=function(){I(O)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,gt=U.port2;U.port1.onmessage=O,G=function(){gt.postMessage(null)}}else G=function(){C(O,0)};function Pt(W,K){P=C(function(){W(i.unstable_now())},K)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(W){W.callback=null},i.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<W?Math.floor(1e3/W):5},i.unstable_getCurrentPriorityLevel=function(){return v},i.unstable_next=function(W){switch(v){case 1:case 2:case 3:var K=3;break;default:K=v}var tt=v;v=K;try{return W()}finally{v=tt}},i.unstable_requestPaint=function(){S=!0},i.unstable_runWithPriority=function(W,K){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var tt=v;v=W;try{return K()}finally{v=tt}},i.unstable_scheduleCallback=function(W,K,tt){var ut=i.unstable_now();switch(typeof tt=="object"&&tt!==null?(tt=tt.delay,tt=typeof tt=="number"&&0<tt?ut+tt:ut):tt=ut,W){case 1:var At=-1;break;case 2:At=250;break;case 5:At=1073741823;break;case 4:At=1e4;break;default:At=5e3}return At=tt+At,W={id:p++,callback:K,priorityLevel:W,startTime:tt,expirationTime:At,sortIndex:-1},tt>ut?(W.sortIndex=tt,t(d,W),e(h)===null&&W===e(d)&&(E?(R(P),P=-1):E=!0,Pt(F,tt-ut))):(W.sortIndex=At,t(h,W),w||b||(w=!0,j||(j=!0,G()))),W},i.unstable_shouldYield=V,i.unstable_wrapCallback=function(W){var K=v;return function(){var tt=v;v=K;try{return W.apply(this,arguments)}finally{v=tt}}}})(Xy)),Xy}var wT;function nk(){return wT||(wT=1,Yy.exports=ek()),Yy.exports}var Qy={exports:{}},In={};var TT;function ik(){if(TT)return In;TT=1;var i=Z_();function t(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var n={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(h,d,p){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:m==null?null:""+m,children:h,containerInfo:d,implementation:p}}var l=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return In.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,In.createPortal=function(h,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return a(h,d,null,p)},In.flushSync=function(h){var d=l.T,p=n.p;try{if(l.T=null,n.p=2,h)return h()}finally{l.T=d,n.p=p,n.d.f()}},In.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},In.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},In.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var p=d.as,m=c(p,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:m,integrity:v,fetchPriority:b}):p==="script"&&n.d.X(h,{crossOrigin:m,integrity:v,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},In.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=c(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},In.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,m=c(p,d.crossOrigin);n.d.L(h,p,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},In.preloadModule=function(h,d){if(typeof h=="string")if(d){var p=c(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},In.requestFormReset=function(h){n.d.r(h)},In.unstable_batchedUpdates=function(h,d){return h(d)},In.useFormState=function(h,d,p){return l.H.useFormState(h,d,p)},In.useFormStatus=function(){return l.H.useHostTransitionStatus()},In.version="19.2.3",In}var ST;function sk(){if(ST)return Qy.exports;ST=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(t){console.error(t)}}return i(),Qy.exports=ik(),Qy.exports}var CT;function rk(){if(CT)return zu;CT=1;var i=nk(),t=Z_(),e=sk();function n(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var o=r,u=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(u=o.return),r=o.return;while(r)}return o.tag===3?u:null}function l(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function c(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function h(r){if(a(r)!==r)throw Error(n(188))}function d(r){var o=r.alternate;if(!o){if(o=a(r),o===null)throw Error(n(188));return o!==r?null:r}for(var u=r,f=o;;){var y=u.return;if(y===null)break;var _=y.alternate;if(_===null){if(f=y.return,f!==null){u=f;continue}break}if(y.child===_.child){for(_=y.child;_;){if(_===u)return h(y),r;if(_===f)return h(y),o;_=_.sibling}throw Error(n(188))}if(u.return!==f.return)u=y,f=_;else{for(var T=!1,k=y.child;k;){if(k===u){T=!0,u=y,f=_;break}if(k===f){T=!0,f=y,u=_;break}k=k.sibling}if(!T){for(k=_.child;k;){if(k===u){T=!0,u=_,f=y;break}if(k===f){T=!0,f=_,u=y;break}k=k.sibling}if(!T)throw Error(n(189))}}if(u.alternate!==f)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?r:o}function p(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=p(r),o!==null)return o;r=r.sibling}return null}var m=Object.assign,v=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),I=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),O=Symbol.iterator;function G(r){return r===null||typeof r!="object"?null:(r=O&&r[O]||r["@@iterator"],typeof r=="function"?r:null)}var U=Symbol.for("react.client.reference");function gt(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===U?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case E:return"Fragment";case C:return"Profiler";case S:return"StrictMode";case F:return"Suspense";case j:return"SuspenseList";case M:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case w:return"Portal";case I:return r.displayName||"Context";case R:return(r._context.displayName||"Context")+".Consumer";case B:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case P:return o=r.displayName||null,o!==null?o:gt(r.type)||"Memo";case D:o=r._payload,r=r._init;try{return gt(r(o))}catch{}}return null}var Pt=Array.isArray,W=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,tt={pending:!1,data:null,method:null,action:null},ut=[],At=-1;function H(r){return{current:r}}function et(r){0>At||(r.current=ut[At],ut[At]=null,At--)}function ct(r,o){At++,ut[At]=r.current,r.current=o}var dt=H(null),Et=H(null),Tt=H(null),wt=H(null);function ye(r,o){switch(ct(Tt,o),ct(Et,r),ct(dt,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?Fw(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=Fw(o),r=Uw(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}et(dt),ct(dt,r)}function se(){et(dt),et(Et),et(Tt)}function Js(r){r.memoizedState!==null&&ct(wt,r);var o=dt.current,u=Uw(o,r.type);o!==u&&(ct(Et,r),ct(dt,u))}function us(r){Et.current===r&&(et(dt),et(Et)),wt.current===r&&(et(wt),Vu._currentValue=tt)}var hs,Zs;function yi(r){if(hs===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);hs=o&&o[1]||"",Zs=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+hs+r+Zs}var Vc=!1;function $a(r,o){if(!r||Vc)return"";Vc=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(o){var at=function(){throw Error()};if(Object.defineProperty(at.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(at,[])}catch(it){var Z=it}Reflect.construct(r,[],at)}else{try{at.call()}catch(it){Z=it}r.call(at.prototype)}}else{try{throw Error()}catch(it){Z=it}(at=r())&&typeof at.catch=="function"&&at.catch(function(){})}}catch(it){if(it&&Z&&typeof it.stack=="string")return[it.stack,Z.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=f.DetermineComponentFrameRoot(),T=_[0],k=_[1];if(T&&k){var q=T.split(`
`),J=k.split(`
`);for(y=f=0;f<q.length&&!q[f].includes("DetermineComponentFrameRoot");)f++;for(;y<J.length&&!J[y].includes("DetermineComponentFrameRoot");)y++;if(f===q.length||y===J.length)for(f=q.length-1,y=J.length-1;1<=f&&0<=y&&q[f]!==J[y];)y--;for(;1<=f&&0<=y;f--,y--)if(q[f]!==J[y]){if(f!==1||y!==1)do if(f--,y--,0>y||q[f]!==J[y]){var st=`
`+q[f].replace(" at new "," at ");return r.displayName&&st.includes("<anonymous>")&&(st=st.replace("<anonymous>",r.displayName)),st}while(1<=f&&0<=y);break}}}finally{Vc=!1,Error.prepareStackTrace=u}return(u=r?r.displayName||r.name:"")?yi(u):""}function Bc(r,o){switch(r.tag){case 26:case 27:case 5:return yi(r.type);case 16:return yi("Lazy");case 13:return r.child!==o&&o!==null?yi("Suspense Fallback"):yi("Suspense");case 19:return yi("SuspenseList");case 0:case 15:return $a(r.type,!1);case 11:return $a(r.type.render,!1);case 1:return $a(r.type,!0);case 31:return yi("Activity");default:return""}}function Fc(r){try{var o="",u=null;do o+=Bc(r,u),u=r,r=r.return;while(r);return o}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var je=Object.prototype.hasOwnProperty,sn=i.unstable_scheduleCallback,Vr=i.unstable_cancelCallback,Wm=i.unstable_shouldYield,fd=i.unstable_requestPaint,On=i.unstable_now,Wa=i.unstable_getCurrentPriorityLevel,Uc=i.unstable_ImmediatePriority,jc=i.unstable_UserBlockingPriority,Br=i.unstable_NormalPriority,Km=i.unstable_LowPriority,pd=i.unstable_IdlePriority,md=i.log,gd=i.unstable_setDisableYieldValue,ji=null,yn=null;function vi(r){if(typeof md=="function"&&gd(r),yn&&typeof yn.setStrictMode=="function")try{yn.setStrictMode(ji,r)}catch{}}var Oe=Math.clz32?Math.clz32:vd,yd=Math.log,tl=Math.LN2;function vd(r){return r>>>=0,r===0?32:31-(yd(r)/tl|0)|0}var ds=256,Ka=262144,ze=4194304;function fs(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function ps(r,o,u){var f=r.pendingLanes;if(f===0)return 0;var y=0,_=r.suspendedLanes,T=r.pingedLanes;r=r.warmLanes;var k=f&134217727;return k!==0?(f=k&~_,f!==0?y=fs(f):(T&=k,T!==0?y=fs(T):u||(u=k&~r,u!==0&&(y=fs(u))))):(k=f&~_,k!==0?y=fs(k):T!==0?y=fs(T):u||(u=f&~r,u!==0&&(y=fs(u)))),y===0?0:o!==0&&o!==y&&(o&_)===0&&(_=y&-y,u=o&-o,_>=u||_===32&&(u&4194048)!==0)?o:y}function zi(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function Ym(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _d(){var r=ze;return ze<<=1,(ze&62914560)===0&&(ze=4194304),r}function ms(r){for(var o=[],u=0;31>u;u++)o.push(r);return o}function Ya(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Xm(r,o,u,f,y,_){var T=r.pendingLanes;r.pendingLanes=u,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=u,r.entangledLanes&=u,r.errorRecoveryDisabledLanes&=u,r.shellSuspendCounter=0;var k=r.entanglements,q=r.expirationTimes,J=r.hiddenUpdates;for(u=T&~u;0<u;){var st=31-Oe(u),at=1<<st;k[st]=0,q[st]=-1;var Z=J[st];if(Z!==null)for(J[st]=null,st=0;st<Z.length;st++){var it=Z[st];it!==null&&(it.lane&=-536870913)}u&=~at}f!==0&&Xa(r,f,0),_!==0&&y===0&&r.tag!==0&&(r.suspendedLanes|=_&~(T&~o))}function Xa(r,o,u){r.pendingLanes|=o,r.suspendedLanes&=~o;var f=31-Oe(o);r.entangledLanes|=o,r.entanglements[f]=r.entanglements[f]|1073741824|u&261930}function zc(r,o){var u=r.entangledLanes|=o;for(r=r.entanglements;u;){var f=31-Oe(u),y=1<<f;y&o|r[f]&o&&(r[f]|=o),u&=~y}}function Hc(r,o){var u=o&-o;return u=(u&42)!==0?1:Qa(u),(u&(r.suspendedLanes|o))!==0?0:u}function Qa(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function tr(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function bd(){var r=K.p;return r!==0?r:(r=window.event,r===void 0?32:cT(r.type))}function Hi(r,o){var u=K.p;try{return K.p=r,o()}finally{K.p=u}}var qi=Math.random().toString(36).slice(2),He="__reactFiber$"+qi,hn="__reactProps$"+qi,gs="__reactContainer$"+qi,el="__reactEvents$"+qi,Qm="__reactListeners$"+qi,Ad="__reactHandles$"+qi,Ed="__reactResources$"+qi,ys="__reactMarker$"+qi;function nl(r){delete r[He],delete r[hn],delete r[el],delete r[Qm],delete r[Ad]}function vs(r){var o=r[He];if(o)return o;for(var u=r.parentNode;u;){if(o=u[gs]||u[He]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(r=Ww(r);r!==null;){if(u=r[He])return u;r=Ww(r)}return o}r=u,u=r.parentNode}return null}function _i(r){if(r=r[He]||r[gs]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function ii(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(n(33))}function _s(r){var o=r[Ed];return o||(o=r[Ed]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function qe(r){r[ys]=!0}var qc=new Set,Gc={};function bs(r,o){As(r,o),As(r+"Capture",o)}function As(r,o){for(Gc[r]=o,r=0;r<o.length;r++)qc.add(o[r])}var $c=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Wc={},Kc={};function wd(r){return je.call(Kc,r)?!0:je.call(Wc,r)?!1:$c.test(r)?Kc[r]=!0:(Wc[r]=!0,!1)}function il(r,o,u){if(wd(o))if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var f=o.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+u)}}function si(r,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+u)}}function Ge(r,o,u,f){if(f===null)r.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttributeNS(o,u,""+f)}}function dn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Fr(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Yc(r,o,u){var f=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var y=f.get,_=f.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return y.call(this)},set:function(T){u=""+T,_.call(this,T)}}),Object.defineProperty(r,o,{enumerable:f.enumerable}),{getValue:function(){return u},setValue:function(T){u=""+T},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function ae(r){if(!r._valueTracker){var o=Fr(r)?"checked":"value";r._valueTracker=Yc(r,o,""+r[o])}}function Ja(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var u=o.getValue(),f="";return r&&(f=Fr(r)?r.checked?"true":"false":r.value),r=f,r!==u?(o.setValue(r),!0):!1}function Es(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Za=/[\n"\\]/g;function Gn(r){return r.replace(Za,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function sl(r,o,u,f,y,_,T,k){r.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?r.type=T:r.removeAttribute("type"),o!=null?T==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+dn(o)):r.value!==""+dn(o)&&(r.value=""+dn(o)):T!=="submit"&&T!=="reset"||r.removeAttribute("value"),o!=null?Xc(r,T,dn(o)):u!=null?Xc(r,T,dn(u)):f!=null&&r.removeAttribute("value"),y==null&&_!=null&&(r.defaultChecked=!!_),y!=null&&(r.checked=y&&typeof y!="function"&&typeof y!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?r.name=""+dn(k):r.removeAttribute("name")}function Td(r,o,u,f,y,_,T,k){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(r.type=_),o!=null||u!=null){if(!(_!=="submit"&&_!=="reset"||o!=null)){ae(r);return}u=u!=null?""+dn(u):"",o=o!=null?""+dn(o):u,k||o===r.value||(r.value=o),r.defaultValue=o}f=f??y,f=typeof f!="function"&&typeof f!="symbol"&&!!f,r.checked=k?r.checked:!!f,r.defaultChecked=!!f,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(r.name=T),ae(r)}function Xc(r,o,u){o==="number"&&Es(r.ownerDocument)===r||r.defaultValue===""+u||(r.defaultValue=""+u)}function Ur(r,o,u,f){if(r=r.options,o){o={};for(var y=0;y<u.length;y++)o["$"+u[y]]=!0;for(u=0;u<r.length;u++)y=o.hasOwnProperty("$"+r[u].value),r[u].selected!==y&&(r[u].selected=y),y&&f&&(r[u].defaultSelected=!0)}else{for(u=""+dn(u),o=null,y=0;y<r.length;y++){if(r[y].value===u){r[y].selected=!0,f&&(r[y].defaultSelected=!0);return}o!==null||r[y].disabled||(o=r[y])}o!==null&&(o.selected=!0)}}function Sd(r,o,u){if(o!=null&&(o=""+dn(o),o!==r.value&&(r.value=o),u==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=u!=null?""+dn(u):""}function jr(r,o,u,f){if(o==null){if(f!=null){if(u!=null)throw Error(n(92));if(Pt(f)){if(1<f.length)throw Error(n(93));f=f[0]}u=f}u==null&&(u=""),o=u}u=dn(o),r.defaultValue=u,f=r.textContent,f===u&&f!==""&&f!==null&&(r.value=f),ae(r)}function $n(r,o){if(o){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=o;return}}r.textContent=o}var Cd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Qc(r,o,u){var f=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?f?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":f?r.setProperty(o,u):typeof u!="number"||u===0||Cd.has(o)?o==="float"?r.cssFloat=u:r[o]=(""+u).trim():r[o]=u+"px"}function Jc(r,o,u){if(o!=null&&typeof o!="object")throw Error(n(62));if(r=r.style,u!=null){for(var f in u)!u.hasOwnProperty(f)||o!=null&&o.hasOwnProperty(f)||(f.indexOf("--")===0?r.setProperty(f,""):f==="float"?r.cssFloat="":r[f]="");for(var y in o)f=o[y],o.hasOwnProperty(y)&&u[y]!==f&&Qc(r,y,f)}else for(var _ in o)o.hasOwnProperty(_)&&Qc(r,_,o[_])}function rl(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),zr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function al(r){return zr.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Gi(){}var Zc=null;function bi(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Hr=null,ws=null;function to(r){var o=_i(r);if(o&&(r=o.stateNode)){var u=r[hn]||null;t:switch(r=o.stateNode,o.type){case"input":if(sl(r,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Gn(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var f=u[o];if(f!==r&&f.form===r.form){var y=f[hn]||null;if(!y)throw Error(n(90));sl(f,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(o=0;o<u.length;o++)f=u[o],f.form===r.form&&Ja(f)}break t;case"textarea":Sd(r,u.value,u.defaultValue);break t;case"select":o=u.value,o!=null&&Ur(r,!!u.multiple,o,!1)}}}var ol=!1;function qr(r,o,u){if(ol)return r(o,u);ol=!0;try{var f=r(o);return f}finally{if(ol=!1,(Hr!==null||ws!==null)&&(Af(),Hr&&(o=Hr,r=ws,ws=Hr=null,to(o),r)))for(o=0;o<r.length;o++)to(r[o])}}function $i(r,o){var u=r.stateNode;if(u===null)return null;var f=u[hn]||null;if(f===null)return null;u=f[o];t:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(r=r.type,f=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!f;break t;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(n(231,o,typeof u));return u}var Ai=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),eo=!1;if(Ai)try{var ce={};Object.defineProperty(ce,"passive",{get:function(){eo=!0}}),window.addEventListener("test",ce,ce),window.removeEventListener("test",ce,ce)}catch{eo=!1}var Ts=null,tu=null,no=null;function eu(){if(no)return no;var r,o=tu,u=o.length,f,y="value"in Ts?Ts.value:Ts.textContent,_=y.length;for(r=0;r<u&&o[r]===y[r];r++);var T=u-r;for(f=1;f<=T&&o[u-f]===y[_-f];f++);return no=y.slice(r,1<f?1-f:void 0)}function io(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function er(){return!0}function Wi(){return!1}function vn(r){function o(u,f,y,_,T){this._reactName=u,this._targetInst=y,this.type=f,this.nativeEvent=_,this.target=T,this.currentTarget=null;for(var k in r)r.hasOwnProperty(k)&&(u=r[k],this[k]=u?u(_):_[k]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?er:Wi,this.isPropagationStopped=Wi,this}return m(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=er)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=er)},persist:function(){},isPersistent:er}),o}var nr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ss=vn(nr),Gr=m({},nr,{view:0,detail:0}),nu=vn(Gr),$r,ll,Cs,cl=m({},Gr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wr,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Cs&&(Cs&&r.type==="mousemove"?($r=r.screenX-Cs.screenX,ll=r.screenY-Cs.screenY):ll=$r=0,Cs=r),$r)},movementY:function(r){return"movementY"in r?r.movementY:ll}}),iu=vn(cl),so=m({},cl,{dataTransfer:0}),Rd=vn(so),Id=m({},Gr,{relatedTarget:0}),ro=vn(Id),su=m({},nr,{animationName:0,elapsedTime:0,pseudoElement:0}),Dd=vn(su),ul=m({},nr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Pd=vn(ul),Md=m({},nr,{data:0}),xs=vn(Md),kd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ld(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=Od[r])?!!o[r]:!1}function Wr(){return Ld}var Ln=m({},Gr,{key:function(r){if(r.key){var o=kd[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=io(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Nd[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wr,charCode:function(r){return r.type==="keypress"?io(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?io(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Vd=vn(Ln),Bd=m({},cl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ir=vn(Bd),g=m({},Gr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wr}),A=vn(g),x=m({},nr,{propertyName:0,elapsedTime:0,pseudoElement:0}),N=vn(x),X=m({},cl,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),nt=vn(X),ht=m({},nr,{newState:0,oldState:0}),Bt=vn(ht),Le=[9,13,27,32],te=Ai&&"CompositionEvent"in window,Ee=null;Ai&&"documentMode"in document&&(Ee=document.documentMode);var Ei=Ai&&"TextEvent"in window&&!Ee,Rs=Ai&&(!te||Ee&&8<Ee&&11>=Ee),Ki=" ",Yi=!1;function ao(r,o){switch(r){case"keyup":return Le.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hl(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var dl=!1;function A2(r,o){switch(r){case"compositionend":return hl(o);case"keypress":return o.which!==32?null:(Yi=!0,Ki);case"textInput":return r=o.data,r===Ki&&Yi?null:r;default:return null}}function E2(r,o){if(dl)return r==="compositionend"||!te&&ao(r,o)?(r=eu(),no=tu=Ts=null,dl=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Rs&&o.locale!=="ko"?null:o.data;default:return null}}var w2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xb(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!w2[r.type]:o==="textarea"}function Qb(r,o,u,f){Hr?ws?ws.push(f):ws=[f]:Hr=f,o=Rf(o,"onChange"),0<o.length&&(u=new Ss("onChange","change",null,u,f),r.push({event:u,listeners:o}))}var ru=null,au=null;function T2(r){kw(r,0)}function Fd(r){var o=ii(r);if(Ja(o))return r}function Jb(r,o){if(r==="change")return o}var Zb=!1;if(Ai){var Jm;if(Ai){var Zm="oninput"in document;if(!Zm){var tA=document.createElement("div");tA.setAttribute("oninput","return;"),Zm=typeof tA.oninput=="function"}Jm=Zm}else Jm=!1;Zb=Jm&&(!document.documentMode||9<document.documentMode)}function eA(){ru&&(ru.detachEvent("onpropertychange",nA),au=ru=null)}function nA(r){if(r.propertyName==="value"&&Fd(au)){var o=[];Qb(o,au,r,bi(r)),qr(T2,o)}}function S2(r,o,u){r==="focusin"?(eA(),ru=o,au=u,ru.attachEvent("onpropertychange",nA)):r==="focusout"&&eA()}function C2(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Fd(au)}function x2(r,o){if(r==="click")return Fd(o)}function R2(r,o){if(r==="input"||r==="change")return Fd(o)}function I2(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var ri=typeof Object.is=="function"?Object.is:I2;function ou(r,o){if(ri(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var u=Object.keys(r),f=Object.keys(o);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var y=u[f];if(!je.call(o,y)||!ri(r[y],o[y]))return!1}return!0}function iA(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function sA(r,o){var u=iA(r);r=0;for(var f;u;){if(u.nodeType===3){if(f=r+u.textContent.length,r<=o&&f>=o)return{node:u,offset:o-r};r=f}t:{for(;u;){if(u.nextSibling){u=u.nextSibling;break t}u=u.parentNode}u=void 0}u=iA(u)}}function rA(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?rA(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function aA(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=Es(r.document);o instanceof r.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)r=o.contentWindow;else break;o=Es(r.document)}return o}function tg(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var D2=Ai&&"documentMode"in document&&11>=document.documentMode,fl=null,eg=null,lu=null,ng=!1;function oA(r,o,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;ng||fl==null||fl!==Es(f)||(f=fl,"selectionStart"in f&&tg(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),lu&&ou(lu,f)||(lu=f,f=Rf(eg,"onSelect"),0<f.length&&(o=new Ss("onSelect","select",null,o,u),r.push({event:o,listeners:f}),o.target=fl)))}function oo(r,o){var u={};return u[r.toLowerCase()]=o.toLowerCase(),u["Webkit"+r]="webkit"+o,u["Moz"+r]="moz"+o,u}var pl={animationend:oo("Animation","AnimationEnd"),animationiteration:oo("Animation","AnimationIteration"),animationstart:oo("Animation","AnimationStart"),transitionrun:oo("Transition","TransitionRun"),transitionstart:oo("Transition","TransitionStart"),transitioncancel:oo("Transition","TransitionCancel"),transitionend:oo("Transition","TransitionEnd")},ig={},lA={};Ai&&(lA=document.createElement("div").style,"AnimationEvent"in window||(delete pl.animationend.animation,delete pl.animationiteration.animation,delete pl.animationstart.animation),"TransitionEvent"in window||delete pl.transitionend.transition);function lo(r){if(ig[r])return ig[r];if(!pl[r])return r;var o=pl[r],u;for(u in o)if(o.hasOwnProperty(u)&&u in lA)return ig[r]=o[u];return r}var cA=lo("animationend"),uA=lo("animationiteration"),hA=lo("animationstart"),P2=lo("transitionrun"),M2=lo("transitionstart"),k2=lo("transitioncancel"),dA=lo("transitionend"),fA=new Map,sg="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");sg.push("scrollEnd");function Xi(r,o){fA.set(r,o),bs(o,[r])}var Ud=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},wi=[],ml=0,rg=0;function jd(){for(var r=ml,o=rg=ml=0;o<r;){var u=wi[o];wi[o++]=null;var f=wi[o];wi[o++]=null;var y=wi[o];wi[o++]=null;var _=wi[o];if(wi[o++]=null,f!==null&&y!==null){var T=f.pending;T===null?y.next=y:(y.next=T.next,T.next=y),f.pending=y}_!==0&&pA(u,y,_)}}function zd(r,o,u,f){wi[ml++]=r,wi[ml++]=o,wi[ml++]=u,wi[ml++]=f,rg|=f,r.lanes|=f,r=r.alternate,r!==null&&(r.lanes|=f)}function ag(r,o,u,f){return zd(r,o,u,f),Hd(r)}function co(r,o){return zd(r,null,null,o),Hd(r)}function pA(r,o,u){r.lanes|=u;var f=r.alternate;f!==null&&(f.lanes|=u);for(var y=!1,_=r.return;_!==null;)_.childLanes|=u,f=_.alternate,f!==null&&(f.childLanes|=u),_.tag===22&&(r=_.stateNode,r===null||r._visibility&1||(y=!0)),r=_,_=_.return;return r.tag===3?(_=r.stateNode,y&&o!==null&&(y=31-Oe(u),r=_.hiddenUpdates,f=r[y],f===null?r[y]=[o]:f.push(o),o.lane=u|536870912),_):null}function Hd(r){if(50<Du)throw Du=0,my=null,Error(n(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var gl={};function N2(r,o,u,f){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ai(r,o,u,f){return new N2(r,o,u,f)}function og(r){return r=r.prototype,!(!r||!r.isReactComponent)}function sr(r,o){var u=r.alternate;return u===null?(u=ai(r.tag,o,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=o,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&65011712,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,o=r.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u.refCleanup=r.refCleanup,u}function mA(r,o){r.flags&=65011714;var u=r.alternate;return u===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=u.childLanes,r.lanes=u.lanes,r.child=u.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=u.memoizedProps,r.memoizedState=u.memoizedState,r.updateQueue=u.updateQueue,r.type=u.type,o=u.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function qd(r,o,u,f,y,_){var T=0;if(f=r,typeof r=="function")og(r)&&(T=1);else if(typeof r=="string")T=FM(r,u,dt.current)?26:r==="html"||r==="head"||r==="body"?27:5;else t:switch(r){case M:return r=ai(31,u,o,y),r.elementType=M,r.lanes=_,r;case E:return uo(u.children,y,_,o);case S:T=8,y|=24;break;case C:return r=ai(12,u,o,y|2),r.elementType=C,r.lanes=_,r;case F:return r=ai(13,u,o,y),r.elementType=F,r.lanes=_,r;case j:return r=ai(19,u,o,y),r.elementType=j,r.lanes=_,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case I:T=10;break t;case R:T=9;break t;case B:T=11;break t;case P:T=14;break t;case D:T=16,f=null;break t}T=29,u=Error(n(130,r===null?"null":typeof r,"")),f=null}return o=ai(T,u,o,y),o.elementType=r,o.type=f,o.lanes=_,o}function uo(r,o,u,f){return r=ai(7,r,f,o),r.lanes=u,r}function lg(r,o,u){return r=ai(6,r,null,o),r.lanes=u,r}function gA(r){var o=ai(18,null,null,0);return o.stateNode=r,o}function cg(r,o,u){return o=ai(4,r.children!==null?r.children:[],r.key,o),o.lanes=u,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var yA=new WeakMap;function Ti(r,o){if(typeof r=="object"&&r!==null){var u=yA.get(r);return u!==void 0?u:(o={value:r,source:o,stack:Fc(o)},yA.set(r,o),o)}return{value:r,source:o,stack:Fc(o)}}var yl=[],vl=0,Gd=null,cu=0,Si=[],Ci=0,Kr=null,Is=1,Ds="";function rr(r,o){yl[vl++]=cu,yl[vl++]=Gd,Gd=r,cu=o}function vA(r,o,u){Si[Ci++]=Is,Si[Ci++]=Ds,Si[Ci++]=Kr,Kr=r;var f=Is;r=Ds;var y=32-Oe(f)-1;f&=~(1<<y),u+=1;var _=32-Oe(o)+y;if(30<_){var T=y-y%5;_=(f&(1<<T)-1).toString(32),f>>=T,y-=T,Is=1<<32-Oe(o)+y|u<<y|f,Ds=_+r}else Is=1<<_|u<<y|f,Ds=r}function ug(r){r.return!==null&&(rr(r,1),vA(r,1,0))}function hg(r){for(;r===Gd;)Gd=yl[--vl],yl[vl]=null,cu=yl[--vl],yl[vl]=null;for(;r===Kr;)Kr=Si[--Ci],Si[Ci]=null,Ds=Si[--Ci],Si[Ci]=null,Is=Si[--Ci],Si[Ci]=null}function _A(r,o){Si[Ci++]=Is,Si[Ci++]=Ds,Si[Ci++]=Kr,Is=o.id,Ds=o.overflow,Kr=r}var _n=null,ve=null,Kt=!1,Yr=null,xi=!1,dg=Error(n(519));function Xr(r){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw uu(Ti(o,r)),dg}function bA(r){var o=r.stateNode,u=r.type,f=r.memoizedProps;switch(o[He]=r,o[hn]=f,u){case"dialog":zt("cancel",o),zt("close",o);break;case"iframe":case"object":case"embed":zt("load",o);break;case"video":case"audio":for(u=0;u<Mu.length;u++)zt(Mu[u],o);break;case"source":zt("error",o);break;case"img":case"image":case"link":zt("error",o),zt("load",o);break;case"details":zt("toggle",o);break;case"input":zt("invalid",o),Td(o,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":zt("invalid",o);break;case"textarea":zt("invalid",o),jr(o,f.value,f.defaultValue,f.children)}u=f.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||f.suppressHydrationWarning===!0||Vw(o.textContent,u)?(f.popover!=null&&(zt("beforetoggle",o),zt("toggle",o)),f.onScroll!=null&&zt("scroll",o),f.onScrollEnd!=null&&zt("scrollend",o),f.onClick!=null&&(o.onclick=Gi),o=!0):o=!1,o||Xr(r,!0)}function AA(r){for(_n=r.return;_n;)switch(_n.tag){case 5:case 31:case 13:xi=!1;return;case 27:case 3:xi=!0;return;default:_n=_n.return}}function _l(r){if(r!==_n)return!1;if(!Kt)return AA(r),Kt=!0,!1;var o=r.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=r.type,u=!(u!=="form"&&u!=="button")||Dy(r.type,r.memoizedProps)),u=!u),u&&ve&&Xr(r),AA(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));ve=$w(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));ve=$w(r)}else o===27?(o=ve,ua(r.type)?(r=Oy,Oy=null,ve=r):ve=o):ve=_n?Ii(r.stateNode.nextSibling):null;return!0}function ho(){ve=_n=null,Kt=!1}function fg(){var r=Yr;return r!==null&&(Xn===null?Xn=r:Xn.push.apply(Xn,r),Yr=null),r}function uu(r){Yr===null?Yr=[r]:Yr.push(r)}var pg=H(null),fo=null,ar=null;function Qr(r,o,u){ct(pg,o._currentValue),o._currentValue=u}function or(r){r._currentValue=pg.current,et(pg)}function mg(r,o,u){for(;r!==null;){var f=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),r===u)break;r=r.return}}function gg(r,o,u,f){var y=r.child;for(y!==null&&(y.return=r);y!==null;){var _=y.dependencies;if(_!==null){var T=y.child;_=_.firstContext;t:for(;_!==null;){var k=_;_=y;for(var q=0;q<o.length;q++)if(k.context===o[q]){_.lanes|=u,k=_.alternate,k!==null&&(k.lanes|=u),mg(_.return,u,r),f||(T=null);break t}_=k.next}}else if(y.tag===18){if(T=y.return,T===null)throw Error(n(341));T.lanes|=u,_=T.alternate,_!==null&&(_.lanes|=u),mg(T,u,r),T=null}else T=y.child;if(T!==null)T.return=y;else for(T=y;T!==null;){if(T===r){T=null;break}if(y=T.sibling,y!==null){y.return=T.return,T=y;break}T=T.return}y=T}}function bl(r,o,u,f){r=null;for(var y=o,_=!1;y!==null;){if(!_){if((y.flags&524288)!==0)_=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var T=y.alternate;if(T===null)throw Error(n(387));if(T=T.memoizedProps,T!==null){var k=y.type;ri(y.pendingProps.value,T.value)||(r!==null?r.push(k):r=[k])}}else if(y===wt.current){if(T=y.alternate,T===null)throw Error(n(387));T.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(r!==null?r.push(Vu):r=[Vu])}y=y.return}r!==null&&gg(o,r,u,f),o.flags|=262144}function $d(r){for(r=r.firstContext;r!==null;){if(!ri(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function po(r){fo=r,ar=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function bn(r){return EA(fo,r)}function Wd(r,o){return fo===null&&po(r),EA(r,o)}function EA(r,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},ar===null){if(r===null)throw Error(n(308));ar=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else ar=ar.next=o;return u}var O2=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(u,f){r.push(f)}};this.abort=function(){o.aborted=!0,r.forEach(function(u){return u()})}},L2=i.unstable_scheduleCallback,V2=i.unstable_NormalPriority,$e={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function yg(){return{controller:new O2,data:new Map,refCount:0}}function hu(r){r.refCount--,r.refCount===0&&L2(V2,function(){r.controller.abort()})}var du=null,vg=0,Al=0,El=null;function B2(r,o){if(du===null){var u=du=[];vg=0,Al=Ay(),El={status:"pending",value:void 0,then:function(f){u.push(f)}}}return vg++,o.then(wA,wA),o}function wA(){if(--vg===0&&du!==null){El!==null&&(El.status="fulfilled");var r=du;du=null,Al=0,El=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function F2(r,o){var u=[],f={status:"pending",value:null,reason:null,then:function(y){u.push(y)}};return r.then(function(){f.status="fulfilled",f.value=o;for(var y=0;y<u.length;y++)(0,u[y])(o)},function(y){for(f.status="rejected",f.reason=y,y=0;y<u.length;y++)(0,u[y])(void 0)}),f}var TA=W.S;W.S=function(r,o){ow=On(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&B2(r,o),TA!==null&&TA(r,o)};var mo=H(null);function _g(){var r=mo.current;return r!==null?r:pe.pooledCache}function Kd(r,o){o===null?ct(mo,mo.current):ct(mo,o.pool)}function SA(){var r=_g();return r===null?null:{parent:$e._currentValue,pool:r}}var wl=Error(n(460)),bg=Error(n(474)),Yd=Error(n(542)),Xd={then:function(){}};function CA(r){return r=r.status,r==="fulfilled"||r==="rejected"}function xA(r,o,u){switch(u=r[u],u===void 0?r.push(o):u!==o&&(o.then(Gi,Gi),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,IA(r),r;default:if(typeof o.status=="string")o.then(Gi,Gi);else{if(r=pe,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=o,r.status="pending",r.then(function(f){if(o.status==="pending"){var y=o;y.status="fulfilled",y.value=f}},function(f){if(o.status==="pending"){var y=o;y.status="rejected",y.reason=f}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,IA(r),r}throw yo=o,wl}}function go(r){try{var o=r._init;return o(r._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(yo=u,wl):u}}var yo=null;function RA(){if(yo===null)throw Error(n(459));var r=yo;return yo=null,r}function IA(r){if(r===wl||r===Yd)throw Error(n(483))}var Tl=null,fu=0;function Qd(r){var o=fu;return fu+=1,Tl===null&&(Tl=[]),xA(Tl,r,o)}function pu(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function Jd(r,o){throw o.$$typeof===v?Error(n(525)):(r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function DA(r){function o(Y,$){if(r){var Q=Y.deletions;Q===null?(Y.deletions=[$],Y.flags|=16):Q.push($)}}function u(Y,$){if(!r)return null;for(;$!==null;)o(Y,$),$=$.sibling;return null}function f(Y){for(var $=new Map;Y!==null;)Y.key!==null?$.set(Y.key,Y):$.set(Y.index,Y),Y=Y.sibling;return $}function y(Y,$){return Y=sr(Y,$),Y.index=0,Y.sibling=null,Y}function _(Y,$,Q){return Y.index=Q,r?(Q=Y.alternate,Q!==null?(Q=Q.index,Q<$?(Y.flags|=67108866,$):Q):(Y.flags|=67108866,$)):(Y.flags|=1048576,$)}function T(Y){return r&&Y.alternate===null&&(Y.flags|=67108866),Y}function k(Y,$,Q,rt){return $===null||$.tag!==6?($=lg(Q,Y.mode,rt),$.return=Y,$):($=y($,Q),$.return=Y,$)}function q(Y,$,Q,rt){var St=Q.type;return St===E?st(Y,$,Q.props.children,rt,Q.key):$!==null&&($.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===D&&go(St)===$.type)?($=y($,Q.props),pu($,Q),$.return=Y,$):($=qd(Q.type,Q.key,Q.props,null,Y.mode,rt),pu($,Q),$.return=Y,$)}function J(Y,$,Q,rt){return $===null||$.tag!==4||$.stateNode.containerInfo!==Q.containerInfo||$.stateNode.implementation!==Q.implementation?($=cg(Q,Y.mode,rt),$.return=Y,$):($=y($,Q.children||[]),$.return=Y,$)}function st(Y,$,Q,rt,St){return $===null||$.tag!==7?($=uo(Q,Y.mode,rt,St),$.return=Y,$):($=y($,Q),$.return=Y,$)}function at(Y,$,Q){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=lg(""+$,Y.mode,Q),$.return=Y,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case b:return Q=qd($.type,$.key,$.props,null,Y.mode,Q),pu(Q,$),Q.return=Y,Q;case w:return $=cg($,Y.mode,Q),$.return=Y,$;case D:return $=go($),at(Y,$,Q)}if(Pt($)||G($))return $=uo($,Y.mode,Q,null),$.return=Y,$;if(typeof $.then=="function")return at(Y,Qd($),Q);if($.$$typeof===I)return at(Y,Wd(Y,$),Q);Jd(Y,$)}return null}function Z(Y,$,Q,rt){var St=$!==null?$.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return St!==null?null:k(Y,$,""+Q,rt);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case b:return Q.key===St?q(Y,$,Q,rt):null;case w:return Q.key===St?J(Y,$,Q,rt):null;case D:return Q=go(Q),Z(Y,$,Q,rt)}if(Pt(Q)||G(Q))return St!==null?null:st(Y,$,Q,rt,null);if(typeof Q.then=="function")return Z(Y,$,Qd(Q),rt);if(Q.$$typeof===I)return Z(Y,$,Wd(Y,Q),rt);Jd(Y,Q)}return null}function it(Y,$,Q,rt,St){if(typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint")return Y=Y.get(Q)||null,k($,Y,""+rt,St);if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case b:return Y=Y.get(rt.key===null?Q:rt.key)||null,q($,Y,rt,St);case w:return Y=Y.get(rt.key===null?Q:rt.key)||null,J($,Y,rt,St);case D:return rt=go(rt),it(Y,$,Q,rt,St)}if(Pt(rt)||G(rt))return Y=Y.get(Q)||null,st($,Y,rt,St,null);if(typeof rt.then=="function")return it(Y,$,Q,Qd(rt),St);if(rt.$$typeof===I)return it(Y,$,Q,Wd($,rt),St);Jd($,rt)}return null}function vt(Y,$,Q,rt){for(var St=null,Jt=null,bt=$,Ut=$=0,qt=null;bt!==null&&Ut<Q.length;Ut++){bt.index>Ut?(qt=bt,bt=null):qt=bt.sibling;var Zt=Z(Y,bt,Q[Ut],rt);if(Zt===null){bt===null&&(bt=qt);break}r&&bt&&Zt.alternate===null&&o(Y,bt),$=_(Zt,$,Ut),Jt===null?St=Zt:Jt.sibling=Zt,Jt=Zt,bt=qt}if(Ut===Q.length)return u(Y,bt),Kt&&rr(Y,Ut),St;if(bt===null){for(;Ut<Q.length;Ut++)bt=at(Y,Q[Ut],rt),bt!==null&&($=_(bt,$,Ut),Jt===null?St=bt:Jt.sibling=bt,Jt=bt);return Kt&&rr(Y,Ut),St}for(bt=f(bt);Ut<Q.length;Ut++)qt=it(bt,Y,Ut,Q[Ut],rt),qt!==null&&(r&&qt.alternate!==null&&bt.delete(qt.key===null?Ut:qt.key),$=_(qt,$,Ut),Jt===null?St=qt:Jt.sibling=qt,Jt=qt);return r&&bt.forEach(function(ma){return o(Y,ma)}),Kt&&rr(Y,Ut),St}function Rt(Y,$,Q,rt){if(Q==null)throw Error(n(151));for(var St=null,Jt=null,bt=$,Ut=$=0,qt=null,Zt=Q.next();bt!==null&&!Zt.done;Ut++,Zt=Q.next()){bt.index>Ut?(qt=bt,bt=null):qt=bt.sibling;var ma=Z(Y,bt,Zt.value,rt);if(ma===null){bt===null&&(bt=qt);break}r&&bt&&ma.alternate===null&&o(Y,bt),$=_(ma,$,Ut),Jt===null?St=ma:Jt.sibling=ma,Jt=ma,bt=qt}if(Zt.done)return u(Y,bt),Kt&&rr(Y,Ut),St;if(bt===null){for(;!Zt.done;Ut++,Zt=Q.next())Zt=at(Y,Zt.value,rt),Zt!==null&&($=_(Zt,$,Ut),Jt===null?St=Zt:Jt.sibling=Zt,Jt=Zt);return Kt&&rr(Y,Ut),St}for(bt=f(bt);!Zt.done;Ut++,Zt=Q.next())Zt=it(bt,Y,Ut,Zt.value,rt),Zt!==null&&(r&&Zt.alternate!==null&&bt.delete(Zt.key===null?Ut:Zt.key),$=_(Zt,$,Ut),Jt===null?St=Zt:Jt.sibling=Zt,Jt=Zt);return r&&bt.forEach(function(XM){return o(Y,XM)}),Kt&&rr(Y,Ut),St}function de(Y,$,Q,rt){if(typeof Q=="object"&&Q!==null&&Q.type===E&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case b:t:{for(var St=Q.key;$!==null;){if($.key===St){if(St=Q.type,St===E){if($.tag===7){u(Y,$.sibling),rt=y($,Q.props.children),rt.return=Y,Y=rt;break t}}else if($.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===D&&go(St)===$.type){u(Y,$.sibling),rt=y($,Q.props),pu(rt,Q),rt.return=Y,Y=rt;break t}u(Y,$);break}else o(Y,$);$=$.sibling}Q.type===E?(rt=uo(Q.props.children,Y.mode,rt,Q.key),rt.return=Y,Y=rt):(rt=qd(Q.type,Q.key,Q.props,null,Y.mode,rt),pu(rt,Q),rt.return=Y,Y=rt)}return T(Y);case w:t:{for(St=Q.key;$!==null;){if($.key===St)if($.tag===4&&$.stateNode.containerInfo===Q.containerInfo&&$.stateNode.implementation===Q.implementation){u(Y,$.sibling),rt=y($,Q.children||[]),rt.return=Y,Y=rt;break t}else{u(Y,$);break}else o(Y,$);$=$.sibling}rt=cg(Q,Y.mode,rt),rt.return=Y,Y=rt}return T(Y);case D:return Q=go(Q),de(Y,$,Q,rt)}if(Pt(Q))return vt(Y,$,Q,rt);if(G(Q)){if(St=G(Q),typeof St!="function")throw Error(n(150));return Q=St.call(Q),Rt(Y,$,Q,rt)}if(typeof Q.then=="function")return de(Y,$,Qd(Q),rt);if(Q.$$typeof===I)return de(Y,$,Wd(Y,Q),rt);Jd(Y,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,$!==null&&$.tag===6?(u(Y,$.sibling),rt=y($,Q),rt.return=Y,Y=rt):(u(Y,$),rt=lg(Q,Y.mode,rt),rt.return=Y,Y=rt),T(Y)):u(Y,$)}return function(Y,$,Q,rt){try{fu=0;var St=de(Y,$,Q,rt);return Tl=null,St}catch(bt){if(bt===wl||bt===Yd)throw bt;var Jt=ai(29,bt,null,Y.mode);return Jt.lanes=rt,Jt.return=Y,Jt}}}var vo=DA(!0),PA=DA(!1),Jr=!1;function Ag(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Eg(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Zr(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ta(r,o,u){var f=r.updateQueue;if(f===null)return null;if(f=f.shared,(ee&2)!==0){var y=f.pending;return y===null?o.next=o:(o.next=y.next,y.next=o),f.pending=o,o=Hd(r),pA(r,null,u),o}return zd(r,f,o,u),Hd(r)}function mu(r,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var f=o.lanes;f&=r.pendingLanes,u|=f,o.lanes=u,zc(r,u)}}function wg(r,o){var u=r.updateQueue,f=r.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var y=null,_=null;if(u=u.firstBaseUpdate,u!==null){do{var T={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};_===null?y=_=T:_=_.next=T,u=u.next}while(u!==null);_===null?y=_=o:_=_.next=o}else y=_=o;u={baseState:f.baseState,firstBaseUpdate:y,lastBaseUpdate:_,shared:f.shared,callbacks:f.callbacks},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=o:r.next=o,u.lastBaseUpdate=o}var Tg=!1;function gu(){if(Tg){var r=El;if(r!==null)throw r}}function yu(r,o,u,f){Tg=!1;var y=r.updateQueue;Jr=!1;var _=y.firstBaseUpdate,T=y.lastBaseUpdate,k=y.shared.pending;if(k!==null){y.shared.pending=null;var q=k,J=q.next;q.next=null,T===null?_=J:T.next=J,T=q;var st=r.alternate;st!==null&&(st=st.updateQueue,k=st.lastBaseUpdate,k!==T&&(k===null?st.firstBaseUpdate=J:k.next=J,st.lastBaseUpdate=q))}if(_!==null){var at=y.baseState;T=0,st=J=q=null,k=_;do{var Z=k.lane&-536870913,it=Z!==k.lane;if(it?(Ht&Z)===Z:(f&Z)===Z){Z!==0&&Z===Al&&(Tg=!0),st!==null&&(st=st.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});t:{var vt=r,Rt=k;Z=o;var de=u;switch(Rt.tag){case 1:if(vt=Rt.payload,typeof vt=="function"){at=vt.call(de,at,Z);break t}at=vt;break t;case 3:vt.flags=vt.flags&-65537|128;case 0:if(vt=Rt.payload,Z=typeof vt=="function"?vt.call(de,at,Z):vt,Z==null)break t;at=m({},at,Z);break t;case 2:Jr=!0}}Z=k.callback,Z!==null&&(r.flags|=64,it&&(r.flags|=8192),it=y.callbacks,it===null?y.callbacks=[Z]:it.push(Z))}else it={lane:Z,tag:k.tag,payload:k.payload,callback:k.callback,next:null},st===null?(J=st=it,q=at):st=st.next=it,T|=Z;if(k=k.next,k===null){if(k=y.shared.pending,k===null)break;it=k,k=it.next,it.next=null,y.lastBaseUpdate=it,y.shared.pending=null}}while(!0);st===null&&(q=at),y.baseState=q,y.firstBaseUpdate=J,y.lastBaseUpdate=st,_===null&&(y.shared.lanes=0),ra|=T,r.lanes=T,r.memoizedState=at}}function MA(r,o){if(typeof r!="function")throw Error(n(191,r));r.call(o)}function kA(r,o){var u=r.callbacks;if(u!==null)for(r.callbacks=null,r=0;r<u.length;r++)MA(u[r],o)}var Sl=H(null),Zd=H(0);function NA(r,o){r=gr,ct(Zd,r),ct(Sl,o),gr=r|o.baseLanes}function Sg(){ct(Zd,gr),ct(Sl,Sl.current)}function Cg(){gr=Zd.current,et(Sl),et(Zd)}var oi=H(null),Ri=null;function ea(r){var o=r.alternate;ct(Ve,Ve.current&1),ct(oi,r),Ri===null&&(o===null||Sl.current!==null||o.memoizedState!==null)&&(Ri=r)}function xg(r){ct(Ve,Ve.current),ct(oi,r),Ri===null&&(Ri=r)}function OA(r){r.tag===22?(ct(Ve,Ve.current),ct(oi,r),Ri===null&&(Ri=r)):na()}function na(){ct(Ve,Ve.current),ct(oi,oi.current)}function li(r){et(oi),Ri===r&&(Ri=null),et(Ve)}var Ve=H(0);function tf(r){for(var o=r;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||ky(u)||Ny(u)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var lr=0,Ft=null,ue=null,We=null,ef=!1,Cl=!1,_o=!1,nf=0,vu=0,xl=null,U2=0;function Pe(){throw Error(n(321))}function Rg(r,o){if(o===null)return!1;for(var u=0;u<o.length&&u<r.length;u++)if(!ri(r[u],o[u]))return!1;return!0}function Ig(r,o,u,f,y,_){return lr=_,Ft=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,W.H=r===null||r.memoizedState===null?vE:qg,_o=!1,_=u(f,y),_o=!1,Cl&&(_=VA(o,u,f,y)),LA(r),_}function LA(r){W.H=Au;var o=ue!==null&&ue.next!==null;if(lr=0,We=ue=Ft=null,ef=!1,vu=0,xl=null,o)throw Error(n(300));r===null||Ke||(r=r.dependencies,r!==null&&$d(r)&&(Ke=!0))}function VA(r,o,u,f){Ft=r;var y=0;do{if(Cl&&(xl=null),vu=0,Cl=!1,25<=y)throw Error(n(301));if(y+=1,We=ue=null,r.updateQueue!=null){var _=r.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}W.H=_E,_=o(u,f)}while(Cl);return _}function j2(){var r=W.H,o=r.useState()[0];return o=typeof o.then=="function"?_u(o):o,r=r.useState()[0],(ue!==null?ue.memoizedState:null)!==r&&(Ft.flags|=1024),o}function Dg(){var r=nf!==0;return nf=0,r}function Pg(r,o,u){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~u}function Mg(r){if(ef){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}ef=!1}lr=0,We=ue=Ft=null,Cl=!1,vu=nf=0,xl=null}function Vn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return We===null?Ft.memoizedState=We=r:We=We.next=r,We}function Be(){if(ue===null){var r=Ft.alternate;r=r!==null?r.memoizedState:null}else r=ue.next;var o=We===null?Ft.memoizedState:We.next;if(o!==null)We=o,ue=r;else{if(r===null)throw Ft.alternate===null?Error(n(467)):Error(n(310));ue=r,r={memoizedState:ue.memoizedState,baseState:ue.baseState,baseQueue:ue.baseQueue,queue:ue.queue,next:null},We===null?Ft.memoizedState=We=r:We=We.next=r}return We}function sf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function _u(r){var o=vu;return vu+=1,xl===null&&(xl=[]),r=xA(xl,r,o),o=Ft,(We===null?o.memoizedState:We.next)===null&&(o=o.alternate,W.H=o===null||o.memoizedState===null?vE:qg),r}function rf(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return _u(r);if(r.$$typeof===I)return bn(r)}throw Error(n(438,String(r)))}function kg(r){var o=null,u=Ft.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var f=Ft.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(o={data:f.data.map(function(y){return y.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=sf(),Ft.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(r),f=0;f<r;f++)u[f]=V;return o.index++,u}function cr(r,o){return typeof o=="function"?o(r):o}function af(r){var o=Be();return Ng(o,ue,r)}function Ng(r,o,u){var f=r.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=u;var y=r.baseQueue,_=f.pending;if(_!==null){if(y!==null){var T=y.next;y.next=_.next,_.next=T}o.baseQueue=y=_,f.pending=null}if(_=r.baseState,y===null)r.memoizedState=_;else{o=y.next;var k=T=null,q=null,J=o,st=!1;do{var at=J.lane&-536870913;if(at!==J.lane?(Ht&at)===at:(lr&at)===at){var Z=J.revertLane;if(Z===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),at===Al&&(st=!0);else if((lr&Z)===Z){J=J.next,Z===Al&&(st=!0);continue}else at={lane:0,revertLane:J.revertLane,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},q===null?(k=q=at,T=_):q=q.next=at,Ft.lanes|=Z,ra|=Z;at=J.action,_o&&u(_,at),_=J.hasEagerState?J.eagerState:u(_,at)}else Z={lane:at,revertLane:J.revertLane,gesture:J.gesture,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},q===null?(k=q=Z,T=_):q=q.next=Z,Ft.lanes|=at,ra|=at;J=J.next}while(J!==null&&J!==o);if(q===null?T=_:q.next=k,!ri(_,r.memoizedState)&&(Ke=!0,st&&(u=El,u!==null)))throw u;r.memoizedState=_,r.baseState=T,r.baseQueue=q,f.lastRenderedState=_}return y===null&&(f.lanes=0),[r.memoizedState,f.dispatch]}function Og(r){var o=Be(),u=o.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=r;var f=u.dispatch,y=u.pending,_=o.memoizedState;if(y!==null){u.pending=null;var T=y=y.next;do _=r(_,T.action),T=T.next;while(T!==y);ri(_,o.memoizedState)||(Ke=!0),o.memoizedState=_,o.baseQueue===null&&(o.baseState=_),u.lastRenderedState=_}return[_,f]}function BA(r,o,u){var f=Ft,y=Be(),_=Kt;if(_){if(u===void 0)throw Error(n(407));u=u()}else u=o();var T=!ri((ue||y).memoizedState,u);if(T&&(y.memoizedState=u,Ke=!0),y=y.queue,Bg(jA.bind(null,f,y,r),[r]),y.getSnapshot!==o||T||We!==null&&We.memoizedState.tag&1){if(f.flags|=2048,Rl(9,{destroy:void 0},UA.bind(null,f,y,u,o),null),pe===null)throw Error(n(349));_||(lr&127)!==0||FA(f,o,u)}return u}function FA(r,o,u){r.flags|=16384,r={getSnapshot:o,value:u},o=Ft.updateQueue,o===null?(o=sf(),Ft.updateQueue=o,o.stores=[r]):(u=o.stores,u===null?o.stores=[r]:u.push(r))}function UA(r,o,u,f){o.value=u,o.getSnapshot=f,zA(o)&&HA(r)}function jA(r,o,u){return u(function(){zA(o)&&HA(r)})}function zA(r){var o=r.getSnapshot;r=r.value;try{var u=o();return!ri(r,u)}catch{return!0}}function HA(r){var o=co(r,2);o!==null&&Qn(o,r,2)}function Lg(r){var o=Vn();if(typeof r=="function"){var u=r;if(r=u(),_o){vi(!0);try{u()}finally{vi(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:cr,lastRenderedState:r},o}function qA(r,o,u,f){return r.baseState=u,Ng(r,ue,typeof f=="function"?f:cr)}function z2(r,o,u,f,y){if(cf(r))throw Error(n(485));if(r=o.action,r!==null){var _={payload:y,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){_.listeners.push(T)}};W.T!==null?u(!0):_.isTransition=!1,f(_),u=o.pending,u===null?(_.next=o.pending=_,GA(o,_)):(_.next=u.next,o.pending=u.next=_)}}function GA(r,o){var u=o.action,f=o.payload,y=r.state;if(o.isTransition){var _=W.T,T={};W.T=T;try{var k=u(y,f),q=W.S;q!==null&&q(T,k),$A(r,o,k)}catch(J){Vg(r,o,J)}finally{_!==null&&T.types!==null&&(_.types=T.types),W.T=_}}else try{_=u(y,f),$A(r,o,_)}catch(J){Vg(r,o,J)}}function $A(r,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(f){WA(r,o,f)},function(f){return Vg(r,o,f)}):WA(r,o,u)}function WA(r,o,u){o.status="fulfilled",o.value=u,KA(o),r.state=u,o=r.pending,o!==null&&(u=o.next,u===o?r.pending=null:(u=u.next,o.next=u,GA(r,u)))}function Vg(r,o,u){var f=r.pending;if(r.pending=null,f!==null){f=f.next;do o.status="rejected",o.reason=u,KA(o),o=o.next;while(o!==f)}r.action=null}function KA(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function YA(r,o){return o}function XA(r,o){if(Kt){var u=pe.formState;if(u!==null){t:{var f=Ft;if(Kt){if(ve){e:{for(var y=ve,_=xi;y.nodeType!==8;){if(!_){y=null;break e}if(y=Ii(y.nextSibling),y===null){y=null;break e}}_=y.data,y=_==="F!"||_==="F"?y:null}if(y){ve=Ii(y.nextSibling),f=y.data==="F!";break t}}Xr(f)}f=!1}f&&(o=u[0])}}return u=Vn(),u.memoizedState=u.baseState=o,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:YA,lastRenderedState:o},u.queue=f,u=mE.bind(null,Ft,f),f.dispatch=u,f=Lg(!1),_=Hg.bind(null,Ft,!1,f.queue),f=Vn(),y={state:o,dispatch:null,action:r,pending:null},f.queue=y,u=z2.bind(null,Ft,y,_,u),y.dispatch=u,f.memoizedState=r,[o,u,!1]}function QA(r){var o=Be();return JA(o,ue,r)}function JA(r,o,u){if(o=Ng(r,o,YA)[0],r=af(cr)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var f=_u(o)}catch(T){throw T===wl?Yd:T}else f=o;o=Be();var y=o.queue,_=y.dispatch;return u!==o.memoizedState&&(Ft.flags|=2048,Rl(9,{destroy:void 0},H2.bind(null,y,u),null)),[f,_,r]}function H2(r,o){r.action=o}function ZA(r){var o=Be(),u=ue;if(u!==null)return JA(o,u,r);Be(),o=o.memoizedState,u=Be();var f=u.queue.dispatch;return u.memoizedState=r,[o,f,!1]}function Rl(r,o,u,f){return r={tag:r,create:u,deps:f,inst:o,next:null},o=Ft.updateQueue,o===null&&(o=sf(),Ft.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=r.next=r:(f=u.next,u.next=r,r.next=f,o.lastEffect=r),r}function tE(){return Be().memoizedState}function of(r,o,u,f){var y=Vn();Ft.flags|=r,y.memoizedState=Rl(1|o,{destroy:void 0},u,f===void 0?null:f)}function lf(r,o,u,f){var y=Be();f=f===void 0?null:f;var _=y.memoizedState.inst;ue!==null&&f!==null&&Rg(f,ue.memoizedState.deps)?y.memoizedState=Rl(o,_,u,f):(Ft.flags|=r,y.memoizedState=Rl(1|o,_,u,f))}function eE(r,o){of(8390656,8,r,o)}function Bg(r,o){lf(2048,8,r,o)}function q2(r){Ft.flags|=4;var o=Ft.updateQueue;if(o===null)o=sf(),Ft.updateQueue=o,o.events=[r];else{var u=o.events;u===null?o.events=[r]:u.push(r)}}function nE(r){var o=Be().memoizedState;return q2({ref:o,nextImpl:r}),function(){if((ee&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function iE(r,o){return lf(4,2,r,o)}function sE(r,o){return lf(4,4,r,o)}function rE(r,o){if(typeof o=="function"){r=r();var u=o(r);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function aE(r,o,u){u=u!=null?u.concat([r]):null,lf(4,4,rE.bind(null,o,r),u)}function Fg(){}function oE(r,o){var u=Be();o=o===void 0?null:o;var f=u.memoizedState;return o!==null&&Rg(o,f[1])?f[0]:(u.memoizedState=[r,o],r)}function lE(r,o){var u=Be();o=o===void 0?null:o;var f=u.memoizedState;if(o!==null&&Rg(o,f[1]))return f[0];if(f=r(),_o){vi(!0);try{r()}finally{vi(!1)}}return u.memoizedState=[f,o],f}function Ug(r,o,u){return u===void 0||(lr&1073741824)!==0&&(Ht&261930)===0?r.memoizedState=o:(r.memoizedState=u,r=cw(),Ft.lanes|=r,ra|=r,u)}function cE(r,o,u,f){return ri(u,o)?u:Sl.current!==null?(r=Ug(r,u,f),ri(r,o)||(Ke=!0),r):(lr&42)===0||(lr&1073741824)!==0&&(Ht&261930)===0?(Ke=!0,r.memoizedState=u):(r=cw(),Ft.lanes|=r,ra|=r,o)}function uE(r,o,u,f,y){var _=K.p;K.p=_!==0&&8>_?_:8;var T=W.T,k={};W.T=k,Hg(r,!1,o,u);try{var q=y(),J=W.S;if(J!==null&&J(k,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var st=F2(q,f);bu(r,o,st,hi(r))}else bu(r,o,f,hi(r))}catch(at){bu(r,o,{then:function(){},status:"rejected",reason:at},hi())}finally{K.p=_,T!==null&&k.types!==null&&(T.types=k.types),W.T=T}}function G2(){}function jg(r,o,u,f){if(r.tag!==5)throw Error(n(476));var y=hE(r).queue;uE(r,y,o,tt,u===null?G2:function(){return dE(r),u(f)})}function hE(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:tt,baseState:tt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:cr,lastRenderedState:tt},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:cr,lastRenderedState:u},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function dE(r){var o=hE(r);o.next===null&&(o=r.alternate.memoizedState),bu(r,o.next.queue,{},hi())}function zg(){return bn(Vu)}function fE(){return Be().memoizedState}function pE(){return Be().memoizedState}function $2(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var u=hi();r=Zr(u);var f=ta(o,r,u);f!==null&&(Qn(f,o,u),mu(f,o,u)),o={cache:yg()},r.payload=o;return}o=o.return}}function W2(r,o,u){var f=hi();u={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},cf(r)?gE(o,u):(u=ag(r,o,u,f),u!==null&&(Qn(u,r,f),yE(u,o,f)))}function mE(r,o,u){var f=hi();bu(r,o,u,f)}function bu(r,o,u,f){var y={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(cf(r))gE(o,y);else{var _=r.alternate;if(r.lanes===0&&(_===null||_.lanes===0)&&(_=o.lastRenderedReducer,_!==null))try{var T=o.lastRenderedState,k=_(T,u);if(y.hasEagerState=!0,y.eagerState=k,ri(k,T))return zd(r,o,y,0),pe===null&&jd(),!1}catch{}if(u=ag(r,o,y,f),u!==null)return Qn(u,r,f),yE(u,o,f),!0}return!1}function Hg(r,o,u,f){if(f={lane:2,revertLane:Ay(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},cf(r)){if(o)throw Error(n(479))}else o=ag(r,u,f,2),o!==null&&Qn(o,r,2)}function cf(r){var o=r.alternate;return r===Ft||o!==null&&o===Ft}function gE(r,o){Cl=ef=!0;var u=r.pending;u===null?o.next=o:(o.next=u.next,u.next=o),r.pending=o}function yE(r,o,u){if((u&4194048)!==0){var f=o.lanes;f&=r.pendingLanes,u|=f,o.lanes=u,zc(r,u)}}var Au={readContext:bn,use:rf,useCallback:Pe,useContext:Pe,useEffect:Pe,useImperativeHandle:Pe,useLayoutEffect:Pe,useInsertionEffect:Pe,useMemo:Pe,useReducer:Pe,useRef:Pe,useState:Pe,useDebugValue:Pe,useDeferredValue:Pe,useTransition:Pe,useSyncExternalStore:Pe,useId:Pe,useHostTransitionStatus:Pe,useFormState:Pe,useActionState:Pe,useOptimistic:Pe,useMemoCache:Pe,useCacheRefresh:Pe};Au.useEffectEvent=Pe;var vE={readContext:bn,use:rf,useCallback:function(r,o){return Vn().memoizedState=[r,o===void 0?null:o],r},useContext:bn,useEffect:eE,useImperativeHandle:function(r,o,u){u=u!=null?u.concat([r]):null,of(4194308,4,rE.bind(null,o,r),u)},useLayoutEffect:function(r,o){return of(4194308,4,r,o)},useInsertionEffect:function(r,o){of(4,2,r,o)},useMemo:function(r,o){var u=Vn();o=o===void 0?null:o;var f=r();if(_o){vi(!0);try{r()}finally{vi(!1)}}return u.memoizedState=[f,o],f},useReducer:function(r,o,u){var f=Vn();if(u!==void 0){var y=u(o);if(_o){vi(!0);try{u(o)}finally{vi(!1)}}}else y=o;return f.memoizedState=f.baseState=y,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:y},f.queue=r,r=r.dispatch=W2.bind(null,Ft,r),[f.memoizedState,r]},useRef:function(r){var o=Vn();return r={current:r},o.memoizedState=r},useState:function(r){r=Lg(r);var o=r.queue,u=mE.bind(null,Ft,o);return o.dispatch=u,[r.memoizedState,u]},useDebugValue:Fg,useDeferredValue:function(r,o){var u=Vn();return Ug(u,r,o)},useTransition:function(){var r=Lg(!1);return r=uE.bind(null,Ft,r.queue,!0,!1),Vn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,u){var f=Ft,y=Vn();if(Kt){if(u===void 0)throw Error(n(407));u=u()}else{if(u=o(),pe===null)throw Error(n(349));(Ht&127)!==0||FA(f,o,u)}y.memoizedState=u;var _={value:u,getSnapshot:o};return y.queue=_,eE(jA.bind(null,f,_,r),[r]),f.flags|=2048,Rl(9,{destroy:void 0},UA.bind(null,f,_,u,o),null),u},useId:function(){var r=Vn(),o=pe.identifierPrefix;if(Kt){var u=Ds,f=Is;u=(f&~(1<<32-Oe(f)-1)).toString(32)+u,o="_"+o+"R_"+u,u=nf++,0<u&&(o+="H"+u.toString(32)),o+="_"}else u=U2++,o="_"+o+"r_"+u.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:zg,useFormState:XA,useActionState:XA,useOptimistic:function(r){var o=Vn();o.memoizedState=o.baseState=r;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=Hg.bind(null,Ft,!0,u),u.dispatch=o,[r,o]},useMemoCache:kg,useCacheRefresh:function(){return Vn().memoizedState=$2.bind(null,Ft)},useEffectEvent:function(r){var o=Vn(),u={impl:r};return o.memoizedState=u,function(){if((ee&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},qg={readContext:bn,use:rf,useCallback:oE,useContext:bn,useEffect:Bg,useImperativeHandle:aE,useInsertionEffect:iE,useLayoutEffect:sE,useMemo:lE,useReducer:af,useRef:tE,useState:function(){return af(cr)},useDebugValue:Fg,useDeferredValue:function(r,o){var u=Be();return cE(u,ue.memoizedState,r,o)},useTransition:function(){var r=af(cr)[0],o=Be().memoizedState;return[typeof r=="boolean"?r:_u(r),o]},useSyncExternalStore:BA,useId:fE,useHostTransitionStatus:zg,useFormState:QA,useActionState:QA,useOptimistic:function(r,o){var u=Be();return qA(u,ue,r,o)},useMemoCache:kg,useCacheRefresh:pE};qg.useEffectEvent=nE;var _E={readContext:bn,use:rf,useCallback:oE,useContext:bn,useEffect:Bg,useImperativeHandle:aE,useInsertionEffect:iE,useLayoutEffect:sE,useMemo:lE,useReducer:Og,useRef:tE,useState:function(){return Og(cr)},useDebugValue:Fg,useDeferredValue:function(r,o){var u=Be();return ue===null?Ug(u,r,o):cE(u,ue.memoizedState,r,o)},useTransition:function(){var r=Og(cr)[0],o=Be().memoizedState;return[typeof r=="boolean"?r:_u(r),o]},useSyncExternalStore:BA,useId:fE,useHostTransitionStatus:zg,useFormState:ZA,useActionState:ZA,useOptimistic:function(r,o){var u=Be();return ue!==null?qA(u,ue,r,o):(u.baseState=r,[r,u.queue.dispatch])},useMemoCache:kg,useCacheRefresh:pE};_E.useEffectEvent=nE;function Gg(r,o,u,f){o=r.memoizedState,u=u(f,o),u=u==null?o:m({},o,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var $g={enqueueSetState:function(r,o,u){r=r._reactInternals;var f=hi(),y=Zr(f);y.payload=o,u!=null&&(y.callback=u),o=ta(r,y,f),o!==null&&(Qn(o,r,f),mu(o,r,f))},enqueueReplaceState:function(r,o,u){r=r._reactInternals;var f=hi(),y=Zr(f);y.tag=1,y.payload=o,u!=null&&(y.callback=u),o=ta(r,y,f),o!==null&&(Qn(o,r,f),mu(o,r,f))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var u=hi(),f=Zr(u);f.tag=2,o!=null&&(f.callback=o),o=ta(r,f,u),o!==null&&(Qn(o,r,u),mu(o,r,u))}};function bE(r,o,u,f,y,_,T){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(f,_,T):o.prototype&&o.prototype.isPureReactComponent?!ou(u,f)||!ou(y,_):!0}function AE(r,o,u,f){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,f),o.state!==r&&$g.enqueueReplaceState(o,o.state,null)}function bo(r,o){var u=o;if("ref"in o){u={};for(var f in o)f!=="ref"&&(u[f]=o[f])}if(r=r.defaultProps){u===o&&(u=m({},u));for(var y in r)u[y]===void 0&&(u[y]=r[y])}return u}function EE(r){Ud(r)}function wE(r){console.error(r)}function TE(r){Ud(r)}function uf(r,o){try{var u=r.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(f){setTimeout(function(){throw f})}}function SE(r,o,u){try{var f=r.onCaughtError;f(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Wg(r,o,u){return u=Zr(u),u.tag=3,u.payload={element:null},u.callback=function(){uf(r,o)},u}function CE(r){return r=Zr(r),r.tag=3,r}function xE(r,o,u,f){var y=u.type.getDerivedStateFromError;if(typeof y=="function"){var _=f.value;r.payload=function(){return y(_)},r.callback=function(){SE(o,u,f)}}var T=u.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(r.callback=function(){SE(o,u,f),typeof y!="function"&&(aa===null?aa=new Set([this]):aa.add(this));var k=f.stack;this.componentDidCatch(f.value,{componentStack:k!==null?k:""})})}function K2(r,o,u,f,y){if(u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(o=u.alternate,o!==null&&bl(o,u,y,!0),u=oi.current,u!==null){switch(u.tag){case 31:case 13:return Ri===null?Ef():u.alternate===null&&Me===0&&(Me=3),u.flags&=-257,u.flags|=65536,u.lanes=y,f===Xd?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([f]):o.add(f),vy(r,f,y)),!1;case 22:return u.flags|=65536,f===Xd?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([f])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([f]):u.add(f)),vy(r,f,y)),!1}throw Error(n(435,u.tag))}return vy(r,f,y),Ef(),!1}if(Kt)return o=oi.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=y,f!==dg&&(r=Error(n(422),{cause:f}),uu(Ti(r,u)))):(f!==dg&&(o=Error(n(423),{cause:f}),uu(Ti(o,u))),r=r.current.alternate,r.flags|=65536,y&=-y,r.lanes|=y,f=Ti(f,u),y=Wg(r.stateNode,f,y),wg(r,y),Me!==4&&(Me=2)),!1;var _=Error(n(520),{cause:f});if(_=Ti(_,u),Iu===null?Iu=[_]:Iu.push(_),Me!==4&&(Me=2),o===null)return!0;f=Ti(f,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,r=y&-y,u.lanes|=r,r=Wg(u.stateNode,f,r),wg(u,r),!1;case 1:if(o=u.type,_=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(aa===null||!aa.has(_))))return u.flags|=65536,y&=-y,u.lanes|=y,y=CE(y),xE(y,r,u,f),wg(u,y),!1}u=u.return}while(u!==null);return!1}var Kg=Error(n(461)),Ke=!1;function An(r,o,u,f){o.child=r===null?PA(o,null,u,f):vo(o,r.child,u,f)}function RE(r,o,u,f,y){u=u.render;var _=o.ref;if("ref"in f){var T={};for(var k in f)k!=="ref"&&(T[k]=f[k])}else T=f;return po(o),f=Ig(r,o,u,T,_,y),k=Dg(),r!==null&&!Ke?(Pg(r,o,y),ur(r,o,y)):(Kt&&k&&ug(o),o.flags|=1,An(r,o,f,y),o.child)}function IE(r,o,u,f,y){if(r===null){var _=u.type;return typeof _=="function"&&!og(_)&&_.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=_,DE(r,o,_,f,y)):(r=qd(u.type,null,f,o,o.mode,y),r.ref=o.ref,r.return=o,o.child=r)}if(_=r.child,!ny(r,y)){var T=_.memoizedProps;if(u=u.compare,u=u!==null?u:ou,u(T,f)&&r.ref===o.ref)return ur(r,o,y)}return o.flags|=1,r=sr(_,f),r.ref=o.ref,r.return=o,o.child=r}function DE(r,o,u,f,y){if(r!==null){var _=r.memoizedProps;if(ou(_,f)&&r.ref===o.ref)if(Ke=!1,o.pendingProps=f=_,ny(r,y))(r.flags&131072)!==0&&(Ke=!0);else return o.lanes=r.lanes,ur(r,o,y)}return Yg(r,o,u,f,y)}function PE(r,o,u,f){var y=f.children,_=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((o.flags&128)!==0){if(_=_!==null?_.baseLanes|u:u,r!==null){for(f=o.child=r.child,y=0;f!==null;)y=y|f.lanes|f.childLanes,f=f.sibling;f=y&~_}else f=0,o.child=null;return ME(r,o,_,u,f)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&Kd(o,_!==null?_.cachePool:null),_!==null?NA(o,_):Sg(),OA(o);else return f=o.lanes=536870912,ME(r,o,_!==null?_.baseLanes|u:u,u,f)}else _!==null?(Kd(o,_.cachePool),NA(o,_),na(),o.memoizedState=null):(r!==null&&Kd(o,null),Sg(),na());return An(r,o,y,u),o.child}function Eu(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function ME(r,o,u,f,y){var _=_g();return _=_===null?null:{parent:$e._currentValue,pool:_},o.memoizedState={baseLanes:u,cachePool:_},r!==null&&Kd(o,null),Sg(),OA(o),r!==null&&bl(r,o,f,!0),o.childLanes=y,null}function hf(r,o){return o=ff({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function kE(r,o,u){return vo(o,r.child,null,u),r=hf(o,o.pendingProps),r.flags|=2,li(o),o.memoizedState=null,r}function Y2(r,o,u){var f=o.pendingProps,y=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(Kt){if(f.mode==="hidden")return r=hf(o,f),o.lanes=536870912,Eu(null,r);if(xg(o),(r=ve)?(r=Gw(r,xi),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:Kr!==null?{id:Is,overflow:Ds}:null,retryLane:536870912,hydrationErrors:null},u=gA(r),u.return=o,o.child=u,_n=o,ve=null)):r=null,r===null)throw Xr(o);return o.lanes=536870912,null}return hf(o,f)}var _=r.memoizedState;if(_!==null){var T=_.dehydrated;if(xg(o),y)if(o.flags&256)o.flags&=-257,o=kE(r,o,u);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(n(558));else if(Ke||bl(r,o,u,!1),y=(u&r.childLanes)!==0,Ke||y){if(f=pe,f!==null&&(T=Hc(f,u),T!==0&&T!==_.retryLane))throw _.retryLane=T,co(r,T),Qn(f,r,T),Kg;Ef(),o=kE(r,o,u)}else r=_.treeContext,ve=Ii(T.nextSibling),_n=o,Kt=!0,Yr=null,xi=!1,r!==null&&_A(o,r),o=hf(o,f),o.flags|=4096;return o}return r=sr(r.child,{mode:f.mode,children:f.children}),r.ref=o.ref,o.child=r,r.return=o,r}function df(r,o){var u=o.ref;if(u===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(r===null||r.ref!==u)&&(o.flags|=4194816)}}function Yg(r,o,u,f,y){return po(o),u=Ig(r,o,u,f,void 0,y),f=Dg(),r!==null&&!Ke?(Pg(r,o,y),ur(r,o,y)):(Kt&&f&&ug(o),o.flags|=1,An(r,o,u,y),o.child)}function NE(r,o,u,f,y,_){return po(o),o.updateQueue=null,u=VA(o,f,u,y),LA(r),f=Dg(),r!==null&&!Ke?(Pg(r,o,_),ur(r,o,_)):(Kt&&f&&ug(o),o.flags|=1,An(r,o,u,_),o.child)}function OE(r,o,u,f,y){if(po(o),o.stateNode===null){var _=gl,T=u.contextType;typeof T=="object"&&T!==null&&(_=bn(T)),_=new u(f,_),o.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=$g,o.stateNode=_,_._reactInternals=o,_=o.stateNode,_.props=f,_.state=o.memoizedState,_.refs={},Ag(o),T=u.contextType,_.context=typeof T=="object"&&T!==null?bn(T):gl,_.state=o.memoizedState,T=u.getDerivedStateFromProps,typeof T=="function"&&(Gg(o,u,T,f),_.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(T=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),T!==_.state&&$g.enqueueReplaceState(_,_.state,null),yu(o,f,_,y),gu(),_.state=o.memoizedState),typeof _.componentDidMount=="function"&&(o.flags|=4194308),f=!0}else if(r===null){_=o.stateNode;var k=o.memoizedProps,q=bo(u,k);_.props=q;var J=_.context,st=u.contextType;T=gl,typeof st=="object"&&st!==null&&(T=bn(st));var at=u.getDerivedStateFromProps;st=typeof at=="function"||typeof _.getSnapshotBeforeUpdate=="function",k=o.pendingProps!==k,st||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(k||J!==T)&&AE(o,_,f,T),Jr=!1;var Z=o.memoizedState;_.state=Z,yu(o,f,_,y),gu(),J=o.memoizedState,k||Z!==J||Jr?(typeof at=="function"&&(Gg(o,u,at,f),J=o.memoizedState),(q=Jr||bE(o,u,q,f,Z,J,T))?(st||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(o.flags|=4194308)):(typeof _.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=J),_.props=f,_.state=J,_.context=T,f=q):(typeof _.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{_=o.stateNode,Eg(r,o),T=o.memoizedProps,st=bo(u,T),_.props=st,at=o.pendingProps,Z=_.context,J=u.contextType,q=gl,typeof J=="object"&&J!==null&&(q=bn(J)),k=u.getDerivedStateFromProps,(J=typeof k=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(T!==at||Z!==q)&&AE(o,_,f,q),Jr=!1,Z=o.memoizedState,_.state=Z,yu(o,f,_,y),gu();var it=o.memoizedState;T!==at||Z!==it||Jr||r!==null&&r.dependencies!==null&&$d(r.dependencies)?(typeof k=="function"&&(Gg(o,u,k,f),it=o.memoizedState),(st=Jr||bE(o,u,st,f,Z,it,q)||r!==null&&r.dependencies!==null&&$d(r.dependencies))?(J||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(f,it,q),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(f,it,q)),typeof _.componentDidUpdate=="function"&&(o.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof _.componentDidUpdate!="function"||T===r.memoizedProps&&Z===r.memoizedState||(o.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||T===r.memoizedProps&&Z===r.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=it),_.props=f,_.state=it,_.context=q,f=st):(typeof _.componentDidUpdate!="function"||T===r.memoizedProps&&Z===r.memoizedState||(o.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||T===r.memoizedProps&&Z===r.memoizedState||(o.flags|=1024),f=!1)}return _=f,df(r,o),f=(o.flags&128)!==0,_||f?(_=o.stateNode,u=f&&typeof u.getDerivedStateFromError!="function"?null:_.render(),o.flags|=1,r!==null&&f?(o.child=vo(o,r.child,null,y),o.child=vo(o,null,u,y)):An(r,o,u,y),o.memoizedState=_.state,r=o.child):r=ur(r,o,y),r}function LE(r,o,u,f){return ho(),o.flags|=256,An(r,o,u,f),o.child}var Xg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qg(r){return{baseLanes:r,cachePool:SA()}}function Jg(r,o,u){return r=r!==null?r.childLanes&~u:0,o&&(r|=ui),r}function VE(r,o,u){var f=o.pendingProps,y=!1,_=(o.flags&128)!==0,T;if((T=_)||(T=r!==null&&r.memoizedState===null?!1:(Ve.current&2)!==0),T&&(y=!0,o.flags&=-129),T=(o.flags&32)!==0,o.flags&=-33,r===null){if(Kt){if(y?ea(o):na(),(r=ve)?(r=Gw(r,xi),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:Kr!==null?{id:Is,overflow:Ds}:null,retryLane:536870912,hydrationErrors:null},u=gA(r),u.return=o,o.child=u,_n=o,ve=null)):r=null,r===null)throw Xr(o);return Ny(r)?o.lanes=32:o.lanes=536870912,null}var k=f.children;return f=f.fallback,y?(na(),y=o.mode,k=ff({mode:"hidden",children:k},y),f=uo(f,y,u,null),k.return=o,f.return=o,k.sibling=f,o.child=k,f=o.child,f.memoizedState=Qg(u),f.childLanes=Jg(r,T,u),o.memoizedState=Xg,Eu(null,f)):(ea(o),Zg(o,k))}var q=r.memoizedState;if(q!==null&&(k=q.dehydrated,k!==null)){if(_)o.flags&256?(ea(o),o.flags&=-257,o=ty(r,o,u)):o.memoizedState!==null?(na(),o.child=r.child,o.flags|=128,o=null):(na(),k=f.fallback,y=o.mode,f=ff({mode:"visible",children:f.children},y),k=uo(k,y,u,null),k.flags|=2,f.return=o,k.return=o,f.sibling=k,o.child=f,vo(o,r.child,null,u),f=o.child,f.memoizedState=Qg(u),f.childLanes=Jg(r,T,u),o.memoizedState=Xg,o=Eu(null,f));else if(ea(o),Ny(k)){if(T=k.nextSibling&&k.nextSibling.dataset,T)var J=T.dgst;T=J,f=Error(n(419)),f.stack="",f.digest=T,uu({value:f,source:null,stack:null}),o=ty(r,o,u)}else if(Ke||bl(r,o,u,!1),T=(u&r.childLanes)!==0,Ke||T){if(T=pe,T!==null&&(f=Hc(T,u),f!==0&&f!==q.retryLane))throw q.retryLane=f,co(r,f),Qn(T,r,f),Kg;ky(k)||Ef(),o=ty(r,o,u)}else ky(k)?(o.flags|=192,o.child=r.child,o=null):(r=q.treeContext,ve=Ii(k.nextSibling),_n=o,Kt=!0,Yr=null,xi=!1,r!==null&&_A(o,r),o=Zg(o,f.children),o.flags|=4096);return o}return y?(na(),k=f.fallback,y=o.mode,q=r.child,J=q.sibling,f=sr(q,{mode:"hidden",children:f.children}),f.subtreeFlags=q.subtreeFlags&65011712,J!==null?k=sr(J,k):(k=uo(k,y,u,null),k.flags|=2),k.return=o,f.return=o,f.sibling=k,o.child=f,Eu(null,f),f=o.child,k=r.child.memoizedState,k===null?k=Qg(u):(y=k.cachePool,y!==null?(q=$e._currentValue,y=y.parent!==q?{parent:q,pool:q}:y):y=SA(),k={baseLanes:k.baseLanes|u,cachePool:y}),f.memoizedState=k,f.childLanes=Jg(r,T,u),o.memoizedState=Xg,Eu(r.child,f)):(ea(o),u=r.child,r=u.sibling,u=sr(u,{mode:"visible",children:f.children}),u.return=o,u.sibling=null,r!==null&&(T=o.deletions,T===null?(o.deletions=[r],o.flags|=16):T.push(r)),o.child=u,o.memoizedState=null,u)}function Zg(r,o){return o=ff({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function ff(r,o){return r=ai(22,r,null,o),r.lanes=0,r}function ty(r,o,u){return vo(o,r.child,null,u),r=Zg(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function BE(r,o,u){r.lanes|=o;var f=r.alternate;f!==null&&(f.lanes|=o),mg(r.return,o,u)}function ey(r,o,u,f,y,_){var T=r.memoizedState;T===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:y,treeForkCount:_}:(T.isBackwards=o,T.rendering=null,T.renderingStartTime=0,T.last=f,T.tail=u,T.tailMode=y,T.treeForkCount=_)}function FE(r,o,u){var f=o.pendingProps,y=f.revealOrder,_=f.tail;f=f.children;var T=Ve.current,k=(T&2)!==0;if(k?(T=T&1|2,o.flags|=128):T&=1,ct(Ve,T),An(r,o,f,u),f=Kt?cu:0,!k&&r!==null&&(r.flags&128)!==0)t:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&BE(r,u,o);else if(r.tag===19)BE(r,u,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break t;for(;r.sibling===null;){if(r.return===null||r.return===o)break t;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(y){case"forwards":for(u=o.child,y=null;u!==null;)r=u.alternate,r!==null&&tf(r)===null&&(y=u),u=u.sibling;u=y,u===null?(y=o.child,o.child=null):(y=u.sibling,u.sibling=null),ey(o,!1,y,u,_,f);break;case"backwards":case"unstable_legacy-backwards":for(u=null,y=o.child,o.child=null;y!==null;){if(r=y.alternate,r!==null&&tf(r)===null){o.child=y;break}r=y.sibling,y.sibling=u,u=y,y=r}ey(o,!0,u,null,_,f);break;case"together":ey(o,!1,null,null,void 0,f);break;default:o.memoizedState=null}return o.child}function ur(r,o,u){if(r!==null&&(o.dependencies=r.dependencies),ra|=o.lanes,(u&o.childLanes)===0)if(r!==null){if(bl(r,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,u=sr(r,r.pendingProps),o.child=u,u.return=o;r.sibling!==null;)r=r.sibling,u=u.sibling=sr(r,r.pendingProps),u.return=o;u.sibling=null}return o.child}function ny(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&$d(r)))}function X2(r,o,u){switch(o.tag){case 3:ye(o,o.stateNode.containerInfo),Qr(o,$e,r.memoizedState.cache),ho();break;case 27:case 5:Js(o);break;case 4:ye(o,o.stateNode.containerInfo);break;case 10:Qr(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,xg(o),null;break;case 13:var f=o.memoizedState;if(f!==null)return f.dehydrated!==null?(ea(o),o.flags|=128,null):(u&o.child.childLanes)!==0?VE(r,o,u):(ea(o),r=ur(r,o,u),r!==null?r.sibling:null);ea(o);break;case 19:var y=(r.flags&128)!==0;if(f=(u&o.childLanes)!==0,f||(bl(r,o,u,!1),f=(u&o.childLanes)!==0),y){if(f)return FE(r,o,u);o.flags|=128}if(y=o.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),ct(Ve,Ve.current),f)break;return null;case 22:return o.lanes=0,PE(r,o,u,o.pendingProps);case 24:Qr(o,$e,r.memoizedState.cache)}return ur(r,o,u)}function UE(r,o,u){if(r!==null)if(r.memoizedProps!==o.pendingProps)Ke=!0;else{if(!ny(r,u)&&(o.flags&128)===0)return Ke=!1,X2(r,o,u);Ke=(r.flags&131072)!==0}else Ke=!1,Kt&&(o.flags&1048576)!==0&&vA(o,cu,o.index);switch(o.lanes=0,o.tag){case 16:t:{var f=o.pendingProps;if(r=go(o.elementType),o.type=r,typeof r=="function")og(r)?(f=bo(r,f),o.tag=1,o=OE(null,o,r,f,u)):(o.tag=0,o=Yg(null,o,r,f,u));else{if(r!=null){var y=r.$$typeof;if(y===B){o.tag=11,o=RE(null,o,r,f,u);break t}else if(y===P){o.tag=14,o=IE(null,o,r,f,u);break t}}throw o=gt(r)||r,Error(n(306,o,""))}}return o;case 0:return Yg(r,o,o.type,o.pendingProps,u);case 1:return f=o.type,y=bo(f,o.pendingProps),OE(r,o,f,y,u);case 3:t:{if(ye(o,o.stateNode.containerInfo),r===null)throw Error(n(387));f=o.pendingProps;var _=o.memoizedState;y=_.element,Eg(r,o),yu(o,f,null,u);var T=o.memoizedState;if(f=T.cache,Qr(o,$e,f),f!==_.cache&&gg(o,[$e],u,!0),gu(),f=T.element,_.isDehydrated)if(_={element:f,isDehydrated:!1,cache:T.cache},o.updateQueue.baseState=_,o.memoizedState=_,o.flags&256){o=LE(r,o,f,u);break t}else if(f!==y){y=Ti(Error(n(424)),o),uu(y),o=LE(r,o,f,u);break t}else for(r=o.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,ve=Ii(r.firstChild),_n=o,Kt=!0,Yr=null,xi=!0,u=PA(o,null,f,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(ho(),f===y){o=ur(r,o,u);break t}An(r,o,f,u)}o=o.child}return o;case 26:return df(r,o),r===null?(u=Qw(o.type,null,o.pendingProps,null))?o.memoizedState=u:Kt||(u=o.type,r=o.pendingProps,f=If(Tt.current).createElement(u),f[He]=o,f[hn]=r,En(f,u,r),qe(f),o.stateNode=f):o.memoizedState=Qw(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return Js(o),r===null&&Kt&&(f=o.stateNode=Kw(o.type,o.pendingProps,Tt.current),_n=o,xi=!0,y=ve,ua(o.type)?(Oy=y,ve=Ii(f.firstChild)):ve=y),An(r,o,o.pendingProps.children,u),df(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&Kt&&((y=f=ve)&&(f=CM(f,o.type,o.pendingProps,xi),f!==null?(o.stateNode=f,_n=o,ve=Ii(f.firstChild),xi=!1,y=!0):y=!1),y||Xr(o)),Js(o),y=o.type,_=o.pendingProps,T=r!==null?r.memoizedProps:null,f=_.children,Dy(y,_)?f=null:T!==null&&Dy(y,T)&&(o.flags|=32),o.memoizedState!==null&&(y=Ig(r,o,j2,null,null,u),Vu._currentValue=y),df(r,o),An(r,o,f,u),o.child;case 6:return r===null&&Kt&&((r=u=ve)&&(u=xM(u,o.pendingProps,xi),u!==null?(o.stateNode=u,_n=o,ve=null,r=!0):r=!1),r||Xr(o)),null;case 13:return VE(r,o,u);case 4:return ye(o,o.stateNode.containerInfo),f=o.pendingProps,r===null?o.child=vo(o,null,f,u):An(r,o,f,u),o.child;case 11:return RE(r,o,o.type,o.pendingProps,u);case 7:return An(r,o,o.pendingProps,u),o.child;case 8:return An(r,o,o.pendingProps.children,u),o.child;case 12:return An(r,o,o.pendingProps.children,u),o.child;case 10:return f=o.pendingProps,Qr(o,o.type,f.value),An(r,o,f.children,u),o.child;case 9:return y=o.type._context,f=o.pendingProps.children,po(o),y=bn(y),f=f(y),o.flags|=1,An(r,o,f,u),o.child;case 14:return IE(r,o,o.type,o.pendingProps,u);case 15:return DE(r,o,o.type,o.pendingProps,u);case 19:return FE(r,o,u);case 31:return Y2(r,o,u);case 22:return PE(r,o,u,o.pendingProps);case 24:return po(o),f=bn($e),r===null?(y=_g(),y===null&&(y=pe,_=yg(),y.pooledCache=_,_.refCount++,_!==null&&(y.pooledCacheLanes|=u),y=_),o.memoizedState={parent:f,cache:y},Ag(o),Qr(o,$e,y)):((r.lanes&u)!==0&&(Eg(r,o),yu(o,null,null,u),gu()),y=r.memoizedState,_=o.memoizedState,y.parent!==f?(y={parent:f,cache:f},o.memoizedState=y,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=y),Qr(o,$e,f)):(f=_.cache,Qr(o,$e,f),f!==y.cache&&gg(o,[$e],u,!0))),An(r,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function hr(r){r.flags|=4}function iy(r,o,u,f,y){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(y&335544128)===y)if(r.stateNode.complete)r.flags|=8192;else if(fw())r.flags|=8192;else throw yo=Xd,bg}else r.flags&=-16777217}function jE(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!nT(o))if(fw())r.flags|=8192;else throw yo=Xd,bg}function pf(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?_d():536870912,r.lanes|=o,Ml|=o)}function wu(r,o){if(!Kt)switch(r.tailMode){case"hidden":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:f.sibling=null}}function _e(r){var o=r.alternate!==null&&r.alternate.child===r.child,u=0,f=0;if(o)for(var y=r.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags&65011712,f|=y.flags&65011712,y.return=r,y=y.sibling;else for(y=r.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags,f|=y.flags,y.return=r,y=y.sibling;return r.subtreeFlags|=f,r.childLanes=u,o}function Q2(r,o,u){var f=o.pendingProps;switch(hg(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _e(o),null;case 1:return _e(o),null;case 3:return u=o.stateNode,f=null,r!==null&&(f=r.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),or($e),se(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(r===null||r.child===null)&&(_l(o)?hr(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,fg())),_e(o),null;case 26:var y=o.type,_=o.memoizedState;return r===null?(hr(o),_!==null?(_e(o),jE(o,_)):(_e(o),iy(o,y,null,f,u))):_?_!==r.memoizedState?(hr(o),_e(o),jE(o,_)):(_e(o),o.flags&=-16777217):(r=r.memoizedProps,r!==f&&hr(o),_e(o),iy(o,y,r,f,u)),null;case 27:if(us(o),u=Tt.current,y=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==f&&hr(o);else{if(!f){if(o.stateNode===null)throw Error(n(166));return _e(o),null}r=dt.current,_l(o)?bA(o):(r=Kw(y,f,u),o.stateNode=r,hr(o))}return _e(o),null;case 5:if(us(o),y=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==f&&hr(o);else{if(!f){if(o.stateNode===null)throw Error(n(166));return _e(o),null}if(_=dt.current,_l(o))bA(o);else{var T=If(Tt.current);switch(_){case 1:_=T.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:_=T.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":_=T.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":_=T.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":_=T.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof f.is=="string"?T.createElement("select",{is:f.is}):T.createElement("select"),f.multiple?_.multiple=!0:f.size&&(_.size=f.size);break;default:_=typeof f.is=="string"?T.createElement(y,{is:f.is}):T.createElement(y)}}_[He]=o,_[hn]=f;t:for(T=o.child;T!==null;){if(T.tag===5||T.tag===6)_.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===o)break t;for(;T.sibling===null;){if(T.return===null||T.return===o)break t;T=T.return}T.sibling.return=T.return,T=T.sibling}o.stateNode=_;t:switch(En(_,y,f),y){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break t;case"img":f=!0;break t;default:f=!1}f&&hr(o)}}return _e(o),iy(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,u),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==f&&hr(o);else{if(typeof f!="string"&&o.stateNode===null)throw Error(n(166));if(r=Tt.current,_l(o)){if(r=o.stateNode,u=o.memoizedProps,f=null,y=_n,y!==null)switch(y.tag){case 27:case 5:f=y.memoizedProps}r[He]=o,r=!!(r.nodeValue===u||f!==null&&f.suppressHydrationWarning===!0||Vw(r.nodeValue,u)),r||Xr(o,!0)}else r=If(r).createTextNode(f),r[He]=o,o.stateNode=r}return _e(o),null;case 31:if(u=o.memoizedState,r===null||r.memoizedState!==null){if(f=_l(o),u!==null){if(r===null){if(!f)throw Error(n(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(557));r[He]=o}else ho(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;_e(o),r=!1}else u=fg(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=u),r=!0;if(!r)return o.flags&256?(li(o),o):(li(o),null);if((o.flags&128)!==0)throw Error(n(558))}return _e(o),null;case 13:if(f=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(y=_l(o),f!==null&&f.dehydrated!==null){if(r===null){if(!y)throw Error(n(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(n(317));y[He]=o}else ho(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;_e(o),y=!1}else y=fg(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=y),y=!0;if(!y)return o.flags&256?(li(o),o):(li(o),null)}return li(o),(o.flags&128)!==0?(o.lanes=u,o):(u=f!==null,r=r!==null&&r.memoizedState!==null,u&&(f=o.child,y=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(y=f.alternate.memoizedState.cachePool.pool),_=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(_=f.memoizedState.cachePool.pool),_!==y&&(f.flags|=2048)),u!==r&&u&&(o.child.flags|=8192),pf(o,o.updateQueue),_e(o),null);case 4:return se(),r===null&&Sy(o.stateNode.containerInfo),_e(o),null;case 10:return or(o.type),_e(o),null;case 19:if(et(Ve),f=o.memoizedState,f===null)return _e(o),null;if(y=(o.flags&128)!==0,_=f.rendering,_===null)if(y)wu(f,!1);else{if(Me!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(_=tf(r),_!==null){for(o.flags|=128,wu(f,!1),r=_.updateQueue,o.updateQueue=r,pf(o,r),o.subtreeFlags=0,r=u,u=o.child;u!==null;)mA(u,r),u=u.sibling;return ct(Ve,Ve.current&1|2),Kt&&rr(o,f.treeForkCount),o.child}r=r.sibling}f.tail!==null&&On()>_f&&(o.flags|=128,y=!0,wu(f,!1),o.lanes=4194304)}else{if(!y)if(r=tf(_),r!==null){if(o.flags|=128,y=!0,r=r.updateQueue,o.updateQueue=r,pf(o,r),wu(f,!0),f.tail===null&&f.tailMode==="hidden"&&!_.alternate&&!Kt)return _e(o),null}else 2*On()-f.renderingStartTime>_f&&u!==536870912&&(o.flags|=128,y=!0,wu(f,!1),o.lanes=4194304);f.isBackwards?(_.sibling=o.child,o.child=_):(r=f.last,r!==null?r.sibling=_:o.child=_,f.last=_)}return f.tail!==null?(r=f.tail,f.rendering=r,f.tail=r.sibling,f.renderingStartTime=On(),r.sibling=null,u=Ve.current,ct(Ve,y?u&1|2:u&1),Kt&&rr(o,f.treeForkCount),r):(_e(o),null);case 22:case 23:return li(o),Cg(),f=o.memoizedState!==null,r!==null?r.memoizedState!==null!==f&&(o.flags|=8192):f&&(o.flags|=8192),f?(u&536870912)!==0&&(o.flags&128)===0&&(_e(o),o.subtreeFlags&6&&(o.flags|=8192)):_e(o),u=o.updateQueue,u!==null&&pf(o,u.retryQueue),u=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),f=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==u&&(o.flags|=2048),r!==null&&et(mo),null;case 24:return u=null,r!==null&&(u=r.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),or($e),_e(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function J2(r,o){switch(hg(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return or($e),se(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return us(o),null;case 31:if(o.memoizedState!==null){if(li(o),o.alternate===null)throw Error(n(340));ho()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(li(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));ho()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return et(Ve),null;case 4:return se(),null;case 10:return or(o.type),null;case 22:case 23:return li(o),Cg(),r!==null&&et(mo),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return or($e),null;case 25:return null;default:return null}}function zE(r,o){switch(hg(o),o.tag){case 3:or($e),se();break;case 26:case 27:case 5:us(o);break;case 4:se();break;case 31:o.memoizedState!==null&&li(o);break;case 13:li(o);break;case 19:et(Ve);break;case 10:or(o.type);break;case 22:case 23:li(o),Cg(),r!==null&&et(mo);break;case 24:or($e)}}function Tu(r,o){try{var u=o.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var y=f.next;u=y;do{if((u.tag&r)===r){f=void 0;var _=u.create,T=u.inst;f=_(),T.destroy=f}u=u.next}while(u!==y)}}catch(k){le(o,o.return,k)}}function ia(r,o,u){try{var f=o.updateQueue,y=f!==null?f.lastEffect:null;if(y!==null){var _=y.next;f=_;do{if((f.tag&r)===r){var T=f.inst,k=T.destroy;if(k!==void 0){T.destroy=void 0,y=o;var q=u,J=k;try{J()}catch(st){le(y,q,st)}}}f=f.next}while(f!==_)}}catch(st){le(o,o.return,st)}}function HE(r){var o=r.updateQueue;if(o!==null){var u=r.stateNode;try{kA(o,u)}catch(f){le(r,r.return,f)}}}function qE(r,o,u){u.props=bo(r.type,r.memoizedProps),u.state=r.memoizedState;try{u.componentWillUnmount()}catch(f){le(r,o,f)}}function Su(r,o){try{var u=r.ref;if(u!==null){switch(r.tag){case 26:case 27:case 5:var f=r.stateNode;break;case 30:f=r.stateNode;break;default:f=r.stateNode}typeof u=="function"?r.refCleanup=u(f):u.current=f}}catch(y){le(r,o,y)}}function Ps(r,o){var u=r.ref,f=r.refCleanup;if(u!==null)if(typeof f=="function")try{f()}catch(y){le(r,o,y)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(y){le(r,o,y)}else u.current=null}function GE(r){var o=r.type,u=r.memoizedProps,f=r.stateNode;try{t:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&f.focus();break t;case"img":u.src?f.src=u.src:u.srcSet&&(f.srcset=u.srcSet)}}catch(y){le(r,r.return,y)}}function sy(r,o,u){try{var f=r.stateNode;bM(f,r.type,u,o),f[hn]=o}catch(y){le(r,r.return,y)}}function $E(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&ua(r.type)||r.tag===4}function ry(r){t:for(;;){for(;r.sibling===null;){if(r.return===null||$E(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&ua(r.type)||r.flags&2||r.child===null||r.tag===4)continue t;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function ay(r,o,u){var f=r.tag;if(f===5||f===6)r=r.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(r,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(r),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=Gi));else if(f!==4&&(f===27&&ua(r.type)&&(u=r.stateNode,o=null),r=r.child,r!==null))for(ay(r,o,u),r=r.sibling;r!==null;)ay(r,o,u),r=r.sibling}function mf(r,o,u){var f=r.tag;if(f===5||f===6)r=r.stateNode,o?u.insertBefore(r,o):u.appendChild(r);else if(f!==4&&(f===27&&ua(r.type)&&(u=r.stateNode),r=r.child,r!==null))for(mf(r,o,u),r=r.sibling;r!==null;)mf(r,o,u),r=r.sibling}function WE(r){var o=r.stateNode,u=r.memoizedProps;try{for(var f=r.type,y=o.attributes;y.length;)o.removeAttributeNode(y[0]);En(o,f,u),o[He]=r,o[hn]=u}catch(_){le(r,r.return,_)}}var dr=!1,Ye=!1,oy=!1,KE=typeof WeakSet=="function"?WeakSet:Set,fn=null;function Z2(r,o){if(r=r.containerInfo,Ry=Lf,r=aA(r),tg(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else t:{u=(u=r.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var y=f.anchorOffset,_=f.focusNode;f=f.focusOffset;try{u.nodeType,_.nodeType}catch{u=null;break t}var T=0,k=-1,q=-1,J=0,st=0,at=r,Z=null;e:for(;;){for(var it;at!==u||y!==0&&at.nodeType!==3||(k=T+y),at!==_||f!==0&&at.nodeType!==3||(q=T+f),at.nodeType===3&&(T+=at.nodeValue.length),(it=at.firstChild)!==null;)Z=at,at=it;for(;;){if(at===r)break e;if(Z===u&&++J===y&&(k=T),Z===_&&++st===f&&(q=T),(it=at.nextSibling)!==null)break;at=Z,Z=at.parentNode}at=it}u=k===-1||q===-1?null:{start:k,end:q}}else u=null}u=u||{start:0,end:0}}else u=null;for(Iy={focusedElem:r,selectionRange:u},Lf=!1,fn=o;fn!==null;)if(o=fn,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,fn=r;else for(;fn!==null;){switch(o=fn,_=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(u=0;u<r.length;u++)y=r[u],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&_!==null){r=void 0,u=o,y=_.memoizedProps,_=_.memoizedState,f=u.stateNode;try{var vt=bo(u.type,y);r=f.getSnapshotBeforeUpdate(vt,_),f.__reactInternalSnapshotBeforeUpdate=r}catch(Rt){le(u,u.return,Rt)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,u=r.nodeType,u===9)My(r);else if(u===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":My(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=o.sibling,r!==null){r.return=o.return,fn=r;break}fn=o.return}}function YE(r,o,u){var f=u.flags;switch(u.tag){case 0:case 11:case 15:pr(r,u),f&4&&Tu(5,u);break;case 1:if(pr(r,u),f&4)if(r=u.stateNode,o===null)try{r.componentDidMount()}catch(T){le(u,u.return,T)}else{var y=bo(u.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(y,o,r.__reactInternalSnapshotBeforeUpdate)}catch(T){le(u,u.return,T)}}f&64&&HE(u),f&512&&Su(u,u.return);break;case 3:if(pr(r,u),f&64&&(r=u.updateQueue,r!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{kA(r,o)}catch(T){le(u,u.return,T)}}break;case 27:o===null&&f&4&&WE(u);case 26:case 5:pr(r,u),o===null&&f&4&&GE(u),f&512&&Su(u,u.return);break;case 12:pr(r,u);break;case 31:pr(r,u),f&4&&JE(r,u);break;case 13:pr(r,u),f&4&&ZE(r,u),f&64&&(r=u.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(u=lM.bind(null,u),RM(r,u))));break;case 22:if(f=u.memoizedState!==null||dr,!f){o=o!==null&&o.memoizedState!==null||Ye,y=dr;var _=Ye;dr=f,(Ye=o)&&!_?mr(r,u,(u.subtreeFlags&8772)!==0):pr(r,u),dr=y,Ye=_}break;case 30:break;default:pr(r,u)}}function XE(r){var o=r.alternate;o!==null&&(r.alternate=null,XE(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&nl(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var we=null,Wn=!1;function fr(r,o,u){for(u=u.child;u!==null;)QE(r,o,u),u=u.sibling}function QE(r,o,u){if(yn&&typeof yn.onCommitFiberUnmount=="function")try{yn.onCommitFiberUnmount(ji,u)}catch{}switch(u.tag){case 26:Ye||Ps(u,o),fr(r,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Ye||Ps(u,o);var f=we,y=Wn;ua(u.type)&&(we=u.stateNode,Wn=!1),fr(r,o,u),Nu(u.stateNode),we=f,Wn=y;break;case 5:Ye||Ps(u,o);case 6:if(f=we,y=Wn,we=null,fr(r,o,u),we=f,Wn=y,we!==null)if(Wn)try{(we.nodeType===9?we.body:we.nodeName==="HTML"?we.ownerDocument.body:we).removeChild(u.stateNode)}catch(_){le(u,o,_)}else try{we.removeChild(u.stateNode)}catch(_){le(u,o,_)}break;case 18:we!==null&&(Wn?(r=we,Hw(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,u.stateNode),Ul(r)):Hw(we,u.stateNode));break;case 4:f=we,y=Wn,we=u.stateNode.containerInfo,Wn=!0,fr(r,o,u),we=f,Wn=y;break;case 0:case 11:case 14:case 15:ia(2,u,o),Ye||ia(4,u,o),fr(r,o,u);break;case 1:Ye||(Ps(u,o),f=u.stateNode,typeof f.componentWillUnmount=="function"&&qE(u,o,f)),fr(r,o,u);break;case 21:fr(r,o,u);break;case 22:Ye=(f=Ye)||u.memoizedState!==null,fr(r,o,u),Ye=f;break;default:fr(r,o,u)}}function JE(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Ul(r)}catch(u){le(o,o.return,u)}}}function ZE(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Ul(r)}catch(u){le(o,o.return,u)}}function tM(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new KE),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new KE),o;default:throw Error(n(435,r.tag))}}function gf(r,o){var u=tM(r);o.forEach(function(f){if(!u.has(f)){u.add(f);var y=cM.bind(null,r,f);f.then(y,y)}})}function Kn(r,o){var u=o.deletions;if(u!==null)for(var f=0;f<u.length;f++){var y=u[f],_=r,T=o,k=T;t:for(;k!==null;){switch(k.tag){case 27:if(ua(k.type)){we=k.stateNode,Wn=!1;break t}break;case 5:we=k.stateNode,Wn=!1;break t;case 3:case 4:we=k.stateNode.containerInfo,Wn=!0;break t}k=k.return}if(we===null)throw Error(n(160));QE(_,T,y),we=null,Wn=!1,_=y.alternate,_!==null&&(_.return=null),y.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)tw(o,r),o=o.sibling}var Qi=null;function tw(r,o){var u=r.alternate,f=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Kn(o,r),Yn(r),f&4&&(ia(3,r,r.return),Tu(3,r),ia(5,r,r.return));break;case 1:Kn(o,r),Yn(r),f&512&&(Ye||u===null||Ps(u,u.return)),f&64&&dr&&(r=r.updateQueue,r!==null&&(f=r.callbacks,f!==null&&(u=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=u===null?f:u.concat(f))));break;case 26:var y=Qi;if(Kn(o,r),Yn(r),f&512&&(Ye||u===null||Ps(u,u.return)),f&4){var _=u!==null?u.memoizedState:null;if(f=r.memoizedState,u===null)if(f===null)if(r.stateNode===null){t:{f=r.type,u=r.memoizedProps,y=y.ownerDocument||y;e:switch(f){case"title":_=y.getElementsByTagName("title")[0],(!_||_[ys]||_[He]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=y.createElement(f),y.head.insertBefore(_,y.querySelector("head > title"))),En(_,f,u),_[He]=r,qe(_),f=_;break t;case"link":var T=tT("link","href",y).get(f+(u.href||""));if(T){for(var k=0;k<T.length;k++)if(_=T[k],_.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&_.getAttribute("rel")===(u.rel==null?null:u.rel)&&_.getAttribute("title")===(u.title==null?null:u.title)&&_.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){T.splice(k,1);break e}}_=y.createElement(f),En(_,f,u),y.head.appendChild(_);break;case"meta":if(T=tT("meta","content",y).get(f+(u.content||""))){for(k=0;k<T.length;k++)if(_=T[k],_.getAttribute("content")===(u.content==null?null:""+u.content)&&_.getAttribute("name")===(u.name==null?null:u.name)&&_.getAttribute("property")===(u.property==null?null:u.property)&&_.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&_.getAttribute("charset")===(u.charSet==null?null:u.charSet)){T.splice(k,1);break e}}_=y.createElement(f),En(_,f,u),y.head.appendChild(_);break;default:throw Error(n(468,f))}_[He]=r,qe(_),f=_}r.stateNode=f}else eT(y,r.type,r.stateNode);else r.stateNode=Zw(y,f,r.memoizedProps);else _!==f?(_===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):_.count--,f===null?eT(y,r.type,r.stateNode):Zw(y,f,r.memoizedProps)):f===null&&r.stateNode!==null&&sy(r,r.memoizedProps,u.memoizedProps)}break;case 27:Kn(o,r),Yn(r),f&512&&(Ye||u===null||Ps(u,u.return)),u!==null&&f&4&&sy(r,r.memoizedProps,u.memoizedProps);break;case 5:if(Kn(o,r),Yn(r),f&512&&(Ye||u===null||Ps(u,u.return)),r.flags&32){y=r.stateNode;try{$n(y,"")}catch(vt){le(r,r.return,vt)}}f&4&&r.stateNode!=null&&(y=r.memoizedProps,sy(r,y,u!==null?u.memoizedProps:y)),f&1024&&(oy=!0);break;case 6:if(Kn(o,r),Yn(r),f&4){if(r.stateNode===null)throw Error(n(162));f=r.memoizedProps,u=r.stateNode;try{u.nodeValue=f}catch(vt){le(r,r.return,vt)}}break;case 3:if(Mf=null,y=Qi,Qi=Df(o.containerInfo),Kn(o,r),Qi=y,Yn(r),f&4&&u!==null&&u.memoizedState.isDehydrated)try{Ul(o.containerInfo)}catch(vt){le(r,r.return,vt)}oy&&(oy=!1,ew(r));break;case 4:f=Qi,Qi=Df(r.stateNode.containerInfo),Kn(o,r),Yn(r),Qi=f;break;case 12:Kn(o,r),Yn(r);break;case 31:Kn(o,r),Yn(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,gf(r,f)));break;case 13:Kn(o,r),Yn(r),r.child.flags&8192&&r.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(vf=On()),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,gf(r,f)));break;case 22:y=r.memoizedState!==null;var q=u!==null&&u.memoizedState!==null,J=dr,st=Ye;if(dr=J||y,Ye=st||q,Kn(o,r),Ye=st,dr=J,Yn(r),f&8192)t:for(o=r.stateNode,o._visibility=y?o._visibility&-2:o._visibility|1,y&&(u===null||q||dr||Ye||Ao(r)),u=null,o=r;;){if(o.tag===5||o.tag===26){if(u===null){q=u=o;try{if(_=q.stateNode,y)T=_.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{k=q.stateNode;var at=q.memoizedProps.style,Z=at!=null&&at.hasOwnProperty("display")?at.display:null;k.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(vt){le(q,q.return,vt)}}}else if(o.tag===6){if(u===null){q=o;try{q.stateNode.nodeValue=y?"":q.memoizedProps}catch(vt){le(q,q.return,vt)}}}else if(o.tag===18){if(u===null){q=o;try{var it=q.stateNode;y?qw(it,!0):qw(q.stateNode,!1)}catch(vt){le(q,q.return,vt)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break t;for(;o.sibling===null;){if(o.return===null||o.return===r)break t;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}f&4&&(f=r.updateQueue,f!==null&&(u=f.retryQueue,u!==null&&(f.retryQueue=null,gf(r,u))));break;case 19:Kn(o,r),Yn(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,gf(r,f)));break;case 30:break;case 21:break;default:Kn(o,r),Yn(r)}}function Yn(r){var o=r.flags;if(o&2){try{for(var u,f=r.return;f!==null;){if($E(f)){u=f;break}f=f.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var y=u.stateNode,_=ry(r);mf(r,_,y);break;case 5:var T=u.stateNode;u.flags&32&&($n(T,""),u.flags&=-33);var k=ry(r);mf(r,k,T);break;case 3:case 4:var q=u.stateNode.containerInfo,J=ry(r);ay(r,J,q);break;default:throw Error(n(161))}}catch(st){le(r,r.return,st)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function ew(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;ew(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function pr(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)YE(r,o.alternate,o),o=o.sibling}function Ao(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:ia(4,o,o.return),Ao(o);break;case 1:Ps(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&qE(o,o.return,u),Ao(o);break;case 27:Nu(o.stateNode);case 26:case 5:Ps(o,o.return),Ao(o);break;case 22:o.memoizedState===null&&Ao(o);break;case 30:Ao(o);break;default:Ao(o)}r=r.sibling}}function mr(r,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var f=o.alternate,y=r,_=o,T=_.flags;switch(_.tag){case 0:case 11:case 15:mr(y,_,u),Tu(4,_);break;case 1:if(mr(y,_,u),f=_,y=f.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(J){le(f,f.return,J)}if(f=_,y=f.updateQueue,y!==null){var k=f.stateNode;try{var q=y.shared.hiddenCallbacks;if(q!==null)for(y.shared.hiddenCallbacks=null,y=0;y<q.length;y++)MA(q[y],k)}catch(J){le(f,f.return,J)}}u&&T&64&&HE(_),Su(_,_.return);break;case 27:WE(_);case 26:case 5:mr(y,_,u),u&&f===null&&T&4&&GE(_),Su(_,_.return);break;case 12:mr(y,_,u);break;case 31:mr(y,_,u),u&&T&4&&JE(y,_);break;case 13:mr(y,_,u),u&&T&4&&ZE(y,_);break;case 22:_.memoizedState===null&&mr(y,_,u),Su(_,_.return);break;case 30:break;default:mr(y,_,u)}o=o.sibling}}function ly(r,o){var u=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==u&&(r!=null&&r.refCount++,u!=null&&hu(u))}function cy(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&hu(r))}function Ji(r,o,u,f){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)nw(r,o,u,f),o=o.sibling}function nw(r,o,u,f){var y=o.flags;switch(o.tag){case 0:case 11:case 15:Ji(r,o,u,f),y&2048&&Tu(9,o);break;case 1:Ji(r,o,u,f);break;case 3:Ji(r,o,u,f),y&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&hu(r)));break;case 12:if(y&2048){Ji(r,o,u,f),r=o.stateNode;try{var _=o.memoizedProps,T=_.id,k=_.onPostCommit;typeof k=="function"&&k(T,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(q){le(o,o.return,q)}}else Ji(r,o,u,f);break;case 31:Ji(r,o,u,f);break;case 13:Ji(r,o,u,f);break;case 23:break;case 22:_=o.stateNode,T=o.alternate,o.memoizedState!==null?_._visibility&2?Ji(r,o,u,f):Cu(r,o):_._visibility&2?Ji(r,o,u,f):(_._visibility|=2,Il(r,o,u,f,(o.subtreeFlags&10256)!==0||!1)),y&2048&&ly(T,o);break;case 24:Ji(r,o,u,f),y&2048&&cy(o.alternate,o);break;default:Ji(r,o,u,f)}}function Il(r,o,u,f,y){for(y=y&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var _=r,T=o,k=u,q=f,J=T.flags;switch(T.tag){case 0:case 11:case 15:Il(_,T,k,q,y),Tu(8,T);break;case 23:break;case 22:var st=T.stateNode;T.memoizedState!==null?st._visibility&2?Il(_,T,k,q,y):Cu(_,T):(st._visibility|=2,Il(_,T,k,q,y)),y&&J&2048&&ly(T.alternate,T);break;case 24:Il(_,T,k,q,y),y&&J&2048&&cy(T.alternate,T);break;default:Il(_,T,k,q,y)}o=o.sibling}}function Cu(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=r,f=o,y=f.flags;switch(f.tag){case 22:Cu(u,f),y&2048&&ly(f.alternate,f);break;case 24:Cu(u,f),y&2048&&cy(f.alternate,f);break;default:Cu(u,f)}o=o.sibling}}var xu=8192;function Dl(r,o,u){if(r.subtreeFlags&xu)for(r=r.child;r!==null;)iw(r,o,u),r=r.sibling}function iw(r,o,u){switch(r.tag){case 26:Dl(r,o,u),r.flags&xu&&r.memoizedState!==null&&UM(u,Qi,r.memoizedState,r.memoizedProps);break;case 5:Dl(r,o,u);break;case 3:case 4:var f=Qi;Qi=Df(r.stateNode.containerInfo),Dl(r,o,u),Qi=f;break;case 22:r.memoizedState===null&&(f=r.alternate,f!==null&&f.memoizedState!==null?(f=xu,xu=16777216,Dl(r,o,u),xu=f):Dl(r,o,u));break;default:Dl(r,o,u)}}function sw(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function Ru(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];fn=f,aw(f,r)}sw(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)rw(r),r=r.sibling}function rw(r){switch(r.tag){case 0:case 11:case 15:Ru(r),r.flags&2048&&ia(9,r,r.return);break;case 3:Ru(r);break;case 12:Ru(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,yf(r)):Ru(r);break;default:Ru(r)}}function yf(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];fn=f,aw(f,r)}sw(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:ia(8,o,o.return),yf(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,yf(o));break;default:yf(o)}r=r.sibling}}function aw(r,o){for(;fn!==null;){var u=fn;switch(u.tag){case 0:case 11:case 15:ia(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var f=u.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:hu(u.memoizedState.cache)}if(f=u.child,f!==null)f.return=u,fn=f;else t:for(u=r;fn!==null;){f=fn;var y=f.sibling,_=f.return;if(XE(f),f===u){fn=null;break t}if(y!==null){y.return=_,fn=y;break t}fn=_}}}var eM={getCacheForType:function(r){var o=bn($e),u=o.data.get(r);return u===void 0&&(u=r(),o.data.set(r,u)),u},cacheSignal:function(){return bn($e).controller.signal}},nM=typeof WeakMap=="function"?WeakMap:Map,ee=0,pe=null,jt=null,Ht=0,oe=0,ci=null,sa=!1,Pl=!1,uy=!1,gr=0,Me=0,ra=0,Eo=0,hy=0,ui=0,Ml=0,Iu=null,Xn=null,dy=!1,vf=0,ow=0,_f=1/0,bf=null,aa=null,rn=0,oa=null,kl=null,yr=0,fy=0,py=null,lw=null,Du=0,my=null;function hi(){return(ee&2)!==0&&Ht!==0?Ht&-Ht:W.T!==null?Ay():bd()}function cw(){if(ui===0)if((Ht&536870912)===0||Kt){var r=Ka;Ka<<=1,(Ka&3932160)===0&&(Ka=262144),ui=r}else ui=536870912;return r=oi.current,r!==null&&(r.flags|=32),ui}function Qn(r,o,u){(r===pe&&(oe===2||oe===9)||r.cancelPendingCommit!==null)&&(Nl(r,0),la(r,Ht,ui,!1)),Ya(r,u),((ee&2)===0||r!==pe)&&(r===pe&&((ee&2)===0&&(Eo|=u),Me===4&&la(r,Ht,ui,!1)),Ms(r))}function uw(r,o,u){if((ee&6)!==0)throw Error(n(327));var f=!u&&(o&127)===0&&(o&r.expiredLanes)===0||zi(r,o),y=f?rM(r,o):yy(r,o,!0),_=f;do{if(y===0){Pl&&!f&&la(r,o,0,!1);break}else{if(u=r.current.alternate,_&&!iM(u)){y=yy(r,o,!1),_=!1;continue}if(y===2){if(_=o,r.errorRecoveryDisabledLanes&_)var T=0;else T=r.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){o=T;t:{var k=r;y=Iu;var q=k.current.memoizedState.isDehydrated;if(q&&(Nl(k,T).flags|=256),T=yy(k,T,!1),T!==2){if(uy&&!q){k.errorRecoveryDisabledLanes|=_,Eo|=_,y=4;break t}_=Xn,Xn=y,_!==null&&(Xn===null?Xn=_:Xn.push.apply(Xn,_))}y=T}if(_=!1,y!==2)continue}}if(y===1){Nl(r,0),la(r,o,0,!0);break}t:{switch(f=r,_=y,_){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:la(f,o,ui,!sa);break t;case 2:Xn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(y=vf+300-On(),10<y)){if(la(f,o,ui,!sa),ps(f,0,!0)!==0)break t;yr=o,f.timeoutHandle=jw(hw.bind(null,f,u,Xn,bf,dy,o,ui,Eo,Ml,sa,_,"Throttled",-0,0),y);break t}hw(f,u,Xn,bf,dy,o,ui,Eo,Ml,sa,_,null,-0,0)}}break}while(!0);Ms(r)}function hw(r,o,u,f,y,_,T,k,q,J,st,at,Z,it){if(r.timeoutHandle=-1,at=o.subtreeFlags,at&8192||(at&16785408)===16785408){at={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Gi},iw(o,_,at);var vt=(_&62914560)===_?vf-On():(_&4194048)===_?ow-On():0;if(vt=jM(at,vt),vt!==null){yr=_,r.cancelPendingCommit=vt(_w.bind(null,r,o,_,u,f,y,T,k,q,st,at,null,Z,it)),la(r,_,T,!J);return}}_w(r,o,_,u,f,y,T,k,q)}function iM(r){for(var o=r;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var f=0;f<u.length;f++){var y=u[f],_=y.getSnapshot;y=y.value;try{if(!ri(_(),y))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function la(r,o,u,f){o&=~hy,o&=~Eo,r.suspendedLanes|=o,r.pingedLanes&=~o,f&&(r.warmLanes|=o),f=r.expirationTimes;for(var y=o;0<y;){var _=31-Oe(y),T=1<<_;f[_]=-1,y&=~T}u!==0&&Xa(r,u,o)}function Af(){return(ee&6)===0?(Pu(0),!1):!0}function gy(){if(jt!==null){if(oe===0)var r=jt.return;else r=jt,ar=fo=null,Mg(r),Tl=null,fu=0,r=jt;for(;r!==null;)zE(r.alternate,r),r=r.return;jt=null}}function Nl(r,o){var u=r.timeoutHandle;u!==-1&&(r.timeoutHandle=-1,wM(u)),u=r.cancelPendingCommit,u!==null&&(r.cancelPendingCommit=null,u()),yr=0,gy(),pe=r,jt=u=sr(r.current,null),Ht=o,oe=0,ci=null,sa=!1,Pl=zi(r,o),uy=!1,Ml=ui=hy=Eo=ra=Me=0,Xn=Iu=null,dy=!1,(o&8)!==0&&(o|=o&32);var f=r.entangledLanes;if(f!==0)for(r=r.entanglements,f&=o;0<f;){var y=31-Oe(f),_=1<<y;o|=r[y],f&=~_}return gr=o,jd(),u}function dw(r,o){Ft=null,W.H=Au,o===wl||o===Yd?(o=RA(),oe=3):o===bg?(o=RA(),oe=4):oe=o===Kg?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,ci=o,jt===null&&(Me=1,uf(r,Ti(o,r.current)))}function fw(){var r=oi.current;return r===null?!0:(Ht&4194048)===Ht?Ri===null:(Ht&62914560)===Ht||(Ht&536870912)!==0?r===Ri:!1}function pw(){var r=W.H;return W.H=Au,r===null?Au:r}function mw(){var r=W.A;return W.A=eM,r}function Ef(){Me=4,sa||(Ht&4194048)!==Ht&&oi.current!==null||(Pl=!0),(ra&134217727)===0&&(Eo&134217727)===0||pe===null||la(pe,Ht,ui,!1)}function yy(r,o,u){var f=ee;ee|=2;var y=pw(),_=mw();(pe!==r||Ht!==o)&&(bf=null,Nl(r,o)),o=!1;var T=Me;t:do try{if(oe!==0&&jt!==null){var k=jt,q=ci;switch(oe){case 8:gy(),T=6;break t;case 3:case 2:case 9:case 6:oi.current===null&&(o=!0);var J=oe;if(oe=0,ci=null,Ol(r,k,q,J),u&&Pl){T=0;break t}break;default:J=oe,oe=0,ci=null,Ol(r,k,q,J)}}sM(),T=Me;break}catch(st){dw(r,st)}while(!0);return o&&r.shellSuspendCounter++,ar=fo=null,ee=f,W.H=y,W.A=_,jt===null&&(pe=null,Ht=0,jd()),T}function sM(){for(;jt!==null;)gw(jt)}function rM(r,o){var u=ee;ee|=2;var f=pw(),y=mw();pe!==r||Ht!==o?(bf=null,_f=On()+500,Nl(r,o)):Pl=zi(r,o);t:do try{if(oe!==0&&jt!==null){o=jt;var _=ci;e:switch(oe){case 1:oe=0,ci=null,Ol(r,o,_,1);break;case 2:case 9:if(CA(_)){oe=0,ci=null,yw(o);break}o=function(){oe!==2&&oe!==9||pe!==r||(oe=7),Ms(r)},_.then(o,o);break t;case 3:oe=7;break t;case 4:oe=5;break t;case 7:CA(_)?(oe=0,ci=null,yw(o)):(oe=0,ci=null,Ol(r,o,_,7));break;case 5:var T=null;switch(jt.tag){case 26:T=jt.memoizedState;case 5:case 27:var k=jt;if(T?nT(T):k.stateNode.complete){oe=0,ci=null;var q=k.sibling;if(q!==null)jt=q;else{var J=k.return;J!==null?(jt=J,wf(J)):jt=null}break e}}oe=0,ci=null,Ol(r,o,_,5);break;case 6:oe=0,ci=null,Ol(r,o,_,6);break;case 8:gy(),Me=6;break t;default:throw Error(n(462))}}aM();break}catch(st){dw(r,st)}while(!0);return ar=fo=null,W.H=f,W.A=y,ee=u,jt!==null?0:(pe=null,Ht=0,jd(),Me)}function aM(){for(;jt!==null&&!Wm();)gw(jt)}function gw(r){var o=UE(r.alternate,r,gr);r.memoizedProps=r.pendingProps,o===null?wf(r):jt=o}function yw(r){var o=r,u=o.alternate;switch(o.tag){case 15:case 0:o=NE(u,o,o.pendingProps,o.type,void 0,Ht);break;case 11:o=NE(u,o,o.pendingProps,o.type.render,o.ref,Ht);break;case 5:Mg(o);default:zE(u,o),o=jt=mA(o,gr),o=UE(u,o,gr)}r.memoizedProps=r.pendingProps,o===null?wf(r):jt=o}function Ol(r,o,u,f){ar=fo=null,Mg(o),Tl=null,fu=0;var y=o.return;try{if(K2(r,y,o,u,Ht)){Me=1,uf(r,Ti(u,r.current)),jt=null;return}}catch(_){if(y!==null)throw jt=y,_;Me=1,uf(r,Ti(u,r.current)),jt=null;return}o.flags&32768?(Kt||f===1?r=!0:Pl||(Ht&536870912)!==0?r=!1:(sa=r=!0,(f===2||f===9||f===3||f===6)&&(f=oi.current,f!==null&&f.tag===13&&(f.flags|=16384))),vw(o,r)):wf(o)}function wf(r){var o=r;do{if((o.flags&32768)!==0){vw(o,sa);return}r=o.return;var u=Q2(o.alternate,o,gr);if(u!==null){jt=u;return}if(o=o.sibling,o!==null){jt=o;return}jt=o=r}while(o!==null);Me===0&&(Me=5)}function vw(r,o){do{var u=J2(r.alternate,r);if(u!==null){u.flags&=32767,jt=u;return}if(u=r.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(r=r.sibling,r!==null)){jt=r;return}jt=r=u}while(r!==null);Me=6,jt=null}function _w(r,o,u,f,y,_,T,k,q){r.cancelPendingCommit=null;do Tf();while(rn!==0);if((ee&6)!==0)throw Error(n(327));if(o!==null){if(o===r.current)throw Error(n(177));if(_=o.lanes|o.childLanes,_|=rg,Xm(r,u,_,T,k,q),r===pe&&(jt=pe=null,Ht=0),kl=o,oa=r,yr=u,fy=_,py=y,lw=f,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,uM(Br,function(){return Tw(),null})):(r.callbackNode=null,r.callbackPriority=0),f=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||f){f=W.T,W.T=null,y=K.p,K.p=2,T=ee,ee|=4;try{Z2(r,o,u)}finally{ee=T,K.p=y,W.T=f}}rn=1,bw(),Aw(),Ew()}}function bw(){if(rn===1){rn=0;var r=oa,o=kl,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=W.T,W.T=null;var f=K.p;K.p=2;var y=ee;ee|=4;try{tw(o,r);var _=Iy,T=aA(r.containerInfo),k=_.focusedElem,q=_.selectionRange;if(T!==k&&k&&k.ownerDocument&&rA(k.ownerDocument.documentElement,k)){if(q!==null&&tg(k)){var J=q.start,st=q.end;if(st===void 0&&(st=J),"selectionStart"in k)k.selectionStart=J,k.selectionEnd=Math.min(st,k.value.length);else{var at=k.ownerDocument||document,Z=at&&at.defaultView||window;if(Z.getSelection){var it=Z.getSelection(),vt=k.textContent.length,Rt=Math.min(q.start,vt),de=q.end===void 0?Rt:Math.min(q.end,vt);!it.extend&&Rt>de&&(T=de,de=Rt,Rt=T);var Y=sA(k,Rt),$=sA(k,de);if(Y&&$&&(it.rangeCount!==1||it.anchorNode!==Y.node||it.anchorOffset!==Y.offset||it.focusNode!==$.node||it.focusOffset!==$.offset)){var Q=at.createRange();Q.setStart(Y.node,Y.offset),it.removeAllRanges(),Rt>de?(it.addRange(Q),it.extend($.node,$.offset)):(Q.setEnd($.node,$.offset),it.addRange(Q))}}}}for(at=[],it=k;it=it.parentNode;)it.nodeType===1&&at.push({element:it,left:it.scrollLeft,top:it.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<at.length;k++){var rt=at[k];rt.element.scrollLeft=rt.left,rt.element.scrollTop=rt.top}}Lf=!!Ry,Iy=Ry=null}finally{ee=y,K.p=f,W.T=u}}r.current=o,rn=2}}function Aw(){if(rn===2){rn=0;var r=oa,o=kl,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=W.T,W.T=null;var f=K.p;K.p=2;var y=ee;ee|=4;try{YE(r,o.alternate,o)}finally{ee=y,K.p=f,W.T=u}}rn=3}}function Ew(){if(rn===4||rn===3){rn=0,fd();var r=oa,o=kl,u=yr,f=lw;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?rn=5:(rn=0,kl=oa=null,ww(r,r.pendingLanes));var y=r.pendingLanes;if(y===0&&(aa=null),tr(u),o=o.stateNode,yn&&typeof yn.onCommitFiberRoot=="function")try{yn.onCommitFiberRoot(ji,o,void 0,(o.current.flags&128)===128)}catch{}if(f!==null){o=W.T,y=K.p,K.p=2,W.T=null;try{for(var _=r.onRecoverableError,T=0;T<f.length;T++){var k=f[T];_(k.value,{componentStack:k.stack})}}finally{W.T=o,K.p=y}}(yr&3)!==0&&Tf(),Ms(r),y=r.pendingLanes,(u&261930)!==0&&(y&42)!==0?r===my?Du++:(Du=0,my=r):Du=0,Pu(0)}}function ww(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,hu(o)))}function Tf(){return bw(),Aw(),Ew(),Tw()}function Tw(){if(rn!==5)return!1;var r=oa,o=fy;fy=0;var u=tr(yr),f=W.T,y=K.p;try{K.p=32>u?32:u,W.T=null,u=py,py=null;var _=oa,T=yr;if(rn=0,kl=oa=null,yr=0,(ee&6)!==0)throw Error(n(331));var k=ee;if(ee|=4,rw(_.current),nw(_,_.current,T,u),ee=k,Pu(0,!1),yn&&typeof yn.onPostCommitFiberRoot=="function")try{yn.onPostCommitFiberRoot(ji,_)}catch{}return!0}finally{K.p=y,W.T=f,ww(r,o)}}function Sw(r,o,u){o=Ti(u,o),o=Wg(r.stateNode,o,2),r=ta(r,o,2),r!==null&&(Ya(r,2),Ms(r))}function le(r,o,u){if(r.tag===3)Sw(r,r,u);else for(;o!==null;){if(o.tag===3){Sw(o,r,u);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(aa===null||!aa.has(f))){r=Ti(u,r),u=CE(2),f=ta(o,u,2),f!==null&&(xE(u,f,o,r),Ya(f,2),Ms(f));break}}o=o.return}}function vy(r,o,u){var f=r.pingCache;if(f===null){f=r.pingCache=new nM;var y=new Set;f.set(o,y)}else y=f.get(o),y===void 0&&(y=new Set,f.set(o,y));y.has(u)||(uy=!0,y.add(u),r=oM.bind(null,r,o,u),o.then(r,r))}function oM(r,o,u){var f=r.pingCache;f!==null&&f.delete(o),r.pingedLanes|=r.suspendedLanes&u,r.warmLanes&=~u,pe===r&&(Ht&u)===u&&(Me===4||Me===3&&(Ht&62914560)===Ht&&300>On()-vf?(ee&2)===0&&Nl(r,0):hy|=u,Ml===Ht&&(Ml=0)),Ms(r)}function Cw(r,o){o===0&&(o=_d()),r=co(r,o),r!==null&&(Ya(r,o),Ms(r))}function lM(r){var o=r.memoizedState,u=0;o!==null&&(u=o.retryLane),Cw(r,u)}function cM(r,o){var u=0;switch(r.tag){case 31:case 13:var f=r.stateNode,y=r.memoizedState;y!==null&&(u=y.retryLane);break;case 19:f=r.stateNode;break;case 22:f=r.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(o),Cw(r,u)}function uM(r,o){return sn(r,o)}var Sf=null,Ll=null,_y=!1,Cf=!1,by=!1,ca=0;function Ms(r){r!==Ll&&r.next===null&&(Ll===null?Sf=Ll=r:Ll=Ll.next=r),Cf=!0,_y||(_y=!0,dM())}function Pu(r,o){if(!by&&Cf){by=!0;do for(var u=!1,f=Sf;f!==null;){if(r!==0){var y=f.pendingLanes;if(y===0)var _=0;else{var T=f.suspendedLanes,k=f.pingedLanes;_=(1<<31-Oe(42|r)+1)-1,_&=y&~(T&~k),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(u=!0,Dw(f,_))}else _=Ht,_=ps(f,f===pe?_:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(_&3)===0||zi(f,_)||(u=!0,Dw(f,_));f=f.next}while(u);by=!1}}function hM(){xw()}function xw(){Cf=_y=!1;var r=0;ca!==0&&EM()&&(r=ca);for(var o=On(),u=null,f=Sf;f!==null;){var y=f.next,_=Rw(f,o);_===0?(f.next=null,u===null?Sf=y:u.next=y,y===null&&(Ll=u)):(u=f,(r!==0||(_&3)!==0)&&(Cf=!0)),f=y}rn!==0&&rn!==5||Pu(r),ca!==0&&(ca=0)}function Rw(r,o){for(var u=r.suspendedLanes,f=r.pingedLanes,y=r.expirationTimes,_=r.pendingLanes&-62914561;0<_;){var T=31-Oe(_),k=1<<T,q=y[T];q===-1?((k&u)===0||(k&f)!==0)&&(y[T]=Ym(k,o)):q<=o&&(r.expiredLanes|=k),_&=~k}if(o=pe,u=Ht,u=ps(r,r===o?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f=r.callbackNode,u===0||r===o&&(oe===2||oe===9)||r.cancelPendingCommit!==null)return f!==null&&f!==null&&Vr(f),r.callbackNode=null,r.callbackPriority=0;if((u&3)===0||zi(r,u)){if(o=u&-u,o===r.callbackPriority)return o;switch(f!==null&&Vr(f),tr(u)){case 2:case 8:u=jc;break;case 32:u=Br;break;case 268435456:u=pd;break;default:u=Br}return f=Iw.bind(null,r),u=sn(u,f),r.callbackPriority=o,r.callbackNode=u,o}return f!==null&&f!==null&&Vr(f),r.callbackPriority=2,r.callbackNode=null,2}function Iw(r,o){if(rn!==0&&rn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var u=r.callbackNode;if(Tf()&&r.callbackNode!==u)return null;var f=Ht;return f=ps(r,r===pe?f:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f===0?null:(uw(r,f,o),Rw(r,On()),r.callbackNode!=null&&r.callbackNode===u?Iw.bind(null,r):null)}function Dw(r,o){if(Tf())return null;uw(r,o,!0)}function dM(){TM(function(){(ee&6)!==0?sn(Uc,hM):xw()})}function Ay(){if(ca===0){var r=Al;r===0&&(r=ds,ds<<=1,(ds&261888)===0&&(ds=256)),ca=r}return ca}function Pw(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:al(""+r)}function Mw(r,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,r.id&&u.setAttribute("form",r.id),o.parentNode.insertBefore(u,o),r=new FormData(r),u.parentNode.removeChild(u),r}function fM(r,o,u,f,y){if(o==="submit"&&u&&u.stateNode===y){var _=Pw((y[hn]||null).action),T=f.submitter;T&&(o=(o=T[hn]||null)?Pw(o.formAction):T.getAttribute("formAction"),o!==null&&(_=o,T=null));var k=new Ss("action","action",null,f,y);r.push({event:k,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(ca!==0){var q=T?Mw(y,T):new FormData(y);jg(u,{pending:!0,data:q,method:y.method,action:_},null,q)}}else typeof _=="function"&&(k.preventDefault(),q=T?Mw(y,T):new FormData(y),jg(u,{pending:!0,data:q,method:y.method,action:_},_,q))},currentTarget:y}]})}}for(var Ey=0;Ey<sg.length;Ey++){var wy=sg[Ey],pM=wy.toLowerCase(),mM=wy[0].toUpperCase()+wy.slice(1);Xi(pM,"on"+mM)}Xi(cA,"onAnimationEnd"),Xi(uA,"onAnimationIteration"),Xi(hA,"onAnimationStart"),Xi("dblclick","onDoubleClick"),Xi("focusin","onFocus"),Xi("focusout","onBlur"),Xi(P2,"onTransitionRun"),Xi(M2,"onTransitionStart"),Xi(k2,"onTransitionCancel"),Xi(dA,"onTransitionEnd"),As("onMouseEnter",["mouseout","mouseover"]),As("onMouseLeave",["mouseout","mouseover"]),As("onPointerEnter",["pointerout","pointerover"]),As("onPointerLeave",["pointerout","pointerover"]),bs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),bs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),bs("onBeforeInput",["compositionend","keypress","textInput","paste"]),bs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),bs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),bs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gM=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Mu));function kw(r,o){o=(o&4)!==0;for(var u=0;u<r.length;u++){var f=r[u],y=f.event;f=f.listeners;t:{var _=void 0;if(o)for(var T=f.length-1;0<=T;T--){var k=f[T],q=k.instance,J=k.currentTarget;if(k=k.listener,q!==_&&y.isPropagationStopped())break t;_=k,y.currentTarget=J;try{_(y)}catch(st){Ud(st)}y.currentTarget=null,_=q}else for(T=0;T<f.length;T++){if(k=f[T],q=k.instance,J=k.currentTarget,k=k.listener,q!==_&&y.isPropagationStopped())break t;_=k,y.currentTarget=J;try{_(y)}catch(st){Ud(st)}y.currentTarget=null,_=q}}}}function zt(r,o){var u=o[el];u===void 0&&(u=o[el]=new Set);var f=r+"__bubble";u.has(f)||(Nw(o,r,2,!1),u.add(f))}function Ty(r,o,u){var f=0;o&&(f|=4),Nw(u,r,f,o)}var xf="_reactListening"+Math.random().toString(36).slice(2);function Sy(r){if(!r[xf]){r[xf]=!0,qc.forEach(function(u){u!=="selectionchange"&&(gM.has(u)||Ty(u,!1,r),Ty(u,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[xf]||(o[xf]=!0,Ty("selectionchange",!1,o))}}function Nw(r,o,u,f){switch(cT(o)){case 2:var y=qM;break;case 8:y=GM;break;default:y=Uy}u=y.bind(null,o,u,r),y=void 0,!eo||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(y=!0),f?y!==void 0?r.addEventListener(o,u,{capture:!0,passive:y}):r.addEventListener(o,u,!0):y!==void 0?r.addEventListener(o,u,{passive:y}):r.addEventListener(o,u,!1)}function Cy(r,o,u,f,y){var _=f;if((o&1)===0&&(o&2)===0&&f!==null)t:for(;;){if(f===null)return;var T=f.tag;if(T===3||T===4){var k=f.stateNode.containerInfo;if(k===y)break;if(T===4)for(T=f.return;T!==null;){var q=T.tag;if((q===3||q===4)&&T.stateNode.containerInfo===y)return;T=T.return}for(;k!==null;){if(T=vs(k),T===null)return;if(q=T.tag,q===5||q===6||q===26||q===27){f=_=T;continue t}k=k.parentNode}}f=f.return}qr(function(){var J=_,st=bi(u),at=[];t:{var Z=fA.get(r);if(Z!==void 0){var it=Ss,vt=r;switch(r){case"keypress":if(io(u)===0)break t;case"keydown":case"keyup":it=Vd;break;case"focusin":vt="focus",it=ro;break;case"focusout":vt="blur",it=ro;break;case"beforeblur":case"afterblur":it=ro;break;case"click":if(u.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":it=iu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":it=Rd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":it=A;break;case cA:case uA:case hA:it=Dd;break;case dA:it=N;break;case"scroll":case"scrollend":it=nu;break;case"wheel":it=nt;break;case"copy":case"cut":case"paste":it=Pd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":it=ir;break;case"toggle":case"beforetoggle":it=Bt}var Rt=(o&4)!==0,de=!Rt&&(r==="scroll"||r==="scrollend"),Y=Rt?Z!==null?Z+"Capture":null:Z;Rt=[];for(var $=J,Q;$!==null;){var rt=$;if(Q=rt.stateNode,rt=rt.tag,rt!==5&&rt!==26&&rt!==27||Q===null||Y===null||(rt=$i($,Y),rt!=null&&Rt.push(ku($,rt,Q))),de)break;$=$.return}0<Rt.length&&(Z=new it(Z,vt,null,u,st),at.push({event:Z,listeners:Rt}))}}if((o&7)===0){t:{if(Z=r==="mouseover"||r==="pointerover",it=r==="mouseout"||r==="pointerout",Z&&u!==Zc&&(vt=u.relatedTarget||u.fromElement)&&(vs(vt)||vt[gs]))break t;if((it||Z)&&(Z=st.window===st?st:(Z=st.ownerDocument)?Z.defaultView||Z.parentWindow:window,it?(vt=u.relatedTarget||u.toElement,it=J,vt=vt?vs(vt):null,vt!==null&&(de=a(vt),Rt=vt.tag,vt!==de||Rt!==5&&Rt!==27&&Rt!==6)&&(vt=null)):(it=null,vt=J),it!==vt)){if(Rt=iu,rt="onMouseLeave",Y="onMouseEnter",$="mouse",(r==="pointerout"||r==="pointerover")&&(Rt=ir,rt="onPointerLeave",Y="onPointerEnter",$="pointer"),de=it==null?Z:ii(it),Q=vt==null?Z:ii(vt),Z=new Rt(rt,$+"leave",it,u,st),Z.target=de,Z.relatedTarget=Q,rt=null,vs(st)===J&&(Rt=new Rt(Y,$+"enter",vt,u,st),Rt.target=Q,Rt.relatedTarget=de,rt=Rt),de=rt,it&&vt)e:{for(Rt=yM,Y=it,$=vt,Q=0,rt=Y;rt;rt=Rt(rt))Q++;rt=0;for(var St=$;St;St=Rt(St))rt++;for(;0<Q-rt;)Y=Rt(Y),Q--;for(;0<rt-Q;)$=Rt($),rt--;for(;Q--;){if(Y===$||$!==null&&Y===$.alternate){Rt=Y;break e}Y=Rt(Y),$=Rt($)}Rt=null}else Rt=null;it!==null&&Ow(at,Z,it,Rt,!1),vt!==null&&de!==null&&Ow(at,de,vt,Rt,!0)}}t:{if(Z=J?ii(J):window,it=Z.nodeName&&Z.nodeName.toLowerCase(),it==="select"||it==="input"&&Z.type==="file")var Jt=Jb;else if(Xb(Z))if(Zb)Jt=R2;else{Jt=C2;var bt=S2}else it=Z.nodeName,!it||it.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?J&&rl(J.elementType)&&(Jt=Jb):Jt=x2;if(Jt&&(Jt=Jt(r,J))){Qb(at,Jt,u,st);break t}bt&&bt(r,Z,J),r==="focusout"&&J&&Z.type==="number"&&J.memoizedProps.value!=null&&Xc(Z,"number",Z.value)}switch(bt=J?ii(J):window,r){case"focusin":(Xb(bt)||bt.contentEditable==="true")&&(fl=bt,eg=J,lu=null);break;case"focusout":lu=eg=fl=null;break;case"mousedown":ng=!0;break;case"contextmenu":case"mouseup":case"dragend":ng=!1,oA(at,u,st);break;case"selectionchange":if(D2)break;case"keydown":case"keyup":oA(at,u,st)}var Ut;if(te)t:{switch(r){case"compositionstart":var qt="onCompositionStart";break t;case"compositionend":qt="onCompositionEnd";break t;case"compositionupdate":qt="onCompositionUpdate";break t}qt=void 0}else dl?ao(r,u)&&(qt="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(qt="onCompositionStart");qt&&(Rs&&u.locale!=="ko"&&(dl||qt!=="onCompositionStart"?qt==="onCompositionEnd"&&dl&&(Ut=eu()):(Ts=st,tu="value"in Ts?Ts.value:Ts.textContent,dl=!0)),bt=Rf(J,qt),0<bt.length&&(qt=new xs(qt,r,null,u,st),at.push({event:qt,listeners:bt}),Ut?qt.data=Ut:(Ut=hl(u),Ut!==null&&(qt.data=Ut)))),(Ut=Ei?A2(r,u):E2(r,u))&&(qt=Rf(J,"onBeforeInput"),0<qt.length&&(bt=new xs("onBeforeInput","beforeinput",null,u,st),at.push({event:bt,listeners:qt}),bt.data=Ut)),fM(at,r,J,u,st)}kw(at,o)})}function ku(r,o,u){return{instance:r,listener:o,currentTarget:u}}function Rf(r,o){for(var u=o+"Capture",f=[];r!==null;){var y=r,_=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||_===null||(y=$i(r,u),y!=null&&f.unshift(ku(r,y,_)),y=$i(r,o),y!=null&&f.push(ku(r,y,_))),r.tag===3)return f;r=r.return}return[]}function yM(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Ow(r,o,u,f,y){for(var _=o._reactName,T=[];u!==null&&u!==f;){var k=u,q=k.alternate,J=k.stateNode;if(k=k.tag,q!==null&&q===f)break;k!==5&&k!==26&&k!==27||J===null||(q=J,y?(J=$i(u,_),J!=null&&T.unshift(ku(u,J,q))):y||(J=$i(u,_),J!=null&&T.push(ku(u,J,q)))),u=u.return}T.length!==0&&r.push({event:o,listeners:T})}var vM=/\r\n?/g,_M=/\u0000|\uFFFD/g;function Lw(r){return(typeof r=="string"?r:""+r).replace(vM,`
`).replace(_M,"")}function Vw(r,o){return o=Lw(o),Lw(r)===o}function he(r,o,u,f,y,_){switch(u){case"children":typeof f=="string"?o==="body"||o==="textarea"&&f===""||$n(r,f):(typeof f=="number"||typeof f=="bigint")&&o!=="body"&&$n(r,""+f);break;case"className":si(r,"class",f);break;case"tabIndex":si(r,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":si(r,u,f);break;case"style":Jc(r,f,_);break;case"data":if(o!=="object"){si(r,"data",f);break}case"src":case"href":if(f===""&&(o!=="a"||u!=="href")){r.removeAttribute(u);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(u);break}f=al(""+f),r.setAttribute(u,f);break;case"action":case"formAction":if(typeof f=="function"){r.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(u==="formAction"?(o!=="input"&&he(r,o,"name",y.name,y,null),he(r,o,"formEncType",y.formEncType,y,null),he(r,o,"formMethod",y.formMethod,y,null),he(r,o,"formTarget",y.formTarget,y,null)):(he(r,o,"encType",y.encType,y,null),he(r,o,"method",y.method,y,null),he(r,o,"target",y.target,y,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(u);break}f=al(""+f),r.setAttribute(u,f);break;case"onClick":f!=null&&(r.onclick=Gi);break;case"onScroll":f!=null&&zt("scroll",r);break;case"onScrollEnd":f!=null&&zt("scrollend",r);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(u=f.__html,u!=null){if(y.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"multiple":r.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":r.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){r.removeAttribute("xlink:href");break}u=al(""+f),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,""+f):r.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,""):r.removeAttribute(u);break;case"capture":case"download":f===!0?r.setAttribute(u,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,f):r.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?r.setAttribute(u,f):r.removeAttribute(u);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?r.removeAttribute(u):r.setAttribute(u,f);break;case"popover":zt("beforetoggle",r),zt("toggle",r),il(r,"popover",f);break;case"xlinkActuate":Ge(r,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Ge(r,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Ge(r,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Ge(r,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Ge(r,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Ge(r,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Ge(r,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Ge(r,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Ge(r,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":il(r,"is",f);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=xd.get(u)||u,il(r,u,f))}}function xy(r,o,u,f,y,_){switch(u){case"style":Jc(r,f,_);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(u=f.__html,u!=null){if(y.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"children":typeof f=="string"?$n(r,f):(typeof f=="number"||typeof f=="bigint")&&$n(r,""+f);break;case"onScroll":f!=null&&zt("scroll",r);break;case"onScrollEnd":f!=null&&zt("scrollend",r);break;case"onClick":f!=null&&(r.onclick=Gi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Gc.hasOwnProperty(u))t:{if(u[0]==="o"&&u[1]==="n"&&(y=u.endsWith("Capture"),o=u.slice(2,y?u.length-7:void 0),_=r[hn]||null,_=_!=null?_[u]:null,typeof _=="function"&&r.removeEventListener(o,_,y),typeof f=="function")){typeof _!="function"&&_!==null&&(u in r?r[u]=null:r.hasAttribute(u)&&r.removeAttribute(u)),r.addEventListener(o,f,y);break t}u in r?r[u]=f:f===!0?r.setAttribute(u,""):il(r,u,f)}}}function En(r,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":zt("error",r),zt("load",r);var f=!1,y=!1,_;for(_ in u)if(u.hasOwnProperty(_)){var T=u[_];if(T!=null)switch(_){case"src":f=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:he(r,o,_,T,u,null)}}y&&he(r,o,"srcSet",u.srcSet,u,null),f&&he(r,o,"src",u.src,u,null);return;case"input":zt("invalid",r);var k=_=T=y=null,q=null,J=null;for(f in u)if(u.hasOwnProperty(f)){var st=u[f];if(st!=null)switch(f){case"name":y=st;break;case"type":T=st;break;case"checked":q=st;break;case"defaultChecked":J=st;break;case"value":_=st;break;case"defaultValue":k=st;break;case"children":case"dangerouslySetInnerHTML":if(st!=null)throw Error(n(137,o));break;default:he(r,o,f,st,u,null)}}Td(r,_,k,q,J,T,y,!1);return;case"select":zt("invalid",r),f=T=_=null;for(y in u)if(u.hasOwnProperty(y)&&(k=u[y],k!=null))switch(y){case"value":_=k;break;case"defaultValue":T=k;break;case"multiple":f=k;default:he(r,o,y,k,u,null)}o=_,u=T,r.multiple=!!f,o!=null?Ur(r,!!f,o,!1):u!=null&&Ur(r,!!f,u,!0);return;case"textarea":zt("invalid",r),_=y=f=null;for(T in u)if(u.hasOwnProperty(T)&&(k=u[T],k!=null))switch(T){case"value":f=k;break;case"defaultValue":y=k;break;case"children":_=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(n(91));break;default:he(r,o,T,k,u,null)}jr(r,f,y,_);return;case"option":for(q in u)u.hasOwnProperty(q)&&(f=u[q],f!=null)&&(q==="selected"?r.selected=f&&typeof f!="function"&&typeof f!="symbol":he(r,o,q,f,u,null));return;case"dialog":zt("beforetoggle",r),zt("toggle",r),zt("cancel",r),zt("close",r);break;case"iframe":case"object":zt("load",r);break;case"video":case"audio":for(f=0;f<Mu.length;f++)zt(Mu[f],r);break;case"image":zt("error",r),zt("load",r);break;case"details":zt("toggle",r);break;case"embed":case"source":case"link":zt("error",r),zt("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in u)if(u.hasOwnProperty(J)&&(f=u[J],f!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:he(r,o,J,f,u,null)}return;default:if(rl(o)){for(st in u)u.hasOwnProperty(st)&&(f=u[st],f!==void 0&&xy(r,o,st,f,u,void 0));return}}for(k in u)u.hasOwnProperty(k)&&(f=u[k],f!=null&&he(r,o,k,f,u,null))}function bM(r,o,u,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,_=null,T=null,k=null,q=null,J=null,st=null;for(it in u){var at=u[it];if(u.hasOwnProperty(it)&&at!=null)switch(it){case"checked":break;case"value":break;case"defaultValue":q=at;default:f.hasOwnProperty(it)||he(r,o,it,null,f,at)}}for(var Z in f){var it=f[Z];if(at=u[Z],f.hasOwnProperty(Z)&&(it!=null||at!=null))switch(Z){case"type":_=it;break;case"name":y=it;break;case"checked":J=it;break;case"defaultChecked":st=it;break;case"value":T=it;break;case"defaultValue":k=it;break;case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(n(137,o));break;default:it!==at&&he(r,o,Z,it,f,at)}}sl(r,T,k,q,J,st,_,y);return;case"select":it=T=k=Z=null;for(_ in u)if(q=u[_],u.hasOwnProperty(_)&&q!=null)switch(_){case"value":break;case"multiple":it=q;default:f.hasOwnProperty(_)||he(r,o,_,null,f,q)}for(y in f)if(_=f[y],q=u[y],f.hasOwnProperty(y)&&(_!=null||q!=null))switch(y){case"value":Z=_;break;case"defaultValue":k=_;break;case"multiple":T=_;default:_!==q&&he(r,o,y,_,f,q)}o=k,u=T,f=it,Z!=null?Ur(r,!!u,Z,!1):!!f!=!!u&&(o!=null?Ur(r,!!u,o,!0):Ur(r,!!u,u?[]:"",!1));return;case"textarea":it=Z=null;for(k in u)if(y=u[k],u.hasOwnProperty(k)&&y!=null&&!f.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:he(r,o,k,null,f,y)}for(T in f)if(y=f[T],_=u[T],f.hasOwnProperty(T)&&(y!=null||_!=null))switch(T){case"value":Z=y;break;case"defaultValue":it=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(n(91));break;default:y!==_&&he(r,o,T,y,f,_)}Sd(r,Z,it);return;case"option":for(var vt in u)Z=u[vt],u.hasOwnProperty(vt)&&Z!=null&&!f.hasOwnProperty(vt)&&(vt==="selected"?r.selected=!1:he(r,o,vt,null,f,Z));for(q in f)Z=f[q],it=u[q],f.hasOwnProperty(q)&&Z!==it&&(Z!=null||it!=null)&&(q==="selected"?r.selected=Z&&typeof Z!="function"&&typeof Z!="symbol":he(r,o,q,Z,f,it));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Rt in u)Z=u[Rt],u.hasOwnProperty(Rt)&&Z!=null&&!f.hasOwnProperty(Rt)&&he(r,o,Rt,null,f,Z);for(J in f)if(Z=f[J],it=u[J],f.hasOwnProperty(J)&&Z!==it&&(Z!=null||it!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(n(137,o));break;default:he(r,o,J,Z,f,it)}return;default:if(rl(o)){for(var de in u)Z=u[de],u.hasOwnProperty(de)&&Z!==void 0&&!f.hasOwnProperty(de)&&xy(r,o,de,void 0,f,Z);for(st in f)Z=f[st],it=u[st],!f.hasOwnProperty(st)||Z===it||Z===void 0&&it===void 0||xy(r,o,st,Z,f,it);return}}for(var Y in u)Z=u[Y],u.hasOwnProperty(Y)&&Z!=null&&!f.hasOwnProperty(Y)&&he(r,o,Y,null,f,Z);for(at in f)Z=f[at],it=u[at],!f.hasOwnProperty(at)||Z===it||Z==null&&it==null||he(r,o,at,Z,f,it)}function Bw(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function AM(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,u=performance.getEntriesByType("resource"),f=0;f<u.length;f++){var y=u[f],_=y.transferSize,T=y.initiatorType,k=y.duration;if(_&&k&&Bw(T)){for(T=0,k=y.responseEnd,f+=1;f<u.length;f++){var q=u[f],J=q.startTime;if(J>k)break;var st=q.transferSize,at=q.initiatorType;st&&Bw(at)&&(q=q.responseEnd,T+=st*(q<k?1:(k-J)/(q-J)))}if(--f,o+=8*(_+T)/(y.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Ry=null,Iy=null;function If(r){return r.nodeType===9?r:r.ownerDocument}function Fw(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Uw(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function Dy(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Py=null;function EM(){var r=window.event;return r&&r.type==="popstate"?r===Py?!1:(Py=r,!0):(Py=null,!1)}var jw=typeof setTimeout=="function"?setTimeout:void 0,wM=typeof clearTimeout=="function"?clearTimeout:void 0,zw=typeof Promise=="function"?Promise:void 0,TM=typeof queueMicrotask=="function"?queueMicrotask:typeof zw<"u"?function(r){return zw.resolve(null).then(r).catch(SM)}:jw;function SM(r){setTimeout(function(){throw r})}function ua(r){return r==="head"}function Hw(r,o){var u=o,f=0;do{var y=u.nextSibling;if(r.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"||u==="/&"){if(f===0){r.removeChild(y),Ul(o);return}f--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")f++;else if(u==="html")Nu(r.ownerDocument.documentElement);else if(u==="head"){u=r.ownerDocument.head,Nu(u);for(var _=u.firstChild;_;){var T=_.nextSibling,k=_.nodeName;_[ys]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&_.rel.toLowerCase()==="stylesheet"||u.removeChild(_),_=T}}else u==="body"&&Nu(r.ownerDocument.body);u=y}while(u);Ul(o)}function qw(r,o){var u=r;r=0;do{var f=u.nextSibling;if(u.nodeType===1?o?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(o?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),f&&f.nodeType===8)if(u=f.data,u==="/$"){if(r===0)break;r--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||r++;u=f}while(u)}function My(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":My(u),nl(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}r.removeChild(u)}}function CM(r,o,u,f){for(;r.nodeType===1;){var y=u;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!f&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(f){if(!r[ys])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(_=r.getAttribute("rel"),_==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(_!==y.rel||r.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||r.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||r.getAttribute("title")!==(y.title==null?null:y.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(_=r.getAttribute("src"),(_!==(y.src==null?null:y.src)||r.getAttribute("type")!==(y.type==null?null:y.type)||r.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&_&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var _=y.name==null?null:""+y.name;if(y.type==="hidden"&&r.getAttribute("name")===_)return r}else return r;if(r=Ii(r.nextSibling),r===null)break}return null}function xM(r,o,u){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!u||(r=Ii(r.nextSibling),r===null))return null;return r}function Gw(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=Ii(r.nextSibling),r===null))return null;return r}function ky(r){return r.data==="$?"||r.data==="$~"}function Ny(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function RM(r,o){var u=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||u.readyState!=="loading")o();else{var f=function(){o(),u.removeEventListener("DOMContentLoaded",f)};u.addEventListener("DOMContentLoaded",f),r._reactRetry=f}}function Ii(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var Oy=null;function $w(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="/$"||u==="/&"){if(o===0)return Ii(r.nextSibling);o--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||o++}r=r.nextSibling}return null}function Ww(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(o===0)return r;o--}else u!=="/$"&&u!=="/&"||o++}r=r.previousSibling}return null}function Kw(r,o,u){switch(o=If(u),r){case"html":if(r=o.documentElement,!r)throw Error(n(452));return r;case"head":if(r=o.head,!r)throw Error(n(453));return r;case"body":if(r=o.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function Nu(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);nl(r)}var Di=new Map,Yw=new Set;function Df(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var vr=K.d;K.d={f:IM,r:DM,D:PM,C:MM,L:kM,m:NM,X:LM,S:OM,M:VM};function IM(){var r=vr.f(),o=Af();return r||o}function DM(r){var o=_i(r);o!==null&&o.tag===5&&o.type==="form"?dE(o):vr.r(r)}var Vl=typeof document>"u"?null:document;function Xw(r,o,u){var f=Vl;if(f&&typeof o=="string"&&o){var y=Gn(o);y='link[rel="'+r+'"][href="'+y+'"]',typeof u=="string"&&(y+='[crossorigin="'+u+'"]'),Yw.has(y)||(Yw.add(y),r={rel:r,crossOrigin:u,href:o},f.querySelector(y)===null&&(o=f.createElement("link"),En(o,"link",r),qe(o),f.head.appendChild(o)))}}function PM(r){vr.D(r),Xw("dns-prefetch",r,null)}function MM(r,o){vr.C(r,o),Xw("preconnect",r,o)}function kM(r,o,u){vr.L(r,o,u);var f=Vl;if(f&&r&&o){var y='link[rel="preload"][as="'+Gn(o)+'"]';o==="image"&&u&&u.imageSrcSet?(y+='[imagesrcset="'+Gn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(y+='[imagesizes="'+Gn(u.imageSizes)+'"]')):y+='[href="'+Gn(r)+'"]';var _=y;switch(o){case"style":_=Bl(r);break;case"script":_=Fl(r)}Di.has(_)||(r=m({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:r,as:o},u),Di.set(_,r),f.querySelector(y)!==null||o==="style"&&f.querySelector(Ou(_))||o==="script"&&f.querySelector(Lu(_))||(o=f.createElement("link"),En(o,"link",r),qe(o),f.head.appendChild(o)))}}function NM(r,o){vr.m(r,o);var u=Vl;if(u&&r){var f=o&&typeof o.as=="string"?o.as:"script",y='link[rel="modulepreload"][as="'+Gn(f)+'"][href="'+Gn(r)+'"]',_=y;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=Fl(r)}if(!Di.has(_)&&(r=m({rel:"modulepreload",href:r},o),Di.set(_,r),u.querySelector(y)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Lu(_)))return}f=u.createElement("link"),En(f,"link",r),qe(f),u.head.appendChild(f)}}}function OM(r,o,u){vr.S(r,o,u);var f=Vl;if(f&&r){var y=_s(f).hoistableStyles,_=Bl(r);o=o||"default";var T=y.get(_);if(!T){var k={loading:0,preload:null};if(T=f.querySelector(Ou(_)))k.loading=5;else{r=m({rel:"stylesheet",href:r,"data-precedence":o},u),(u=Di.get(_))&&Ly(r,u);var q=T=f.createElement("link");qe(q),En(q,"link",r),q._p=new Promise(function(J,st){q.onload=J,q.onerror=st}),q.addEventListener("load",function(){k.loading|=1}),q.addEventListener("error",function(){k.loading|=2}),k.loading|=4,Pf(T,o,f)}T={type:"stylesheet",instance:T,count:1,state:k},y.set(_,T)}}}function LM(r,o){vr.X(r,o);var u=Vl;if(u&&r){var f=_s(u).hoistableScripts,y=Fl(r),_=f.get(y);_||(_=u.querySelector(Lu(y)),_||(r=m({src:r,async:!0},o),(o=Di.get(y))&&Vy(r,o),_=u.createElement("script"),qe(_),En(_,"link",r),u.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},f.set(y,_))}}function VM(r,o){vr.M(r,o);var u=Vl;if(u&&r){var f=_s(u).hoistableScripts,y=Fl(r),_=f.get(y);_||(_=u.querySelector(Lu(y)),_||(r=m({src:r,async:!0,type:"module"},o),(o=Di.get(y))&&Vy(r,o),_=u.createElement("script"),qe(_),En(_,"link",r),u.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},f.set(y,_))}}function Qw(r,o,u,f){var y=(y=Tt.current)?Df(y):null;if(!y)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Bl(u.href),u=_s(y).hoistableStyles,f=u.get(o),f||(f={type:"style",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){r=Bl(u.href);var _=_s(y).hoistableStyles,T=_.get(r);if(T||(y=y.ownerDocument||y,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(r,T),(_=y.querySelector(Ou(r)))&&!_._p&&(T.instance=_,T.state.loading=5),Di.has(r)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Di.set(r,u),_||BM(y,r,u,T.state))),o&&f===null)throw Error(n(528,""));return T}if(o&&f!==null)throw Error(n(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Fl(u),u=_s(y).hoistableScripts,f=u.get(o),f||(f={type:"script",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function Bl(r){return'href="'+Gn(r)+'"'}function Ou(r){return'link[rel="stylesheet"]['+r+"]"}function Jw(r){return m({},r,{"data-precedence":r.precedence,precedence:null})}function BM(r,o,u,f){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?f.loading=1:(o=r.createElement("link"),f.preload=o,o.addEventListener("load",function(){return f.loading|=1}),o.addEventListener("error",function(){return f.loading|=2}),En(o,"link",u),qe(o),r.head.appendChild(o))}function Fl(r){return'[src="'+Gn(r)+'"]'}function Lu(r){return"script[async]"+r}function Zw(r,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var f=r.querySelector('style[data-href~="'+Gn(u.href)+'"]');if(f)return o.instance=f,qe(f),f;var y=m({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return f=(r.ownerDocument||r).createElement("style"),qe(f),En(f,"style",y),Pf(f,u.precedence,r),o.instance=f;case"stylesheet":y=Bl(u.href);var _=r.querySelector(Ou(y));if(_)return o.state.loading|=4,o.instance=_,qe(_),_;f=Jw(u),(y=Di.get(y))&&Ly(f,y),_=(r.ownerDocument||r).createElement("link"),qe(_);var T=_;return T._p=new Promise(function(k,q){T.onload=k,T.onerror=q}),En(_,"link",f),o.state.loading|=4,Pf(_,u.precedence,r),o.instance=_;case"script":return _=Fl(u.src),(y=r.querySelector(Lu(_)))?(o.instance=y,qe(y),y):(f=u,(y=Di.get(_))&&(f=m({},u),Vy(f,y)),r=r.ownerDocument||r,y=r.createElement("script"),qe(y),En(y,"link",f),r.head.appendChild(y),o.instance=y);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(f=o.instance,o.state.loading|=4,Pf(f,u.precedence,r));return o.instance}function Pf(r,o,u){for(var f=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=f.length?f[f.length-1]:null,_=y,T=0;T<f.length;T++){var k=f[T];if(k.dataset.precedence===o)_=k;else if(_!==y)break}_?_.parentNode.insertBefore(r,_.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(r,o.firstChild))}function Ly(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function Vy(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var Mf=null;function tT(r,o,u){if(Mf===null){var f=new Map,y=Mf=new Map;y.set(u,f)}else y=Mf,f=y.get(u),f||(f=new Map,y.set(u,f));if(f.has(r))return f;for(f.set(r,null),u=u.getElementsByTagName(r),y=0;y<u.length;y++){var _=u[y];if(!(_[ys]||_[He]||r==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var T=_.getAttribute(o)||"";T=r+T;var k=f.get(T);k?k.push(_):f.set(T,[_])}}return f}function eT(r,o,u){r=r.ownerDocument||r,r.head.insertBefore(u,o==="title"?r.querySelector("head > title"):null)}function FM(r,o,u){if(u===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;return o.rel==="stylesheet"?(r=o.disabled,typeof o.precedence=="string"&&r==null):!0;case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function nT(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function UM(r,o,u,f){if(u.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var y=Bl(f.href),_=o.querySelector(Ou(y));if(_){o=_._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=kf.bind(r),o.then(r,r)),u.state.loading|=4,u.instance=_,qe(_);return}_=o.ownerDocument||o,f=Jw(f),(y=Di.get(y))&&Ly(f,y),_=_.createElement("link"),qe(_);var T=_;T._p=new Promise(function(k,q){T.onload=k,T.onerror=q}),En(_,"link",f),u.instance=_}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(r.count++,u=kf.bind(r),o.addEventListener("load",u),o.addEventListener("error",u))}}var By=0;function jM(r,o){return r.stylesheets&&r.count===0&&Of(r,r.stylesheets),0<r.count||0<r.imgCount?function(u){var f=setTimeout(function(){if(r.stylesheets&&Of(r,r.stylesheets),r.unsuspend){var _=r.unsuspend;r.unsuspend=null,_()}},6e4+o);0<r.imgBytes&&By===0&&(By=62500*AM());var y=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Of(r,r.stylesheets),r.unsuspend)){var _=r.unsuspend;r.unsuspend=null,_()}},(r.imgBytes>By?50:800)+o);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(f),clearTimeout(y)}}:null}function kf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Of(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Nf=null;function Of(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Nf=new Map,o.forEach(zM,r),Nf=null,kf.call(r))}function zM(r,o){if(!(o.state.loading&4)){var u=Nf.get(r);if(u)var f=u.get(null);else{u=new Map,Nf.set(r,u);for(var y=r.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<y.length;_++){var T=y[_];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(u.set(T.dataset.precedence,T),f=T)}f&&u.set(null,f)}y=o.instance,T=y.getAttribute("data-precedence"),_=u.get(T)||f,_===f&&u.set(null,y),u.set(T,y),this.count++,f=kf.bind(this),y.addEventListener("load",f),y.addEventListener("error",f),_?_.parentNode.insertBefore(y,_.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(y,r.firstChild)),o.state.loading|=4}}var Vu={$$typeof:I,Provider:null,Consumer:null,_currentValue:tt,_currentValue2:tt,_threadCount:0};function HM(r,o,u,f,y,_,T,k,q){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ms(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ms(0),this.hiddenUpdates=ms(null),this.identifierPrefix=f,this.onUncaughtError=y,this.onCaughtError=_,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function iT(r,o,u,f,y,_,T,k,q,J,st,at){return r=new HM(r,o,u,T,q,J,st,at,k),o=1,_===!0&&(o|=24),_=ai(3,null,null,o),r.current=_,_.stateNode=r,o=yg(),o.refCount++,r.pooledCache=o,o.refCount++,_.memoizedState={element:f,isDehydrated:u,cache:o},Ag(_),r}function sT(r){return r?(r=gl,r):gl}function rT(r,o,u,f,y,_){y=sT(y),f.context===null?f.context=y:f.pendingContext=y,f=Zr(o),f.payload={element:u},_=_===void 0?null:_,_!==null&&(f.callback=_),u=ta(r,f,o),u!==null&&(Qn(u,r,o),mu(u,r,o))}function aT(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<o?u:o}}function Fy(r,o){aT(r,o),(r=r.alternate)&&aT(r,o)}function oT(r){if(r.tag===13||r.tag===31){var o=co(r,67108864);o!==null&&Qn(o,r,67108864),Fy(r,67108864)}}function lT(r){if(r.tag===13||r.tag===31){var o=hi();o=Qa(o);var u=co(r,o);u!==null&&Qn(u,r,o),Fy(r,o)}}var Lf=!0;function qM(r,o,u,f){var y=W.T;W.T=null;var _=K.p;try{K.p=2,Uy(r,o,u,f)}finally{K.p=_,W.T=y}}function GM(r,o,u,f){var y=W.T;W.T=null;var _=K.p;try{K.p=8,Uy(r,o,u,f)}finally{K.p=_,W.T=y}}function Uy(r,o,u,f){if(Lf){var y=jy(f);if(y===null)Cy(r,o,f,Vf,u),uT(r,f);else if(WM(y,r,o,u,f))f.stopPropagation();else if(uT(r,f),o&4&&-1<$M.indexOf(r)){for(;y!==null;){var _=_i(y);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var T=fs(_.pendingLanes);if(T!==0){var k=_;for(k.pendingLanes|=2,k.entangledLanes|=2;T;){var q=1<<31-Oe(T);k.entanglements[1]|=q,T&=~q}Ms(_),(ee&6)===0&&(_f=On()+500,Pu(0))}}break;case 31:case 13:k=co(_,2),k!==null&&Qn(k,_,2),Af(),Fy(_,2)}if(_=jy(f),_===null&&Cy(r,o,f,Vf,u),_===y)break;y=_}y!==null&&f.stopPropagation()}else Cy(r,o,f,null,u)}}function jy(r){return r=bi(r),zy(r)}var Vf=null;function zy(r){if(Vf=null,r=vs(r),r!==null){var o=a(r);if(o===null)r=null;else{var u=o.tag;if(u===13){if(r=l(o),r!==null)return r;r=null}else if(u===31){if(r=c(o),r!==null)return r;r=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return Vf=r,null}function cT(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Wa()){case Uc:return 2;case jc:return 8;case Br:case Km:return 32;case pd:return 268435456;default:return 32}default:return 32}}var Hy=!1,ha=null,da=null,fa=null,Bu=new Map,Fu=new Map,pa=[],$M="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function uT(r,o){switch(r){case"focusin":case"focusout":ha=null;break;case"dragenter":case"dragleave":da=null;break;case"mouseover":case"mouseout":fa=null;break;case"pointerover":case"pointerout":Bu.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fu.delete(o.pointerId)}}function Uu(r,o,u,f,y,_){return r===null||r.nativeEvent!==_?(r={blockedOn:o,domEventName:u,eventSystemFlags:f,nativeEvent:_,targetContainers:[y]},o!==null&&(o=_i(o),o!==null&&oT(o)),r):(r.eventSystemFlags|=f,o=r.targetContainers,y!==null&&o.indexOf(y)===-1&&o.push(y),r)}function WM(r,o,u,f,y){switch(o){case"focusin":return ha=Uu(ha,r,o,u,f,y),!0;case"dragenter":return da=Uu(da,r,o,u,f,y),!0;case"mouseover":return fa=Uu(fa,r,o,u,f,y),!0;case"pointerover":var _=y.pointerId;return Bu.set(_,Uu(Bu.get(_)||null,r,o,u,f,y)),!0;case"gotpointercapture":return _=y.pointerId,Fu.set(_,Uu(Fu.get(_)||null,r,o,u,f,y)),!0}return!1}function hT(r){var o=vs(r.target);if(o!==null){var u=a(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){r.blockedOn=o,Hi(r.priority,function(){lT(u)});return}}else if(o===31){if(o=c(u),o!==null){r.blockedOn=o,Hi(r.priority,function(){lT(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Bf(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var u=jy(r.nativeEvent);if(u===null){u=r.nativeEvent;var f=new u.constructor(u.type,u);Zc=f,u.target.dispatchEvent(f),Zc=null}else return o=_i(u),o!==null&&oT(o),r.blockedOn=u,!1;o.shift()}return!0}function dT(r,o,u){Bf(r)&&u.delete(o)}function KM(){Hy=!1,ha!==null&&Bf(ha)&&(ha=null),da!==null&&Bf(da)&&(da=null),fa!==null&&Bf(fa)&&(fa=null),Bu.forEach(dT),Fu.forEach(dT)}function Ff(r,o){r.blockedOn===o&&(r.blockedOn=null,Hy||(Hy=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,KM)))}var Uf=null;function fT(r){Uf!==r&&(Uf=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Uf===r&&(Uf=null);for(var o=0;o<r.length;o+=3){var u=r[o],f=r[o+1],y=r[o+2];if(typeof f!="function"){if(zy(f||u)===null)continue;break}var _=_i(u);_!==null&&(r.splice(o,3),o-=3,jg(_,{pending:!0,data:y,method:u.method,action:f},f,y))}}))}function Ul(r){function o(q){return Ff(q,r)}ha!==null&&Ff(ha,r),da!==null&&Ff(da,r),fa!==null&&Ff(fa,r),Bu.forEach(o),Fu.forEach(o);for(var u=0;u<pa.length;u++){var f=pa[u];f.blockedOn===r&&(f.blockedOn=null)}for(;0<pa.length&&(u=pa[0],u.blockedOn===null);)hT(u),u.blockedOn===null&&pa.shift();if(u=(r.ownerDocument||r).$$reactFormReplay,u!=null)for(f=0;f<u.length;f+=3){var y=u[f],_=u[f+1],T=y[hn]||null;if(typeof _=="function")T||fT(u);else if(T){var k=null;if(_&&_.hasAttribute("formAction")){if(y=_,T=_[hn]||null)k=T.formAction;else if(zy(y)!==null)continue}else k=T.action;typeof k=="function"?u[f+1]=k:(u.splice(f,3),f-=3),fT(u)}}}function pT(){function r(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(T){return y=T})},focusReset:"manual",scroll:"manual"})}function o(){y!==null&&(y(),y=null),f||setTimeout(u,20)}function u(){if(!f&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,y=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(u,100),function(){f=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),y!==null&&(y(),y=null)}}}function qy(r){this._internalRoot=r}jf.prototype.render=qy.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));var u=o.current,f=hi();rT(u,f,r,o,null,null)},jf.prototype.unmount=qy.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;rT(r.current,2,null,r,null,null),Af(),o[gs]=null}};function jf(r){this._internalRoot=r}jf.prototype.unstable_scheduleHydration=function(r){if(r){var o=bd();r={blockedOn:null,target:r,priority:o};for(var u=0;u<pa.length&&o!==0&&o<pa[u].priority;u++);pa.splice(u,0,r),u===0&&hT(r)}};var mT=t.version;if(mT!=="19.2.3")throw Error(n(527,mT,"19.2.3"));K.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=d(o),r=r!==null?p(r):null,r=r===null?null:r.stateNode,r};var YM={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zf.isDisabled&&zf.supportsFiber)try{ji=zf.inject(YM),yn=zf}catch{}}return zu.createRoot=function(r,o){if(!s(r))throw Error(n(299));var u=!1,f="",y=EE,_=wE,T=TE;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(_=o.onCaughtError),o.onRecoverableError!==void 0&&(T=o.onRecoverableError)),o=iT(r,1,!1,null,null,u,f,null,y,_,T,pT),r[gs]=o.current,Sy(r),new qy(o)},zu.hydrateRoot=function(r,o,u){if(!s(r))throw Error(n(299));var f=!1,y="",_=EE,T=wE,k=TE,q=null;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(_=u.onUncaughtError),u.onCaughtError!==void 0&&(T=u.onCaughtError),u.onRecoverableError!==void 0&&(k=u.onRecoverableError),u.formState!==void 0&&(q=u.formState)),o=iT(r,1,!0,o,u??null,f,y,q,_,T,k,pT),o.context=sT(null),u=o.current,f=hi(),f=Qa(f),y=Zr(f),y.callback=null,ta(u,y,f),u=f,o.current.lanes=u,Ya(o,u),Ms(o),r[gs]=o.current,Sy(r),new jf(o)},zu.version="19.2.3",zu}var xT;function ak(){if(xT)return Ky.exports;xT=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(t){console.error(t)}}return i(),Ky.exports=rk(),Ky.exports}var ok=ak();const lk=ix(ok);var RT="popstate";function ck(i={}){function t(s,a){let{pathname:l="/",search:c="",hash:h=""}=Go(s.location.hash.substring(1));return!l.startsWith("/")&&!l.startsWith(".")&&(l="/"+l),Fv("",{pathname:l,search:c,hash:h},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function e(s,a){let l=s.document.querySelector("base"),c="";if(l&&l.getAttribute("href")){let h=s.location.href,d=h.indexOf("#");c=d===-1?h:h.slice(0,d)}return c+"#"+(typeof a=="string"?a:bh(a))}function n(s,a){mi(s.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return hk(t,e,n,i)}function Ce(i,t){if(i===!1||i===null||typeof i>"u")throw new Error(t)}function mi(i,t){if(!i){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function uk(){return Math.random().toString(36).substring(2,10)}function IT(i,t){return{usr:i.state,key:i.key,idx:t}}function Fv(i,t,e=null,n){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof t=="string"?Go(t):t,state:e,key:t&&t.key||n||uk()}}function bh({pathname:i="/",search:t="",hash:e=""}){return t&&t!=="?"&&(i+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(i+=e.charAt(0)==="#"?e:"#"+e),i}function Go(i){let t={};if(i){let e=i.indexOf("#");e>=0&&(t.hash=i.substring(e),i=i.substring(0,e));let n=i.indexOf("?");n>=0&&(t.search=i.substring(n),i=i.substring(0,n)),i&&(t.pathname=i)}return t}function hk(i,t,e,n={}){let{window:s=document.defaultView,v5Compat:a=!1}=n,l=s.history,c="POP",h=null,d=p();d==null&&(d=0,l.replaceState({...l.state,idx:d},""));function p(){return(l.state||{idx:null}).idx}function m(){c="POP";let S=p(),C=S==null?null:S-d;d=S,h&&h({action:c,location:E.location,delta:C})}function v(S,C){c="PUSH";let R=Fv(E.location,S,C);e&&e(R,S),d=p()+1;let I=IT(R,d),B=E.createHref(R);try{l.pushState(I,"",B)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;s.location.assign(B)}a&&h&&h({action:c,location:E.location,delta:1})}function b(S,C){c="REPLACE";let R=Fv(E.location,S,C);e&&e(R,S),d=p();let I=IT(R,d),B=E.createHref(R);l.replaceState(I,"",B),a&&h&&h({action:c,location:E.location,delta:0})}function w(S){return dk(S)}let E={get action(){return c},get location(){return i(s,l)},listen(S){if(h)throw new Error("A history only accepts one active listener");return s.addEventListener(RT,m),h=S,()=>{s.removeEventListener(RT,m),h=null}},createHref(S){return t(s,S)},createURL:w,encodeLocation(S){let C=w(S);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:v,replace:b,go(S){return l.go(S)}};return E}function dk(i,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),Ce(e,"No window.location.(origin|href) available to create URL");let n=typeof i=="string"?i:bh(i);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=e+n),new URL(n,e)}function sx(i,t,e="/"){return fk(i,t,e,!1)}function fk(i,t,e,n){let s=typeof t=="string"?Go(t):t,a=Dr(s.pathname||"/",e);if(a==null)return null;let l=rx(i);pk(l);let c=null;for(let h=0;c==null&&h<l.length;++h){let d=Sk(a);c=wk(l[h],d,n)}return c}function rx(i,t=[],e=[],n="",s=!1){let a=(l,c,h=s,d)=>{let p={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(n)&&h)return;Ce(p.relativePath.startsWith(n),`Absolute route path "${p.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(n.length)}let m=Sr([n,p.relativePath]),v=e.concat(p);l.children&&l.children.length>0&&(Ce(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),rx(l.children,t,v,m,h)),!(l.path==null&&!l.index)&&t.push({path:m,score:Ak(m,l.index),routesMeta:v})};return i.forEach((l,c)=>{if(l.path===""||!l.path?.includes("?"))a(l,c);else for(let h of ax(l.path))a(l,c,!0,h)}),t}function ax(i){let t=i.split("/");if(t.length===0)return[];let[e,...n]=t,s=e.endsWith("?"),a=e.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let l=ax(n.join("/")),c=[];return c.push(...l.map(h=>h===""?a:[a,h].join("/"))),s&&c.push(...l),c.map(h=>i.startsWith("/")&&h===""?"/":h)}function pk(i){i.sort((t,e)=>t.score!==e.score?e.score-t.score:Ek(t.routesMeta.map(n=>n.childrenIndex),e.routesMeta.map(n=>n.childrenIndex)))}var mk=/^:[\w-]+$/,gk=3,yk=2,vk=1,_k=10,bk=-2,DT=i=>i==="*";function Ak(i,t){let e=i.split("/"),n=e.length;return e.some(DT)&&(n+=bk),t&&(n+=yk),e.filter(s=>!DT(s)).reduce((s,a)=>s+(mk.test(a)?gk:a===""?vk:_k),n)}function Ek(i,t){return i.length===t.length&&i.slice(0,-1).every((n,s)=>n===t[s])?i[i.length-1]-t[t.length-1]:0}function wk(i,t,e=!1){let{routesMeta:n}=i,s={},a="/",l=[];for(let c=0;c<n.length;++c){let h=n[c],d=c===n.length-1,p=a==="/"?t:t.slice(a.length)||"/",m=Mp({path:h.relativePath,caseSensitive:h.caseSensitive,end:d},p),v=h.route;if(!m&&d&&e&&!n[n.length-1].route.index&&(m=Mp({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},p)),!m)return null;Object.assign(s,m.params),l.push({params:s,pathname:Sr([a,m.pathname]),pathnameBase:Ik(Sr([a,m.pathnameBase])),route:v}),m.pathnameBase!=="/"&&(a=Sr([a,m.pathnameBase]))}return l}function Mp(i,t){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[e,n]=Tk(i.path,i.caseSensitive,i.end),s=t.match(e);if(!s)return null;let a=s[0],l=a.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:n.reduce((d,{paramName:p,isOptional:m},v)=>{if(p==="*"){let w=c[v]||"";l=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const b=c[v];return m&&!b?d[p]=void 0:d[p]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:l,pattern:i}}function Tk(i,t=!1,e=!0){mi(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let n=[],s="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,h)=>(n.push({paramName:c,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return i.endsWith("*")?(n.push({paramName:"*"}),s+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?s+="\\/*$":i!==""&&i!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function Sk(i){try{return i.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return mi(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),i}}function Dr(i,t){if(t==="/")return i;if(!i.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,n=i.charAt(e);return n&&n!=="/"?null:i.slice(e)||"/"}var ox=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ck=i=>ox.test(i);function xk(i,t="/"){let{pathname:e,search:n="",hash:s=""}=typeof i=="string"?Go(i):i,a;if(e)if(Ck(e))a=e;else{if(e.includes("//")){let l=e;e=e.replace(/\/\/+/g,"/"),mi(!1,`Pathnames cannot have embedded double slashes - normalizing ${l} -> ${e}`)}e.startsWith("/")?a=PT(e.substring(1),"/"):a=PT(e,t)}else a=t;return{pathname:a,search:Dk(n),hash:Pk(s)}}function PT(i,t){let e=t.replace(/\/+$/,"").split("/");return i.split("/").forEach(s=>{s===".."?e.length>1&&e.pop():s!=="."&&e.push(s)}),e.length>1?e.join("/"):"/"}function Jy(i,t,e,n){return`Cannot include a '${i}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Rk(i){return i.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function t0(i){let t=Rk(i);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function e0(i,t,e,n=!1){let s;typeof i=="string"?s=Go(i):(s={...i},Ce(!s.pathname||!s.pathname.includes("?"),Jy("?","pathname","search",s)),Ce(!s.pathname||!s.pathname.includes("#"),Jy("#","pathname","hash",s)),Ce(!s.search||!s.search.includes("#"),Jy("#","search","hash",s)));let a=i===""||s.pathname==="",l=a?"/":s.pathname,c;if(l==null)c=e;else{let m=t.length-1;if(!n&&l.startsWith("..")){let v=l.split("/");for(;v[0]==="..";)v.shift(),m-=1;s.pathname=v.join("/")}c=m>=0?t[m]:"/"}let h=xk(s,c),d=l&&l!=="/"&&l.endsWith("/"),p=(a||l===".")&&e.endsWith("/");return!h.pathname.endsWith("/")&&(d||p)&&(h.pathname+="/"),h}var Sr=i=>i.join("/").replace(/\/\/+/g,"/"),Ik=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),Dk=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,Pk=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i,Mk=class{constructor(i,t,e,n=!1){this.status=i,this.statusText=t||"",this.internal=n,e instanceof Error?(this.data=e.toString(),this.error=e):this.data=e}};function kk(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}function Nk(i){return i.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var lx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function cx(i,t){let e=i;if(typeof e!="string"||!ox.test(e))return{absoluteURL:void 0,isExternal:!1,to:e};let n=e,s=!1;if(lx)try{let a=new URL(window.location.href),l=e.startsWith("//")?new URL(a.protocol+e):new URL(e),c=Dr(l.pathname,t);l.origin===a.origin&&c!=null?e=c+l.search+l.hash:s=!0}catch{mi(!1,`<Link to="${e}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:s,to:e}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var ux=["POST","PUT","PATCH","DELETE"];new Set(ux);var Ok=["GET",...ux];new Set(Ok);var Sc=z.createContext(null);Sc.displayName="DataRouter";var pm=z.createContext(null);pm.displayName="DataRouterState";var Lk=z.createContext(!1),hx=z.createContext({isTransitioning:!1});hx.displayName="ViewTransition";var Vk=z.createContext(new Map);Vk.displayName="Fetchers";var Bk=z.createContext(null);Bk.displayName="Await";var gi=z.createContext(null);gi.displayName="Navigation";var jh=z.createContext(null);jh.displayName="Location";var cs=z.createContext({outlet:null,matches:[],isDataRoute:!1});cs.displayName="Route";var n0=z.createContext(null);n0.displayName="RouteError";var dx="REACT_ROUTER_ERROR",Fk="REDIRECT",Uk="ROUTE_ERROR_RESPONSE";function jk(i){if(i.startsWith(`${dx}:${Fk}:{`))try{let t=JSON.parse(i.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function zk(i){if(i.startsWith(`${dx}:${Uk}:{`))try{let t=JSON.parse(i.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new Mk(t.status,t.statusText,t.data)}catch{}}function Hk(i,{relative:t}={}){Ce(Cc(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:n}=z.useContext(gi),{hash:s,pathname:a,search:l}=Hh(i,{relative:t}),c=a;return e!=="/"&&(c=a==="/"?e:Sr([e,a])),n.createHref({pathname:c,search:l,hash:s})}function Cc(){return z.useContext(jh)!=null}function ja(){return Ce(Cc(),"useLocation() may be used only in the context of a <Router> component."),z.useContext(jh).location}var fx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function px(i){z.useContext(gi).static||z.useLayoutEffect(i)}function zh(){let{isDataRoute:i}=z.useContext(cs);return i?iN():qk()}function qk(){Ce(Cc(),"useNavigate() may be used only in the context of a <Router> component.");let i=z.useContext(Sc),{basename:t,navigator:e}=z.useContext(gi),{matches:n}=z.useContext(cs),{pathname:s}=ja(),a=JSON.stringify(t0(n)),l=z.useRef(!1);return px(()=>{l.current=!0}),z.useCallback((h,d={})=>{if(mi(l.current,fx),!l.current)return;if(typeof h=="number"){e.go(h);return}let p=e0(h,JSON.parse(a),s,d.relative==="path");i==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:Sr([t,p.pathname])),(d.replace?e.replace:e.push)(p,d.state,d)},[t,e,a,s,i])}z.createContext(null);function Gk(){let{matches:i}=z.useContext(cs),t=i[i.length-1];return t?t.params:{}}function Hh(i,{relative:t}={}){let{matches:e}=z.useContext(cs),{pathname:n}=ja(),s=JSON.stringify(t0(e));return z.useMemo(()=>e0(i,JSON.parse(s),n,t==="path"),[i,s,n,t])}function $k(i,t){return mx(i,t)}function mx(i,t,e,n,s){Ce(Cc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=z.useContext(gi),{matches:l}=z.useContext(cs),c=l[l.length-1],h=c?c.params:{},d=c?c.pathname:"/",p=c?c.pathnameBase:"/",m=c&&c.route;{let R=m&&m.path||"";yx(d,!m||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let v=ja(),b;if(t){let R=typeof t=="string"?Go(t):t;Ce(p==="/"||R.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${R.pathname}" was given in the \`location\` prop.`),b=R}else b=v;let w=b.pathname||"/",E=w;if(p!=="/"){let R=p.replace(/^\//,"").split("/");E="/"+w.replace(/^\//,"").split("/").slice(R.length).join("/")}let S=sx(i,{pathname:E});mi(m||S!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),mi(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let C=Qk(S&&S.map(R=>Object.assign({},R,{params:Object.assign({},h,R.params),pathname:Sr([p,a.encodeLocation?a.encodeLocation(R.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?p:Sr([p,a.encodeLocation?a.encodeLocation(R.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathnameBase])})),l,e,n,s);return t&&C?z.createElement(jh.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},C):C}function Wk(){let i=nN(),t=kk(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),e=i instanceof Error?i.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},l=null;return console.error("Error handled by React Router default ErrorBoundary:",i),l=z.createElement(z.Fragment,null,z.createElement("p",null," Hey developer "),z.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",z.createElement("code",{style:a},"ErrorBoundary")," or"," ",z.createElement("code",{style:a},"errorElement")," prop on your route.")),z.createElement(z.Fragment,null,z.createElement("h2",null,"Unexpected Application Error!"),z.createElement("h3",{style:{fontStyle:"italic"}},t),e?z.createElement("pre",{style:s},e):null,l)}var Kk=z.createElement(Wk,null),gx=class extends z.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,t){return t.location!==i.location||t.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:t.error,location:t.location,revalidation:i.revalidation||t.revalidation}}componentDidCatch(i,t){this.props.onError?this.props.onError(i,t):console.error("React Router caught the following error during render",i)}render(){let i=this.state.error;if(this.context&&typeof i=="object"&&i&&"digest"in i&&typeof i.digest=="string"){const e=zk(i.digest);e&&(i=e)}let t=i!==void 0?z.createElement(cs.Provider,{value:this.props.routeContext},z.createElement(n0.Provider,{value:i,children:this.props.component})):this.props.children;return this.context?z.createElement(Yk,{error:i},t):t}};gx.contextType=Lk;var Zy=new WeakMap;function Yk({children:i,error:t}){let{basename:e}=z.useContext(gi);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let n=jk(t.digest);if(n){let s=Zy.get(t);if(s)throw s;let a=cx(n.location,e);if(lx&&!Zy.get(t))if(a.isExternal||n.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const l=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:n.replace}));throw Zy.set(t,l),l}return z.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return i}function Xk({routeContext:i,match:t,children:e}){let n=z.useContext(Sc);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),z.createElement(cs.Provider,{value:i},e)}function Qk(i,t=[],e=null,n=null,s=null){if(i==null){if(!e)return null;if(e.errors)i=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)i=e.matches;else return null}let a=i,l=e?.errors;if(l!=null){let p=a.findIndex(m=>m.route.id&&l?.[m.route.id]!==void 0);Ce(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,p+1))}let c=!1,h=-1;if(e)for(let p=0;p<a.length;p++){let m=a[p];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(h=p),m.route.id){let{loaderData:v,errors:b}=e,w=m.route.loader&&!v.hasOwnProperty(m.route.id)&&(!b||b[m.route.id]===void 0);if(m.route.lazy||w){c=!0,h>=0?a=a.slice(0,h+1):a=[a[0]];break}}}let d=e&&n?(p,m)=>{n(p,{location:e.location,params:e.matches?.[0]?.params??{},unstable_pattern:Nk(e.matches),errorInfo:m})}:void 0;return a.reduceRight((p,m,v)=>{let b,w=!1,E=null,S=null;e&&(b=l&&m.route.id?l[m.route.id]:void 0,E=m.route.errorElement||Kk,c&&(h<0&&v===0?(yx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,S=null):h===v&&(w=!0,S=m.route.hydrateFallbackElement||null)));let C=t.concat(a.slice(0,v+1)),R=()=>{let I;return b?I=E:w?I=S:m.route.Component?I=z.createElement(m.route.Component,null):m.route.element?I=m.route.element:I=p,z.createElement(Xk,{match:m,routeContext:{outlet:p,matches:C,isDataRoute:e!=null},children:I})};return e&&(m.route.ErrorBoundary||m.route.errorElement||v===0)?z.createElement(gx,{location:e.location,revalidation:e.revalidation,component:E,error:b,children:R(),routeContext:{outlet:null,matches:C,isDataRoute:!0},onError:d}):R()},null)}function i0(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Jk(i){let t=z.useContext(Sc);return Ce(t,i0(i)),t}function Zk(i){let t=z.useContext(pm);return Ce(t,i0(i)),t}function tN(i){let t=z.useContext(cs);return Ce(t,i0(i)),t}function s0(i){let t=tN(i),e=t.matches[t.matches.length-1];return Ce(e.route.id,`${i} can only be used on routes that contain a unique "id"`),e.route.id}function eN(){return s0("useRouteId")}function nN(){let i=z.useContext(n0),t=Zk("useRouteError"),e=s0("useRouteError");return i!==void 0?i:t.errors?.[e]}function iN(){let{router:i}=Jk("useNavigate"),t=s0("useNavigate"),e=z.useRef(!1);return px(()=>{e.current=!0}),z.useCallback(async(s,a={})=>{mi(e.current,fx),e.current&&(typeof s=="number"?await i.navigate(s):await i.navigate(s,{fromRouteId:t,...a}))},[i,t])}var MT={};function yx(i,t,e){!t&&!MT[i]&&(MT[i]=!0,mi(!1,e))}z.memo(sN);function sN({routes:i,future:t,state:e,onError:n}){return mx(i,void 0,e,n,t)}function rN({to:i,replace:t,state:e,relative:n}){Ce(Cc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=z.useContext(gi);mi(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=z.useContext(cs),{pathname:l}=ja(),c=zh(),h=e0(i,t0(a),l,n==="path"),d=JSON.stringify(h);return z.useEffect(()=>{c(JSON.parse(d),{replace:t,state:e,relative:n})},[c,d,n,t,e]),null}function zl(i){Ce(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function aN({basename:i="/",children:t=null,location:e,navigationType:n="POP",navigator:s,static:a=!1,unstable_useTransitions:l}){Ce(!Cc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=i.replace(/^\/*/,"/"),h=z.useMemo(()=>({basename:c,navigator:s,static:a,unstable_useTransitions:l,future:{}}),[c,s,a,l]);typeof e=="string"&&(e=Go(e));let{pathname:d="/",search:p="",hash:m="",state:v=null,key:b="default"}=e,w=z.useMemo(()=>{let E=Dr(d,c);return E==null?null:{location:{pathname:E,search:p,hash:m,state:v,key:b},navigationType:n}},[c,d,p,m,v,b,n]);return mi(w!=null,`<Router basename="${c}"> is not able to match the URL "${d}${p}${m}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:z.createElement(gi.Provider,{value:h},z.createElement(jh.Provider,{children:t,value:w}))}function oN({children:i,location:t}){return $k(Uv(i),t)}function Uv(i,t=[]){let e=[];return z.Children.forEach(i,(n,s)=>{if(!z.isValidElement(n))return;let a=[...t,s];if(n.type===z.Fragment){e.push.apply(e,Uv(n.props.children,a));return}Ce(n.type===zl,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ce(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=Uv(n.props.children,a)),e.push(l)}),e}var hp="get",dp="application/x-www-form-urlencoded";function mm(i){return typeof HTMLElement<"u"&&i instanceof HTMLElement}function lN(i){return mm(i)&&i.tagName.toLowerCase()==="button"}function cN(i){return mm(i)&&i.tagName.toLowerCase()==="form"}function uN(i){return mm(i)&&i.tagName.toLowerCase()==="input"}function hN(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function dN(i,t){return i.button===0&&(!t||t==="_self")&&!hN(i)}var Hf=null;function fN(){if(Hf===null)try{new FormData(document.createElement("form"),0),Hf=!1}catch{Hf=!0}return Hf}var pN=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function tv(i){return i!=null&&!pN.has(i)?(mi(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${dp}"`),null):i}function mN(i,t){let e,n,s,a,l;if(cN(i)){let c=i.getAttribute("action");n=c?Dr(c,t):null,e=i.getAttribute("method")||hp,s=tv(i.getAttribute("enctype"))||dp,a=new FormData(i)}else if(lN(i)||uN(i)&&(i.type==="submit"||i.type==="image")){let c=i.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=i.getAttribute("formaction")||c.getAttribute("action");if(n=h?Dr(h,t):null,e=i.getAttribute("formmethod")||c.getAttribute("method")||hp,s=tv(i.getAttribute("formenctype"))||tv(c.getAttribute("enctype"))||dp,a=new FormData(c,i),!fN()){let{name:d,type:p,value:m}=i;if(p==="image"){let v=d?`${d}.`:"";a.append(`${v}x`,"0"),a.append(`${v}y`,"0")}else d&&a.append(d,m)}}else{if(mm(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=hp,n=null,s=dp,l=i}return a&&s==="text/plain"&&(l=a,a=void 0),{action:n,method:e.toLowerCase(),encType:s,formData:a,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function r0(i,t){if(i===!1||i===null||typeof i>"u")throw new Error(t)}function gN(i,t,e,n){let s=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return e?s.pathname.endsWith("/")?s.pathname=`${s.pathname}_.${n}`:s.pathname=`${s.pathname}.${n}`:s.pathname==="/"?s.pathname=`_root.${n}`:t&&Dr(s.pathname,t)==="/"?s.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${n}`,s}async function yN(i,t){if(i.id in t)return t[i.id];try{let e=await import(i.module);return t[i.id]=e,e}catch(e){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function vN(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function _N(i,t,e){let n=await Promise.all(i.map(async s=>{let a=t.routes[s.route.id];if(a){let l=await yN(a,e);return l.links?l.links():[]}return[]}));return wN(n.flat(1).filter(vN).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function kT(i,t,e,n,s,a){let l=(h,d)=>e[d]?h.route.id!==e[d].route.id:!0,c=(h,d)=>e[d].pathname!==h.pathname||e[d].route.path?.endsWith("*")&&e[d].params["*"]!==h.params["*"];return a==="assets"?t.filter((h,d)=>l(h,d)||c(h,d)):a==="data"?t.filter((h,d)=>{let p=n.routes[h.route.id];if(!p||!p.hasLoader)return!1;if(l(h,d)||c(h,d))return!0;if(h.route.shouldRevalidate){let m=h.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(i,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function bN(i,t,{includeHydrateFallback:e}={}){return AN(i.map(n=>{let s=t.routes[n.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),e&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function AN(i){return[...new Set(i)]}function EN(i){let t={},e=Object.keys(i).sort();for(let n of e)t[n]=i[n];return t}function wN(i,t){let e=new Set;return new Set(t),i.reduce((n,s)=>{let a=JSON.stringify(EN(s));return e.has(a)||(e.add(a),n.push({key:a,link:s})),n},[])}function vx(){let i=z.useContext(Sc);return r0(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function TN(){let i=z.useContext(pm);return r0(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var a0=z.createContext(void 0);a0.displayName="FrameworkContext";function _x(){let i=z.useContext(a0);return r0(i,"You must render this element inside a <HydratedRouter> element"),i}function SN(i,t){let e=z.useContext(a0),[n,s]=z.useState(!1),[a,l]=z.useState(!1),{onFocus:c,onBlur:h,onMouseEnter:d,onMouseLeave:p,onTouchStart:m}=t,v=z.useRef(null);z.useEffect(()=>{if(i==="render"&&l(!0),i==="viewport"){let E=C=>{C.forEach(R=>{l(R.isIntersecting)})},S=new IntersectionObserver(E,{threshold:.5});return v.current&&S.observe(v.current),()=>{S.disconnect()}}},[i]),z.useEffect(()=>{if(n){let E=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(E)}}},[n]);let b=()=>{s(!0)},w=()=>{s(!1),l(!1)};return e?i!=="intent"?[a,v,{}]:[a,v,{onFocus:Hu(c,b),onBlur:Hu(h,w),onMouseEnter:Hu(d,b),onMouseLeave:Hu(p,w),onTouchStart:Hu(m,b)}]:[!1,v,{}]}function Hu(i,t){return e=>{i&&i(e),e.defaultPrevented||t(e)}}function CN({page:i,...t}){let{router:e}=vx(),n=z.useMemo(()=>sx(e.routes,i,e.basename),[e.routes,i,e.basename]);return n?z.createElement(RN,{page:i,matches:n,...t}):null}function xN(i){let{manifest:t,routeModules:e}=_x(),[n,s]=z.useState([]);return z.useEffect(()=>{let a=!1;return _N(i,t,e).then(l=>{a||s(l)}),()=>{a=!0}},[i,t,e]),n}function RN({page:i,matches:t,...e}){let n=ja(),{future:s,manifest:a,routeModules:l}=_x(),{basename:c}=vx(),{loaderData:h,matches:d}=TN(),p=z.useMemo(()=>kT(i,t,d,a,n,"data"),[i,t,d,a,n]),m=z.useMemo(()=>kT(i,t,d,a,n,"assets"),[i,t,d,a,n]),v=z.useMemo(()=>{if(i===n.pathname+n.search+n.hash)return[];let E=new Set,S=!1;if(t.forEach(R=>{let I=a.routes[R.route.id];!I||!I.hasLoader||(!p.some(B=>B.route.id===R.route.id)&&R.route.id in h&&l[R.route.id]?.shouldRevalidate||I.hasClientLoader?S=!0:E.add(R.route.id))}),E.size===0)return[];let C=gN(i,c,s.unstable_trailingSlashAwareDataRequests,"data");return S&&E.size>0&&C.searchParams.set("_routes",t.filter(R=>E.has(R.route.id)).map(R=>R.route.id).join(",")),[C.pathname+C.search]},[c,s.unstable_trailingSlashAwareDataRequests,h,n,a,p,t,i,l]),b=z.useMemo(()=>bN(m,a),[m,a]),w=xN(m);return z.createElement(z.Fragment,null,v.map(E=>z.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...e})),b.map(E=>z.createElement("link",{key:E,rel:"modulepreload",href:E,...e})),w.map(({key:E,link:S})=>z.createElement("link",{key:E,nonce:e.nonce,...S})))}function IN(...i){return t=>{i.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var DN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{DN&&(window.__reactRouterVersion="7.12.0")}catch{}function PN({basename:i,children:t,unstable_useTransitions:e,window:n}){let s=z.useRef();s.current==null&&(s.current=ck({window:n,v5Compat:!0}));let a=s.current,[l,c]=z.useState({action:a.action,location:a.location}),h=z.useCallback(d=>{e===!1?c(d):z.startTransition(()=>c(d))},[e]);return z.useLayoutEffect(()=>a.listen(h),[a,h]),z.createElement(aN,{basename:i,children:t,location:l.location,navigationType:l.action,navigator:a,unstable_useTransitions:e})}var bx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wa=z.forwardRef(function({onClick:t,discover:e="render",prefetch:n="none",relative:s,reloadDocument:a,replace:l,state:c,target:h,to:d,preventScrollReset:p,viewTransition:m,unstable_defaultShouldRevalidate:v,...b},w){let{basename:E,unstable_useTransitions:S}=z.useContext(gi),C=typeof d=="string"&&bx.test(d),R=cx(d,E);d=R.to;let I=Hk(d,{relative:s}),[B,F,j]=SN(n,b),P=ON(d,{replace:l,state:c,target:h,preventScrollReset:p,relative:s,viewTransition:m,unstable_defaultShouldRevalidate:v,unstable_useTransitions:S});function D(V){t&&t(V),V.defaultPrevented||P(V)}let M=z.createElement("a",{...b,...j,href:R.absoluteURL||I,onClick:R.isExternal||a?t:D,ref:IN(w,F),target:h,"data-discover":!C&&e==="render"?"true":void 0});return B&&!C?z.createElement(z.Fragment,null,M,z.createElement(CN,{page:I})):M});wa.displayName="Link";var MN=z.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:n="",end:s=!1,style:a,to:l,viewTransition:c,children:h,...d},p){let m=Hh(l,{relative:d.relative}),v=ja(),b=z.useContext(pm),{navigator:w,basename:E}=z.useContext(gi),S=b!=null&&UN(m)&&c===!0,C=w.encodeLocation?w.encodeLocation(m).pathname:m.pathname,R=v.pathname,I=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;e||(R=R.toLowerCase(),I=I?I.toLowerCase():null,C=C.toLowerCase()),I&&E&&(I=Dr(I,E)||I);const B=C!=="/"&&C.endsWith("/")?C.length-1:C.length;let F=R===C||!s&&R.startsWith(C)&&R.charAt(B)==="/",j=I!=null&&(I===C||!s&&I.startsWith(C)&&I.charAt(C.length)==="/"),P={isActive:F,isPending:j,isTransitioning:S},D=F?t:void 0,M;typeof n=="function"?M=n(P):M=[n,F?"active":null,j?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let V=typeof a=="function"?a(P):a;return z.createElement(wa,{...d,"aria-current":D,className:M,ref:p,style:V,to:l,viewTransition:c},typeof h=="function"?h(P):h)});MN.displayName="NavLink";var kN=z.forwardRef(({discover:i="render",fetcherKey:t,navigate:e,reloadDocument:n,replace:s,state:a,method:l=hp,action:c,onSubmit:h,relative:d,preventScrollReset:p,viewTransition:m,unstable_defaultShouldRevalidate:v,...b},w)=>{let{unstable_useTransitions:E}=z.useContext(gi),S=BN(),C=FN(c,{relative:d}),R=l.toLowerCase()==="get"?"get":"post",I=typeof c=="string"&&bx.test(c),B=F=>{if(h&&h(F),F.defaultPrevented)return;F.preventDefault();let j=F.nativeEvent.submitter,P=j?.getAttribute("formmethod")||l,D=()=>S(j||F.currentTarget,{fetcherKey:t,method:P,navigate:e,replace:s,state:a,relative:d,preventScrollReset:p,viewTransition:m,unstable_defaultShouldRevalidate:v});E&&e!==!1?z.startTransition(()=>D()):D()};return z.createElement("form",{ref:w,method:R,action:C,onSubmit:n?h:B,...b,"data-discover":!I&&i==="render"?"true":void 0})});kN.displayName="Form";function NN(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ax(i){let t=z.useContext(Sc);return Ce(t,NN(i)),t}function ON(i,{target:t,replace:e,state:n,preventScrollReset:s,relative:a,viewTransition:l,unstable_defaultShouldRevalidate:c,unstable_useTransitions:h}={}){let d=zh(),p=ja(),m=Hh(i,{relative:a});return z.useCallback(v=>{if(dN(v,t)){v.preventDefault();let b=e!==void 0?e:bh(p)===bh(m),w=()=>d(i,{replace:b,state:n,preventScrollReset:s,relative:a,viewTransition:l,unstable_defaultShouldRevalidate:c});h?z.startTransition(()=>w()):w()}},[p,d,m,e,n,t,i,s,a,l,c,h])}var LN=0,VN=()=>`__${String(++LN)}__`;function BN(){let{router:i}=Ax("useSubmit"),{basename:t}=z.useContext(gi),e=eN(),n=i.fetch,s=i.navigate;return z.useCallback(async(a,l={})=>{let{action:c,method:h,encType:d,formData:p,body:m}=mN(a,t);if(l.navigate===!1){let v=l.fetcherKey||VN();await n(v,e,l.action||c,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:p,body:m,formMethod:l.method||h,formEncType:l.encType||d,flushSync:l.flushSync})}else await s(l.action||c,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:p,body:m,formMethod:l.method||h,formEncType:l.encType||d,replace:l.replace,state:l.state,fromRouteId:e,flushSync:l.flushSync,viewTransition:l.viewTransition})},[n,s,t,e])}function FN(i,{relative:t}={}){let{basename:e}=z.useContext(gi),n=z.useContext(cs);Ce(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),a={...Hh(i||".",{relative:t})},l=ja();if(i==null){a.search=l.search;let c=new URLSearchParams(a.search),h=c.getAll("index");if(h.some(p=>p==="")){c.delete("index"),h.filter(m=>m).forEach(m=>c.append("index",m));let p=c.toString();a.search=p?`?${p}`:""}}return(!i||i===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(a.pathname=a.pathname==="/"?e:Sr([e,a.pathname])),bh(a)}function UN(i,{relative:t}={}){let e=z.useContext(hx);Ce(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Ax("useViewTransitionState"),s=Hh(i,{relative:t});if(!e.isTransitioning)return!1;let a=Dr(e.currentLocation.pathname,n)||e.currentLocation.pathname,l=Dr(e.nextLocation.pathname,n)||e.nextLocation.pathname;return Mp(s.pathname,l)!=null||Mp(s.pathname,a)!=null}const jN=()=>{};var NT={};const Ex=function(i){const t=[];let e=0;for(let n=0;n<i.length;n++){let s=i.charCodeAt(n);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=s&63|128):(s&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(i.charCodeAt(++n)&1023),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=s&63|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=s&63|128)}return t},zN=function(i){const t=[];let e=0,n=0;for(;e<i.length;){const s=i[e++];if(s<128)t[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=i[e++];t[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=i[e++],l=i[e++],c=i[e++],h=((s&7)<<18|(a&63)<<12|(l&63)<<6|c&63)-65536;t[n++]=String.fromCharCode(55296+(h>>10)),t[n++]=String.fromCharCode(56320+(h&1023))}else{const a=i[e++],l=i[e++];t[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|l&63)}}return t.join("")},wx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,t){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<i.length;s+=3){const a=i[s],l=s+1<i.length,c=l?i[s+1]:0,h=s+2<i.length,d=h?i[s+2]:0,p=a>>2,m=(a&3)<<4|c>>4;let v=(c&15)<<2|d>>6,b=d&63;h||(b=64,l||(v=64)),n.push(e[p],e[m],e[v],e[b])}return n.join("")},encodeString(i,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(i):this.encodeByteArray(Ex(i),t)},decodeString(i,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(i):zN(this.decodeStringToByteArray(i,t))},decodeStringToByteArray(i,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<i.length;){const a=e[i.charAt(s++)],c=s<i.length?e[i.charAt(s)]:0;++s;const d=s<i.length?e[i.charAt(s)]:64;++s;const m=s<i.length?e[i.charAt(s)]:64;if(++s,a==null||c==null||d==null||m==null)throw new HN;const v=a<<2|c>>4;if(n.push(v),d!==64){const b=c<<4&240|d>>2;if(n.push(b),m!==64){const w=d<<6&192|m;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class HN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qN=function(i){const t=Ex(i);return wx.encodeByteArray(t,!0)},kp=function(i){return qN(i).replace(/\./g,"")},Tx=function(i){try{return wx.decodeString(i,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function GN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const $N=()=>GN().__FIREBASE_DEFAULTS__,WN=()=>{if(typeof process>"u"||typeof NT>"u")return;const i=NT.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},KN=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=i&&Tx(i[1]);return t&&JSON.parse(t)},gm=()=>{try{return jN()||$N()||WN()||KN()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},Sx=i=>gm()?.emulatorHosts?.[i],Cx=i=>{const t=Sx(i);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),n]:[t.substring(0,e),n]},xx=()=>gm()?.config,Rx=i=>gm()?.[`_${i}`];class YN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,n))}}}function $o(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function o0(i){return(await fetch(i,{credentials:"include"})).ok}function Ix(i,t){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},n=t||"demo-project",s=i.iat||0,a=i.sub||i.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...i};return[kp(JSON.stringify(e)),kp(JSON.stringify(l)),""].join(".")}const lh={};function XN(){const i={prod:[],emulator:[]};for(const t of Object.keys(lh))lh[t]?i.emulator.push(t):i.prod.push(t);return i}function QN(i){let t=document.getElementById(i),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",i),e=!0),{created:e,element:t}}let OT=!1;function l0(i,t){if(typeof window>"u"||typeof document>"u"||!$o(window.location.host)||lh[i]===t||lh[i]||OT)return;lh[i]=t;function e(v){return`__firebase__banner__${v}`}const n="__firebase__banner",a=XN().prod.length>0;function l(){const v=document.getElementById(n);v&&v.remove()}function c(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function h(v,b){v.setAttribute("width","24"),v.setAttribute("id",b),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function d(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{OT=!0,l()},v}function p(v,b){v.setAttribute("id",b),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function m(){const v=QN(n),b=e("text"),w=document.getElementById(b)||document.createElement("span"),E=e("learnmore"),S=document.getElementById(E)||document.createElement("a"),C=e("preprendIcon"),R=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const I=v.element;c(I),p(S,E);const B=d();h(R,C),I.append(R,w,S,B),document.body.appendChild(I)}a?(w.innerText="Preview backend disconnected.",R.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(R.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function Nn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function JN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Nn())}function ZN(){const i=gm()?.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function tO(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function eO(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function nO(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function iO(){const i=Nn();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function sO(){return!ZN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function rO(){try{return typeof indexedDB=="object"}catch{return!1}}function aO(){return new Promise((i,t)=>{try{let e=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(n),i(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{t(s.error?.message||"")}}catch(e){t(e)}})}const oO="FirebaseError";class Xs extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name=oO,Object.setPrototypeOf(this,Xs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qh.prototype.create)}}class qh{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},s=`${this.service}/${t}`,a=this.errors[t],l=a?lO(a,n):"Error",c=`${this.serviceName}: ${l} (${s}).`;return new Xs(s,c,n)}}function lO(i,t){return i.replace(cO,(e,n)=>{const s=t[n];return s!=null?String(s):`<${n}?>`})}const cO=/\{\$([^}]+)}/g;function uO(i){for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t))return!1;return!0}function Vo(i,t){if(i===t)return!0;const e=Object.keys(i),n=Object.keys(t);for(const s of e){if(!n.includes(s))return!1;const a=i[s],l=t[s];if(LT(a)&&LT(l)){if(!Vo(a,l))return!1}else if(a!==l)return!1}for(const s of n)if(!e.includes(s))return!1;return!0}function LT(i){return i!==null&&typeof i=="object"}function Gh(i){const t=[];for(const[e,n]of Object.entries(i))Array.isArray(n)?n.forEach(s=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function Qu(i){const t={};return i.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,a]=n.split("=");t[decodeURIComponent(s)]=decodeURIComponent(a)}}),t}function Ju(i){const t=i.indexOf("?");if(!t)return"";const e=i.indexOf("#",t);return i.substring(t,e>0?e:void 0)}function hO(i,t){const e=new dO(i,t);return e.subscribe.bind(e)}class dO{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(n=>{this.error(n)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,n){let s;if(t===void 0&&e===void 0&&n===void 0)throw new Error("Missing Observer.");fO(t,["next","error","complete"])?s=t:s={next:t,error:e,complete:n},s.next===void 0&&(s.next=ev),s.error===void 0&&(s.error=ev),s.complete===void 0&&(s.complete=ev);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function fO(i,t){if(typeof i!="object"||i===null)return!1;for(const e of t)if(e in i&&typeof i[e]=="function")return!0;return!1}function ev(){}function qn(i){return i&&i._delegate?i._delegate:i}class Da{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const To="[DEFAULT]";class pO{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const n=new YN;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),n=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(gO(t))try{this.getOrInitializeService({instanceIdentifier:To})}catch{}for(const[e,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(t=To){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=To){return this.instances.has(t)}getOptions(t=To){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[a,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);n===c&&l.resolve(s)}return s}onInit(t,e){const n=this.normalizeInstanceIdentifier(e),s=this.onInitCallbacks.get(n)??new Set;s.add(t),this.onInitCallbacks.set(n,s);const a=this.instances.get(n);return a&&t(a,n),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const s of n)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:mO(t),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=To){return this.component?this.component.multipleInstances?t:To:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function mO(i){return i===To?void 0:i}function gO(i){return i.instantiationMode==="EAGER"}class yO{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new pO(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}var Gt;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(Gt||(Gt={}));const vO={debug:Gt.DEBUG,verbose:Gt.VERBOSE,info:Gt.INFO,warn:Gt.WARN,error:Gt.ERROR,silent:Gt.SILENT},_O=Gt.INFO,bO={[Gt.DEBUG]:"log",[Gt.VERBOSE]:"log",[Gt.INFO]:"info",[Gt.WARN]:"warn",[Gt.ERROR]:"error"},AO=(i,t,...e)=>{if(t<i.logLevel)return;const n=new Date().toISOString(),s=bO[t];if(s)console[s](`[${n}]  ${i.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class c0{constructor(t){this.name=t,this._logLevel=_O,this._logHandler=AO,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Gt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?vO[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Gt.DEBUG,...t),this._logHandler(this,Gt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Gt.VERBOSE,...t),this._logHandler(this,Gt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Gt.INFO,...t),this._logHandler(this,Gt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Gt.WARN,...t),this._logHandler(this,Gt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Gt.ERROR,...t),this._logHandler(this,Gt.ERROR,...t)}}const EO=(i,t)=>t.some(e=>i instanceof e);let VT,BT;function wO(){return VT||(VT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function TO(){return BT||(BT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Dx=new WeakMap,jv=new WeakMap,Px=new WeakMap,nv=new WeakMap,u0=new WeakMap;function SO(i){const t=new Promise((e,n)=>{const s=()=>{i.removeEventListener("success",a),i.removeEventListener("error",l)},a=()=>{e(Ca(i.result)),s()},l=()=>{n(i.error),s()};i.addEventListener("success",a),i.addEventListener("error",l)});return t.then(e=>{e instanceof IDBCursor&&Dx.set(e,i)}).catch(()=>{}),u0.set(t,i),t}function CO(i){if(jv.has(i))return;const t=new Promise((e,n)=>{const s=()=>{i.removeEventListener("complete",a),i.removeEventListener("error",l),i.removeEventListener("abort",l)},a=()=>{e(),s()},l=()=>{n(i.error||new DOMException("AbortError","AbortError")),s()};i.addEventListener("complete",a),i.addEventListener("error",l),i.addEventListener("abort",l)});jv.set(i,t)}let zv={get(i,t,e){if(i instanceof IDBTransaction){if(t==="done")return jv.get(i);if(t==="objectStoreNames")return i.objectStoreNames||Px.get(i);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Ca(i[t])},set(i,t,e){return i[t]=e,!0},has(i,t){return i instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in i}};function xO(i){zv=i(zv)}function RO(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const n=i.call(iv(this),t,...e);return Px.set(n,t.sort?t.sort():[t]),Ca(n)}:TO().includes(i)?function(...t){return i.apply(iv(this),t),Ca(Dx.get(this))}:function(...t){return Ca(i.apply(iv(this),t))}}function IO(i){return typeof i=="function"?RO(i):(i instanceof IDBTransaction&&CO(i),EO(i,wO())?new Proxy(i,zv):i)}function Ca(i){if(i instanceof IDBRequest)return SO(i);if(nv.has(i))return nv.get(i);const t=IO(i);return t!==i&&(nv.set(i,t),u0.set(t,i)),t}const iv=i=>u0.get(i);function DO(i,t,{blocked:e,upgrade:n,blocking:s,terminated:a}={}){const l=indexedDB.open(i,t),c=Ca(l);return n&&l.addEventListener("upgradeneeded",h=>{n(Ca(l.result),h.oldVersion,h.newVersion,Ca(l.transaction),h)}),e&&l.addEventListener("blocked",h=>e(h.oldVersion,h.newVersion,h)),c.then(h=>{a&&h.addEventListener("close",()=>a()),s&&h.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const PO=["get","getKey","getAll","getAllKeys","count"],MO=["put","add","delete","clear"],sv=new Map;function FT(i,t){if(!(i instanceof IDBDatabase&&!(t in i)&&typeof t=="string"))return;if(sv.get(t))return sv.get(t);const e=t.replace(/FromIndex$/,""),n=t!==e,s=MO.includes(e);if(!(e in(n?IDBIndex:IDBObjectStore).prototype)||!(s||PO.includes(e)))return;const a=async function(l,...c){const h=this.transaction(l,s?"readwrite":"readonly");let d=h.store;return n&&(d=d.index(c.shift())),(await Promise.all([d[e](...c),s&&h.done]))[0]};return sv.set(t,a),a}xO(i=>({...i,get:(t,e,n)=>FT(t,e)||i.get(t,e,n),has:(t,e)=>!!FT(t,e)||i.has(t,e)}));class kO{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(NO(e)){const n=e.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(e=>e).join(" ")}}function NO(i){return i.getComponent()?.type==="VERSION"}const Hv="@firebase/app",UT="0.14.7";const Pr=new c0("@firebase/app"),OO="@firebase/app-compat",LO="@firebase/analytics-compat",VO="@firebase/analytics",BO="@firebase/app-check-compat",FO="@firebase/app-check",UO="@firebase/auth",jO="@firebase/auth-compat",zO="@firebase/database",HO="@firebase/data-connect",qO="@firebase/database-compat",GO="@firebase/functions",$O="@firebase/functions-compat",WO="@firebase/installations",KO="@firebase/installations-compat",YO="@firebase/messaging",XO="@firebase/messaging-compat",QO="@firebase/performance",JO="@firebase/performance-compat",ZO="@firebase/remote-config",tL="@firebase/remote-config-compat",eL="@firebase/storage",nL="@firebase/storage-compat",iL="@firebase/firestore",sL="@firebase/ai",rL="@firebase/firestore-compat",aL="firebase",oL="12.8.0";const qv="[DEFAULT]",lL={[Hv]:"fire-core",[OO]:"fire-core-compat",[VO]:"fire-analytics",[LO]:"fire-analytics-compat",[FO]:"fire-app-check",[BO]:"fire-app-check-compat",[UO]:"fire-auth",[jO]:"fire-auth-compat",[zO]:"fire-rtdb",[HO]:"fire-data-connect",[qO]:"fire-rtdb-compat",[GO]:"fire-fn",[$O]:"fire-fn-compat",[WO]:"fire-iid",[KO]:"fire-iid-compat",[YO]:"fire-fcm",[XO]:"fire-fcm-compat",[QO]:"fire-perf",[JO]:"fire-perf-compat",[ZO]:"fire-rc",[tL]:"fire-rc-compat",[eL]:"fire-gcs",[nL]:"fire-gcs-compat",[iL]:"fire-fst",[rL]:"fire-fst-compat",[sL]:"fire-vertex","fire-js":"fire-js",[aL]:"fire-js-all"};const Np=new Map,cL=new Map,Gv=new Map;function jT(i,t){try{i.container.addComponent(t)}catch(e){Pr.debug(`Component ${t.name} failed to register with FirebaseApp ${i.name}`,e)}}function Bo(i){const t=i.name;if(Gv.has(t))return Pr.debug(`There were multiple attempts to register component ${t}.`),!1;Gv.set(t,i);for(const e of Np.values())jT(e,i);for(const e of cL.values())jT(e,i);return!0}function ym(i,t){const e=i.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),i.container.getProvider(t)}function ni(i){return i==null?!1:i.settings!==void 0}const uL={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xa=new qh("app","Firebase",uL);class hL{constructor(t,e,n){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Da("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw xa.create("app-deleted",{appName:this._name})}}const Wo=oL;function Mx(i,t={}){let e=i;typeof t!="object"&&(t={name:t});const n={name:qv,automaticDataCollectionEnabled:!0,...t},s=n.name;if(typeof s!="string"||!s)throw xa.create("bad-app-name",{appName:String(s)});if(e||(e=xx()),!e)throw xa.create("no-options");const a=Np.get(s);if(a){if(Vo(e,a.options)&&Vo(n,a.config))return a;throw xa.create("duplicate-app",{appName:s})}const l=new yO(s);for(const h of Gv.values())l.addComponent(h);const c=new hL(e,n,l);return Np.set(s,c),c}function h0(i=qv){const t=Np.get(i);if(!t&&i===qv&&xx())return Mx();if(!t)throw xa.create("no-app",{appName:i});return t}function Us(i,t,e){let n=lL[i]??i;e&&(n+=`-${e}`);const s=n.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const l=[`Unable to register library "${n}" with version "${t}":`];s&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Pr.warn(l.join(" "));return}Bo(new Da(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}const dL="firebase-heartbeat-database",fL=1,Ah="firebase-heartbeat-store";let rv=null;function kx(){return rv||(rv=DO(dL,fL,{upgrade:(i,t)=>{switch(t){case 0:try{i.createObjectStore(Ah)}catch(e){console.warn(e)}}}}).catch(i=>{throw xa.create("idb-open",{originalErrorMessage:i.message})})),rv}async function pL(i){try{const e=(await kx()).transaction(Ah),n=await e.objectStore(Ah).get(Nx(i));return await e.done,n}catch(t){if(t instanceof Xs)Pr.warn(t.message);else{const e=xa.create("idb-get",{originalErrorMessage:t?.message});Pr.warn(e.message)}}}async function zT(i,t){try{const n=(await kx()).transaction(Ah,"readwrite");await n.objectStore(Ah).put(t,Nx(i)),await n.done}catch(e){if(e instanceof Xs)Pr.warn(e.message);else{const n=xa.create("idb-set",{originalErrorMessage:e?.message});Pr.warn(n.message)}}}function Nx(i){return`${i.name}!${i.options.appId}`}const mL=1024,gL=30;class yL{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new _L(e),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=HT();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(s=>s.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:e}),this._heartbeatsCache.heartbeats.length>gL){const s=bL(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){Pr.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=HT(),{heartbeatsToSend:e,unsentEntries:n}=vL(this._heartbeatsCache.heartbeats),s=kp(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Pr.warn(t),""}}}function HT(){return new Date().toISOString().substring(0,10)}function vL(i,t=mL){const e=[];let n=i.slice();for(const s of i){const a=e.find(l=>l.agent===s.agent);if(a){if(a.dates.push(s.date),qT(e)>t){a.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),qT(e)>t){e.pop();break}n=n.slice(1)}return{heartbeatsToSend:e,unsentEntries:n}}class _L{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return rO()?aO().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await pL(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return zT(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return zT(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}else return}}function qT(i){return kp(JSON.stringify({version:2,heartbeats:i})).length}function bL(i){if(i.length===0)return-1;let t=0,e=i[0].date;for(let n=1;n<i.length;n++)i[n].date<e&&(e=i[n].date,t=n);return t}function AL(i){Bo(new Da("platform-logger",t=>new kO(t),"PRIVATE")),Bo(new Da("heartbeat",t=>new yL(t),"PRIVATE")),Us(Hv,UT,i),Us(Hv,UT,"esm2020"),Us("fire-js","")}AL("");var EL="firebase",wL="12.8.0";Us(EL,wL,"app");var GT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ra,Ox;(function(){var i;function t(P,D){function M(){}M.prototype=D.prototype,P.F=D.prototype,P.prototype=new M,P.prototype.constructor=P,P.D=function(V,O,G){for(var U=Array(arguments.length-2),gt=2;gt<arguments.length;gt++)U[gt-2]=arguments[gt];return D.prototype[O].apply(V,U)}}function e(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(n,e),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(P,D,M){M||(M=0);const V=Array(16);if(typeof D=="string")for(var O=0;O<16;++O)V[O]=D.charCodeAt(M++)|D.charCodeAt(M++)<<8|D.charCodeAt(M++)<<16|D.charCodeAt(M++)<<24;else for(O=0;O<16;++O)V[O]=D[M++]|D[M++]<<8|D[M++]<<16|D[M++]<<24;D=P.g[0],M=P.g[1],O=P.g[2];let G=P.g[3],U;U=D+(G^M&(O^G))+V[0]+3614090360&4294967295,D=M+(U<<7&4294967295|U>>>25),U=G+(O^D&(M^O))+V[1]+3905402710&4294967295,G=D+(U<<12&4294967295|U>>>20),U=O+(M^G&(D^M))+V[2]+606105819&4294967295,O=G+(U<<17&4294967295|U>>>15),U=M+(D^O&(G^D))+V[3]+3250441966&4294967295,M=O+(U<<22&4294967295|U>>>10),U=D+(G^M&(O^G))+V[4]+4118548399&4294967295,D=M+(U<<7&4294967295|U>>>25),U=G+(O^D&(M^O))+V[5]+1200080426&4294967295,G=D+(U<<12&4294967295|U>>>20),U=O+(M^G&(D^M))+V[6]+2821735955&4294967295,O=G+(U<<17&4294967295|U>>>15),U=M+(D^O&(G^D))+V[7]+4249261313&4294967295,M=O+(U<<22&4294967295|U>>>10),U=D+(G^M&(O^G))+V[8]+1770035416&4294967295,D=M+(U<<7&4294967295|U>>>25),U=G+(O^D&(M^O))+V[9]+2336552879&4294967295,G=D+(U<<12&4294967295|U>>>20),U=O+(M^G&(D^M))+V[10]+4294925233&4294967295,O=G+(U<<17&4294967295|U>>>15),U=M+(D^O&(G^D))+V[11]+2304563134&4294967295,M=O+(U<<22&4294967295|U>>>10),U=D+(G^M&(O^G))+V[12]+1804603682&4294967295,D=M+(U<<7&4294967295|U>>>25),U=G+(O^D&(M^O))+V[13]+4254626195&4294967295,G=D+(U<<12&4294967295|U>>>20),U=O+(M^G&(D^M))+V[14]+2792965006&4294967295,O=G+(U<<17&4294967295|U>>>15),U=M+(D^O&(G^D))+V[15]+1236535329&4294967295,M=O+(U<<22&4294967295|U>>>10),U=D+(O^G&(M^O))+V[1]+4129170786&4294967295,D=M+(U<<5&4294967295|U>>>27),U=G+(M^O&(D^M))+V[6]+3225465664&4294967295,G=D+(U<<9&4294967295|U>>>23),U=O+(D^M&(G^D))+V[11]+643717713&4294967295,O=G+(U<<14&4294967295|U>>>18),U=M+(G^D&(O^G))+V[0]+3921069994&4294967295,M=O+(U<<20&4294967295|U>>>12),U=D+(O^G&(M^O))+V[5]+3593408605&4294967295,D=M+(U<<5&4294967295|U>>>27),U=G+(M^O&(D^M))+V[10]+38016083&4294967295,G=D+(U<<9&4294967295|U>>>23),U=O+(D^M&(G^D))+V[15]+3634488961&4294967295,O=G+(U<<14&4294967295|U>>>18),U=M+(G^D&(O^G))+V[4]+3889429448&4294967295,M=O+(U<<20&4294967295|U>>>12),U=D+(O^G&(M^O))+V[9]+568446438&4294967295,D=M+(U<<5&4294967295|U>>>27),U=G+(M^O&(D^M))+V[14]+3275163606&4294967295,G=D+(U<<9&4294967295|U>>>23),U=O+(D^M&(G^D))+V[3]+4107603335&4294967295,O=G+(U<<14&4294967295|U>>>18),U=M+(G^D&(O^G))+V[8]+1163531501&4294967295,M=O+(U<<20&4294967295|U>>>12),U=D+(O^G&(M^O))+V[13]+2850285829&4294967295,D=M+(U<<5&4294967295|U>>>27),U=G+(M^O&(D^M))+V[2]+4243563512&4294967295,G=D+(U<<9&4294967295|U>>>23),U=O+(D^M&(G^D))+V[7]+1735328473&4294967295,O=G+(U<<14&4294967295|U>>>18),U=M+(G^D&(O^G))+V[12]+2368359562&4294967295,M=O+(U<<20&4294967295|U>>>12),U=D+(M^O^G)+V[5]+4294588738&4294967295,D=M+(U<<4&4294967295|U>>>28),U=G+(D^M^O)+V[8]+2272392833&4294967295,G=D+(U<<11&4294967295|U>>>21),U=O+(G^D^M)+V[11]+1839030562&4294967295,O=G+(U<<16&4294967295|U>>>16),U=M+(O^G^D)+V[14]+4259657740&4294967295,M=O+(U<<23&4294967295|U>>>9),U=D+(M^O^G)+V[1]+2763975236&4294967295,D=M+(U<<4&4294967295|U>>>28),U=G+(D^M^O)+V[4]+1272893353&4294967295,G=D+(U<<11&4294967295|U>>>21),U=O+(G^D^M)+V[7]+4139469664&4294967295,O=G+(U<<16&4294967295|U>>>16),U=M+(O^G^D)+V[10]+3200236656&4294967295,M=O+(U<<23&4294967295|U>>>9),U=D+(M^O^G)+V[13]+681279174&4294967295,D=M+(U<<4&4294967295|U>>>28),U=G+(D^M^O)+V[0]+3936430074&4294967295,G=D+(U<<11&4294967295|U>>>21),U=O+(G^D^M)+V[3]+3572445317&4294967295,O=G+(U<<16&4294967295|U>>>16),U=M+(O^G^D)+V[6]+76029189&4294967295,M=O+(U<<23&4294967295|U>>>9),U=D+(M^O^G)+V[9]+3654602809&4294967295,D=M+(U<<4&4294967295|U>>>28),U=G+(D^M^O)+V[12]+3873151461&4294967295,G=D+(U<<11&4294967295|U>>>21),U=O+(G^D^M)+V[15]+530742520&4294967295,O=G+(U<<16&4294967295|U>>>16),U=M+(O^G^D)+V[2]+3299628645&4294967295,M=O+(U<<23&4294967295|U>>>9),U=D+(O^(M|~G))+V[0]+4096336452&4294967295,D=M+(U<<6&4294967295|U>>>26),U=G+(M^(D|~O))+V[7]+1126891415&4294967295,G=D+(U<<10&4294967295|U>>>22),U=O+(D^(G|~M))+V[14]+2878612391&4294967295,O=G+(U<<15&4294967295|U>>>17),U=M+(G^(O|~D))+V[5]+4237533241&4294967295,M=O+(U<<21&4294967295|U>>>11),U=D+(O^(M|~G))+V[12]+1700485571&4294967295,D=M+(U<<6&4294967295|U>>>26),U=G+(M^(D|~O))+V[3]+2399980690&4294967295,G=D+(U<<10&4294967295|U>>>22),U=O+(D^(G|~M))+V[10]+4293915773&4294967295,O=G+(U<<15&4294967295|U>>>17),U=M+(G^(O|~D))+V[1]+2240044497&4294967295,M=O+(U<<21&4294967295|U>>>11),U=D+(O^(M|~G))+V[8]+1873313359&4294967295,D=M+(U<<6&4294967295|U>>>26),U=G+(M^(D|~O))+V[15]+4264355552&4294967295,G=D+(U<<10&4294967295|U>>>22),U=O+(D^(G|~M))+V[6]+2734768916&4294967295,O=G+(U<<15&4294967295|U>>>17),U=M+(G^(O|~D))+V[13]+1309151649&4294967295,M=O+(U<<21&4294967295|U>>>11),U=D+(O^(M|~G))+V[4]+4149444226&4294967295,D=M+(U<<6&4294967295|U>>>26),U=G+(M^(D|~O))+V[11]+3174756917&4294967295,G=D+(U<<10&4294967295|U>>>22),U=O+(D^(G|~M))+V[2]+718787259&4294967295,O=G+(U<<15&4294967295|U>>>17),U=M+(G^(O|~D))+V[9]+3951481745&4294967295,P.g[0]=P.g[0]+D&4294967295,P.g[1]=P.g[1]+(O+(U<<21&4294967295|U>>>11))&4294967295,P.g[2]=P.g[2]+O&4294967295,P.g[3]=P.g[3]+G&4294967295}n.prototype.v=function(P,D){D===void 0&&(D=P.length);const M=D-this.blockSize,V=this.C;let O=this.h,G=0;for(;G<D;){if(O==0)for(;G<=M;)s(this,P,G),G+=this.blockSize;if(typeof P=="string"){for(;G<D;)if(V[O++]=P.charCodeAt(G++),O==this.blockSize){s(this,V),O=0;break}}else for(;G<D;)if(V[O++]=P[G++],O==this.blockSize){s(this,V),O=0;break}}this.h=O,this.o+=D},n.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var D=1;D<P.length-8;++D)P[D]=0;D=this.o*8;for(var M=P.length-8;M<P.length;++M)P[M]=D&255,D/=256;for(this.v(P),P=Array(16),D=0,M=0;M<4;++M)for(let V=0;V<32;V+=8)P[D++]=this.g[M]>>>V&255;return P};function a(P,D){var M=c;return Object.prototype.hasOwnProperty.call(M,P)?M[P]:M[P]=D(P)}function l(P,D){this.h=D;const M=[];let V=!0;for(let O=P.length-1;O>=0;O--){const G=P[O]|0;V&&G==D||(M[O]=G,V=!1)}this.g=M}var c={};function h(P){return-128<=P&&P<128?a(P,function(D){return new l([D|0],D<0?-1:0)}):new l([P|0],P<0?-1:0)}function d(P){if(isNaN(P)||!isFinite(P))return m;if(P<0)return S(d(-P));const D=[];let M=1;for(let V=0;P>=M;V++)D[V]=P/M|0,M*=4294967296;return new l(D,0)}function p(P,D){if(P.length==0)throw Error("number format error: empty string");if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(P.charAt(0)=="-")return S(p(P.substring(1),D));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=d(Math.pow(D,8));let V=m;for(let G=0;G<P.length;G+=8){var O=Math.min(8,P.length-G);const U=parseInt(P.substring(G,G+O),D);O<8?(O=d(Math.pow(D,O)),V=V.j(O).add(d(U))):(V=V.j(M),V=V.add(d(U)))}return V}var m=h(0),v=h(1),b=h(16777216);i=l.prototype,i.m=function(){if(E(this))return-S(this).m();let P=0,D=1;for(let M=0;M<this.g.length;M++){const V=this.i(M);P+=(V>=0?V:4294967296+V)*D,D*=4294967296}return P},i.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(w(this))return"0";if(E(this))return"-"+S(this).toString(P);const D=d(Math.pow(P,6));var M=this;let V="";for(;;){const O=B(M,D).g;M=C(M,O.j(D));let G=((M.g.length>0?M.g[0]:M.h)>>>0).toString(P);if(M=O,w(M))return G+V;for(;G.length<6;)G="0"+G;V=G+V}},i.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function w(P){if(P.h!=0)return!1;for(let D=0;D<P.g.length;D++)if(P.g[D]!=0)return!1;return!0}function E(P){return P.h==-1}i.l=function(P){return P=C(this,P),E(P)?-1:w(P)?0:1};function S(P){const D=P.g.length,M=[];for(let V=0;V<D;V++)M[V]=~P.g[V];return new l(M,~P.h).add(v)}i.abs=function(){return E(this)?S(this):this},i.add=function(P){const D=Math.max(this.g.length,P.g.length),M=[];let V=0;for(let O=0;O<=D;O++){let G=V+(this.i(O)&65535)+(P.i(O)&65535),U=(G>>>16)+(this.i(O)>>>16)+(P.i(O)>>>16);V=U>>>16,G&=65535,U&=65535,M[O]=U<<16|G}return new l(M,M[M.length-1]&-2147483648?-1:0)};function C(P,D){return P.add(S(D))}i.j=function(P){if(w(this)||w(P))return m;if(E(this))return E(P)?S(this).j(S(P)):S(S(this).j(P));if(E(P))return S(this.j(S(P)));if(this.l(b)<0&&P.l(b)<0)return d(this.m()*P.m());const D=this.g.length+P.g.length,M=[];for(var V=0;V<2*D;V++)M[V]=0;for(V=0;V<this.g.length;V++)for(let O=0;O<P.g.length;O++){const G=this.i(V)>>>16,U=this.i(V)&65535,gt=P.i(O)>>>16,Pt=P.i(O)&65535;M[2*V+2*O]+=U*Pt,R(M,2*V+2*O),M[2*V+2*O+1]+=G*Pt,R(M,2*V+2*O+1),M[2*V+2*O+1]+=U*gt,R(M,2*V+2*O+1),M[2*V+2*O+2]+=G*gt,R(M,2*V+2*O+2)}for(P=0;P<D;P++)M[P]=M[2*P+1]<<16|M[2*P];for(P=D;P<2*D;P++)M[P]=0;return new l(M,0)};function R(P,D){for(;(P[D]&65535)!=P[D];)P[D+1]+=P[D]>>>16,P[D]&=65535,D++}function I(P,D){this.g=P,this.h=D}function B(P,D){if(w(D))throw Error("division by zero");if(w(P))return new I(m,m);if(E(P))return D=B(S(P),D),new I(S(D.g),S(D.h));if(E(D))return D=B(P,S(D)),new I(S(D.g),D.h);if(P.g.length>30){if(E(P)||E(D))throw Error("slowDivide_ only works with positive integers.");for(var M=v,V=D;V.l(P)<=0;)M=F(M),V=F(V);var O=j(M,1),G=j(V,1);for(V=j(V,2),M=j(M,2);!w(V);){var U=G.add(V);U.l(P)<=0&&(O=O.add(M),G=U),V=j(V,1),M=j(M,1)}return D=C(P,O.j(D)),new I(O,D)}for(O=m;P.l(D)>=0;){for(M=Math.max(1,Math.floor(P.m()/D.m())),V=Math.ceil(Math.log(M)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),G=d(M),U=G.j(D);E(U)||U.l(P)>0;)M-=V,G=d(M),U=G.j(D);w(G)&&(G=v),O=O.add(G),P=C(P,U)}return new I(O,P)}i.B=function(P){return B(this,P).h},i.and=function(P){const D=Math.max(this.g.length,P.g.length),M=[];for(let V=0;V<D;V++)M[V]=this.i(V)&P.i(V);return new l(M,this.h&P.h)},i.or=function(P){const D=Math.max(this.g.length,P.g.length),M=[];for(let V=0;V<D;V++)M[V]=this.i(V)|P.i(V);return new l(M,this.h|P.h)},i.xor=function(P){const D=Math.max(this.g.length,P.g.length),M=[];for(let V=0;V<D;V++)M[V]=this.i(V)^P.i(V);return new l(M,this.h^P.h)};function F(P){const D=P.g.length+1,M=[];for(let V=0;V<D;V++)M[V]=P.i(V)<<1|P.i(V-1)>>>31;return new l(M,P.h)}function j(P,D){const M=D>>5;D%=32;const V=P.g.length-M,O=[];for(let G=0;G<V;G++)O[G]=D>0?P.i(G+M)>>>D|P.i(G+M+1)<<32-D:P.i(G+M);return new l(O,P.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,Ox=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=d,l.fromString=p,Ra=l}).apply(typeof GT<"u"?GT:typeof self<"u"?self:typeof window<"u"?window:{});var qf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Lx,Zu,Vx,fp,$v,Bx,Fx,Ux;(function(){var i,t=Object.defineProperty;function e(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof qf=="object"&&qf];for(var A=0;A<g.length;++A){var x=g[A];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var n=e(this);function s(g,A){if(A)t:{var x=n;g=g.split(".");for(var N=0;N<g.length-1;N++){var X=g[N];if(!(X in x))break t;x=x[X]}g=g[g.length-1],N=x[g],A=A(N),A!=N&&A!=null&&t(x,g,{configurable:!0,writable:!0,value:A})}}s("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(g){return g||function(A){var x=[],N;for(N in A)Object.prototype.hasOwnProperty.call(A,N)&&x.push([N,A[N]]);return x}});var a=a||{},l=this||self;function c(g){var A=typeof g;return A=="object"&&g!=null||A=="function"}function h(g,A,x){return g.call.apply(g.bind,arguments)}function d(g,A,x){return d=h,d.apply(null,arguments)}function p(g,A){var x=Array.prototype.slice.call(arguments,1);return function(){var N=x.slice();return N.push.apply(N,arguments),g.apply(this,N)}}function m(g,A){function x(){}x.prototype=A.prototype,g.Z=A.prototype,g.prototype=new x,g.prototype.constructor=g,g.Ob=function(N,X,nt){for(var ht=Array(arguments.length-2),Bt=2;Bt<arguments.length;Bt++)ht[Bt-2]=arguments[Bt];return A.prototype[X].apply(N,ht)}}var v=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function b(g){const A=g.length;if(A>0){const x=Array(A);for(let N=0;N<A;N++)x[N]=g[N];return x}return[]}function w(g,A){for(let N=1;N<arguments.length;N++){const X=arguments[N];var x=typeof X;if(x=x!="object"?x:X?Array.isArray(X)?"array":x:"null",x=="array"||x=="object"&&typeof X.length=="number"){x=g.length||0;const nt=X.length||0;g.length=x+nt;for(let ht=0;ht<nt;ht++)g[x+ht]=X[ht]}else g.push(X)}}class E{constructor(A,x){this.i=A,this.j=x,this.h=0,this.g=null}get(){let A;return this.h>0?(this.h--,A=this.g,this.g=A.next,A.next=null):A=this.i(),A}}function S(g){l.setTimeout(()=>{throw g},0)}function C(){var g=P;let A=null;return g.g&&(A=g.g,g.g=g.g.next,g.g||(g.h=null),A.next=null),A}class R{constructor(){this.h=this.g=null}add(A,x){const N=I.get();N.set(A,x),this.h?this.h.next=N:this.g=N,this.h=N}}var I=new E(()=>new B,g=>g.reset());class B{constructor(){this.next=this.g=this.h=null}set(A,x){this.h=A,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let F,j=!1,P=new R,D=()=>{const g=Promise.resolve(void 0);F=()=>{g.then(M)}};function M(){for(var g;g=C();){try{g.h.call(g.g)}catch(x){S(x)}var A=I;A.j(g),A.h<100&&(A.h++,g.next=A.g,A.g=g)}j=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(g,A){this.type=g,this.g=this.target=A,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var G=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var g=!1,A=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const x=()=>{};l.addEventListener("test",x,A),l.removeEventListener("test",x,A)}catch{}return g})();function U(g){return/^[\s\xa0]*$/.test(g)}function gt(g,A){O.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,A)}m(gt,O),gt.prototype.init=function(g,A){const x=this.type=g.type,N=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=A,A=g.relatedTarget,A||(x=="mouseover"?A=g.fromElement:x=="mouseout"&&(A=g.toElement)),this.relatedTarget=A,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&gt.Z.h.call(this)},gt.prototype.h=function(){gt.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var Pt="closure_listenable_"+(Math.random()*1e6|0),W=0;function K(g,A,x,N,X){this.listener=g,this.proxy=null,this.src=A,this.type=x,this.capture=!!N,this.ha=X,this.key=++W,this.da=this.fa=!1}function tt(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function ut(g,A,x){for(const N in g)A.call(x,g[N],N,g)}function At(g,A){for(const x in g)A.call(void 0,g[x],x,g)}function H(g){const A={};for(const x in g)A[x]=g[x];return A}const et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ct(g,A){let x,N;for(let X=1;X<arguments.length;X++){N=arguments[X];for(x in N)g[x]=N[x];for(let nt=0;nt<et.length;nt++)x=et[nt],Object.prototype.hasOwnProperty.call(N,x)&&(g[x]=N[x])}}function dt(g){this.src=g,this.g={},this.h=0}dt.prototype.add=function(g,A,x,N,X){const nt=g.toString();g=this.g[nt],g||(g=this.g[nt]=[],this.h++);const ht=Tt(g,A,N,X);return ht>-1?(A=g[ht],x||(A.fa=!1)):(A=new K(A,this.src,nt,!!N,X),A.fa=x,g.push(A)),A};function Et(g,A){const x=A.type;if(x in g.g){var N=g.g[x],X=Array.prototype.indexOf.call(N,A,void 0),nt;(nt=X>=0)&&Array.prototype.splice.call(N,X,1),nt&&(tt(A),g.g[x].length==0&&(delete g.g[x],g.h--))}}function Tt(g,A,x,N){for(let X=0;X<g.length;++X){const nt=g[X];if(!nt.da&&nt.listener==A&&nt.capture==!!x&&nt.ha==N)return X}return-1}var wt="closure_lm_"+(Math.random()*1e6|0),ye={};function se(g,A,x,N,X){if(Array.isArray(A)){for(let nt=0;nt<A.length;nt++)se(g,A[nt],x,N,X);return null}return x=Fc(x),g&&g[Pt]?g.J(A,x,c(N)?!!N.capture:!1,X):Js(g,A,x,!1,N,X)}function Js(g,A,x,N,X,nt){if(!A)throw Error("Invalid event type");const ht=c(X)?!!X.capture:!!X;let Bt=$a(g);if(Bt||(g[wt]=Bt=new dt(g)),x=Bt.add(A,x,N,ht,nt),x.proxy)return x;if(N=us(),x.proxy=N,N.src=g,N.listener=x,g.addEventListener)G||(X=ht),X===void 0&&(X=!1),g.addEventListener(A.toString(),N,X);else if(g.attachEvent)g.attachEvent(yi(A.toString()),N);else if(g.addListener&&g.removeListener)g.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return x}function us(){function g(x){return A.call(g.src,g.listener,x)}const A=Vc;return g}function hs(g,A,x,N,X){if(Array.isArray(A))for(var nt=0;nt<A.length;nt++)hs(g,A[nt],x,N,X);else N=c(N)?!!N.capture:!!N,x=Fc(x),g&&g[Pt]?(g=g.i,nt=String(A).toString(),nt in g.g&&(A=g.g[nt],x=Tt(A,x,N,X),x>-1&&(tt(A[x]),Array.prototype.splice.call(A,x,1),A.length==0&&(delete g.g[nt],g.h--)))):g&&(g=$a(g))&&(A=g.g[A.toString()],g=-1,A&&(g=Tt(A,x,N,X)),(x=g>-1?A[g]:null)&&Zs(x))}function Zs(g){if(typeof g!="number"&&g&&!g.da){var A=g.src;if(A&&A[Pt])Et(A.i,g);else{var x=g.type,N=g.proxy;A.removeEventListener?A.removeEventListener(x,N,g.capture):A.detachEvent?A.detachEvent(yi(x),N):A.addListener&&A.removeListener&&A.removeListener(N),(x=$a(A))?(Et(x,g),x.h==0&&(x.src=null,A[wt]=null)):tt(g)}}}function yi(g){return g in ye?ye[g]:ye[g]="on"+g}function Vc(g,A){if(g.da)g=!0;else{A=new gt(A,this);const x=g.listener,N=g.ha||g.src;g.fa&&Zs(g),g=x.call(N,A)}return g}function $a(g){return g=g[wt],g instanceof dt?g:null}var Bc="__closure_events_fn_"+(Math.random()*1e9>>>0);function Fc(g){return typeof g=="function"?g:(g[Bc]||(g[Bc]=function(A){return g.handleEvent(A)}),g[Bc])}function je(){V.call(this),this.i=new dt(this),this.M=this,this.G=null}m(je,V),je.prototype[Pt]=!0,je.prototype.removeEventListener=function(g,A,x,N){hs(this,g,A,x,N)};function sn(g,A){var x,N=g.G;if(N)for(x=[];N;N=N.G)x.push(N);if(g=g.M,N=A.type||A,typeof A=="string")A=new O(A,g);else if(A instanceof O)A.target=A.target||g;else{var X=A;A=new O(N,g),ct(A,X)}X=!0;let nt,ht;if(x)for(ht=x.length-1;ht>=0;ht--)nt=A.g=x[ht],X=Vr(nt,N,!0,A)&&X;if(nt=A.g=g,X=Vr(nt,N,!0,A)&&X,X=Vr(nt,N,!1,A)&&X,x)for(ht=0;ht<x.length;ht++)nt=A.g=x[ht],X=Vr(nt,N,!1,A)&&X}je.prototype.N=function(){if(je.Z.N.call(this),this.i){var g=this.i;for(const A in g.g){const x=g.g[A];for(let N=0;N<x.length;N++)tt(x[N]);delete g.g[A],g.h--}}this.G=null},je.prototype.J=function(g,A,x,N){return this.i.add(String(g),A,!1,x,N)},je.prototype.K=function(g,A,x,N){return this.i.add(String(g),A,!0,x,N)};function Vr(g,A,x,N){if(A=g.i.g[String(A)],!A)return!0;A=A.concat();let X=!0;for(let nt=0;nt<A.length;++nt){const ht=A[nt];if(ht&&!ht.da&&ht.capture==x){const Bt=ht.listener,Le=ht.ha||ht.src;ht.fa&&Et(g.i,ht),X=Bt.call(Le,N)!==!1&&X}}return X&&!N.defaultPrevented}function Wm(g,A){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=d(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(A)>2147483647?-1:l.setTimeout(g,A||0)}function fd(g){g.g=Wm(()=>{g.g=null,g.i&&(g.i=!1,fd(g))},g.l);const A=g.h;g.h=null,g.m.apply(null,A)}class On extends V{constructor(A,x){super(),this.m=A,this.l=x,this.h=null,this.i=!1,this.g=null}j(A){this.h=arguments,this.g?this.i=!0:fd(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Wa(g){V.call(this),this.h=g,this.g={}}m(Wa,V);var Uc=[];function jc(g){ut(g.g,function(A,x){this.g.hasOwnProperty(x)&&Zs(A)},g),g.g={}}Wa.prototype.N=function(){Wa.Z.N.call(this),jc(this)},Wa.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Br=l.JSON.stringify,Km=l.JSON.parse,pd=class{stringify(g){return l.JSON.stringify(g,void 0)}parse(g){return l.JSON.parse(g,void 0)}};function md(){}function gd(){}var ji={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function yn(){O.call(this,"d")}m(yn,O);function vi(){O.call(this,"c")}m(vi,O);var Oe={},yd=null;function tl(){return yd=yd||new je}Oe.Ia="serverreachability";function vd(g){O.call(this,Oe.Ia,g)}m(vd,O);function ds(g){const A=tl();sn(A,new vd(A))}Oe.STAT_EVENT="statevent";function Ka(g,A){O.call(this,Oe.STAT_EVENT,g),this.stat=A}m(Ka,O);function ze(g){const A=tl();sn(A,new Ka(A,g))}Oe.Ja="timingevent";function fs(g,A){O.call(this,Oe.Ja,g),this.size=A}m(fs,O);function ps(g,A){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){g()},A)}function zi(){this.g=!0}zi.prototype.ua=function(){this.g=!1};function Ym(g,A,x,N,X,nt){g.info(function(){if(g.g)if(nt){var ht="",Bt=nt.split("&");for(let te=0;te<Bt.length;te++){var Le=Bt[te].split("=");if(Le.length>1){const Ee=Le[0];Le=Le[1];const Ei=Ee.split("_");ht=Ei.length>=2&&Ei[1]=="type"?ht+(Ee+"="+Le+"&"):ht+(Ee+"=redacted&")}}}else ht=null;else ht=nt;return"XMLHTTP REQ ("+N+") [attempt "+X+"]: "+A+`
`+x+`
`+ht})}function _d(g,A,x,N,X,nt,ht){g.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+X+"]: "+A+`
`+x+`
`+nt+" "+ht})}function ms(g,A,x,N){g.info(function(){return"XMLHTTP TEXT ("+A+"): "+Xm(g,x)+(N?" "+N:"")})}function Ya(g,A){g.info(function(){return"TIMEOUT: "+A})}zi.prototype.info=function(){};function Xm(g,A){if(!g.g)return A;if(!A)return null;try{const nt=JSON.parse(A);if(nt){for(g=0;g<nt.length;g++)if(Array.isArray(nt[g])){var x=nt[g];if(!(x.length<2)){var N=x[1];if(Array.isArray(N)&&!(N.length<1)){var X=N[0];if(X!="noop"&&X!="stop"&&X!="close")for(let ht=1;ht<N.length;ht++)N[ht]=""}}}}return Br(nt)}catch{return A}}var Xa={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},zc={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Hc;function Qa(){}m(Qa,md),Qa.prototype.g=function(){return new XMLHttpRequest},Hc=new Qa;function tr(g){return encodeURIComponent(String(g))}function bd(g){var A=1;g=g.split(":");const x=[];for(;A>0&&g.length;)x.push(g.shift()),A--;return g.length&&x.push(g.join(":")),x}function Hi(g,A,x,N){this.j=g,this.i=A,this.l=x,this.S=N||1,this.V=new Wa(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new qi}function qi(){this.i=null,this.g="",this.h=!1}var He={},hn={};function gs(g,A,x){g.M=1,g.A=Ja(Ge(A)),g.u=x,g.R=!0,el(g,null)}function el(g,A){g.F=Date.now(),ys(g),g.B=Ge(g.A);var x=g.B,N=g.S;Array.isArray(N)||(N=[String(N)]),rl(x.i,"t",N),g.C=0,x=g.j.L,g.h=new qi,g.g=Od(g.j,x?A:null,!g.u),g.P>0&&(g.O=new On(d(g.Y,g,g.g),g.P)),A=g.V,x=g.g,N=g.ba;var X="readystatechange";Array.isArray(X)||(X&&(Uc[0]=X.toString()),X=Uc);for(let nt=0;nt<X.length;nt++){const ht=se(x,X[nt],N||A.handleEvent,!1,A.h||A);if(!ht)break;A.g[ht.key]=ht}A=g.J?H(g.J):{},g.u?(g.v||(g.v="POST"),A["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,A)):(g.v="GET",g.g.ea(g.B,g.v,null,A)),ds(),Ym(g.i,g.v,g.B,g.l,g.S,g.u)}Hi.prototype.ba=function(g){g=g.target;const A=this.O;A&&Wi(g)==3?A.j():this.Y(g)},Hi.prototype.Y=function(g){try{if(g==this.g)t:{const Bt=Wi(this.g),Le=this.g.ya(),te=this.g.ca();if(!(Bt<3)&&(Bt!=3||this.g&&(this.h.h||this.g.la()||vn(this.g)))){this.K||Bt!=4||Le==7||(Le==8||te<=0?ds(3):ds(2)),vs(this);var A=this.g.ca();this.X=A;var x=Qm(this);if(this.o=A==200,_d(this.i,this.v,this.B,this.l,this.S,Bt,A),this.o){if(this.U&&!this.L){e:{if(this.g){var N,X=this.g;if((N=X.g?X.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(N)){var nt=N;break e}}nt=null}if(g=nt)ms(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,_s(this,g);else{this.o=!1,this.m=3,ze(12),ii(this),_i(this);break t}}if(this.R){g=!0;let Ee;for(;!this.K&&this.C<x.length;)if(Ee=Ed(this,x),Ee==hn){Bt==4&&(this.m=4,ze(14),g=!1),ms(this.i,this.l,null,"[Incomplete Response]");break}else if(Ee==He){this.m=4,ze(15),ms(this.i,this.l,x,"[Invalid Chunk]"),g=!1;break}else ms(this.i,this.l,Ee,null),_s(this,Ee);if(Ad(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Bt!=4||x.length!=0||this.h.h||(this.m=1,ze(16),g=!1),this.o=this.o&&g,!g)ms(this.i,this.l,x,"[Invalid Chunked Response]"),ii(this),_i(this);else if(x.length>0&&!this.W){this.W=!0;var ht=this.j;ht.g==this&&ht.aa&&!ht.P&&(ht.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),su(ht),ht.P=!0,ze(11))}}else ms(this.i,this.l,x,null),_s(this,x);Bt==4&&ii(this),this.o&&!this.K&&(Bt==4?Pd(this.j,this):(this.o=!1,ys(this)))}else nr(this.g),A==400&&x.indexOf("Unknown SID")>0?(this.m=3,ze(12)):(this.m=0,ze(13)),ii(this),_i(this)}}}catch{}};function Qm(g){if(!Ad(g))return g.g.la();const A=vn(g.g);if(A==="")return"";let x="";const N=A.length,X=Wi(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return ii(g),_i(g),"";g.h.i=new l.TextDecoder}for(let nt=0;nt<N;nt++)g.h.h=!0,x+=g.h.i.decode(A[nt],{stream:!(X&&nt==N-1)});return A.length=0,g.h.g+=x,g.C=0,g.h.g}function Ad(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function Ed(g,A){var x=g.C,N=A.indexOf(`
`,x);return N==-1?hn:(x=Number(A.substring(x,N)),isNaN(x)?He:(N+=1,N+x>A.length?hn:(A=A.slice(N,N+x),g.C=N+x,A)))}Hi.prototype.cancel=function(){this.K=!0,ii(this)};function ys(g){g.T=Date.now()+g.H,nl(g,g.H)}function nl(g,A){if(g.D!=null)throw Error("WatchDog timer not null");g.D=ps(d(g.aa,g),A)}function vs(g){g.D&&(l.clearTimeout(g.D),g.D=null)}Hi.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(Ya(this.i,this.B),this.M!=2&&(ds(),ze(17)),ii(this),this.m=2,_i(this)):nl(this,this.T-g)};function _i(g){g.j.I==0||g.K||Pd(g.j,g)}function ii(g){vs(g);var A=g.O;A&&typeof A.dispose=="function"&&A.dispose(),g.O=null,jc(g.V),g.g&&(A=g.g,g.g=null,A.abort(),A.dispose())}function _s(g,A){try{var x=g.j;if(x.I!=0&&(x.g==g||As(x.h,g))){if(!g.L&&As(x.h,g)&&x.I==3){try{var N=x.Ba.g.parse(A)}catch{N=null}if(Array.isArray(N)&&N.length==3){var X=N;if(X[0]==0){t:if(!x.v){if(x.g)if(x.g.F+3e3<g.F)ul(x),$r(x);else break t;ro(x),ze(18)}}else x.xa=X[1],0<x.xa-x.K&&X[2]<37500&&x.F&&x.A==0&&!x.C&&(x.C=ps(d(x.Va,x),6e3));bs(x.h)<=1&&x.ta&&(x.ta=void 0)}else xs(x,11)}else if((g.L||x.g==g)&&ul(x),!U(A))for(X=x.Ba.g.parse(A),A=0;A<X.length;A++){let te=X[A];const Ee=te[0];if(!(Ee<=x.K))if(x.K=Ee,te=te[1],x.I==2)if(te[0]=="c"){x.M=te[1],x.ba=te[2];const Ei=te[3];Ei!=null&&(x.ka=Ei,x.j.info("VER="+x.ka));const Rs=te[4];Rs!=null&&(x.za=Rs,x.j.info("SVER="+x.za));const Ki=te[5];Ki!=null&&typeof Ki=="number"&&Ki>0&&(N=1.5*Ki,x.O=N,x.j.info("backChannelRequestTimeoutMs_="+N)),N=x;const Yi=g.g;if(Yi){const ao=Yi.g?Yi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ao){var nt=N.h;nt.g||ao.indexOf("spdy")==-1&&ao.indexOf("quic")==-1&&ao.indexOf("h2")==-1||(nt.j=nt.l,nt.g=new Set,nt.h&&($c(nt,nt.h),nt.h=null))}if(N.G){const hl=Yi.g?Yi.g.getResponseHeader("X-HTTP-Session-Id"):null;hl&&(N.wa=hl,ae(N.J,N.G,hl))}}x.I=3,x.l&&x.l.ra(),x.aa&&(x.T=Date.now()-g.F,x.j.info("Handshake RTT: "+x.T+"ms")),N=x;var ht=g;if(N.na=Nd(N,N.L?N.ba:null,N.W),ht.L){Wc(N.h,ht);var Bt=ht,Le=N.O;Le&&(Bt.H=Le),Bt.D&&(vs(Bt),ys(Bt)),N.g=ht}else Id(N);x.i.length>0&&Cs(x)}else te[0]!="stop"&&te[0]!="close"||xs(x,7);else x.I==3&&(te[0]=="stop"||te[0]=="close"?te[0]=="stop"?xs(x,7):nu(x):te[0]!="noop"&&x.l&&x.l.qa(te),x.A=0)}}ds(4)}catch{}}var qe=class{constructor(g,A){this.g=g,this.map=A}};function qc(g){this.l=g||10,l.PerformanceNavigationTiming?(g=l.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Gc(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function bs(g){return g.h?1:g.g?g.g.size:0}function As(g,A){return g.h?g.h==A:g.g?g.g.has(A):!1}function $c(g,A){g.g?g.g.add(A):g.h=A}function Wc(g,A){g.h&&g.h==A?g.h=null:g.g&&g.g.has(A)&&g.g.delete(A)}qc.prototype.cancel=function(){if(this.i=Kc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function Kc(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let A=g.i;for(const x of g.g.values())A=A.concat(x.G);return A}return b(g.i)}var wd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function il(g,A){if(g){g=g.split("&");for(let x=0;x<g.length;x++){const N=g[x].indexOf("=");let X,nt=null;N>=0?(X=g[x].substring(0,N),nt=g[x].substring(N+1)):X=g[x],A(X,nt?decodeURIComponent(nt.replace(/\+/g," ")):"")}}}function si(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let A;g instanceof si?(this.l=g.l,dn(this,g.j),this.o=g.o,this.g=g.g,Fr(this,g.u),this.h=g.h,Yc(this,xd(g.i)),this.m=g.m):g&&(A=String(g).match(wd))?(this.l=!1,dn(this,A[1]||"",!0),this.o=Es(A[2]||""),this.g=Es(A[3]||"",!0),Fr(this,A[4]),this.h=Es(A[5]||"",!0),Yc(this,A[6]||"",!0),this.m=Es(A[7]||"")):(this.l=!1,this.i=new jr(null,this.l))}si.prototype.toString=function(){const g=[];var A=this.j;A&&g.push(Za(A,sl,!0),":");var x=this.g;return(x||A=="file")&&(g.push("//"),(A=this.o)&&g.push(Za(A,sl,!0),"@"),g.push(tr(x).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.u,x!=null&&g.push(":",String(x))),(x=this.h)&&(this.g&&x.charAt(0)!="/"&&g.push("/"),g.push(Za(x,x.charAt(0)=="/"?Xc:Td,!0))),(x=this.i.toString())&&g.push("?",x),(x=this.m)&&g.push("#",Za(x,Sd)),g.join("")},si.prototype.resolve=function(g){const A=Ge(this);let x=!!g.j;x?dn(A,g.j):x=!!g.o,x?A.o=g.o:x=!!g.g,x?A.g=g.g:x=g.u!=null;var N=g.h;if(x)Fr(A,g.u);else if(x=!!g.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var X=A.h.lastIndexOf("/");X!=-1&&(N=A.h.slice(0,X+1)+N)}if(X=N,X==".."||X==".")N="";else if(X.indexOf("./")!=-1||X.indexOf("/.")!=-1){N=X.lastIndexOf("/",0)==0,X=X.split("/");const nt=[];for(let ht=0;ht<X.length;){const Bt=X[ht++];Bt=="."?N&&ht==X.length&&nt.push(""):Bt==".."?((nt.length>1||nt.length==1&&nt[0]!="")&&nt.pop(),N&&ht==X.length&&nt.push("")):(nt.push(Bt),N=!0)}N=nt.join("/")}else N=X}return x?A.h=N:x=g.i.toString()!=="",x?Yc(A,xd(g.i)):x=!!g.m,x&&(A.m=g.m),A};function Ge(g){return new si(g)}function dn(g,A,x){g.j=x?Es(A,!0):A,g.j&&(g.j=g.j.replace(/:$/,""))}function Fr(g,A){if(A){if(A=Number(A),isNaN(A)||A<0)throw Error("Bad port number "+A);g.u=A}else g.u=null}function Yc(g,A,x){A instanceof jr?(g.i=A,al(g.i,g.l)):(x||(A=Za(A,Ur)),g.i=new jr(A,g.l))}function ae(g,A,x){g.i.set(A,x)}function Ja(g){return ae(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function Es(g,A){return g?A?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function Za(g,A,x){return typeof g=="string"?(g=encodeURI(g).replace(A,Gn),x&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Gn(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var sl=/[#\/\?@]/g,Td=/[#\?:]/g,Xc=/[#\?]/g,Ur=/[#\?@]/g,Sd=/#/g;function jr(g,A){this.h=this.g=null,this.i=g||null,this.j=!!A}function $n(g){g.g||(g.g=new Map,g.h=0,g.i&&il(g.i,function(A,x){g.add(decodeURIComponent(A.replace(/\+/g," ")),x)}))}i=jr.prototype,i.add=function(g,A){$n(this),this.i=null,g=zr(this,g);let x=this.g.get(g);return x||this.g.set(g,x=[]),x.push(A),this.h+=1,this};function Cd(g,A){$n(g),A=zr(g,A),g.g.has(A)&&(g.i=null,g.h-=g.g.get(A).length,g.g.delete(A))}function Qc(g,A){return $n(g),A=zr(g,A),g.g.has(A)}i.forEach=function(g,A){$n(this),this.g.forEach(function(x,N){x.forEach(function(X){g.call(A,X,N,this)},this)},this)};function Jc(g,A){$n(g);let x=[];if(typeof A=="string")Qc(g,A)&&(x=x.concat(g.g.get(zr(g,A))));else for(g=Array.from(g.g.values()),A=0;A<g.length;A++)x=x.concat(g[A]);return x}i.set=function(g,A){return $n(this),this.i=null,g=zr(this,g),Qc(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[A]),this.h+=1,this},i.get=function(g,A){return g?(g=Jc(this,g),g.length>0?String(g[0]):A):A};function rl(g,A,x){Cd(g,A),x.length>0&&(g.i=null,g.g.set(zr(g,A),b(x)),g.h+=x.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],A=Array.from(this.g.keys());for(let N=0;N<A.length;N++){var x=A[N];const X=tr(x);x=Jc(this,x);for(let nt=0;nt<x.length;nt++){let ht=X;x[nt]!==""&&(ht+="="+tr(x[nt])),g.push(ht)}}return this.i=g.join("&")};function xd(g){const A=new jr;return A.i=g.i,g.g&&(A.g=new Map(g.g),A.h=g.h),A}function zr(g,A){return A=String(A),g.j&&(A=A.toLowerCase()),A}function al(g,A){A&&!g.j&&($n(g),g.i=null,g.g.forEach(function(x,N){const X=N.toLowerCase();N!=X&&(Cd(this,N),rl(this,X,x))},g)),g.j=A}function Gi(g,A){const x=new zi;if(l.Image){const N=new Image;N.onload=p(bi,x,"TestLoadImage: loaded",!0,A,N),N.onerror=p(bi,x,"TestLoadImage: error",!1,A,N),N.onabort=p(bi,x,"TestLoadImage: abort",!1,A,N),N.ontimeout=p(bi,x,"TestLoadImage: timeout",!1,A,N),l.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=g}else A(!1)}function Zc(g,A){const x=new zi,N=new AbortController,X=setTimeout(()=>{N.abort(),bi(x,"TestPingServer: timeout",!1,A)},1e4);fetch(g,{signal:N.signal}).then(nt=>{clearTimeout(X),nt.ok?bi(x,"TestPingServer: ok",!0,A):bi(x,"TestPingServer: server error",!1,A)}).catch(()=>{clearTimeout(X),bi(x,"TestPingServer: error",!1,A)})}function bi(g,A,x,N,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),N(x)}catch{}}function Hr(){this.g=new pd}function ws(g){this.i=g.Sb||null,this.h=g.ab||!1}m(ws,md),ws.prototype.g=function(){return new to(this.i,this.h)};function to(g,A){je.call(this),this.H=g,this.o=A,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(to,je),i=to.prototype,i.open=function(g,A){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=A,this.readyState=1,$i(this)},i.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const A={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(A.body=g),(this.H||l).fetch(new Request(this.D,A)).then(this.Pa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,qr(this)),this.readyState=0},i.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,$i(this)),this.g&&(this.readyState=3,$i(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ol(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function ol(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}i.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var A=g.value?g.value:new Uint8Array(0);(A=this.B.decode(A,{stream:!g.done}))&&(this.response=this.responseText+=A)}g.done?qr(this):$i(this),this.readyState==3&&ol(this)}},i.Oa=function(g){this.g&&(this.response=this.responseText=g,qr(this))},i.Na=function(g){this.g&&(this.response=g,qr(this))},i.ga=function(){this.g&&qr(this)};function qr(g){g.readyState=4,g.l=null,g.j=null,g.B=null,$i(g)}i.setRequestHeader=function(g,A){this.A.append(g,A)},i.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],A=this.h.entries();for(var x=A.next();!x.done;)x=x.value,g.push(x[0]+": "+x[1]),x=A.next();return g.join(`\r
`)};function $i(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(to.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Ai(g){let A="";return ut(g,function(x,N){A+=N,A+=":",A+=x,A+=`\r
`}),A}function eo(g,A,x){t:{for(N in x){var N=!1;break t}N=!0}N||(x=Ai(x),typeof g=="string"?x!=null&&tr(x):ae(g,A,x))}function ce(g){je.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(ce,je);var Ts=/^https?$/i,tu=["POST","PUT"];i=ce.prototype,i.Fa=function(g){this.H=g},i.ea=function(g,A,x,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);A=A?A.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Hc.g(),this.g.onreadystatechange=v(d(this.Ca,this));try{this.B=!0,this.g.open(A,String(g),!0),this.B=!1}catch(nt){no(this,nt);return}if(g=x||"",x=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var X in N)x.set(X,N[X]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const nt of N.keys())x.set(nt,N.get(nt));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(x.keys()).find(nt=>nt.toLowerCase()=="content-type"),X=l.FormData&&g instanceof l.FormData,!(Array.prototype.indexOf.call(tu,A,void 0)>=0)||N||X||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[nt,ht]of x)this.g.setRequestHeader(nt,ht);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(nt){no(this,nt)}};function no(g,A){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=A,g.o=5,eu(g),er(g)}function eu(g){g.A||(g.A=!0,sn(g,"complete"),sn(g,"error"))}i.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,sn(this,"complete"),sn(this,"abort"),er(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),er(this,!0)),ce.Z.N.call(this)},i.Ca=function(){this.u||(this.B||this.v||this.j?io(this):this.Xa())},i.Xa=function(){io(this)};function io(g){if(g.h&&typeof a<"u"){if(g.v&&Wi(g)==4)setTimeout(g.Ca.bind(g),0);else if(sn(g,"readystatechange"),Wi(g)==4){g.h=!1;try{const nt=g.ca();t:switch(nt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var A=!0;break t;default:A=!1}var x;if(!(x=A)){var N;if(N=nt===0){let ht=String(g.D).match(wd)[1]||null;!ht&&l.self&&l.self.location&&(ht=l.self.location.protocol.slice(0,-1)),N=!Ts.test(ht?ht.toLowerCase():"")}x=N}if(x)sn(g,"complete"),sn(g,"success");else{g.o=6;try{var X=Wi(g)>2?g.g.statusText:""}catch{X=""}g.l=X+" ["+g.ca()+"]",eu(g)}}finally{er(g)}}}}function er(g,A){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const x=g.g;g.g=null,A||sn(g,"ready");try{x.onreadystatechange=null}catch{}}}i.isActive=function(){return!!this.g};function Wi(g){return g.g?g.g.readyState:0}i.ca=function(){try{return Wi(this)>2?this.g.status:-1}catch{return-1}},i.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.La=function(g){if(this.g){var A=this.g.responseText;return g&&A.indexOf(g)==0&&(A=A.substring(g.length)),Km(A)}};function vn(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function nr(g){const A={};g=(g.g&&Wi(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<g.length;N++){if(U(g[N]))continue;var x=bd(g[N]);const X=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const nt=A[X]||[];A[X]=nt,nt.push(x)}At(A,function(N){return N.join(", ")})}i.ya=function(){return this.o},i.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ss(g,A,x){return x&&x.internalChannelParams&&x.internalChannelParams[g]||A}function Gr(g){this.za=0,this.i=[],this.j=new zi,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ss("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ss("baseRetryDelayMs",5e3,g),this.Za=Ss("retryDelaySeedMs",1e4,g),this.Ta=Ss("forwardChannelMaxRetries",2,g),this.va=Ss("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new qc(g&&g.concurrentRequestLimit),this.Ba=new Hr,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}i=Gr.prototype,i.ka=8,i.I=1,i.connect=function(g,A,x,N){ze(0),this.W=g,this.H=A||{},x&&N!==void 0&&(this.H.OSID=x,this.H.OAID=N),this.F=this.X,this.J=Nd(this,null,this.W),Cs(this)};function nu(g){if(ll(g),g.I==3){var A=g.V++,x=Ge(g.J);if(ae(x,"SID",g.M),ae(x,"RID",A),ae(x,"TYPE","terminate"),so(g,x),A=new Hi(g,g.j,A),A.M=2,A.A=Ja(Ge(x)),x=!1,l.navigator&&l.navigator.sendBeacon)try{x=l.navigator.sendBeacon(A.A.toString(),"")}catch{}!x&&l.Image&&(new Image().src=A.A,x=!0),x||(A.g=Od(A.j,null),A.g.ea(A.A)),A.F=Date.now(),ys(A)}kd(g)}function $r(g){g.g&&(su(g),g.g.cancel(),g.g=null)}function ll(g){$r(g),g.v&&(l.clearTimeout(g.v),g.v=null),ul(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&l.clearTimeout(g.m),g.m=null)}function Cs(g){if(!Gc(g.h)&&!g.m){g.m=!0;var A=g.Ea;F||D(),j||(F(),j=!0),P.add(A,g),g.D=0}}function cl(g,A){return bs(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=A.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=ps(d(g.Ea,g,A),Md(g,g.D)),g.D++,!0)}i.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const X=new Hi(this,this.j,g);let nt=this.o;if(this.U&&(nt?(nt=H(nt),ct(nt,this.U)):nt=this.U),this.u!==null||this.R||(X.J=nt,nt=null),this.S)t:{for(var A=0,x=0;x<this.i.length;x++){e:{var N=this.i[x];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break e}N=void 0}if(N===void 0)break;if(A+=N,A>4096){A=x;break t}if(A===4096||x===this.i.length-1){A=x+1;break t}}A=1e3}else A=1e3;A=Rd(this,X,A),x=Ge(this.J),ae(x,"RID",g),ae(x,"CVER",22),this.G&&ae(x,"X-HTTP-Session-Id",this.G),so(this,x),nt&&(this.R?A="headers="+tr(Ai(nt))+"&"+A:this.u&&eo(x,this.u,nt)),$c(this.h,X),this.Ra&&ae(x,"TYPE","init"),this.S?(ae(x,"$req",A),ae(x,"SID","null"),X.U=!0,gs(X,x,null)):gs(X,x,A),this.I=2}}else this.I==3&&(g?iu(this,g):this.i.length==0||Gc(this.h)||iu(this))};function iu(g,A){var x;A?x=A.l:x=g.V++;const N=Ge(g.J);ae(N,"SID",g.M),ae(N,"RID",x),ae(N,"AID",g.K),so(g,N),g.u&&g.o&&eo(N,g.u,g.o),x=new Hi(g,g.j,x,g.D+1),g.u===null&&(x.J=g.o),A&&(g.i=A.G.concat(g.i)),A=Rd(g,x,1e3),x.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),$c(g.h,x),gs(x,N,A)}function so(g,A){g.H&&ut(g.H,function(x,N){ae(A,N,x)}),g.l&&ut({},function(x,N){ae(A,N,x)})}function Rd(g,A,x){x=Math.min(g.i.length,x);const N=g.l?d(g.l.Ka,g.l,g):null;t:{var X=g.i;let Bt=-1;for(;;){const Le=["count="+x];Bt==-1?x>0?(Bt=X[0].g,Le.push("ofs="+Bt)):Bt=0:Le.push("ofs="+Bt);let te=!0;for(let Ee=0;Ee<x;Ee++){var nt=X[Ee].g;const Ei=X[Ee].map;if(nt-=Bt,nt<0)Bt=Math.max(0,X[Ee].g-100),te=!1;else try{nt="req"+nt+"_"||"";try{var ht=Ei instanceof Map?Ei:Object.entries(Ei);for(const[Rs,Ki]of ht){let Yi=Ki;c(Ki)&&(Yi=Br(Ki)),Le.push(nt+Rs+"="+encodeURIComponent(Yi))}}catch(Rs){throw Le.push(nt+"type="+encodeURIComponent("_badmap")),Rs}}catch{N&&N(Ei)}}if(te){ht=Le.join("&");break t}}ht=void 0}return g=g.i.splice(0,x),A.G=g,ht}function Id(g){if(!g.g&&!g.v){g.Y=1;var A=g.Da;F||D(),j||(F(),j=!0),P.add(A,g),g.A=0}}function ro(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=ps(d(g.Da,g),Md(g,g.A)),g.A++,!0)}i.Da=function(){if(this.v=null,Dd(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=ps(d(this.Wa,this),g)}},i.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ze(10),$r(this),Dd(this))};function su(g){g.B!=null&&(l.clearTimeout(g.B),g.B=null)}function Dd(g){g.g=new Hi(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var A=Ge(g.na);ae(A,"RID","rpc"),ae(A,"SID",g.M),ae(A,"AID",g.K),ae(A,"CI",g.F?"0":"1"),!g.F&&g.ia&&ae(A,"TO",g.ia),ae(A,"TYPE","xmlhttp"),so(g,A),g.u&&g.o&&eo(A,g.u,g.o),g.O&&(g.g.H=g.O);var x=g.g;g=g.ba,x.M=1,x.A=Ja(Ge(A)),x.u=null,x.R=!0,el(x,g)}i.Va=function(){this.C!=null&&(this.C=null,$r(this),ro(this),ze(19))};function ul(g){g.C!=null&&(l.clearTimeout(g.C),g.C=null)}function Pd(g,A){var x=null;if(g.g==A){ul(g),su(g),g.g=null;var N=2}else if(As(g.h,A))x=A.G,Wc(g.h,A),N=1;else return;if(g.I!=0){if(A.o)if(N==1){x=A.u?A.u.length:0,A=Date.now()-A.F;var X=g.D;N=tl(),sn(N,new fs(N,x)),Cs(g)}else Id(g);else if(X=A.m,X==3||X==0&&A.X>0||!(N==1&&cl(g,A)||N==2&&ro(g)))switch(x&&x.length>0&&(A=g.h,A.i=A.i.concat(x)),X){case 1:xs(g,5);break;case 4:xs(g,10);break;case 3:xs(g,6);break;default:xs(g,2)}}}function Md(g,A){let x=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(x*=2),x*A}function xs(g,A){if(g.j.info("Error code "+A),A==2){var x=d(g.bb,g),N=g.Ua;const X=!N;N=new si(N||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||dn(N,"https"),Ja(N),X?Gi(N.toString(),x):Zc(N.toString(),x)}else ze(2);g.I=0,g.l&&g.l.pa(A),kd(g),ll(g)}i.bb=function(g){g?(this.j.info("Successfully pinged google.com"),ze(2)):(this.j.info("Failed to ping google.com"),ze(1))};function kd(g){if(g.I=0,g.ja=[],g.l){const A=Kc(g.h);(A.length!=0||g.i.length!=0)&&(w(g.ja,A),w(g.ja,g.i),g.h.i.length=0,b(g.i),g.i.length=0),g.l.oa()}}function Nd(g,A,x){var N=x instanceof si?Ge(x):new si(x);if(N.g!="")A&&(N.g=A+"."+N.g),Fr(N,N.u);else{var X=l.location;N=X.protocol,A=A?A+"."+X.hostname:X.hostname,X=+X.port;const nt=new si(null);N&&dn(nt,N),A&&(nt.g=A),X&&Fr(nt,X),x&&(nt.h=x),N=nt}return x=g.G,A=g.wa,x&&A&&ae(N,x,A),ae(N,"VER",g.ka),so(g,N),N}function Od(g,A,x){if(A&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return A=g.Aa&&!g.ma?new ce(new ws({ab:x})):new ce(g.ma),A.Fa(g.L),A}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ld(){}i=Ld.prototype,i.ra=function(){},i.qa=function(){},i.pa=function(){},i.oa=function(){},i.isActive=function(){return!0},i.Ka=function(){};function Wr(){}Wr.prototype.g=function(g,A){return new Ln(g,A)};function Ln(g,A){je.call(this),this.g=new Gr(A),this.l=g,this.h=A&&A.messageUrlParams||null,g=A&&A.messageHeaders||null,A&&A.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=A&&A.initMessageHeaders||null,A&&A.messageContentType&&(g?g["X-WebChannel-Content-Type"]=A.messageContentType:g={"X-WebChannel-Content-Type":A.messageContentType}),A&&A.sa&&(g?g["X-WebChannel-Client-Profile"]=A.sa:g={"X-WebChannel-Client-Profile":A.sa}),this.g.U=g,(g=A&&A.Qb)&&!U(g)&&(this.g.u=g),this.A=A&&A.supportsCrossDomainXhr||!1,this.v=A&&A.sendRawJson||!1,(A=A&&A.httpSessionIdParam)&&!U(A)&&(this.g.G=A,g=this.h,g!==null&&A in g&&(g=this.h,A in g&&delete g[A])),this.j=new ir(this)}m(Ln,je),Ln.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ln.prototype.close=function(){nu(this.g)},Ln.prototype.o=function(g){var A=this.g;if(typeof g=="string"){var x={};x.__data__=g,g=x}else this.v&&(x={},x.__data__=Br(g),g=x);A.i.push(new qe(A.Ya++,g)),A.I==3&&Cs(A)},Ln.prototype.N=function(){this.g.l=null,delete this.j,nu(this.g),delete this.g,Ln.Z.N.call(this)};function Vd(g){yn.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var A=g.__sm__;if(A){t:{for(const x in A){g=x;break t}g=void 0}(this.i=g)&&(g=this.i,A=A!==null&&g in A?A[g]:void 0),this.data=A}else this.data=g}m(Vd,yn);function Bd(){vi.call(this),this.status=1}m(Bd,vi);function ir(g){this.g=g}m(ir,Ld),ir.prototype.ra=function(){sn(this.g,"a")},ir.prototype.qa=function(g){sn(this.g,new Vd(g))},ir.prototype.pa=function(g){sn(this.g,new Bd)},ir.prototype.oa=function(){sn(this.g,"b")},Wr.prototype.createWebChannel=Wr.prototype.g,Ln.prototype.send=Ln.prototype.o,Ln.prototype.open=Ln.prototype.m,Ln.prototype.close=Ln.prototype.close,Ux=function(){return new Wr},Fx=function(){return tl()},Bx=Oe,$v={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Xa.NO_ERROR=0,Xa.TIMEOUT=8,Xa.HTTP_ERROR=6,fp=Xa,zc.COMPLETE="complete",Vx=zc,gd.EventType=ji,ji.OPEN="a",ji.CLOSE="b",ji.ERROR="c",ji.MESSAGE="d",je.prototype.listen=je.prototype.J,Zu=gd,ce.prototype.listenOnce=ce.prototype.K,ce.prototype.getLastError=ce.prototype.Ha,ce.prototype.getLastErrorCode=ce.prototype.ya,ce.prototype.getStatus=ce.prototype.ca,ce.prototype.getResponseJson=ce.prototype.La,ce.prototype.getResponseText=ce.prototype.la,ce.prototype.send=ce.prototype.ea,ce.prototype.setWithCredentials=ce.prototype.Fa,Lx=ce}).apply(typeof qf<"u"?qf:typeof self<"u"?self:typeof window<"u"?window:{});class Pn{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Pn.UNAUTHENTICATED=new Pn(null),Pn.GOOGLE_CREDENTIALS=new Pn("google-credentials-uid"),Pn.FIRST_PARTY=new Pn("first-party-uid"),Pn.MOCK_USER=new Pn("mock-user");let xc="12.8.0";function TL(i){xc=i}const Fo=new c0("@firebase/firestore");function Hl(){return Fo.logLevel}function mt(i,...t){if(Fo.logLevel<=Gt.DEBUG){const e=t.map(d0);Fo.debug(`Firestore (${xc}): ${i}`,...e)}}function Mr(i,...t){if(Fo.logLevel<=Gt.ERROR){const e=t.map(d0);Fo.error(`Firestore (${xc}): ${i}`,...e)}}function mc(i,...t){if(Fo.logLevel<=Gt.WARN){const e=t.map(d0);Fo.warn(`Firestore (${xc}): ${i}`,...e)}}function d0(i){if(typeof i=="string")return i;try{return(function(e){return JSON.stringify(e)})(i)}catch{return i}}function Dt(i,t,e){let n="Unexpected state";typeof t=="string"?n=t:e=t,jx(i,n,e)}function jx(i,t,e){let n=`FIRESTORE (${xc}) INTERNAL ASSERTION FAILED: ${t} (ID: ${i.toString(16)})`;if(e!==void 0)try{n+=" CONTEXT: "+JSON.stringify(e)}catch{n+=" CONTEXT: "+e}throw Mr(n),new Error(n)}function re(i,t,e,n){let s="Unexpected state";typeof e=="string"?s=e:n=e,i||jx(t,s,n)}function Lt(i,t){return i}const ot={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pt extends Xs{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Cr{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class zx{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class SL{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Pn.UNAUTHENTICATED)))}shutdown(){}}class CL{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class xL{constructor(t){this.t=t,this.currentUser=Pn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){re(this.o===void 0,42304);let n=this.i;const s=h=>this.i!==n?(n=this.i,e(h)):Promise.resolve();let a=new Cr;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Cr,t.enqueueRetryable((()=>s(this.currentUser)))};const l=()=>{const h=a;t.enqueueRetryable((async()=>{await h.promise,await s(this.currentUser)}))},c=h=>{mt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((h=>c(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?c(h):(mt("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Cr)}}),0),l()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((n=>this.i!==t?(mt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(re(typeof n.accessToken=="string",31837,{l:n}),new zx(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return re(t===null||typeof t=="string",2055,{h:t}),new Pn(t)}}class RL{constructor(t,e,n){this.P=t,this.T=e,this.I=n,this.type="FirstParty",this.user=Pn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const t=this.A();return t&&this.R.set("Authorization",t),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class IL{constructor(t,e,n){this.P=t,this.T=e,this.I=n}getToken(){return Promise.resolve(new RL(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(Pn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class $T{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class DL{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ni(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){re(this.o===void 0,3512);const n=a=>{a.error!=null&&mt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,mt("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?e(a.token):Promise.resolve()};this.o=a=>{t.enqueueRetryable((()=>n(a)))};const s=a=>{mt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>s(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):mt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new $T(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(re(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new $T(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function PL(i){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(i);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let n=0;n<i;n++)e[n]=Math.floor(256*Math.random());return e}class f0{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=PL(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<e&&(n+=t.charAt(s[a]%62))}return n}}function $t(i,t){return i<t?-1:i>t?1:0}function Wv(i,t){const e=Math.min(i.length,t.length);for(let n=0;n<e;n++){const s=i.charAt(n),a=t.charAt(n);if(s!==a)return av(s)===av(a)?$t(s,a):av(s)?1:-1}return $t(i.length,t.length)}const ML=55296,kL=57343;function av(i){const t=i.charCodeAt(0);return t>=ML&&t<=kL}function gc(i,t,e){return i.length===t.length&&i.every(((n,s)=>e(n,t[s])))}const WT="__name__";class Bs{constructor(t,e,n){e===void 0?e=0:e>t.length&&Dt(637,{offset:e,range:t.length}),n===void 0?n=t.length-e:n>t.length-e&&Dt(1746,{length:n,range:t.length-e}),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return Bs.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Bs?t.forEach((n=>{e.push(n)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const a=Bs.compareSegments(t.get(s),e.get(s));if(a!==0)return a}return $t(t.length,e.length)}static compareSegments(t,e){const n=Bs.isNumericId(t),s=Bs.isNumericId(e);return n&&!s?-1:!n&&s?1:n&&s?Bs.extractNumericId(t).compare(Bs.extractNumericId(e)):Wv(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Ra.fromString(t.substring(4,t.length-2))}}class ge extends Bs{construct(t,e,n){return new ge(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new pt(ot.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((s=>s.length>0)))}return new ge(e)}static emptyPath(){return new ge([])}}const NL=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xn extends Bs{construct(t,e,n){return new xn(t,e,n)}static isValidIdentifier(t){return NL.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xn.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===WT}static keyField(){return new xn([WT])}static fromServerFormat(t){const e=[];let n="",s=0;const a=()=>{if(n.length===0)throw new pt(ot.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let l=!1;for(;s<t.length;){const c=t[s];if(c==="\\"){if(s+1===t.length)throw new pt(ot.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const h=t[s+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new pt(ot.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=h,s+=2}else c==="`"?(l=!l,s++):c!=="."||l?(n+=c,s++):(a(),s++)}if(a(),l)throw new pt(ot.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new xn(e)}static emptyPath(){return new xn([])}}class xt{constructor(t){this.path=t}static fromPath(t){return new xt(ge.fromString(t))}static fromName(t){return new xt(ge.fromString(t).popFirst(5))}static empty(){return new xt(ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&ge.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return ge.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new xt(new ge(t.slice()))}}function Hx(i,t,e){if(!e)throw new pt(ot.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${t}.`)}function OL(i,t,e,n){if(t===!0&&n===!0)throw new pt(ot.INVALID_ARGUMENT,`${i} and ${e} cannot be used together.`)}function KT(i){if(!xt.isDocumentKey(i))throw new pt(ot.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function YT(i){if(xt.isDocumentKey(i))throw new pt(ot.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function qx(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function vm(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const t=(function(n){return n.constructor?n.constructor.name:null})(i);return t?`a custom ${t} object`:"an object"}}return typeof i=="function"?"a function":Dt(12329,{type:typeof i})}function kr(i,t){if("_delegate"in i&&(i=i._delegate),!(i instanceof t)){if(t.name===i.constructor.name)throw new pt(ot.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=vm(i);throw new pt(ot.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return i}function en(i,t){const e={typeString:i};return t&&(e.value=t),e}function $h(i,t){if(!qx(i))throw new pt(ot.INVALID_ARGUMENT,"JSON must be an object");let e;for(const n in t)if(t[n]){const s=t[n].typeString,a="value"in t[n]?{value:t[n].value}:void 0;if(!(n in i)){e=`JSON missing required field: '${n}'`;break}const l=i[n];if(s&&typeof l!==s){e=`JSON field '${n}' must be a ${s}.`;break}if(a!==void 0&&l!==a.value){e=`Expected '${n}' field to equal '${a.value}'`;break}}if(e)throw new pt(ot.INVALID_ARGUMENT,e);return!0}const XT=-62135596800,QT=1e6;class be{static now(){return be.fromMillis(Date.now())}static fromDate(t){return be.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor((t-1e3*e)*QT);return new be(e,n)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new pt(ot.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new pt(ot.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<XT)throw new pt(ot.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new pt(ot.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/QT}_compareTo(t){return this.seconds===t.seconds?$t(this.nanoseconds,t.nanoseconds):$t(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:be._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if($h(t,be._jsonSchema))return new be(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-XT;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}be._jsonSchemaVersion="firestore/timestamp/1.0",be._jsonSchema={type:en("string",be._jsonSchemaVersion),seconds:en("number"),nanoseconds:en("number")};class Mt{static fromTimestamp(t){return new Mt(t)}static min(){return new Mt(new be(0,0))}static max(){return new Mt(new be(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Eh=-1;function LL(i,t){const e=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,s=Mt.fromTimestamp(n===1e9?new be(e+1,0):new be(e,n));return new Pa(s,xt.empty(),t)}function VL(i){return new Pa(i.readTime,i.key,Eh)}class Pa{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new Pa(Mt.min(),xt.empty(),Eh)}static max(){return new Pa(Mt.max(),xt.empty(),Eh)}}function BL(i,t){let e=i.readTime.compareTo(t.readTime);return e!==0?e:(e=xt.comparator(i.documentKey,t.documentKey),e!==0?e:$t(i.largestBatchId,t.largestBatchId))}const FL="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class UL{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Rc(i){if(i.code!==ot.FAILED_PRECONDITION||i.message!==FL)throw i;mt("LocalStore","Unexpectedly lost primary lease")}class lt{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Dt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new lt(((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(t,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(e,a).next(n,s)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof lt?e:lt.resolve(e)}catch(e){return lt.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):lt.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):lt.reject(e)}static resolve(t){return new lt(((e,n)=>{e(t)}))}static reject(t){return new lt(((e,n)=>{n(t)}))}static waitFor(t){return new lt(((e,n)=>{let s=0,a=0,l=!1;t.forEach((c=>{++s,c.next((()=>{++a,l&&a===s&&e()}),(h=>n(h)))})),l=!0,a===s&&e()}))}static or(t){let e=lt.resolve(!1);for(const n of t)e=e.next((s=>s?lt.resolve(s):n()));return e}static forEach(t,e){const n=[];return t.forEach(((s,a)=>{n.push(e.call(this,s,a))})),this.waitFor(n)}static mapArray(t,e){return new lt(((n,s)=>{const a=t.length,l=new Array(a);let c=0;for(let h=0;h<a;h++){const d=h;e(t[d]).next((p=>{l[d]=p,++c,c===a&&n(l)}),(p=>s(p)))}}))}static doWhile(t,e){return new lt(((n,s)=>{const a=()=>{t()===!0?e().next((()=>{a()}),s):n()};a()}))}}function jL(i){const t=i.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function Ic(i){return i.name==="IndexedDbTransactionError"}class _m{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>e.writeSequenceNumber(n))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}_m.ce=-1;const p0=-1;function bm(i){return i==null}function Op(i){return i===0&&1/i==-1/0}function zL(i){return typeof i=="number"&&Number.isInteger(i)&&!Op(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}const Gx="";function HL(i){let t="";for(let e=0;e<i.length;e++)t.length>0&&(t=JT(t)),t=qL(i.get(e),t);return JT(t)}function qL(i,t){let e=t;const n=i.length;for(let s=0;s<n;s++){const a=i.charAt(s);switch(a){case"\0":e+="";break;case Gx:e+="";break;default:e+=a}}return e}function JT(i){return i+Gx+""}function ZT(i){let t=0;for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&t++;return t}function Ko(i,t){for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&t(e,i[e])}function $x(i){for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t))return!1;return!0}class De{constructor(t,e){this.comparator=t,this.root=e||Sn.EMPTY}insert(t,e){return new De(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Sn.BLACK,null,null))}remove(t){return new De(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Sn.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(n===0)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(t,n.key);if(s===0)return e+n.left.size;s<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Gf(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Gf(this.root,t,this.comparator,!1)}getReverseIterator(){return new Gf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Gf(this.root,t,this.comparator,!0)}}class Gf{constructor(t,e,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!t.isEmpty();)if(a=e?n(t.key,e):1,e&&s&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(a===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Sn{constructor(t,e,n,s,a){this.key=t,this.value=e,this.color=n??Sn.RED,this.left=s??Sn.EMPTY,this.right=a??Sn.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,s,a){return new Sn(t??this.key,e??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let s=this;const a=n(t,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(t,e,n),null):a===0?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Sn.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),e(t,s.key)===0){if(s.right.isEmpty())return Sn.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Dt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Dt(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw Dt(27949);return t+(this.isRed()?0:1)}}Sn.EMPTY=null,Sn.RED=!0,Sn.BLACK=!1;Sn.EMPTY=new class{constructor(){this.size=0}get key(){throw Dt(57766)}get value(){throw Dt(16141)}get color(){throw Dt(16727)}get left(){throw Dt(29726)}get right(){throw Dt(36894)}copy(t,e,n,s,a){return this}insert(t,e,n){return new Sn(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ln{constructor(t){this.comparator=t,this.data=new De(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let n;for(n=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new tS(this.data.getIterator())}getIteratorFrom(t){return new tS(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((n=>{e=e.add(n)})),e}isEqual(t){if(!(t instanceof ln)||this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new ln(this.comparator);return e.data=t,e}}class tS{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ns{constructor(t){this.fields=t,t.sort(xn.comparator)}static empty(){return new ns([])}unionWith(t){let e=new ln(xn.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new ns(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return gc(this.fields,t.fields,((e,n)=>e.isEqual(n)))}}class Wx extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Rn{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new Wx("Invalid base64 string: "+a):a}})(t);return new Rn(e)}static fromUint8Array(t){const e=(function(s){let a="";for(let l=0;l<s.length;++l)a+=String.fromCharCode(s[l]);return a})(t);return new Rn(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const n=new Uint8Array(e.length);for(let s=0;s<e.length;s++)n[s]=e.charCodeAt(s);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return $t(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Rn.EMPTY_BYTE_STRING=new Rn("");const GL=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ma(i){if(re(!!i,39018),typeof i=="string"){let t=0;const e=GL.exec(i);if(re(!!e,46558,{timestamp:i}),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:Ue(i.seconds),nanos:Ue(i.nanos)}}function Ue(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function ka(i){return typeof i=="string"?Rn.fromBase64String(i):Rn.fromUint8Array(i)}const Kx="server_timestamp",Yx="__type__",Xx="__previous_value__",Qx="__local_write_time__";function m0(i){return(i?.mapValue?.fields||{})[Yx]?.stringValue===Kx}function Am(i){const t=i.mapValue.fields[Xx];return m0(t)?Am(t):t}function wh(i){const t=Ma(i.mapValue.fields[Qx].timestampValue);return new be(t.seconds,t.nanos)}class $L{constructor(t,e,n,s,a,l,c,h,d,p,m){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=c,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=p,this.apiKey=m}}const Lp="(default)";class Th{constructor(t,e){this.projectId=t,this.database=e||Lp}static empty(){return new Th("","")}get isDefaultDatabase(){return this.database===Lp}isEqual(t){return t instanceof Th&&t.projectId===this.projectId&&t.database===this.database}}function WL(i,t){if(!Object.prototype.hasOwnProperty.apply(i.options,["projectId"]))throw new pt(ot.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Th(i.options.projectId,t)}const Jx="__type__",KL="__max__",$f={mapValue:{}},Zx="__vector__",Vp="value";function Na(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?m0(i)?4:XL(i)?9007199254740991:YL(i)?10:11:Dt(28295,{value:i})}function $s(i,t){if(i===t)return!0;const e=Na(i);if(e!==Na(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===t.booleanValue;case 4:return wh(i).isEqual(wh(t));case 3:return(function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const l=Ma(s.timestampValue),c=Ma(a.timestampValue);return l.seconds===c.seconds&&l.nanos===c.nanos})(i,t);case 5:return i.stringValue===t.stringValue;case 6:return(function(s,a){return ka(s.bytesValue).isEqual(ka(a.bytesValue))})(i,t);case 7:return i.referenceValue===t.referenceValue;case 8:return(function(s,a){return Ue(s.geoPointValue.latitude)===Ue(a.geoPointValue.latitude)&&Ue(s.geoPointValue.longitude)===Ue(a.geoPointValue.longitude)})(i,t);case 2:return(function(s,a){if("integerValue"in s&&"integerValue"in a)return Ue(s.integerValue)===Ue(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const l=Ue(s.doubleValue),c=Ue(a.doubleValue);return l===c?Op(l)===Op(c):isNaN(l)&&isNaN(c)}return!1})(i,t);case 9:return gc(i.arrayValue.values||[],t.arrayValue.values||[],$s);case 10:case 11:return(function(s,a){const l=s.mapValue.fields||{},c=a.mapValue.fields||{};if(ZT(l)!==ZT(c))return!1;for(const h in l)if(l.hasOwnProperty(h)&&(c[h]===void 0||!$s(l[h],c[h])))return!1;return!0})(i,t);default:return Dt(52216,{left:i})}}function Sh(i,t){return(i.values||[]).find((e=>$s(e,t)))!==void 0}function yc(i,t){if(i===t)return 0;const e=Na(i),n=Na(t);if(e!==n)return $t(e,n);switch(e){case 0:case 9007199254740991:return 0;case 1:return $t(i.booleanValue,t.booleanValue);case 2:return(function(a,l){const c=Ue(a.integerValue||a.doubleValue),h=Ue(l.integerValue||l.doubleValue);return c<h?-1:c>h?1:c===h?0:isNaN(c)?isNaN(h)?0:-1:1})(i,t);case 3:return eS(i.timestampValue,t.timestampValue);case 4:return eS(wh(i),wh(t));case 5:return Wv(i.stringValue,t.stringValue);case 6:return(function(a,l){const c=ka(a),h=ka(l);return c.compareTo(h)})(i.bytesValue,t.bytesValue);case 7:return(function(a,l){const c=a.split("/"),h=l.split("/");for(let d=0;d<c.length&&d<h.length;d++){const p=$t(c[d],h[d]);if(p!==0)return p}return $t(c.length,h.length)})(i.referenceValue,t.referenceValue);case 8:return(function(a,l){const c=$t(Ue(a.latitude),Ue(l.latitude));return c!==0?c:$t(Ue(a.longitude),Ue(l.longitude))})(i.geoPointValue,t.geoPointValue);case 9:return nS(i.arrayValue,t.arrayValue);case 10:return(function(a,l){const c=a.fields||{},h=l.fields||{},d=c[Vp]?.arrayValue,p=h[Vp]?.arrayValue,m=$t(d?.values?.length||0,p?.values?.length||0);return m!==0?m:nS(d,p)})(i.mapValue,t.mapValue);case 11:return(function(a,l){if(a===$f.mapValue&&l===$f.mapValue)return 0;if(a===$f.mapValue)return 1;if(l===$f.mapValue)return-1;const c=a.fields||{},h=Object.keys(c),d=l.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let m=0;m<h.length&&m<p.length;++m){const v=Wv(h[m],p[m]);if(v!==0)return v;const b=yc(c[h[m]],d[p[m]]);if(b!==0)return b}return $t(h.length,p.length)})(i.mapValue,t.mapValue);default:throw Dt(23264,{he:e})}}function eS(i,t){if(typeof i=="string"&&typeof t=="string"&&i.length===t.length)return $t(i,t);const e=Ma(i),n=Ma(t),s=$t(e.seconds,n.seconds);return s!==0?s:$t(e.nanos,n.nanos)}function nS(i,t){const e=i.values||[],n=t.values||[];for(let s=0;s<e.length&&s<n.length;++s){const a=yc(e[s],n[s]);if(a)return a}return $t(e.length,n.length)}function vc(i){return Kv(i)}function Kv(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?(function(e){const n=Ma(e);return`time(${n.seconds},${n.nanos})`})(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?(function(e){return ka(e).toBase64()})(i.bytesValue):"referenceValue"in i?(function(e){return xt.fromName(e).toString()})(i.referenceValue):"geoPointValue"in i?(function(e){return`geo(${e.latitude},${e.longitude})`})(i.geoPointValue):"arrayValue"in i?(function(e){let n="[",s=!0;for(const a of e.values||[])s?s=!1:n+=",",n+=Kv(a);return n+"]"})(i.arrayValue):"mapValue"in i?(function(e){const n=Object.keys(e.fields||{}).sort();let s="{",a=!0;for(const l of n)a?a=!1:s+=",",s+=`${l}:${Kv(e.fields[l])}`;return s+"}"})(i.mapValue):Dt(61005,{value:i})}function pp(i){switch(Na(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Am(i);return t?16+pp(t):16;case 5:return 2*i.stringValue.length;case 6:return ka(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((s,a)=>s+pp(a)),0)})(i.arrayValue);case 10:case 11:return(function(n){let s=0;return Ko(n.fields,((a,l)=>{s+=a.length+pp(l)})),s})(i.mapValue);default:throw Dt(13486,{value:i})}}function iS(i,t){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${t.path.canonicalString()}`}}function Yv(i){return!!i&&"integerValue"in i}function g0(i){return!!i&&"arrayValue"in i}function sS(i){return!!i&&"nullValue"in i}function rS(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function mp(i){return!!i&&"mapValue"in i}function YL(i){return(i?.mapValue?.fields||{})[Jx]?.stringValue===Zx}function ch(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const t={mapValue:{fields:{}}};return Ko(i.mapValue.fields,((e,n)=>t.mapValue.fields[e]=ch(n))),t}if(i.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(i.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=ch(i.arrayValue.values[e]);return t}return{...i}}function XL(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===KL}class Oi{constructor(t){this.value=t}static empty(){return new Oi({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!mp(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=ch(e)}setAll(t){let e=xn.emptyPath(),n={},s=[];t.forEach(((l,c)=>{if(!e.isImmediateParentOf(c)){const h=this.getFieldsMap(e);this.applyChanges(h,n,s),n={},s=[],e=c.popLast()}l?n[c.lastSegment()]=ch(l):s.push(c.lastSegment())}));const a=this.getFieldsMap(e);this.applyChanges(a,n,s)}delete(t){const e=this.field(t.popLast());mp(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return $s(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let s=e.mapValue.fields[t.get(n)];mp(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,n){Ko(e,((s,a)=>t[s]=a));for(const s of n)delete t[s]}clone(){return new Oi(ch(this.value))}}function tR(i){const t=[];return Ko(i.fields,((e,n)=>{const s=new xn([e]);if(mp(n)){const a=tR(n.mapValue).fields;if(a.length===0)t.push(s);else for(const l of a)t.push(s.child(l))}else t.push(s)})),new ns(t)}class Mn{constructor(t,e,n,s,a,l,c){this.key=t,this.documentType=e,this.version=n,this.readTime=s,this.createTime=a,this.data=l,this.documentState=c}static newInvalidDocument(t){return new Mn(t,0,Mt.min(),Mt.min(),Mt.min(),Oi.empty(),0)}static newFoundDocument(t,e,n,s){return new Mn(t,1,e,Mt.min(),n,s,0)}static newNoDocument(t,e){return new Mn(t,2,e,Mt.min(),Mt.min(),Oi.empty(),0)}static newUnknownDocument(t,e){return new Mn(t,3,e,Mt.min(),Mt.min(),Oi.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Mt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Oi.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Oi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Mt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Mn&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Mn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Bp{constructor(t,e){this.position=t,this.inclusive=e}}function aS(i,t,e){let n=0;for(let s=0;s<i.position.length;s++){const a=t[s],l=i.position[s];if(a.field.isKeyField()?n=xt.comparator(xt.fromName(l.referenceValue),e.key):n=yc(l,e.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function oS(i,t){if(i===null)return t===null;if(t===null||i.inclusive!==t.inclusive||i.position.length!==t.position.length)return!1;for(let e=0;e<i.position.length;e++)if(!$s(i.position[e],t.position[e]))return!1;return!0}class Fp{constructor(t,e="asc"){this.field=t,this.dir=e}}function QL(i,t){return i.dir===t.dir&&i.field.isEqual(t.field)}class eR{}class tn extends eR{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,n):new ZL(t,e,n):e==="array-contains"?new nV(t,n):e==="in"?new iV(t,n):e==="not-in"?new sV(t,n):e==="array-contains-any"?new rV(t,n):new tn(t,e,n)}static createKeyFieldInFilter(t,e,n){return e==="in"?new tV(t,n):new eV(t,n)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(yc(e,this.value)):e!==null&&Na(this.value)===Na(e)&&this.matchesComparison(yc(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Dt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ls extends eR{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new ls(t,e)}matches(t){return nR(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function nR(i){return i.op==="and"}function iR(i){return JL(i)&&nR(i)}function JL(i){for(const t of i.filters)if(t instanceof ls)return!1;return!0}function Xv(i){if(i instanceof tn)return i.field.canonicalString()+i.op.toString()+vc(i.value);if(iR(i))return i.filters.map((t=>Xv(t))).join(",");{const t=i.filters.map((e=>Xv(e))).join(",");return`${i.op}(${t})`}}function sR(i,t){return i instanceof tn?(function(n,s){return s instanceof tn&&n.op===s.op&&n.field.isEqual(s.field)&&$s(n.value,s.value)})(i,t):i instanceof ls?(function(n,s){return s instanceof ls&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce(((a,l,c)=>a&&sR(l,s.filters[c])),!0):!1})(i,t):void Dt(19439)}function rR(i){return i instanceof tn?(function(e){return`${e.field.canonicalString()} ${e.op} ${vc(e.value)}`})(i):i instanceof ls?(function(e){return e.op.toString()+" {"+e.getFilters().map(rR).join(" ,")+"}"})(i):"Filter"}class ZL extends tn{constructor(t,e,n){super(t,e,n),this.key=xt.fromName(n.referenceValue)}matches(t){const e=xt.comparator(t.key,this.key);return this.matchesComparison(e)}}class tV extends tn{constructor(t,e){super(t,"in",e),this.keys=aR("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class eV extends tn{constructor(t,e){super(t,"not-in",e),this.keys=aR("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function aR(i,t){return(t.arrayValue?.values||[]).map((e=>xt.fromName(e.referenceValue)))}class nV extends tn{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return g0(e)&&Sh(e.arrayValue,this.value)}}class iV extends tn{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Sh(this.value.arrayValue,e)}}class sV extends tn{constructor(t,e){super(t,"not-in",e)}matches(t){if(Sh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!Sh(this.value.arrayValue,e)}}class rV extends tn{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!g0(e)||!e.arrayValue.values)&&e.arrayValue.values.some((n=>Sh(this.value.arrayValue,n)))}}class aV{constructor(t,e=null,n=[],s=[],a=null,l=null,c=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=l,this.endAt=c,this.Te=null}}function lS(i,t=null,e=[],n=[],s=null,a=null,l=null){return new aV(i,t,e,n,s,a,l)}function y0(i){const t=Lt(i);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((n=>Xv(n))).join(","),e+="|ob:",e+=t.orderBy.map((n=>(function(a){return a.field.canonicalString()+a.dir})(n))).join(","),bm(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((n=>vc(n))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((n=>vc(n))).join(",")),t.Te=e}return t.Te}function v0(i,t){if(i.limit!==t.limit||i.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<i.orderBy.length;e++)if(!QL(i.orderBy[e],t.orderBy[e]))return!1;if(i.filters.length!==t.filters.length)return!1;for(let e=0;e<i.filters.length;e++)if(!sR(i.filters[e],t.filters[e]))return!1;return i.collectionGroup===t.collectionGroup&&!!i.path.isEqual(t.path)&&!!oS(i.startAt,t.startAt)&&oS(i.endAt,t.endAt)}function Qv(i){return xt.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}class Wh{constructor(t,e=null,n=[],s=[],a=null,l="F",c=null,h=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=l,this.startAt=c,this.endAt=h,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function oV(i,t,e,n,s,a,l,c){return new Wh(i,t,e,n,s,a,l,c)}function _0(i){return new Wh(i)}function cS(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function lV(i){return xt.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}function oR(i){return i.collectionGroup!==null}function uh(i){const t=Lt(i);if(t.Ie===null){t.Ie=[];const e=new Set;for(const a of t.explicitOrderBy)t.Ie.push(a),e.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(l){let c=new ln(xn.comparator);return l.filters.forEach((h=>{h.getFlattenedFilters().forEach((d=>{d.isInequality()&&(c=c.add(d.field))}))})),c})(t).forEach((a=>{e.has(a.canonicalString())||a.isKeyField()||t.Ie.push(new Fp(a,n))})),e.has(xn.keyField().canonicalString())||t.Ie.push(new Fp(xn.keyField(),n))}return t.Ie}function js(i){const t=Lt(i);return t.Ee||(t.Ee=cV(t,uh(i))),t.Ee}function cV(i,t){if(i.limitType==="F")return lS(i.path,i.collectionGroup,t,i.filters,i.limit,i.startAt,i.endAt);{t=t.map((s=>{const a=s.dir==="desc"?"asc":"desc";return new Fp(s.field,a)}));const e=i.endAt?new Bp(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new Bp(i.startAt.position,i.startAt.inclusive):null;return lS(i.path,i.collectionGroup,t,i.filters,i.limit,e,n)}}function Jv(i,t){const e=i.filters.concat([t]);return new Wh(i.path,i.collectionGroup,i.explicitOrderBy.slice(),e,i.limit,i.limitType,i.startAt,i.endAt)}function Zv(i,t,e){return new Wh(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),t,e,i.startAt,i.endAt)}function Em(i,t){return v0(js(i),js(t))&&i.limitType===t.limitType}function lR(i){return`${y0(js(i))}|lt:${i.limitType}`}function ql(i){return`Query(target=${(function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map((s=>rR(s))).join(", ")}]`),bm(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map((s=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(s))).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((s=>vc(s))).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((s=>vc(s))).join(",")),`Target(${n})`})(js(i))}; limitType=${i.limitType})`}function wm(i,t){return t.isFoundDocument()&&(function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):xt.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)})(i,t)&&(function(n,s){for(const a of uh(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0})(i,t)&&(function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0})(i,t)&&(function(n,s){return!(n.startAt&&!(function(l,c,h){const d=aS(l,c,h);return l.inclusive?d<=0:d<0})(n.startAt,uh(n),s)||n.endAt&&!(function(l,c,h){const d=aS(l,c,h);return l.inclusive?d>=0:d>0})(n.endAt,uh(n),s))})(i,t)}function uV(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function cR(i){return(t,e)=>{let n=!1;for(const s of uh(i)){const a=hV(s,t,e);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function hV(i,t,e){const n=i.field.isKeyField()?xt.comparator(t.key,e.key):(function(a,l,c){const h=l.data.field(a),d=c.data.field(a);return h!==null&&d!==null?yc(h,d):Dt(42886)})(i.field,t,e);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return Dt(19790,{direction:i.dir})}}class Yo{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,t))return a}}has(t){return this.get(t)!==void 0}set(t,e){const n=this.mapKeyFn(t),s=this.inner[n];if(s===void 0)return this.inner[n]=[[t,e]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],t))return void(s[a]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],t))return n.length===1?delete this.inner[e]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Ko(this.inner,((e,n)=>{for(const[s,a]of n)t(s,a)}))}isEmpty(){return $x(this.inner)}size(){return this.innerSize}}const dV=new De(xt.comparator);function Nr(){return dV}const uR=new De(xt.comparator);function th(...i){let t=uR;for(const e of i)t=t.insert(e.key,e);return t}function hR(i){let t=uR;return i.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Co(){return hh()}function dR(){return hh()}function hh(){return new Yo((i=>i.toString()),((i,t)=>i.isEqual(t)))}const fV=new De(xt.comparator),pV=new ln(xt.comparator);function Wt(...i){let t=pV;for(const e of i)t=t.add(e);return t}const mV=new ln($t);function gV(){return mV}function b0(i,t){if(i.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Op(t)?"-0":t}}function fR(i){return{integerValue:""+i}}function yV(i,t){return zL(t)?fR(t):b0(i,t)}class Tm{constructor(){this._=void 0}}function vV(i,t,e){return i instanceof Up?(function(s,a){const l={fields:{[Yx]:{stringValue:Kx},[Qx]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&m0(a)&&(a=Am(a)),a&&(l.fields[Xx]=a),{mapValue:l}})(e,t):i instanceof Ch?mR(i,t):i instanceof xh?gR(i,t):(function(s,a){const l=pR(s,a),c=uS(l)+uS(s.Ae);return Yv(l)&&Yv(s.Ae)?fR(c):b0(s.serializer,c)})(i,t)}function _V(i,t,e){return i instanceof Ch?mR(i,t):i instanceof xh?gR(i,t):e}function pR(i,t){return i instanceof jp?(function(n){return Yv(n)||(function(a){return!!a&&"doubleValue"in a})(n)})(t)?t:{integerValue:0}:null}class Up extends Tm{}class Ch extends Tm{constructor(t){super(),this.elements=t}}function mR(i,t){const e=yR(t);for(const n of i.elements)e.some((s=>$s(s,n)))||e.push(n);return{arrayValue:{values:e}}}class xh extends Tm{constructor(t){super(),this.elements=t}}function gR(i,t){let e=yR(t);for(const n of i.elements)e=e.filter((s=>!$s(s,n)));return{arrayValue:{values:e}}}class jp extends Tm{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function uS(i){return Ue(i.integerValue||i.doubleValue)}function yR(i){return g0(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}function bV(i,t){return i.field.isEqual(t.field)&&(function(n,s){return n instanceof Ch&&s instanceof Ch||n instanceof xh&&s instanceof xh?gc(n.elements,s.elements,$s):n instanceof jp&&s instanceof jp?$s(n.Ae,s.Ae):n instanceof Up&&s instanceof Up})(i.transform,t.transform)}class AV{constructor(t,e){this.version=t,this.transformResults=e}}class rs{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new rs}static exists(t){return new rs(void 0,t)}static updateTime(t){return new rs(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function gp(i,t){return i.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(i.updateTime):i.exists===void 0||i.exists===t.isFoundDocument()}class Sm{}function vR(i,t){if(!i.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return i.isNoDocument()?new A0(i.key,rs.none()):new Kh(i.key,i.data,rs.none());{const e=i.data,n=Oi.empty();let s=new ln(xn.comparator);for(let a of t.fields)if(!s.has(a)){let l=e.field(a);l===null&&a.length>1&&(a=a.popLast(),l=e.field(a)),l===null?n.delete(a):n.set(a,l),s=s.add(a)}return new Xo(i.key,n,new ns(s.toArray()),rs.none())}}function EV(i,t,e){i instanceof Kh?(function(s,a,l){const c=s.value.clone(),h=dS(s.fieldTransforms,a,l.transformResults);c.setAll(h),a.convertToFoundDocument(l.version,c).setHasCommittedMutations()})(i,t,e):i instanceof Xo?(function(s,a,l){if(!gp(s.precondition,a))return void a.convertToUnknownDocument(l.version);const c=dS(s.fieldTransforms,a,l.transformResults),h=a.data;h.setAll(_R(s)),h.setAll(c),a.convertToFoundDocument(l.version,h).setHasCommittedMutations()})(i,t,e):(function(s,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()})(0,t,e)}function dh(i,t,e,n){return i instanceof Kh?(function(a,l,c,h){if(!gp(a.precondition,l))return c;const d=a.value.clone(),p=fS(a.fieldTransforms,h,l);return d.setAll(p),l.convertToFoundDocument(l.version,d).setHasLocalMutations(),null})(i,t,e,n):i instanceof Xo?(function(a,l,c,h){if(!gp(a.precondition,l))return c;const d=fS(a.fieldTransforms,h,l),p=l.data;return p.setAll(_R(a)),p.setAll(d),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((m=>m.field)))})(i,t,e,n):(function(a,l,c){return gp(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):c})(i,t,e)}function wV(i,t){let e=null;for(const n of i.fieldTransforms){const s=t.data.field(n.field),a=pR(n.transform,s||null);a!=null&&(e===null&&(e=Oi.empty()),e.set(n.field,a))}return e||null}function hS(i,t){return i.type===t.type&&!!i.key.isEqual(t.key)&&!!i.precondition.isEqual(t.precondition)&&!!(function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&gc(n,s,((a,l)=>bV(a,l)))})(i.fieldTransforms,t.fieldTransforms)&&(i.type===0?i.value.isEqual(t.value):i.type!==1||i.data.isEqual(t.data)&&i.fieldMask.isEqual(t.fieldMask))}class Kh extends Sm{constructor(t,e,n,s=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Xo extends Sm{constructor(t,e,n,s,a=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function _R(i){const t=new Map;return i.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const n=i.data.field(e);t.set(e,n)}})),t}function dS(i,t,e){const n=new Map;re(i.length===e.length,32656,{Ve:e.length,de:i.length});for(let s=0;s<e.length;s++){const a=i[s],l=a.transform,c=t.data.field(a.field);n.set(a.field,_V(l,c,e[s]))}return n}function fS(i,t,e){const n=new Map;for(const s of i){const a=s.transform,l=e.data.field(s.field);n.set(s.field,vV(a,l,t))}return n}class A0 extends Sm{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class TV extends Sm{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class SV{constructor(t,e,n,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(t.key)&&EV(a,t,n[s])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=dh(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=dh(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=dR();return this.mutations.forEach((s=>{const a=t.get(s.key),l=a.overlayedDocument;let c=this.applyToLocalView(l,a.mutatedFields);c=e.has(s.key)?null:c;const h=vR(l,c);h!==null&&n.set(s.key,h),l.isValidDocument()||l.convertToNoDocument(Mt.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),Wt())}isEqual(t){return this.batchId===t.batchId&&gc(this.mutations,t.mutations,((e,n)=>hS(e,n)))&&gc(this.baseMutations,t.baseMutations,((e,n)=>hS(e,n)))}}class E0{constructor(t,e,n,s){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=s}static from(t,e,n){re(t.mutations.length===n.length,58842,{me:t.mutations.length,fe:n.length});let s=(function(){return fV})();const a=t.mutations;for(let l=0;l<a.length;l++)s=s.insert(a[l].key,n[l].version);return new E0(t,e,n,s)}}class CV{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class xV{constructor(t,e){this.count=t,this.unchangedNames=e}}var Je,Qt;function RV(i){switch(i){case ot.OK:return Dt(64938);case ot.CANCELLED:case ot.UNKNOWN:case ot.DEADLINE_EXCEEDED:case ot.RESOURCE_EXHAUSTED:case ot.INTERNAL:case ot.UNAVAILABLE:case ot.UNAUTHENTICATED:return!1;case ot.INVALID_ARGUMENT:case ot.NOT_FOUND:case ot.ALREADY_EXISTS:case ot.PERMISSION_DENIED:case ot.FAILED_PRECONDITION:case ot.ABORTED:case ot.OUT_OF_RANGE:case ot.UNIMPLEMENTED:case ot.DATA_LOSS:return!0;default:return Dt(15467,{code:i})}}function bR(i){if(i===void 0)return Mr("GRPC error has no .code"),ot.UNKNOWN;switch(i){case Je.OK:return ot.OK;case Je.CANCELLED:return ot.CANCELLED;case Je.UNKNOWN:return ot.UNKNOWN;case Je.DEADLINE_EXCEEDED:return ot.DEADLINE_EXCEEDED;case Je.RESOURCE_EXHAUSTED:return ot.RESOURCE_EXHAUSTED;case Je.INTERNAL:return ot.INTERNAL;case Je.UNAVAILABLE:return ot.UNAVAILABLE;case Je.UNAUTHENTICATED:return ot.UNAUTHENTICATED;case Je.INVALID_ARGUMENT:return ot.INVALID_ARGUMENT;case Je.NOT_FOUND:return ot.NOT_FOUND;case Je.ALREADY_EXISTS:return ot.ALREADY_EXISTS;case Je.PERMISSION_DENIED:return ot.PERMISSION_DENIED;case Je.FAILED_PRECONDITION:return ot.FAILED_PRECONDITION;case Je.ABORTED:return ot.ABORTED;case Je.OUT_OF_RANGE:return ot.OUT_OF_RANGE;case Je.UNIMPLEMENTED:return ot.UNIMPLEMENTED;case Je.DATA_LOSS:return ot.DATA_LOSS;default:return Dt(39323,{code:i})}}(Qt=Je||(Je={}))[Qt.OK=0]="OK",Qt[Qt.CANCELLED=1]="CANCELLED",Qt[Qt.UNKNOWN=2]="UNKNOWN",Qt[Qt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qt[Qt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qt[Qt.NOT_FOUND=5]="NOT_FOUND",Qt[Qt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qt[Qt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qt[Qt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qt[Qt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qt[Qt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qt[Qt.ABORTED=10]="ABORTED",Qt[Qt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qt[Qt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qt[Qt.INTERNAL=13]="INTERNAL",Qt[Qt.UNAVAILABLE=14]="UNAVAILABLE",Qt[Qt.DATA_LOSS=15]="DATA_LOSS";function IV(){return new TextEncoder}const DV=new Ra([4294967295,4294967295],0);function pS(i){const t=IV().encode(i),e=new Ox;return e.update(t),new Uint8Array(e.digest())}function mS(i){const t=new DataView(i.buffer),e=t.getUint32(0,!0),n=t.getUint32(4,!0),s=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new Ra([e,n],0),new Ra([s,a],0)]}class w0{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new eh(`Invalid padding: ${e}`);if(n<0)throw new eh(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new eh(`Invalid hash count: ${n}`);if(t.length===0&&e!==0)throw new eh(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=Ra.fromNumber(this.ge)}ye(t,e,n){let s=t.add(e.multiply(Ra.fromNumber(n)));return s.compare(DV)===1&&(s=new Ra([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=pS(t),[n,s]=mS(e);for(let a=0;a<this.hashCount;a++){const l=this.ye(n,s,a);if(!this.we(l))return!1}return!0}static create(t,e,n){const s=t%8==0?0:8-t%8,a=new Uint8Array(Math.ceil(t/8)),l=new w0(a,s,e);return n.forEach((c=>l.insert(c))),l}insert(t){if(this.ge===0)return;const e=pS(t),[n,s]=mS(e);for(let a=0;a<this.hashCount;a++){const l=this.ye(n,s,a);this.be(l)}}be(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class eh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Cm{constructor(t,e,n,s,a){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const s=new Map;return s.set(t,Yh.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new Cm(Mt.min(),s,new De($t),Nr(),Wt())}}class Yh{constructor(t,e,n,s,a){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new Yh(n,e,Wt(),Wt(),Wt())}}class yp{constructor(t,e,n,s){this.Se=t,this.removedTargetIds=e,this.key=n,this.De=s}}class AR{constructor(t,e){this.targetId=t,this.Ce=e}}class ER{constructor(t,e,n=Rn.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=s}}class gS{constructor(){this.ve=0,this.Fe=yS(),this.Me=Rn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=Wt(),e=Wt(),n=Wt();return this.Fe.forEach(((s,a)=>{switch(a){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:n=n.add(s);break;default:Dt(38017,{changeType:a})}})),new Yh(this.Me,this.xe,t,e,n)}Ke(){this.Oe=!1,this.Fe=yS()}qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}Ue(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}$e(){this.ve+=1}We(){this.ve-=1,re(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class PV{constructor(t){this.Ge=t,this.ze=new Map,this.je=Nr(),this.He=Wf(),this.Je=Wf(),this.Ze=new De($t)}Xe(t){for(const e of t.Se)t.De&&t.De.isFoundDocument()?this.Ye(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,(e=>{const n=this.nt(e);switch(t.state){case 0:this.rt(e)&&n.Le(t.resumeToken);break;case 1:n.We(),n.Ne||n.Ke(),n.Le(t.resumeToken);break;case 2:n.We(),n.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(n.Qe(),n.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),n.Le(t.resumeToken));break;default:Dt(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach(((n,s)=>{this.rt(s)&&e(s)}))}st(t){const e=t.targetId,n=t.Ce.count,s=this.ot(e);if(s){const a=s.target;if(Qv(a))if(n===0){const l=new xt(a.path);this.et(e,l,Mn.newNoDocument(l,Mt.min()))}else re(n===1,20013,{expectedCount:n});else{const l=this._t(e);if(l!==n){const c=this.ut(t),h=c?this.ct(c,t,l):1;if(h!==0){this.it(e);const d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(e,d)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=e;let l,c;try{l=ka(n).toUint8Array()}catch(h){if(h instanceof Wx)return mc("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{c=new w0(l,s,a)}catch(h){return mc(h instanceof eh?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return c.ge===0?null:c}ct(t,e,n){return e.Ce.count===n-this.Pt(t,e.targetId)?0:2}Pt(t,e){const n=this.Ge.getRemoteKeysForTarget(e);let s=0;return n.forEach((a=>{const l=this.Ge.ht(),c=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;t.mightContain(c)||(this.et(e,a,null),s++)})),s}Tt(t){const e=new Map;this.ze.forEach(((a,l)=>{const c=this.ot(l);if(c){if(a.current&&Qv(c.target)){const h=new xt(c.target.path);this.It(h).has(l)||this.Et(l,h)||this.et(l,h,Mn.newNoDocument(h,t))}a.Be&&(e.set(l,a.ke()),a.Ke())}}));let n=Wt();this.Je.forEach(((a,l)=>{let c=!0;l.forEachWhile((h=>{const d=this.ot(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(n=n.add(a))})),this.je.forEach(((a,l)=>l.setReadTime(t)));const s=new Cm(t,e,this.Ze,this.je,n);return this.je=Nr(),this.He=Wf(),this.Je=Wf(),this.Ze=new De($t),s}Ye(t,e){if(!this.rt(t))return;const n=this.Et(t,e.key)?2:0;this.nt(t).qe(e.key,n),this.je=this.je.insert(e.key,e),this.He=this.He.insert(e.key,this.It(e.key).add(t)),this.Je=this.Je.insert(e.key,this.Rt(e.key).add(t))}et(t,e,n){if(!this.rt(t))return;const s=this.nt(t);this.Et(t,e)?s.qe(e,1):s.Ue(e),this.Je=this.Je.insert(e,this.Rt(e).delete(t)),this.Je=this.Je.insert(e,this.Rt(e).add(t)),n&&(this.je=this.je.insert(e,n))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}$e(t){this.nt(t).$e()}nt(t){let e=this.ze.get(t);return e||(e=new gS,this.ze.set(t,e)),e}Rt(t){let e=this.Je.get(t);return e||(e=new ln($t),this.Je=this.Je.insert(t,e)),e}It(t){let e=this.He.get(t);return e||(e=new ln($t),this.He=this.He.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||mt("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new gS),this.Ge.getRemoteKeysForTarget(t).forEach((e=>{this.et(t,e,null)}))}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function Wf(){return new De(xt.comparator)}function yS(){return new De(xt.comparator)}const MV={asc:"ASCENDING",desc:"DESCENDING"},kV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},NV={and:"AND",or:"OR"};class OV{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function t_(i,t){return i.useProto3Json||bm(t)?t:{value:t}}function zp(i,t){return i.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function wR(i,t){return i.useProto3Json?t.toBase64():t.toUint8Array()}function LV(i,t){return zp(i,t.toTimestamp())}function zs(i){return re(!!i,49232),Mt.fromTimestamp((function(e){const n=Ma(e);return new be(n.seconds,n.nanos)})(i))}function T0(i,t){return e_(i,t).canonicalString()}function e_(i,t){const e=(function(s){return new ge(["projects",s.projectId,"databases",s.database])})(i).child("documents");return t===void 0?e:e.child(t)}function TR(i){const t=ge.fromString(i);return re(IR(t),10190,{key:t.toString()}),t}function n_(i,t){return T0(i.databaseId,t.path)}function ov(i,t){const e=TR(t);if(e.get(1)!==i.databaseId.projectId)throw new pt(ot.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+i.databaseId.projectId);if(e.get(3)!==i.databaseId.database)throw new pt(ot.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+i.databaseId.database);return new xt(CR(e))}function SR(i,t){return T0(i.databaseId,t)}function VV(i){const t=TR(i);return t.length===4?ge.emptyPath():CR(t)}function i_(i){return new ge(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function CR(i){return re(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function vS(i,t,e){return{name:n_(i,t),fields:e.value.mapValue.fields}}function BV(i,t){let e;if("targetChange"in t){t.targetChange;const n=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Dt(39313,{state:d})})(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],a=(function(d,p){return d.useProto3Json?(re(p===void 0||typeof p=="string",58123),Rn.fromBase64String(p||"")):(re(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Rn.fromUint8Array(p||new Uint8Array))})(i,t.targetChange.resumeToken),l=t.targetChange.cause,c=l&&(function(d){const p=d.code===void 0?ot.UNKNOWN:bR(d.code);return new pt(p,d.message||"")})(l);e=new ER(n,s,a,c||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const s=ov(i,n.document.name),a=zs(n.document.updateTime),l=n.document.createTime?zs(n.document.createTime):Mt.min(),c=new Oi({mapValue:{fields:n.document.fields}}),h=Mn.newFoundDocument(s,a,l,c),d=n.targetIds||[],p=n.removedTargetIds||[];e=new yp(d,p,h.key,h)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const s=ov(i,n.document),a=n.readTime?zs(n.readTime):Mt.min(),l=Mn.newNoDocument(s,a),c=n.removedTargetIds||[];e=new yp([],c,l.key,l)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const s=ov(i,n.document),a=n.removedTargetIds||[];e=new yp([],a,s,null)}else{if(!("filter"in t))return Dt(11601,{Vt:t});{t.filter;const n=t.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,l=new xV(s,a),c=n.targetId;e=new AR(c,l)}}return e}function FV(i,t){let e;if(t instanceof Kh)e={update:vS(i,t.key,t.value)};else if(t instanceof A0)e={delete:n_(i,t.key)};else if(t instanceof Xo)e={update:vS(i,t.key,t.data),updateMask:KV(t.fieldMask)};else{if(!(t instanceof TV))return Dt(16599,{dt:t.type});e={verify:n_(i,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map((n=>(function(a,l){const c=l.transform;if(c instanceof Up)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ch)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof xh)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof jp)return{fieldPath:l.field.canonicalString(),increment:c.Ae};throw Dt(20930,{transform:l.transform})})(0,n)))),t.precondition.isNone||(e.currentDocument=(function(s,a){return a.updateTime!==void 0?{updateTime:LV(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Dt(27497)})(i,t.precondition)),e}function UV(i,t){return i&&i.length>0?(re(t!==void 0,14353),i.map((e=>(function(s,a){let l=s.updateTime?zs(s.updateTime):zs(a);return l.isEqual(Mt.min())&&(l=zs(a)),new AV(l,s.transformResults||[])})(e,t)))):[]}function jV(i,t){return{documents:[SR(i,t.path)]}}function zV(i,t){const e={structuredQuery:{}},n=t.path;let s;t.collectionGroup!==null?(s=n,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=n.popLast(),e.structuredQuery.from=[{collectionId:n.lastSegment()}]),e.parent=SR(i,s);const a=(function(d){if(d.length!==0)return RR(ls.create(d,"and"))})(t.filters);a&&(e.structuredQuery.where=a);const l=(function(d){if(d.length!==0)return d.map((p=>(function(v){return{field:Gl(v.field),direction:GV(v.dir)}})(p)))})(t.orderBy);l&&(e.structuredQuery.orderBy=l);const c=t_(i,t.limit);return c!==null&&(e.structuredQuery.limit=c),t.startAt&&(e.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(t.endAt)),{ft:e,parent:s}}function HV(i){let t=VV(i.parent);const e=i.structuredQuery,n=e.from?e.from.length:0;let s=null;if(n>0){re(n===1,65062);const p=e.from[0];p.allDescendants?s=p.collectionId:t=t.child(p.collectionId)}let a=[];e.where&&(a=(function(m){const v=xR(m);return v instanceof ls&&iR(v)?v.getFilters():[v]})(e.where));let l=[];e.orderBy&&(l=(function(m){return m.map((v=>(function(w){return new Fp($l(w.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(v)))})(e.orderBy));let c=null;e.limit&&(c=(function(m){let v;return v=typeof m=="object"?m.value:m,bm(v)?null:v})(e.limit));let h=null;e.startAt&&(h=(function(m){const v=!!m.before,b=m.values||[];return new Bp(b,v)})(e.startAt));let d=null;return e.endAt&&(d=(function(m){const v=!m.before,b=m.values||[];return new Bp(b,v)})(e.endAt)),oV(t,s,l,a,c,"F",h,d)}function qV(i,t){const e=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Dt(28987,{purpose:s})}})(t.purpose);return e==null?null:{"goog-listen-tags":e}}function xR(i){return i.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=$l(e.unaryFilter.field);return tn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=$l(e.unaryFilter.field);return tn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=$l(e.unaryFilter.field);return tn.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=$l(e.unaryFilter.field);return tn.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Dt(61313);default:return Dt(60726)}})(i):i.fieldFilter!==void 0?(function(e){return tn.create($l(e.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Dt(58110);default:return Dt(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(i):i.compositeFilter!==void 0?(function(e){return ls.create(e.compositeFilter.filters.map((n=>xR(n))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Dt(1026)}})(e.compositeFilter.op))})(i):Dt(30097,{filter:i})}function GV(i){return MV[i]}function $V(i){return kV[i]}function WV(i){return NV[i]}function Gl(i){return{fieldPath:i.canonicalString()}}function $l(i){return xn.fromServerFormat(i.fieldPath)}function RR(i){return i instanceof tn?(function(e){if(e.op==="=="){if(rS(e.value))return{unaryFilter:{field:Gl(e.field),op:"IS_NAN"}};if(sS(e.value))return{unaryFilter:{field:Gl(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(rS(e.value))return{unaryFilter:{field:Gl(e.field),op:"IS_NOT_NAN"}};if(sS(e.value))return{unaryFilter:{field:Gl(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Gl(e.field),op:$V(e.op),value:e.value}}})(i):i instanceof ls?(function(e){const n=e.getFilters().map((s=>RR(s)));return n.length===1?n[0]:{compositeFilter:{op:WV(e.op),filters:n}}})(i):Dt(54877,{filter:i})}function KV(i){const t=[];return i.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function IR(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}function DR(i){return!!i&&typeof i._toProto=="function"&&i._protoValueType==="ProtoValue"}class Ta{constructor(t,e,n,s,a=Mt.min(),l=Mt.min(),c=Rn.EMPTY_BYTE_STRING,h=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=c,this.expectedCount=h}withSequenceNumber(t){return new Ta(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new Ta(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Ta(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Ta(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class YV{constructor(t){this.yt=t}}function XV(i){const t=HV({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?Zv(t,t.limit,"L"):t}class QV{constructor(){this.Sn=new JV}addToCollectionParentIndex(t,e){return this.Sn.add(e),lt.resolve()}getCollectionParents(t,e){return lt.resolve(this.Sn.getEntries(e))}addFieldIndex(t,e){return lt.resolve()}deleteFieldIndex(t,e){return lt.resolve()}deleteAllFieldIndexes(t){return lt.resolve()}createTargetIndexes(t,e){return lt.resolve()}getDocumentsMatchingTarget(t,e){return lt.resolve(null)}getIndexType(t,e){return lt.resolve(0)}getFieldIndexes(t,e){return lt.resolve([])}getNextCollectionGroupToUpdate(t){return lt.resolve(null)}getMinOffset(t,e){return lt.resolve(Pa.min())}getMinOffsetFromCollectionGroup(t,e){return lt.resolve(Pa.min())}updateCollectionGroup(t,e,n){return lt.resolve()}updateIndexEntries(t,e){return lt.resolve()}}class JV{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),s=this.index[e]||new ln(ge.comparator),a=!s.has(n);return this.index[e]=s.add(n),a}has(t){const e=t.lastSegment(),n=t.popLast(),s=this.index[e];return s&&s.has(n)}getEntries(t){return(this.index[t]||new ln(ge.comparator)).toArray()}}const _S={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},PR=41943040;class ei{static withCacheSize(t){return new ei(t,ei.DEFAULT_COLLECTION_PERCENTILE,ei.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}}ei.DEFAULT_COLLECTION_PERCENTILE=10,ei.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ei.DEFAULT=new ei(PR,ei.DEFAULT_COLLECTION_PERCENTILE,ei.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ei.DISABLED=new ei(-1,0,0);class _c{constructor(t){this.sr=t}next(){return this.sr+=2,this.sr}static _r(){return new _c(0)}static ar(){return new _c(-1)}}const bS="LruGarbageCollector",ZV=1048576;function AS([i,t],[e,n]){const s=$t(i,e);return s===0?$t(t,n):s}class tB{constructor(t){this.Pr=t,this.buffer=new ln(AS),this.Tr=0}Ir(){return++this.Tr}Er(t){const e=[t,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(e);else{const n=this.buffer.last();AS(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}}get maxValue(){return this.buffer.last()[0]}}class eB{constructor(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(t){mt(bS,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Ic(e)?mt(bS,"Ignoring IndexedDB error during garbage collection: ",e):await Rc(e)}await this.Ar(3e5)}))}}class nB{constructor(t,e){this.Vr=t,this.params=e}calculateTargetCount(t,e){return this.Vr.dr(t).next((n=>Math.floor(e/100*n)))}nthSequenceNumber(t,e){if(e===0)return lt.resolve(_m.ce);const n=new tB(e);return this.Vr.forEachTarget(t,(s=>n.Er(s.sequenceNumber))).next((()=>this.Vr.mr(t,(s=>n.Er(s))))).next((()=>n.maxValue))}removeTargets(t,e,n){return this.Vr.removeTargets(t,e,n)}removeOrphanedDocuments(t,e){return this.Vr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(mt("LruGarbageCollector","Garbage collection skipped; disabled"),lt.resolve(_S)):this.getCacheSize(t).next((n=>n<this.params.cacheSizeCollectionThreshold?(mt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),_S):this.gr(t,e)))}getCacheSize(t){return this.Vr.getCacheSize(t)}gr(t,e){let n,s,a,l,c,h,d;const p=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(mt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,l=Date.now(),this.nthSequenceNumber(t,s)))).next((m=>(n=m,c=Date.now(),this.removeTargets(t,n,e)))).next((m=>(a=m,h=Date.now(),this.removeOrphanedDocuments(t,n)))).next((m=>(d=Date.now(),Hl()<=Gt.DEBUG&&mt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-p}ms
	Determined least recently used ${s} in `+(c-l)+`ms
	Removed ${a} targets in `+(h-c)+`ms
	Removed ${m} documents in `+(d-h)+`ms
Total Duration: ${d-p}ms`),lt.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:m}))))}}function iB(i,t){return new nB(i,t)}class sB{constructor(){this.changes=new Yo((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Mn.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return n!==void 0?lt.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class rB{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class aB{constructor(t,e,n,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=s}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((s=>(n=s,this.remoteDocumentCache.getEntry(t,e)))).next((s=>(n!==null&&dh(n.mutation,s,ns.empty(),be.now()),s)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((n=>this.getLocalViewOfDocuments(t,n,Wt()).next((()=>n))))}getLocalViewOfDocuments(t,e,n=Wt()){const s=Co();return this.populateOverlays(t,s,e).next((()=>this.computeViews(t,e,s,n).next((a=>{let l=th();return a.forEach(((c,h)=>{l=l.insert(c,h.overlayedDocument)})),l}))))}getOverlayedDocuments(t,e){const n=Co();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,Wt())))}populateOverlays(t,e,n){const s=[];return n.forEach((a=>{e.has(a)||s.push(a)})),this.documentOverlayCache.getOverlays(t,s).next((a=>{a.forEach(((l,c)=>{e.set(l,c)}))}))}computeViews(t,e,n,s){let a=Nr();const l=hh(),c=(function(){return hh()})();return e.forEach(((h,d)=>{const p=n.get(d.key);s.has(d.key)&&(p===void 0||p.mutation instanceof Xo)?a=a.insert(d.key,d):p!==void 0?(l.set(d.key,p.mutation.getFieldMask()),dh(p.mutation,d,p.mutation.getFieldMask(),be.now())):l.set(d.key,ns.empty())})),this.recalculateAndSaveOverlays(t,a).next((h=>(h.forEach(((d,p)=>l.set(d,p))),e.forEach(((d,p)=>c.set(d,new rB(p,l.get(d)??null)))),c)))}recalculateAndSaveOverlays(t,e){const n=hh();let s=new De(((l,c)=>l-c)),a=Wt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((l=>{for(const c of l)c.keys().forEach((h=>{const d=e.get(h);if(d===null)return;let p=n.get(h)||ns.empty();p=c.applyToLocalView(d,p),n.set(h,p);const m=(s.get(c.batchId)||Wt()).add(h);s=s.insert(c.batchId,m)}))})).next((()=>{const l=[],c=s.getReverseIterator();for(;c.hasNext();){const h=c.getNext(),d=h.key,p=h.value,m=dR();p.forEach((v=>{if(!a.has(v)){const b=vR(e.get(v),n.get(v));b!==null&&m.set(v,b),a=a.add(v)}})),l.push(this.documentOverlayCache.saveOverlays(t,d,m))}return lt.waitFor(l)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((n=>this.recalculateAndSaveOverlays(t,n)))}getDocumentsMatchingQuery(t,e,n,s){return lV(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):oR(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,s):this.getDocumentsMatchingCollectionQuery(t,e,n,s)}getNextDocuments(t,e,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,s).next((a=>{const l=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,s-a.size):lt.resolve(Co());let c=Eh,h=a;return l.next((d=>lt.forEach(d,((p,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),a.get(p)?lt.resolve():this.remoteDocumentCache.getEntry(t,p).next((v=>{h=h.insert(p,v)}))))).next((()=>this.populateOverlays(t,d,a))).next((()=>this.computeViews(t,h,d,Wt()))).next((p=>({batchId:c,changes:hR(p)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new xt(e)).next((n=>{let s=th();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,s){const a=e.collectionGroup;let l=th();return this.indexManager.getCollectionParents(t,a).next((c=>lt.forEach(c,(h=>{const d=(function(m,v){return new Wh(v,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(e,h.child(a));return this.getDocumentsMatchingCollectionQuery(t,d,n,s).next((p=>{p.forEach(((m,v)=>{l=l.insert(m,v)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(t,e,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,a,s)))).next((l=>{a.forEach(((h,d)=>{const p=d.getKey();l.get(p)===null&&(l=l.insert(p,Mn.newInvalidDocument(p)))}));let c=th();return l.forEach(((h,d)=>{const p=a.get(h);p!==void 0&&dh(p.mutation,d,ns.empty(),be.now()),wm(e,d)&&(c=c.insert(h,d))})),c}))}}class oB{constructor(t){this.serializer=t,this.Nr=new Map,this.Br=new Map}getBundleMetadata(t,e){return lt.resolve(this.Nr.get(e))}saveBundleMetadata(t,e){return this.Nr.set(e.id,(function(s){return{id:s.id,version:s.version,createTime:zs(s.createTime)}})(e)),lt.resolve()}getNamedQuery(t,e){return lt.resolve(this.Br.get(e))}saveNamedQuery(t,e){return this.Br.set(e.name,(function(s){return{name:s.name,query:XV(s.bundledQuery),readTime:zs(s.readTime)}})(e)),lt.resolve()}}class lB{constructor(){this.overlays=new De(xt.comparator),this.Lr=new Map}getOverlay(t,e){return lt.resolve(this.overlays.get(e))}getOverlays(t,e){const n=Co();return lt.forEach(e,(s=>this.getOverlay(t,s).next((a=>{a!==null&&n.set(s,a)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((s,a)=>{this.bt(t,e,a)})),lt.resolve()}removeOverlaysForBatchId(t,e,n){const s=this.Lr.get(n);return s!==void 0&&(s.forEach((a=>this.overlays=this.overlays.remove(a))),this.Lr.delete(n)),lt.resolve()}getOverlaysForCollection(t,e,n){const s=Co(),a=e.length+1,l=new xt(e.child("")),c=this.overlays.getIteratorFrom(l);for(;c.hasNext();){const h=c.getNext().value,d=h.getKey();if(!e.isPrefixOf(d.path))break;d.path.length===a&&h.largestBatchId>n&&s.set(h.getKey(),h)}return lt.resolve(s)}getOverlaysForCollectionGroup(t,e,n,s){let a=new De(((d,p)=>d-p));const l=this.overlays.getIterator();for(;l.hasNext();){const d=l.getNext().value;if(d.getKey().getCollectionGroup()===e&&d.largestBatchId>n){let p=a.get(d.largestBatchId);p===null&&(p=Co(),a=a.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const c=Co(),h=a.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((d,p)=>c.set(d,p))),!(c.size()>=s)););return lt.resolve(c)}bt(t,e,n){const s=this.overlays.get(n.key);if(s!==null){const l=this.Lr.get(s.largestBatchId).delete(n.key);this.Lr.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new CV(e,n));let a=this.Lr.get(e);a===void 0&&(a=Wt(),this.Lr.set(e,a)),this.Lr.set(e,a.add(n.key))}}class cB{constructor(){this.sessionToken=Rn.EMPTY_BYTE_STRING}getSessionToken(t){return lt.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,lt.resolve()}}class S0{constructor(){this.kr=new ln(gn.Kr),this.qr=new ln(gn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(t,e){const n=new gn(t,e);this.kr=this.kr.add(n),this.qr=this.qr.add(n)}$r(t,e){t.forEach((n=>this.addReference(n,e)))}removeReference(t,e){this.Wr(new gn(t,e))}Qr(t,e){t.forEach((n=>this.removeReference(n,e)))}Gr(t){const e=new xt(new ge([])),n=new gn(e,t),s=new gn(e,t+1),a=[];return this.qr.forEachInRange([n,s],(l=>{this.Wr(l),a.push(l.key)})),a}zr(){this.kr.forEach((t=>this.Wr(t)))}Wr(t){this.kr=this.kr.delete(t),this.qr=this.qr.delete(t)}jr(t){const e=new xt(new ge([])),n=new gn(e,t),s=new gn(e,t+1);let a=Wt();return this.qr.forEachInRange([n,s],(l=>{a=a.add(l.key)})),a}containsKey(t){const e=new gn(t,0),n=this.kr.firstAfterOrEqual(e);return n!==null&&t.isEqual(n.key)}}class gn{constructor(t,e){this.key=t,this.Hr=e}static Kr(t,e){return xt.comparator(t.key,e.key)||$t(t.Hr,e.Hr)}static Ur(t,e){return $t(t.Hr,e.Hr)||xt.comparator(t.key,e.key)}}class uB{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.Yn=1,this.Jr=new ln(gn.Kr)}checkEmpty(t){return lt.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,n,s){const a=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new SV(a,e,n,s);this.mutationQueue.push(l);for(const c of s)this.Jr=this.Jr.add(new gn(c.key,a)),this.indexManager.addToCollectionParentIndex(t,c.key.path.popLast());return lt.resolve(l)}lookupMutationBatch(t,e){return lt.resolve(this.Zr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,s=this.Xr(n),a=s<0?0:s;return lt.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return lt.resolve(this.mutationQueue.length===0?p0:this.Yn-1)}getAllMutationBatches(t){return lt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new gn(e,0),s=new gn(e,Number.POSITIVE_INFINITY),a=[];return this.Jr.forEachInRange([n,s],(l=>{const c=this.Zr(l.Hr);a.push(c)})),lt.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new ln($t);return e.forEach((s=>{const a=new gn(s,0),l=new gn(s,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([a,l],(c=>{n=n.add(c.Hr)}))})),lt.resolve(this.Yr(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,s=n.length+1;let a=n;xt.isDocumentKey(a)||(a=a.child(""));const l=new gn(new xt(a),0);let c=new ln($t);return this.Jr.forEachWhile((h=>{const d=h.key.path;return!!n.isPrefixOf(d)&&(d.length===s&&(c=c.add(h.Hr)),!0)}),l),lt.resolve(this.Yr(c))}Yr(t){const e=[];return t.forEach((n=>{const s=this.Zr(n);s!==null&&e.push(s)})),e}removeMutationBatch(t,e){re(this.ei(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Jr;return lt.forEach(e.mutations,(s=>{const a=new gn(s.key,e.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)})).next((()=>{this.Jr=n}))}nr(t){}containsKey(t,e){const n=new gn(e,0),s=this.Jr.firstAfterOrEqual(n);return lt.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,lt.resolve()}ei(t,e){return this.Xr(t)}Xr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Zr(t){const e=this.Xr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class hB{constructor(t){this.ti=t,this.docs=(function(){return new De(xt.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,s=this.docs.get(n),a=s?s.size:0,l=this.ti(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return lt.resolve(n?n.document.mutableCopy():Mn.newInvalidDocument(e))}getEntries(t,e){let n=Nr();return e.forEach((s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():Mn.newInvalidDocument(s))})),lt.resolve(n)}getDocumentsMatchingQuery(t,e,n,s){let a=Nr();const l=e.path,c=new xt(l.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(c);for(;h.hasNext();){const{key:d,value:{document:p}}=h.getNext();if(!l.isPrefixOf(d.path))break;d.path.length>l.length+1||BL(VL(p),n)<=0||(s.has(p.key)||wm(e,p))&&(a=a.insert(p.key,p.mutableCopy()))}return lt.resolve(a)}getAllFromCollectionGroup(t,e,n,s){Dt(9500)}ni(t,e){return lt.forEach(this.docs,(n=>e(n)))}newChangeBuffer(t){return new dB(this)}getSize(t){return lt.resolve(this.size)}}class dB extends sB{constructor(t){super(),this.Mr=t}applyChanges(t){const e=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?e.push(this.Mr.addEntry(t,s)):this.Mr.removeEntry(n)})),lt.waitFor(e)}getFromCache(t,e){return this.Mr.getEntry(t,e)}getAllFromCache(t,e){return this.Mr.getEntries(t,e)}}class fB{constructor(t){this.persistence=t,this.ri=new Yo((e=>y0(e)),v0),this.lastRemoteSnapshotVersion=Mt.min(),this.highestTargetId=0,this.ii=0,this.si=new S0,this.targetCount=0,this.oi=_c._r()}forEachTarget(t,e){return this.ri.forEach(((n,s)=>e(s))),lt.resolve()}getLastRemoteSnapshotVersion(t){return lt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return lt.resolve(this.ii)}allocateTargetId(t){return this.highestTargetId=this.oi.next(),lt.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ii&&(this.ii=e),lt.resolve()}lr(t){this.ri.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.oi=new _c(e),this.highestTargetId=e),t.sequenceNumber>this.ii&&(this.ii=t.sequenceNumber)}addTargetData(t,e){return this.lr(e),this.targetCount+=1,lt.resolve()}updateTargetData(t,e){return this.lr(e),lt.resolve()}removeTargetData(t,e){return this.ri.delete(e.target),this.si.Gr(e.targetId),this.targetCount-=1,lt.resolve()}removeTargets(t,e,n){let s=0;const a=[];return this.ri.forEach(((l,c)=>{c.sequenceNumber<=e&&n.get(c.targetId)===null&&(this.ri.delete(l),a.push(this.removeMatchingKeysForTargetId(t,c.targetId)),s++)})),lt.waitFor(a).next((()=>s))}getTargetCount(t){return lt.resolve(this.targetCount)}getTargetData(t,e){const n=this.ri.get(e)||null;return lt.resolve(n)}addMatchingKeys(t,e,n){return this.si.$r(e,n),lt.resolve()}removeMatchingKeys(t,e,n){this.si.Qr(e,n);const s=this.persistence.referenceDelegate,a=[];return s&&e.forEach((l=>{a.push(s.markPotentiallyOrphaned(t,l))})),lt.waitFor(a)}removeMatchingKeysForTargetId(t,e){return this.si.Gr(e),lt.resolve()}getMatchingKeysForTargetId(t,e){const n=this.si.jr(e);return lt.resolve(n)}containsKey(t,e){return lt.resolve(this.si.containsKey(e))}}class MR{constructor(t,e){this._i={},this.overlays={},this.ai=new _m(0),this.ui=!1,this.ui=!0,this.ci=new cB,this.referenceDelegate=t(this),this.li=new fB(this),this.indexManager=new QV,this.remoteDocumentCache=(function(s){return new hB(s)})((n=>this.referenceDelegate.hi(n))),this.serializer=new YV(e),this.Pi=new oB(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new lB,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this._i[t.toKey()];return n||(n=new uB(e,this.referenceDelegate),this._i[t.toKey()]=n),n}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(t,e,n){mt("MemoryPersistence","Starting transaction:",t);const s=new pB(this.ai.next());return this.referenceDelegate.Ti(),n(s).next((a=>this.referenceDelegate.Ii(s).next((()=>a)))).toPromise().then((a=>(s.raiseOnCommittedEvent(),a)))}Ei(t,e){return lt.or(Object.values(this._i).map((n=>()=>n.containsKey(t,e))))}}class pB extends UL{constructor(t){super(),this.currentSequenceNumber=t}}class C0{constructor(t){this.persistence=t,this.Ri=new S0,this.Ai=null}static Vi(t){return new C0(t)}get di(){if(this.Ai)return this.Ai;throw Dt(60996)}addReference(t,e,n){return this.Ri.addReference(n,e),this.di.delete(n.toString()),lt.resolve()}removeReference(t,e,n){return this.Ri.removeReference(n,e),this.di.add(n.toString()),lt.resolve()}markPotentiallyOrphaned(t,e){return this.di.add(e.toString()),lt.resolve()}removeTarget(t,e){this.Ri.Gr(e.targetId).forEach((s=>this.di.add(s.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((s=>{s.forEach((a=>this.di.add(a.toString())))})).next((()=>n.removeTargetData(t,e)))}Ti(){this.Ai=new Set}Ii(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return lt.forEach(this.di,(n=>{const s=xt.fromPath(n);return this.mi(t,s).next((a=>{a||e.removeEntry(s,Mt.min())}))})).next((()=>(this.Ai=null,e.apply(t))))}updateLimboDocument(t,e){return this.mi(t,e).next((n=>{n?this.di.delete(e.toString()):this.di.add(e.toString())}))}hi(t){return 0}mi(t,e){return lt.or([()=>lt.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ei(t,e)])}}class Hp{constructor(t,e){this.persistence=t,this.fi=new Yo((n=>HL(n.path)),((n,s)=>n.isEqual(s))),this.garbageCollector=iB(this,e)}static Vi(t,e){return new Hp(t,e)}Ti(){}Ii(t){return lt.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}dr(t){const e=this.pr(t);return this.persistence.getTargetCache().getTargetCount(t).next((n=>e.next((s=>n+s))))}pr(t){let e=0;return this.mr(t,(n=>{e++})).next((()=>e))}mr(t,e){return lt.forEach(this.fi,((n,s)=>this.wr(t,n,s).next((a=>a?lt.resolve():e(s)))))}removeTargets(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)}removeOrphanedDocuments(t,e){let n=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ni(t,(l=>this.wr(t,l,e).next((c=>{c||(n++,a.removeEntry(l,Mt.min()))})))).next((()=>a.apply(t))).next((()=>n))}markPotentiallyOrphaned(t,e){return this.fi.set(e,t.currentSequenceNumber),lt.resolve()}removeTarget(t,e){const n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)}addReference(t,e,n){return this.fi.set(n,t.currentSequenceNumber),lt.resolve()}removeReference(t,e,n){return this.fi.set(n,t.currentSequenceNumber),lt.resolve()}updateLimboDocument(t,e){return this.fi.set(e,t.currentSequenceNumber),lt.resolve()}hi(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=pp(t.data.value)),e}wr(t,e,n){return lt.or([()=>this.persistence.Ei(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const s=this.fi.get(e);return lt.resolve(s!==void 0&&s>n)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class x0{constructor(t,e,n,s){this.targetId=t,this.fromCache=e,this.Ts=n,this.Is=s}static Es(t,e){let n=Wt(),s=Wt();for(const a of e.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new x0(t,e.fromCache,n,s)}}class mB{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class gB{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return sO()?8:jL(Nn())>0?6:4})()}initialize(t,e){this.fs=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,n,s){const a={result:null};return this.gs(t,e).next((l=>{a.result=l})).next((()=>{if(!a.result)return this.ps(t,e,s,n).next((l=>{a.result=l}))})).next((()=>{if(a.result)return;const l=new mB;return this.ys(t,e,l).next((c=>{if(a.result=c,this.As)return this.ws(t,e,l,c.size)}))})).next((()=>a.result))}ws(t,e,n,s){return n.documentReadCount<this.Vs?(Hl()<=Gt.DEBUG&&mt("QueryEngine","SDK will not create cache indexes for query:",ql(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),lt.resolve()):(Hl()<=Gt.DEBUG&&mt("QueryEngine","Query:",ql(e),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.ds*s?(Hl()<=Gt.DEBUG&&mt("QueryEngine","The SDK decides to create cache indexes for query:",ql(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,js(e))):lt.resolve())}gs(t,e){if(cS(e))return lt.resolve(null);let n=js(e);return this.indexManager.getIndexType(t,n).next((s=>s===0?null:(e.limit!==null&&s===1&&(e=Zv(e,null,"F"),n=js(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((a=>{const l=Wt(...a);return this.fs.getDocuments(t,l).next((c=>this.indexManager.getMinOffset(t,n).next((h=>{const d=this.bs(e,c);return this.Ss(e,d,l,h.readTime)?this.gs(t,Zv(e,null,"F")):this.Ds(t,d,e,h)}))))})))))}ps(t,e,n,s){return cS(e)||s.isEqual(Mt.min())?lt.resolve(null):this.fs.getDocuments(t,n).next((a=>{const l=this.bs(e,a);return this.Ss(e,l,n,s)?lt.resolve(null):(Hl()<=Gt.DEBUG&&mt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ql(e)),this.Ds(t,l,e,LL(s,Eh)).next((c=>c)))}))}bs(t,e){let n=new ln(cR(t));return e.forEach(((s,a)=>{wm(t,a)&&(n=n.add(a))})),n}Ss(t,e,n,s){if(t.limit===null)return!1;if(n.size!==e.size)return!0;const a=t.limitType==="F"?e.last():e.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}ys(t,e,n){return Hl()<=Gt.DEBUG&&mt("QueryEngine","Using full collection scan to execute query:",ql(e)),this.fs.getDocumentsMatchingQuery(t,e,Pa.min(),n)}Ds(t,e,n,s){return this.fs.getDocumentsMatchingQuery(t,n,s).next((a=>(e.forEach((l=>{a=a.insert(l.key,l)})),a)))}}const R0="LocalStore",yB=3e8;class vB{constructor(t,e,n,s){this.persistence=t,this.Cs=e,this.serializer=s,this.vs=new De($t),this.Fs=new Yo((a=>y0(a)),v0),this.Ms=new Map,this.xs=t.getRemoteDocumentCache(),this.li=t.getTargetCache(),this.Pi=t.getBundleCache(),this.Os(n)}Os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new aB(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.vs)))}}function _B(i,t,e,n){return new vB(i,t,e,n)}async function kR(i,t){const e=Lt(i);return await e.persistence.runTransaction("Handle user change","readonly",(n=>{let s;return e.mutationQueue.getAllMutationBatches(n).next((a=>(s=a,e.Os(t),e.mutationQueue.getAllMutationBatches(n)))).next((a=>{const l=[],c=[];let h=Wt();for(const d of s){l.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}for(const d of a){c.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}return e.localDocuments.getDocuments(n,h).next((d=>({Ns:d,removedBatchIds:l,addedBatchIds:c})))}))}))}function bB(i,t){const e=Lt(i);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const s=t.batch.keys(),a=e.xs.newChangeBuffer({trackRemovals:!0});return(function(c,h,d,p){const m=d.batch,v=m.keys();let b=lt.resolve();return v.forEach((w=>{b=b.next((()=>p.getEntry(h,w))).next((E=>{const S=d.docVersions.get(w);re(S!==null,48541),E.version.compareTo(S)<0&&(m.applyToRemoteDocument(E,d),E.isValidDocument()&&(E.setReadTime(d.commitVersion),p.addEntry(E)))}))})),b.next((()=>c.mutationQueue.removeMutationBatch(h,m)))})(e,n,t,a).next((()=>a.apply(n))).next((()=>e.mutationQueue.performConsistencyCheck(n))).next((()=>e.documentOverlayCache.removeOverlaysForBatchId(n,s,t.batch.batchId))).next((()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(c){let h=Wt();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(h=h.add(c.batch.mutations[d].key));return h})(t)))).next((()=>e.localDocuments.getDocuments(n,s)))}))}function NR(i){const t=Lt(i);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.li.getLastRemoteSnapshotVersion(e)))}function AB(i,t){const e=Lt(i),n=t.snapshotVersion;let s=e.vs;return e.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const l=e.xs.newChangeBuffer({trackRemovals:!0});s=e.vs;const c=[];t.targetChanges.forEach(((p,m)=>{const v=s.get(m);if(!v)return;c.push(e.li.removeMatchingKeys(a,p.removedDocuments,m).next((()=>e.li.addMatchingKeys(a,p.addedDocuments,m))));let b=v.withSequenceNumber(a.currentSequenceNumber);t.targetMismatches.get(m)!==null?b=b.withResumeToken(Rn.EMPTY_BYTE_STRING,Mt.min()).withLastLimboFreeSnapshotVersion(Mt.min()):p.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(p.resumeToken,n)),s=s.insert(m,b),(function(E,S,C){return E.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=yB?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0})(v,b,p)&&c.push(e.li.updateTargetData(a,b))}));let h=Nr(),d=Wt();if(t.documentUpdates.forEach((p=>{t.resolvedLimboDocuments.has(p)&&c.push(e.persistence.referenceDelegate.updateLimboDocument(a,p))})),c.push(EB(a,l,t.documentUpdates).next((p=>{h=p.Bs,d=p.Ls}))),!n.isEqual(Mt.min())){const p=e.li.getLastRemoteSnapshotVersion(a).next((m=>e.li.setTargetsMetadata(a,a.currentSequenceNumber,n)));c.push(p)}return lt.waitFor(c).next((()=>l.apply(a))).next((()=>e.localDocuments.getLocalViewOfDocuments(a,h,d))).next((()=>h))})).then((a=>(e.vs=s,a)))}function EB(i,t,e){let n=Wt(),s=Wt();return e.forEach((a=>n=n.add(a))),t.getEntries(i,n).next((a=>{let l=Nr();return e.forEach(((c,h)=>{const d=a.get(c);h.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(c)),h.isNoDocument()&&h.version.isEqual(Mt.min())?(t.removeEntry(c,h.readTime),l=l.insert(c,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(t.addEntry(h),l=l.insert(c,h)):mt(R0,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",h.version)})),{Bs:l,Ls:s}}))}function wB(i,t){const e=Lt(i);return e.persistence.runTransaction("Get next mutation batch","readonly",(n=>(t===void 0&&(t=p0),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t))))}function TB(i,t){const e=Lt(i);return e.persistence.runTransaction("Allocate target","readwrite",(n=>{let s;return e.li.getTargetData(n,t).next((a=>a?(s=a,lt.resolve(s)):e.li.allocateTargetId(n).next((l=>(s=new Ta(t,l,"TargetPurposeListen",n.currentSequenceNumber),e.li.addTargetData(n,s).next((()=>s)))))))})).then((n=>{const s=e.vs.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(e.vs=e.vs.insert(n.targetId,n),e.Fs.set(t,n.targetId)),n}))}async function s_(i,t,e){const n=Lt(i),s=n.vs.get(t),a=e?"readwrite":"readwrite-primary";try{e||await n.persistence.runTransaction("Release target",a,(l=>n.persistence.referenceDelegate.removeTarget(l,s)))}catch(l){if(!Ic(l))throw l;mt(R0,`Failed to update sequence numbers for target ${t}: ${l}`)}n.vs=n.vs.remove(t),n.Fs.delete(s.target)}function ES(i,t,e){const n=Lt(i);let s=Mt.min(),a=Wt();return n.persistence.runTransaction("Execute query","readwrite",(l=>(function(h,d,p){const m=Lt(h),v=m.Fs.get(p);return v!==void 0?lt.resolve(m.vs.get(v)):m.li.getTargetData(d,p)})(n,l,js(t)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,n.li.getMatchingKeysForTargetId(l,c.targetId).next((h=>{a=h}))})).next((()=>n.Cs.getDocumentsMatchingQuery(l,t,e?s:Mt.min(),e?a:Wt()))).next((c=>(SB(n,uV(t),c),{documents:c,ks:a})))))}function SB(i,t,e){let n=i.Ms.get(t)||Mt.min();e.forEach(((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)})),i.Ms.set(t,n)}class wS{constructor(){this.activeTargetIds=gV()}Qs(t){this.activeTargetIds=this.activeTargetIds.add(t)}Gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class CB{constructor(){this.vo=new wS,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t,e=!0){return e&&this.vo.Qs(t),this.Fo[t]||"not-current"}updateQueryState(t,e,n){this.Fo[t]=e}removeLocalQueryTarget(t){this.vo.Gs(t)}isLocalQueryTarget(t){return this.vo.activeTargetIds.has(t)}clearQueryState(t){delete this.Fo[t]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(t){return this.vo.activeTargetIds.has(t)}start(){return this.vo=new wS,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class xB{Mo(t){}shutdown(){}}const TS="ConnectivityMonitor";class SS{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(t){this.Lo.push(t)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){mt(TS,"Network connectivity changed: AVAILABLE");for(const t of this.Lo)t(0)}Bo(){mt(TS,"Network connectivity changed: UNAVAILABLE");for(const t of this.Lo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Kf=null;function r_(){return Kf===null?Kf=(function(){return 268435456+Math.round(2147483648*Math.random())})():Kf++,"0x"+Kf.toString(16)}const lv="RestConnection",RB={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class IB{get Ko(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.qo=e+"://"+t.host,this.Uo=`projects/${n}/databases/${s}`,this.$o=this.databaseId.database===Lp?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Wo(t,e,n,s,a){const l=r_(),c=this.Qo(t,e.toUriEncodedString());mt(lv,`Sending RPC '${t}' ${l}:`,c,n);const h={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(h,s,a);const{host:d}=new URL(c),p=$o(d);return this.zo(t,c,h,n,p).then((m=>(mt(lv,`Received RPC '${t}' ${l}: `,m),m)),(m=>{throw mc(lv,`RPC '${t}' ${l} failed with error: `,m,"url: ",c,"request:",n),m}))}jo(t,e,n,s,a,l){return this.Wo(t,e,n,s,a)}Go(t,e,n){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+xc})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((s,a)=>t[a]=s)),n&&n.headers.forEach(((s,a)=>t[a]=s))}Qo(t,e){const n=RB[t];let s=`${this.qo}/v1/${e}:${n}`;return this.databaseInfo.apiKey&&(s=`${s}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),s}terminate(){}}class DB{constructor(t){this.Ho=t.Ho,this.Jo=t.Jo}Zo(t){this.Xo=t}Yo(t){this.e_=t}t_(t){this.n_=t}onMessage(t){this.r_=t}close(){this.Jo()}send(t){this.Ho(t)}i_(){this.Xo()}s_(){this.e_()}o_(t){this.n_(t)}__(t){this.r_(t)}}const Dn="WebChannelConnection",qu=(i,t,e)=>{i.listen(t,(n=>{try{e(n)}catch(s){setTimeout((()=>{throw s}),0)}}))};class ic extends IB{constructor(t){super(t),this.a_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}static u_(){if(!ic.c_){const t=Fx();qu(t,Bx.STAT_EVENT,(e=>{e.stat===$v.PROXY?mt(Dn,"STAT_EVENT: detected buffering proxy"):e.stat===$v.NOPROXY&&mt(Dn,"STAT_EVENT: detected no buffering proxy")})),ic.c_=!0}}zo(t,e,n,s,a){const l=r_();return new Promise(((c,h)=>{const d=new Lx;d.setWithCredentials(!0),d.listenOnce(Vx.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case fp.NO_ERROR:const m=d.getResponseJson();mt(Dn,`XHR for RPC '${t}' ${l} received:`,JSON.stringify(m)),c(m);break;case fp.TIMEOUT:mt(Dn,`RPC '${t}' ${l} timed out`),h(new pt(ot.DEADLINE_EXCEEDED,"Request time out"));break;case fp.HTTP_ERROR:const v=d.getStatus();if(mt(Dn,`RPC '${t}' ${l} failed with status:`,v,"response text:",d.getResponseText()),v>0){let b=d.getResponseJson();Array.isArray(b)&&(b=b[0]);const w=b?.error;if(w&&w.status&&w.message){const E=(function(C){const R=C.toLowerCase().replace(/_/g,"-");return Object.values(ot).indexOf(R)>=0?R:ot.UNKNOWN})(w.status);h(new pt(E,w.message))}else h(new pt(ot.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new pt(ot.UNAVAILABLE,"Connection failed."));break;default:Dt(9055,{l_:t,streamId:l,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{mt(Dn,`RPC '${t}' ${l} completed.`)}}));const p=JSON.stringify(s);mt(Dn,`RPC '${t}' ${l} sending request:`,s),d.send(e,"POST",p,n,15)}))}T_(t,e,n){const s=r_(),a=[this.qo,"/","google.firestore.v1.Firestore","/",t,"/channel"],l=this.createWebChannelTransport(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Go(c.initMessageHeaders,e,n),c.encodeInitMessageHeaders=!0;const d=a.join("");mt(Dn,`Creating RPC '${t}' stream ${s}: ${d}`,c);const p=l.createWebChannel(d,c);this.I_(p);let m=!1,v=!1;const b=new DB({Ho:w=>{v?mt(Dn,`Not sending because RPC '${t}' stream ${s} is closed:`,w):(m||(mt(Dn,`Opening RPC '${t}' stream ${s} transport.`),p.open(),m=!0),mt(Dn,`RPC '${t}' stream ${s} sending:`,w),p.send(w))},Jo:()=>p.close()});return qu(p,Zu.EventType.OPEN,(()=>{v||(mt(Dn,`RPC '${t}' stream ${s} transport opened.`),b.i_())})),qu(p,Zu.EventType.CLOSE,(()=>{v||(v=!0,mt(Dn,`RPC '${t}' stream ${s} transport closed`),b.o_(),this.E_(p))})),qu(p,Zu.EventType.ERROR,(w=>{v||(v=!0,mc(Dn,`RPC '${t}' stream ${s} transport errored. Name:`,w.name,"Message:",w.message),b.o_(new pt(ot.UNAVAILABLE,"The operation could not be completed")))})),qu(p,Zu.EventType.MESSAGE,(w=>{if(!v){const E=w.data[0];re(!!E,16349);const S=E,C=S?.error||S[0]?.error;if(C){mt(Dn,`RPC '${t}' stream ${s} received error:`,C);const R=C.status;let I=(function(j){const P=Je[j];if(P!==void 0)return bR(P)})(R),B=C.message;I===void 0&&(I=ot.INTERNAL,B="Unknown error status: "+R+" with message "+C.message),v=!0,b.o_(new pt(I,B)),p.close()}else mt(Dn,`RPC '${t}' stream ${s} received:`,E),b.__(E)}})),ic.u_(),setTimeout((()=>{b.s_()}),0),b}terminate(){this.a_.forEach((t=>t.close())),this.a_=[]}I_(t){this.a_.push(t)}E_(t){this.a_=this.a_.filter((e=>e===t))}Go(t,e,n){super.Go(t,e,n),this.databaseInfo.apiKey&&(t["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Ux()}}function PB(i){return new ic(i)}function cv(){return typeof document<"u"?document:null}function xm(i){return new OV(i,!0)}ic.c_=!1;class OR{constructor(t,e,n=1e3,s=1.5,a=6e4){this.Ci=t,this.timerId=e,this.R_=n,this.A_=s,this.V_=a,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(t){this.cancel();const e=Math.floor(this.d_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,e-n);s>0&&mt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.d_} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),t()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const CS="PersistentStream";class LR{constructor(t,e,n,s,a,l,c,h){this.Ci=t,this.b_=n,this.S_=s,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=c,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new OR(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(t){this.q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===ot.RESOURCE_EXHAUSTED?(Mr(e.toString()),Mr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===ot.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.t_(e)}W_(){}auth(){this.state=1;const t=this.Q_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,s])=>{this.D_===e&&this.G_(n,s)}),(n=>{t((()=>{const s=new pt(ot.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)}))}))}G_(t,e){const n=this.Q_(this.D_);this.stream=this.j_(t,e),this.stream.Zo((()=>{n((()=>this.listener.Zo()))})),this.stream.Yo((()=>{n((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((s=>{n((()=>this.z_(s)))})),this.stream.onMessage((s=>{n((()=>++this.F_==1?this.H_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return mt(CS,`close with error: ${t}`),this.stream=null,this.close(4,t)}Q_(t){return e=>{this.Ci.enqueueAndForget((()=>this.D_===t?e():(mt(CS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class MB extends LR{constructor(t,e,n,s,a,l){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,s,l),this.serializer=a}j_(t,e){return this.connection.T_("Listen",t,e)}H_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=BV(this.serializer,t),n=(function(a){if(!("targetChange"in a))return Mt.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?Mt.min():l.readTime?zs(l.readTime):Mt.min()})(t);return this.listener.J_(e,n)}Z_(t){const e={};e.database=i_(this.serializer),e.addTarget=(function(a,l){let c;const h=l.target;if(c=Qv(h)?{documents:jV(a,h)}:{query:zV(a,h).ft},c.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){c.resumeToken=wR(a,l.resumeToken);const d=t_(a,l.expectedCount);d!==null&&(c.expectedCount=d)}else if(l.snapshotVersion.compareTo(Mt.min())>0){c.readTime=zp(a,l.snapshotVersion.toTimestamp());const d=t_(a,l.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,t);const n=qV(this.serializer,t);n&&(e.labels=n),this.K_(e)}X_(t){const e={};e.database=i_(this.serializer),e.removeTarget=t,this.K_(e)}}class kB extends LR{constructor(t,e,n,s,a,l){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,s,l),this.serializer=a}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}H_(t){return re(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,re(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){re(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=UV(t.writeResults,t.commitTime),n=zs(t.commitTime);return this.listener.na(n,e)}ra(){const t={};t.database=i_(this.serializer),this.K_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map((n=>FV(this.serializer,n)))};this.K_(e)}}class NB{}class OB extends NB{constructor(t,e,n,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new pt(ot.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,e,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Wo(t,e_(e,n),s,a,l))).catch((a=>{throw a.name==="FirebaseError"?(a.code===ot.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new pt(ot.UNKNOWN,a.toString())}))}jo(t,e,n,s,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.jo(t,e_(e,n),s,l,c,a))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ot.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new pt(ot.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function LB(i,t,e,n){return new OB(i,t,e,n)}class VB{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Mr(e),this.aa=!1):mt("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Uo="RemoteStore";class BB{constructor(t,e,n,s,a){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=a,this.Aa.Mo((l=>{n.enqueueAndForget((async()=>{Qo(this)&&(mt(Uo,"Restarting streams for network reachability change."),await(async function(h){const d=Lt(h);d.Ea.add(4),await Xh(d),d.Va.set("Unknown"),d.Ea.delete(4),await Rm(d)})(this))}))})),this.Va=new VB(n,s)}}async function Rm(i){if(Qo(i))for(const t of i.Ra)await t(!0)}async function Xh(i){for(const t of i.Ra)await t(!1)}function VR(i,t){const e=Lt(i);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),M0(e)?P0(e):Dc(e).O_()&&D0(e,t))}function I0(i,t){const e=Lt(i),n=Dc(e);e.Ia.delete(t),n.O_()&&BR(e,t),e.Ia.size===0&&(n.O_()?n.L_():Qo(e)&&e.Va.set("Unknown"))}function D0(i,t){if(i.da.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Mt.min())>0){const e=i.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}Dc(i).Z_(t)}function BR(i,t){i.da.$e(t),Dc(i).X_(t)}function P0(i){i.da=new PV({getRemoteKeysForTarget:t=>i.remoteSyncer.getRemoteKeysForTarget(t),At:t=>i.Ia.get(t)||null,ht:()=>i.datastore.serializer.databaseId}),Dc(i).start(),i.Va.ua()}function M0(i){return Qo(i)&&!Dc(i).x_()&&i.Ia.size>0}function Qo(i){return Lt(i).Ea.size===0}function FR(i){i.da=void 0}async function FB(i){i.Va.set("Online")}async function UB(i){i.Ia.forEach(((t,e)=>{D0(i,t)}))}async function jB(i,t){FR(i),M0(i)?(i.Va.ha(t),P0(i)):i.Va.set("Unknown")}async function zB(i,t,e){if(i.Va.set("Online"),t instanceof ER&&t.state===2&&t.cause)try{await(async function(s,a){const l=a.cause;for(const c of a.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,l),s.Ia.delete(c),s.da.removeTarget(c))})(i,t)}catch(n){mt(Uo,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await qp(i,n)}else if(t instanceof yp?i.da.Xe(t):t instanceof AR?i.da.st(t):i.da.tt(t),!e.isEqual(Mt.min()))try{const n=await NR(i.localStore);e.compareTo(n)>=0&&await(function(a,l){const c=a.da.Tt(l);return c.targetChanges.forEach(((h,d)=>{if(h.resumeToken.approximateByteSize()>0){const p=a.Ia.get(d);p&&a.Ia.set(d,p.withResumeToken(h.resumeToken,l))}})),c.targetMismatches.forEach(((h,d)=>{const p=a.Ia.get(h);if(!p)return;a.Ia.set(h,p.withResumeToken(Rn.EMPTY_BYTE_STRING,p.snapshotVersion)),BR(a,h);const m=new Ta(p.target,h,d,p.sequenceNumber);D0(a,m)})),a.remoteSyncer.applyRemoteEvent(c)})(i,e)}catch(n){mt(Uo,"Failed to raise snapshot:",n),await qp(i,n)}}async function qp(i,t,e){if(!Ic(t))throw t;i.Ea.add(1),await Xh(i),i.Va.set("Offline"),e||(e=()=>NR(i.localStore)),i.asyncQueue.enqueueRetryable((async()=>{mt(Uo,"Retrying IndexedDB access"),await e(),i.Ea.delete(1),await Rm(i)}))}function UR(i,t){return t().catch((e=>qp(i,e,t)))}async function Im(i){const t=Lt(i),e=Oa(t);let n=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:p0;for(;HB(t);)try{const s=await wB(t.localStore,n);if(s===null){t.Ta.length===0&&e.L_();break}n=s.batchId,qB(t,s)}catch(s){await qp(t,s)}jR(t)&&zR(t)}function HB(i){return Qo(i)&&i.Ta.length<10}function qB(i,t){i.Ta.push(t);const e=Oa(i);e.O_()&&e.Y_&&e.ea(t.mutations)}function jR(i){return Qo(i)&&!Oa(i).x_()&&i.Ta.length>0}function zR(i){Oa(i).start()}async function GB(i){Oa(i).ra()}async function $B(i){const t=Oa(i);for(const e of i.Ta)t.ea(e.mutations)}async function WB(i,t,e){const n=i.Ta.shift(),s=E0.from(n,t,e);await UR(i,(()=>i.remoteSyncer.applySuccessfulWrite(s))),await Im(i)}async function KB(i,t){t&&Oa(i).Y_&&await(async function(n,s){if((function(l){return RV(l)&&l!==ot.ABORTED})(s.code)){const a=n.Ta.shift();Oa(n).B_(),await UR(n,(()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s))),await Im(n)}})(i,t),jR(i)&&zR(i)}async function xS(i,t){const e=Lt(i);e.asyncQueue.verifyOperationInProgress(),mt(Uo,"RemoteStore received new credentials");const n=Qo(e);e.Ea.add(3),await Xh(e),n&&e.Va.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await Rm(e)}async function YB(i,t){const e=Lt(i);t?(e.Ea.delete(2),await Rm(e)):t||(e.Ea.add(2),await Xh(e),e.Va.set("Unknown"))}function Dc(i){return i.ma||(i.ma=(function(e,n,s){const a=Lt(e);return a.sa(),new MB(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(i.datastore,i.asyncQueue,{Zo:FB.bind(null,i),Yo:UB.bind(null,i),t_:jB.bind(null,i),J_:zB.bind(null,i)}),i.Ra.push((async t=>{t?(i.ma.B_(),M0(i)?P0(i):i.Va.set("Unknown")):(await i.ma.stop(),FR(i))}))),i.ma}function Oa(i){return i.fa||(i.fa=(function(e,n,s){const a=Lt(e);return a.sa(),new kB(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(i.datastore,i.asyncQueue,{Zo:()=>Promise.resolve(),Yo:GB.bind(null,i),t_:KB.bind(null,i),ta:$B.bind(null,i),na:WB.bind(null,i)}),i.Ra.push((async t=>{t?(i.fa.B_(),await Im(i)):(await i.fa.stop(),i.Ta.length>0&&(mt(Uo,`Stopping write stream with ${i.Ta.length} pending writes`),i.Ta=[]))}))),i.fa}class k0{constructor(t,e,n,s,a){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new Cr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,s,a){const l=Date.now()+n,c=new k0(t,e,l,s,a);return c.start(n),c}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new pt(ot.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function N0(i,t){if(Mr("AsyncQueue",`${t}: ${i}`),Ic(i))return new pt(ot.UNAVAILABLE,`${t}: ${i}`);throw i}class sc{static emptySet(t){return new sc(t.comparator)}constructor(t){this.comparator=t?(e,n)=>t(e,n)||xt.comparator(e.key,n.key):(e,n)=>xt.comparator(e.key,n.key),this.keyedMap=th(),this.sortedSet=new De(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof sc)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const s=e.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const n=new sc;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class RS{constructor(){this.ga=new De(xt.comparator)}track(t){const e=t.doc.key,n=this.ga.get(e);n?t.type!==0&&n.type===3?this.ga=this.ga.insert(e,t):t.type===3&&n.type!==1?this.ga=this.ga.insert(e,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.ga=this.ga.remove(e):t.type===1&&n.type===2?this.ga=this.ga.insert(e,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):Dt(63341,{Vt:t,pa:n}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal(((e,n)=>{t.push(n)})),t}}class bc{constructor(t,e,n,s,a,l,c,h,d){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=c,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(t,e,n,s,a){const l=[];return e.forEach((c=>{l.push({type:0,doc:c})})),new bc(t,e,sc.emptySet(e),l,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Em(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==n[s].type||!e[s].doc.isEqual(n[s].doc))return!1;return!0}}class XB{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((t=>t.Da()))}}class QB{constructor(){this.queries=IS(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,n){const s=Lt(e),a=s.queries;s.queries=IS(),a.forEach(((l,c)=>{for(const h of c.ba)h.onError(n)}))})(this,new pt(ot.ABORTED,"Firestore shutting down"))}}function IS(){return new Yo((i=>lR(i)),Em)}async function HR(i,t){const e=Lt(i);let n=3;const s=t.query;let a=e.queries.get(s);a?!a.Sa()&&t.Da()&&(n=2):(a=new XB,n=t.Da()?0:1);try{switch(n){case 0:a.wa=await e.onListen(s,!0);break;case 1:a.wa=await e.onListen(s,!1);break;case 2:await e.onFirstRemoteStoreListen(s)}}catch(l){const c=N0(l,`Initialization of query '${ql(t.query)}' failed`);return void t.onError(c)}e.queries.set(s,a),a.ba.push(t),t.va(e.onlineState),a.wa&&t.Fa(a.wa)&&O0(e)}async function qR(i,t){const e=Lt(i),n=t.query;let s=3;const a=e.queries.get(n);if(a){const l=a.ba.indexOf(t);l>=0&&(a.ba.splice(l,1),a.ba.length===0?s=t.Da()?0:1:!a.Sa()&&t.Da()&&(s=2))}switch(s){case 0:return e.queries.delete(n),e.onUnlisten(n,!0);case 1:return e.queries.delete(n),e.onUnlisten(n,!1);case 2:return e.onLastRemoteStoreUnlisten(n);default:return}}function JB(i,t){const e=Lt(i);let n=!1;for(const s of t){const a=s.query,l=e.queries.get(a);if(l){for(const c of l.ba)c.Fa(s)&&(n=!0);l.wa=s}}n&&O0(e)}function ZB(i,t,e){const n=Lt(i),s=n.queries.get(t);if(s)for(const a of s.ba)a.onError(e);n.queries.delete(t)}function O0(i){i.Ca.forEach((t=>{t.next()}))}var a_,DS;(DS=a_||(a_={})).Ma="default",DS.Cache="cache";class GR{constructor(t,e,n){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(t){if(!this.options.includeMetadataChanges){const n=[];for(const s of t.docChanges)s.type!==3&&n.push(s);t=new bc(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const n=e!=="Offline";return(!this.options.Ka||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=bc.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==a_.Cache}}class $R{constructor(t){this.key=t}}class WR{constructor(t){this.key=t}}class tF{constructor(t,e){this.query=t,this.Za=e,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Wt(),this.mutatedKeys=Wt(),this.eu=cR(t),this.tu=new sc(this.eu)}get nu(){return this.Za}ru(t,e){const n=e?e.iu:new RS,s=e?e.tu:this.tu;let a=e?e.mutatedKeys:this.mutatedKeys,l=s,c=!1;const h=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal(((p,m)=>{const v=s.get(p),b=wm(this.query,m)?m:null,w=!!v&&this.mutatedKeys.has(v.key),E=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let S=!1;v&&b?v.data.isEqual(b.data)?w!==E&&(n.track({type:3,doc:b}),S=!0):this.su(v,b)||(n.track({type:2,doc:b}),S=!0,(h&&this.eu(b,h)>0||d&&this.eu(b,d)<0)&&(c=!0)):!v&&b?(n.track({type:0,doc:b}),S=!0):v&&!b&&(n.track({type:1,doc:v}),S=!0,(h||d)&&(c=!0)),S&&(b?(l=l.add(b),a=E?a.add(p):a.delete(p)):(l=l.delete(p),a=a.delete(p)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const p=this.query.limitType==="F"?l.last():l.first();l=l.delete(p.key),a=a.delete(p.key),n.track({type:1,doc:p})}return{tu:l,iu:n,Ss:c,mutatedKeys:a}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,s){const a=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const l=t.iu.ya();l.sort(((p,m)=>(function(b,w){const E=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Dt(20277,{Vt:S})}};return E(b)-E(w)})(p.type,m.type)||this.eu(p.doc,m.doc))),this.ou(n),s=s??!1;const c=e&&!s?this._u():[],h=this.Ya.size===0&&this.current&&!s?1:0,d=h!==this.Xa;return this.Xa=h,l.length!==0||d?{snapshot:new bc(this.query,t.tu,a,l,t.mutatedKeys,h===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new RS,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(t){return!this.Za.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach((e=>this.Za=this.Za.add(e))),t.modifiedDocuments.forEach((e=>{})),t.removedDocuments.forEach((e=>this.Za=this.Za.delete(e))),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Ya;this.Ya=Wt(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Ya=this.Ya.add(n.key))}));const e=[];return t.forEach((n=>{this.Ya.has(n)||e.push(new WR(n))})),this.Ya.forEach((n=>{t.has(n)||e.push(new $R(n))})),e}cu(t){this.Za=t.ks,this.Ya=Wt();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return bc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const L0="SyncEngine";class eF{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class nF{constructor(t){this.key=t,this.hu=!1}}class iF{constructor(t,e,n,s,a,l){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new Yo((c=>lR(c)),Em),this.Iu=new Map,this.Eu=new Set,this.Ru=new De(xt.comparator),this.Au=new Map,this.Vu=new S0,this.du={},this.mu=new Map,this.fu=_c.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function sF(i,t,e=!0){const n=ZR(i);let s;const a=n.Tu.get(t);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.lu()):s=await KR(n,t,e,!0),s}async function rF(i,t){const e=ZR(i);await KR(e,t,!0,!1)}async function KR(i,t,e,n){const s=await TB(i.localStore,js(t)),a=s.targetId,l=i.sharedClientState.addLocalQueryTarget(a,e);let c;return n&&(c=await aF(i,t,a,l==="current",s.resumeToken)),i.isPrimaryClient&&e&&VR(i.remoteStore,s),c}async function aF(i,t,e,n,s){i.pu=(m,v,b)=>(async function(E,S,C,R){let I=S.view.ru(C);I.Ss&&(I=await ES(E.localStore,S.query,!1).then((({documents:P})=>S.view.ru(P,I))));const B=R&&R.targetChanges.get(S.targetId),F=R&&R.targetMismatches.get(S.targetId)!=null,j=S.view.applyChanges(I,E.isPrimaryClient,B,F);return MS(E,S.targetId,j.au),j.snapshot})(i,m,v,b);const a=await ES(i.localStore,t,!0),l=new tF(t,a.ks),c=l.ru(a.documents),h=Yh.createSynthesizedTargetChangeForCurrentChange(e,n&&i.onlineState!=="Offline",s),d=l.applyChanges(c,i.isPrimaryClient,h);MS(i,e,d.au);const p=new eF(t,e,l);return i.Tu.set(t,p),i.Iu.has(e)?i.Iu.get(e).push(t):i.Iu.set(e,[t]),d.snapshot}async function oF(i,t,e){const n=Lt(i),s=n.Tu.get(t),a=n.Iu.get(s.targetId);if(a.length>1)return n.Iu.set(s.targetId,a.filter((l=>!Em(l,t)))),void n.Tu.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await s_(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),e&&I0(n.remoteStore,s.targetId),o_(n,s.targetId)})).catch(Rc)):(o_(n,s.targetId),await s_(n.localStore,s.targetId,!0))}async function lF(i,t){const e=Lt(i),n=e.Tu.get(t),s=e.Iu.get(n.targetId);e.isPrimaryClient&&s.length===1&&(e.sharedClientState.removeLocalQueryTarget(n.targetId),I0(e.remoteStore,n.targetId))}async function cF(i,t,e){const n=gF(i);try{const s=await(function(l,c){const h=Lt(l),d=be.now(),p=c.reduce(((b,w)=>b.add(w.key)),Wt());let m,v;return h.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let w=Nr(),E=Wt();return h.xs.getEntries(b,p).next((S=>{w=S,w.forEach(((C,R)=>{R.isValidDocument()||(E=E.add(C))}))})).next((()=>h.localDocuments.getOverlayedDocuments(b,w))).next((S=>{m=S;const C=[];for(const R of c){const I=wV(R,m.get(R.key).overlayedDocument);I!=null&&C.push(new Xo(R.key,I,tR(I.value.mapValue),rs.exists(!0)))}return h.mutationQueue.addMutationBatch(b,d,C,c)})).next((S=>{v=S;const C=S.applyToLocalDocumentSet(m,E);return h.documentOverlayCache.saveOverlays(b,S.batchId,C)}))})).then((()=>({batchId:v.batchId,changes:hR(m)})))})(n.localStore,t);n.sharedClientState.addPendingMutation(s.batchId),(function(l,c,h){let d=l.du[l.currentUser.toKey()];d||(d=new De($t)),d=d.insert(c,h),l.du[l.currentUser.toKey()]=d})(n,s.batchId,e),await Qh(n,s.changes),await Im(n.remoteStore)}catch(s){const a=N0(s,"Failed to persist write");e.reject(a)}}async function YR(i,t){const e=Lt(i);try{const n=await AB(e.localStore,t);t.targetChanges.forEach(((s,a)=>{const l=e.Au.get(a);l&&(re(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?l.hu=!0:s.modifiedDocuments.size>0?re(l.hu,14607):s.removedDocuments.size>0&&(re(l.hu,42227),l.hu=!1))})),await Qh(e,n,t)}catch(n){await Rc(n)}}function PS(i,t,e){const n=Lt(i);if(n.isPrimaryClient&&e===0||!n.isPrimaryClient&&e===1){const s=[];n.Tu.forEach(((a,l)=>{const c=l.view.va(t);c.snapshot&&s.push(c.snapshot)})),(function(l,c){const h=Lt(l);h.onlineState=c;let d=!1;h.queries.forEach(((p,m)=>{for(const v of m.ba)v.va(c)&&(d=!0)})),d&&O0(h)})(n.eventManager,t),s.length&&n.Pu.J_(s),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function uF(i,t,e){const n=Lt(i);n.sharedClientState.updateQueryState(t,"rejected",e);const s=n.Au.get(t),a=s&&s.key;if(a){let l=new De(xt.comparator);l=l.insert(a,Mn.newNoDocument(a,Mt.min()));const c=Wt().add(a),h=new Cm(Mt.min(),new Map,new De($t),l,c);await YR(n,h),n.Ru=n.Ru.remove(a),n.Au.delete(t),V0(n)}else await s_(n.localStore,t,!1).then((()=>o_(n,t,e))).catch(Rc)}async function hF(i,t){const e=Lt(i),n=t.batch.batchId;try{const s=await bB(e.localStore,t);QR(e,n,null),XR(e,n),e.sharedClientState.updateMutationState(n,"acknowledged"),await Qh(e,s)}catch(s){await Rc(s)}}async function dF(i,t,e){const n=Lt(i);try{const s=await(function(l,c){const h=Lt(l);return h.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let p;return h.mutationQueue.lookupMutationBatch(d,c).next((m=>(re(m!==null,37113),p=m.keys(),h.mutationQueue.removeMutationBatch(d,m)))).next((()=>h.mutationQueue.performConsistencyCheck(d))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,c))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p))).next((()=>h.localDocuments.getDocuments(d,p)))}))})(n.localStore,t);QR(n,t,e),XR(n,t),n.sharedClientState.updateMutationState(t,"rejected",e),await Qh(n,s)}catch(s){await Rc(s)}}function XR(i,t){(i.mu.get(t)||[]).forEach((e=>{e.resolve()})),i.mu.delete(t)}function QR(i,t,e){const n=Lt(i);let s=n.du[n.currentUser.toKey()];if(s){const a=s.get(t);a&&(e?a.reject(e):a.resolve(),s=s.remove(t)),n.du[n.currentUser.toKey()]=s}}function o_(i,t,e=null){i.sharedClientState.removeLocalQueryTarget(t);for(const n of i.Iu.get(t))i.Tu.delete(n),e&&i.Pu.yu(n,e);i.Iu.delete(t),i.isPrimaryClient&&i.Vu.Gr(t).forEach((n=>{i.Vu.containsKey(n)||JR(i,n)}))}function JR(i,t){i.Eu.delete(t.path.canonicalString());const e=i.Ru.get(t);e!==null&&(I0(i.remoteStore,e),i.Ru=i.Ru.remove(t),i.Au.delete(e),V0(i))}function MS(i,t,e){for(const n of e)n instanceof $R?(i.Vu.addReference(n.key,t),fF(i,n)):n instanceof WR?(mt(L0,"Document no longer in limbo: "+n.key),i.Vu.removeReference(n.key,t),i.Vu.containsKey(n.key)||JR(i,n.key)):Dt(19791,{wu:n})}function fF(i,t){const e=t.key,n=e.path.canonicalString();i.Ru.get(e)||i.Eu.has(n)||(mt(L0,"New document in limbo: "+e),i.Eu.add(n),V0(i))}function V0(i){for(;i.Eu.size>0&&i.Ru.size<i.maxConcurrentLimboResolutions;){const t=i.Eu.values().next().value;i.Eu.delete(t);const e=new xt(ge.fromString(t)),n=i.fu.next();i.Au.set(n,new nF(e)),i.Ru=i.Ru.insert(e,n),VR(i.remoteStore,new Ta(js(_0(e.path)),n,"TargetPurposeLimboResolution",_m.ce))}}async function Qh(i,t,e){const n=Lt(i),s=[],a=[],l=[];n.Tu.isEmpty()||(n.Tu.forEach(((c,h)=>{l.push(n.pu(h,t,e).then((d=>{if((d||e)&&n.isPrimaryClient){const p=d?!d.fromCache:e?.targetChanges.get(h.targetId)?.current;n.sharedClientState.updateQueryState(h.targetId,p?"current":"not-current")}if(d){s.push(d);const p=x0.Es(h.targetId,d);a.push(p)}})))})),await Promise.all(l),n.Pu.J_(s),await(async function(h,d){const p=Lt(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>lt.forEach(d,(v=>lt.forEach(v.Ts,(b=>p.persistence.referenceDelegate.addReference(m,v.targetId,b))).next((()=>lt.forEach(v.Is,(b=>p.persistence.referenceDelegate.removeReference(m,v.targetId,b)))))))))}catch(m){if(!Ic(m))throw m;mt(R0,"Failed to update sequence numbers: "+m)}for(const m of d){const v=m.targetId;if(!m.fromCache){const b=p.vs.get(v),w=b.snapshotVersion,E=b.withLastLimboFreeSnapshotVersion(w);p.vs=p.vs.insert(v,E)}}})(n.localStore,a))}async function pF(i,t){const e=Lt(i);if(!e.currentUser.isEqual(t)){mt(L0,"User change. New user:",t.toKey());const n=await kR(e.localStore,t);e.currentUser=t,(function(a,l){a.mu.forEach((c=>{c.forEach((h=>{h.reject(new pt(ot.CANCELLED,l))}))})),a.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await Qh(e,n.Ns)}}function mF(i,t){const e=Lt(i),n=e.Au.get(t);if(n&&n.hu)return Wt().add(n.key);{let s=Wt();const a=e.Iu.get(t);if(!a)return s;for(const l of a){const c=e.Tu.get(l);s=s.unionWith(c.view.nu)}return s}}function ZR(i){const t=Lt(i);return t.remoteStore.remoteSyncer.applyRemoteEvent=YR.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=mF.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=uF.bind(null,t),t.Pu.J_=JB.bind(null,t.eventManager),t.Pu.yu=ZB.bind(null,t.eventManager),t}function gF(i){const t=Lt(i);return t.remoteStore.remoteSyncer.applySuccessfulWrite=hF.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=dF.bind(null,t),t}class Gp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=xm(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return _B(this.persistence,new gB,t.initialUser,this.serializer)}Cu(t){return new MR(C0.Vi,this.serializer)}Du(t){return new CB}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Gp.provider={build:()=>new Gp};class yF extends Gp{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){re(this.persistence.referenceDelegate instanceof Hp,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new eB(n,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?ei.withCacheSize(this.cacheSizeBytes):ei.DEFAULT;return new MR((n=>Hp.Vi(n,e)),this.serializer)}}class l_{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>PS(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=pF.bind(null,this.syncEngine),await YB(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new QB})()}createDatastore(t){const e=xm(t.databaseInfo.databaseId),n=PB(t.databaseInfo);return LB(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return(function(n,s,a,l,c){return new BB(n,s,a,l,c)})(this.localStore,this.datastore,t.asyncQueue,(e=>PS(this.syncEngine,e,0)),(function(){return SS.v()?new SS:new xB})())}createSyncEngine(t,e){return(function(s,a,l,c,h,d,p){const m=new iF(s,a,l,c,h,d);return p&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await(async function(e){const n=Lt(e);mt(Uo,"RemoteStore shutting down."),n.Ea.add(5),await Xh(n),n.Aa.shutdown(),n.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}l_.provider={build:()=>new l_};class tI{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):Mr("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}const La="FirestoreClient";class vF{constructor(t,e,n,s,a){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this._databaseInfo=s,this.user=Pn.UNAUTHENTICATED,this.clientId=f0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,(async l=>{mt(La,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(n,(l=>(mt(La,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Cr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=N0(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function uv(i,t){i.asyncQueue.verifyOperationInProgress(),mt(La,"Initializing OfflineComponentProvider");const e=i.configuration;await t.initialize(e);let n=e.initialUser;i.setCredentialChangeListener((async s=>{n.isEqual(s)||(await kR(t.localStore,s),n=s)})),t.persistence.setDatabaseDeletedListener((()=>i.terminate())),i._offlineComponents=t}async function kS(i,t){i.asyncQueue.verifyOperationInProgress();const e=await _F(i);mt(La,"Initializing OnlineComponentProvider"),await t.initialize(e,i.configuration),i.setCredentialChangeListener((n=>xS(t.remoteStore,n))),i.setAppCheckTokenChangeListener(((n,s)=>xS(t.remoteStore,s))),i._onlineComponents=t}async function _F(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){mt(La,"Using user provided OfflineComponentProvider");try{await uv(i,i._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(s){return s.name==="FirebaseError"?s.code===ot.FAILED_PRECONDITION||s.code===ot.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(e))throw e;mc("Error using user provided cache. Falling back to memory cache: "+e),await uv(i,new Gp)}}else mt(La,"Using default OfflineComponentProvider"),await uv(i,new yF(void 0));return i._offlineComponents}async function eI(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(mt(La,"Using user provided OnlineComponentProvider"),await kS(i,i._uninitializedComponentsProvider._online)):(mt(La,"Using default OnlineComponentProvider"),await kS(i,new l_))),i._onlineComponents}function bF(i){return eI(i).then((t=>t.syncEngine))}async function nI(i){const t=await eI(i),e=t.eventManager;return e.onListen=sF.bind(null,t.syncEngine),e.onUnlisten=oF.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=rF.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=lF.bind(null,t.syncEngine),e}function AF(i,t,e={}){const n=new Cr;return i.asyncQueue.enqueueAndForget((async()=>(function(a,l,c,h,d){const p=new tI({next:v=>{p.Nu(),l.enqueueAndForget((()=>qR(a,m)));const b=v.docs.has(c);!b&&v.fromCache?d.reject(new pt(ot.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&v.fromCache&&h&&h.source==="server"?d.reject(new pt(ot.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(v)},error:v=>d.reject(v)}),m=new GR(_0(c.path),p,{includeMetadataChanges:!0,Ka:!0});return HR(a,m)})(await nI(i),i.asyncQueue,t,e,n))),n.promise}function EF(i,t,e={}){const n=new Cr;return i.asyncQueue.enqueueAndForget((async()=>(function(a,l,c,h,d){const p=new tI({next:v=>{p.Nu(),l.enqueueAndForget((()=>qR(a,m))),v.fromCache&&h.source==="server"?d.reject(new pt(ot.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(v)},error:v=>d.reject(v)}),m=new GR(c,p,{includeMetadataChanges:!0,Ka:!0});return HR(a,m)})(await nI(i),i.asyncQueue,t,e,n))),n.promise}function wF(i,t){const e=new Cr;return i.asyncQueue.enqueueAndForget((async()=>cF(await bF(i),t,e))),e.promise}function iI(i){const t={};return i.timeoutSeconds!==void 0&&(t.timeoutSeconds=i.timeoutSeconds),t}const TF="ComponentProvider",NS=new Map;function SF(i,t,e,n,s){return new $L(i,t,e,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,iI(s.experimentalLongPollingOptions),s.useFetchStreams,s.isUsingEmulator,n)}const sI="firestore.googleapis.com",OS=!0;class LS{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new pt(ot.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=sI,this.ssl=OS}else this.host=t.host,this.ssl=t.ssl??OS;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=PR;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<ZV)throw new pt(ot.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}OL("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=iI(t.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new pt(ot.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new pt(ot.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new pt(ot.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(n,s){return n.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Dm{constructor(t,e,n,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new LS({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new pt(ot.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new pt(ot.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new LS(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new SL;switch(n.type){case"firstParty":return new IL(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new pt(ot.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const n=NS.get(e);n&&(mt(TF,"Removing Datastore"),NS.delete(e),n.terminate())})(this),Promise.resolve()}}function CF(i,t,e,n={}){i=kr(i,Dm);const s=$o(t),a=i._getSettings(),l={...a,emulatorOptions:i._getEmulatorOptions()},c=`${t}:${e}`;s&&(o0(`https://${c}`),l0("Firestore",!0)),a.host!==sI&&a.host!==c&&mc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...a,host:c,ssl:s,emulatorOptions:n};if(!Vo(h,l)&&(i._setSettings(h),n.mockUserToken)){let d,p;if(typeof n.mockUserToken=="string")d=n.mockUserToken,p=Pn.MOCK_USER;else{d=Ix(n.mockUserToken,i._app?.options.projectId);const m=n.mockUserToken.sub||n.mockUserToken.user_id;if(!m)throw new pt(ot.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Pn(m)}i._authCredentials=new CL(new zx(d,p))}}class Pc{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Pc(this.firestore,t,this._query)}}class nn{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ia(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new nn(this.firestore,t,this._key)}toJSON(){return{type:nn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,n){if($h(e,nn._jsonSchema))return new nn(t,n||null,new xt(ge.fromString(e.referencePath)))}}nn._jsonSchemaVersion="firestore/documentReference/1.0",nn._jsonSchema={type:en("string",nn._jsonSchemaVersion),referencePath:en("string")};class Ia extends Pc{constructor(t,e,n){super(t,e,_0(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new nn(this.firestore,null,new xt(t))}withConverter(t){return new Ia(this.firestore,t,this._path)}}function xr(i,t,...e){if(i=qn(i),Hx("collection","path",t),i instanceof Dm){const n=ge.fromString(t,...e);return YT(n),new Ia(i,null,n)}{if(!(i instanceof nn||i instanceof Ia))throw new pt(ot.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(ge.fromString(t,...e));return YT(n),new Ia(i.firestore,null,n)}}function No(i,t,...e){if(i=qn(i),arguments.length===1&&(t=f0.newId()),Hx("doc","path",t),i instanceof Dm){const n=ge.fromString(t,...e);return KT(n),new nn(i,null,new xt(n))}{if(!(i instanceof nn||i instanceof Ia))throw new pt(ot.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(ge.fromString(t,...e));return KT(n),new nn(i.firestore,i instanceof Ia?i.converter:null,new xt(n))}}const VS="AsyncQueue";class BS{constructor(t=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new OR(this,"async_queue_retry"),this._c=()=>{const n=cv();n&&mt(VS,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=t;const e=cv();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=cv();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new Cr;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Yu.push(t),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(t){if(!Ic(t))throw t;mt(VS,"Operation failed with retryable error: "+t)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((n=>{throw this.nc=n,this.rc=!1,Mr("INTERNAL UNHANDLED ERROR: ",FS(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=e,e}enqueueAfterDelay(t,e,n){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const s=k0.createAndSchedule(this,t,e,n,(a=>this.hc(a)));return this.tc.push(s),s}uc(){this.nc&&Dt(47125,{Pc:FS(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,n)=>e.targetTimeMs-n.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}Rc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function FS(i){let t=i.message||"";return i.stack&&(t=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),t}class Mc extends Dm{constructor(t,e,n,s){super(t,e,n,s),this.type="firestore",this._queue=new BS,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new BS(t),this._firestoreClient=void 0,await t}}}function xF(i,t){const e=typeof i=="object"?i:h0(),n=typeof i=="string"?i:Lp,s=ym(e,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=Cx("firestore");a&&CF(s,...a)}return s}function B0(i){if(i._terminated)throw new pt(ot.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||RF(i),i._firestoreClient}function RF(i){const t=i._freezeSettings(),e=SF(i._databaseId,i._app?.options.appId||"",i._persistenceKey,i._app?.options.apiKey,t);i._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(i._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),i._firestoreClient=new vF(i._authCredentials,i._appCheckCredentials,i._queue,e,i._componentsProvider&&(function(s){const a=s?._online.build();return{_offline:s?._offline.build(a),_online:a}})(i._componentsProvider))}class Li{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Li(Rn.fromBase64String(t))}catch(e){throw new pt(ot.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new Li(Rn.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Li._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if($h(t,Li._jsonSchema))return Li.fromBase64String(t.bytes)}}Li._jsonSchemaVersion="firestore/bytes/1.0",Li._jsonSchema={type:en("string",Li._jsonSchemaVersion),bytes:en("string")};class rI{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new pt(ot.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xn(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class aI{constructor(t){this._methodName=t}}class Hs{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new pt(ot.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new pt(ot.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return $t(this._lat,t._lat)||$t(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Hs._jsonSchemaVersion}}static fromJSON(t){if($h(t,Hs._jsonSchema))return new Hs(t.latitude,t.longitude)}}Hs._jsonSchemaVersion="firestore/geoPoint/1.0",Hs._jsonSchema={type:en("string",Hs._jsonSchemaVersion),latitude:en("number"),longitude:en("number")};class as{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0})(this._values,t._values)}toJSON(){return{type:as._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if($h(t,as._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new as(t.vectorValues);throw new pt(ot.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}as._jsonSchemaVersion="firestore/vectorValue/1.0",as._jsonSchema={type:en("string",as._jsonSchemaVersion),vectorValues:en("object")};const IF=/^__.*__$/;class DF{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return this.fieldMask!==null?new Xo(t,this.data,this.fieldMask,e,this.fieldTransforms):new Kh(t,this.data,e,this.fieldTransforms)}}function oI(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Dt(40011,{dataSource:i})}}class F0{constructor(t,e,n,s,a,l){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.validatePath(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(t){return new F0({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(t){const e=this.path?.child(t),n=this.contextWith({path:e,arrayElement:!1});return n.validatePathSegment(t),n}childContextForFieldPath(t){const e=this.path?.child(t),n=this.contextWith({path:e,arrayElement:!1});return n.validatePath(),n}childContextForArray(t){return this.contextWith({path:void 0,arrayElement:!0})}createError(t){return $p(t,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(t){return this.fieldMask.find((e=>t.isPrefixOf(e)))!==void 0||this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))!==void 0}validatePath(){if(this.path)for(let t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))}validatePathSegment(t){if(t.length===0)throw this.createError("Document fields must not be empty");if(oI(this.dataSource)&&IF.test(t))throw this.createError('Document fields cannot begin and end with "__"')}}class PF{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||xm(t)}createContext(t,e,n,s=!1){return new F0({dataSource:t,methodName:e,targetDoc:n,path:xn.emptyPath(),arrayElement:!1,hasConverter:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function U0(i){const t=i._freezeSettings(),e=xm(i._databaseId);return new PF(i._databaseId,!!t.ignoreUndefinedProperties,e)}function lI(i,t,e,n,s,a={}){const l=i.createContext(a.merge||a.mergeFields?2:0,t,e,s);hI("Data must be an object, but it was:",l,n);const c=cI(n,l);let h,d;if(a.merge)h=new ns(l.fieldMask),d=l.fieldTransforms;else if(a.mergeFields){const p=[];for(const m of a.mergeFields){const v=Pm(t,m,e);if(!l.contains(v))throw new pt(ot.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);OF(p,v)||p.push(v)}h=new ns(p),d=l.fieldTransforms.filter((m=>h.covers(m.field)))}else h=null,d=l.fieldTransforms;return new DF(new Oi(c),h,d)}function MF(i,t,e,n=!1){return j0(e,i.createContext(n?4:3,t))}function j0(i,t){if(uI(i=qn(i)))return hI("Unsupported field value:",t,i),cI(i,t);if(i instanceof aI)return(function(n,s){if(!oI(s.dataSource))throw s.createError(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.createError(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)})(i,t),null;if(i===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),i instanceof Array){if(t.settings.arrayElement&&t.dataSource!==4)throw t.createError("Nested arrays are not supported");return(function(n,s){const a=[];let l=0;for(const c of n){let h=j0(c,s.childContextForArray(l));h==null&&(h={nullValue:"NULL_VALUE"}),a.push(h),l++}return{arrayValue:{values:a}}})(i,t)}return(function(n,s){if((n=qn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return yV(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=be.fromDate(n);return{timestampValue:zp(s.serializer,a)}}if(n instanceof be){const a=new be(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:zp(s.serializer,a)}}if(n instanceof Hs)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Li)return{bytesValue:wR(s.serializer,n._byteString)};if(n instanceof nn){const a=s.databaseId,l=n.firestore._databaseId;if(!l.isEqual(a))throw s.createError(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:T0(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof as)return(function(l,c){const h=l instanceof as?l.toArray():l;return{mapValue:{fields:{[Jx]:{stringValue:Zx},[Vp]:{arrayValue:{values:h.map((p=>{if(typeof p!="number")throw c.createError("VectorValues must only contain numeric values.");return b0(c.serializer,p)}))}}}}}})(n,s);if(DR(n))return n._toProto(s.serializer);throw s.createError(`Unsupported field value: ${vm(n)}`)})(i,t)}function cI(i,t){const e={};return $x(i)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ko(i,((n,s)=>{const a=j0(s,t.childContextForField(n));a!=null&&(e[n]=a)})),{mapValue:{fields:e}}}function uI(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof be||i instanceof Hs||i instanceof Li||i instanceof nn||i instanceof aI||i instanceof as||DR(i))}function hI(i,t,e){if(!uI(e)||!qx(e)){const n=vm(e);throw n==="an object"?t.createError(i+" a custom object"):t.createError(i+" "+n)}}function Pm(i,t,e){if((t=qn(t))instanceof rI)return t._internalPath;if(typeof t=="string")return NF(i,t);throw $p("Field path arguments must be of type string or ",i,!1,void 0,e)}const kF=new RegExp("[~\\*/\\[\\]]");function NF(i,t,e){if(t.search(kF)>=0)throw $p(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,e);try{return new rI(...t.split("."))._internalPath}catch{throw $p(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,e)}}function $p(i,t,e,n,s){const a=n&&!n.isEmpty(),l=s!==void 0;let c=`Function ${t}() called with invalid data`;e&&(c+=" (via `toFirestore()`)"),c+=". ";let h="";return(a||l)&&(h+=" (found",a&&(h+=` in field ${n}`),l&&(h+=` in document ${s}`),h+=")"),new pt(ot.INVALID_ARGUMENT,c+i+h)}function OF(i,t){return i.some((e=>e.isEqual(t)))}class LF{convertValue(t,e="none"){switch(Na(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ue(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(ka(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw Dt(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return Ko(t,((s,a)=>{n[s]=this.convertValue(a,e)})),n}convertVectorValue(t){const e=t.fields?.[Vp].arrayValue?.values?.map((n=>Ue(n.doubleValue)));return new as(e)}convertGeoPoint(t){return new Hs(Ue(t.latitude),Ue(t.longitude))}convertArray(t,e){return(t.values||[]).map((n=>this.convertValue(n,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=Am(t);return n==null?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(wh(t));default:return null}}convertTimestamp(t){const e=Ma(t);return new be(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=ge.fromString(t);re(IR(n),9688,{name:t});const s=new Th(n.get(1),n.get(3)),a=new xt(n.popFirst(5));return s.isEqual(e)||Mr(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),a}}class dI extends LF{constructor(t){super(),this.firestore=t}convertBytes(t){return new Li(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new nn(this.firestore,null,e)}}const US="@firebase/firestore",jS="4.10.0";class fI{constructor(t,e,n,s,a){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new nn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new VF(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(t){if(this._document){const e=this._document.data.field(Pm("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class VF extends fI{data(){return super.data()}}function BF(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new pt(ot.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class z0{}class FF extends z0{}function Wp(i,t,...e){let n=[];t instanceof z0&&n.push(t),n=n.concat(e),(function(a){const l=a.filter((h=>h instanceof H0)).length,c=a.filter((h=>h instanceof Mm)).length;if(l>1||l>0&&c>0)throw new pt(ot.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const s of n)i=s._apply(i);return i}class Mm extends FF{constructor(t,e,n){super(),this._field=t,this._op=e,this._value=n,this.type="where"}static _create(t,e,n){return new Mm(t,e,n)}_apply(t){const e=this._parse(t);return pI(t._query,e),new Pc(t.firestore,t.converter,Jv(t._query,e))}_parse(t){const e=U0(t.firestore);return(function(a,l,c,h,d,p,m){let v;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new pt(ot.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){HS(m,p);const w=[];for(const E of m)w.push(zS(h,a,E));v={arrayValue:{values:w}}}else v=zS(h,a,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||HS(m,p),v=MF(c,l,m,p==="in"||p==="not-in");return tn.create(d,p,v)})(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}}function Kp(i,t,e){const n=t,s=Pm("where",i);return Mm._create(s,n,e)}class H0 extends z0{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new H0(t,e)}_parse(t){const e=this._queryConstraints.map((n=>n._parse(t))).filter((n=>n.getFilters().length>0));return e.length===1?e[0]:ls.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return e.getFilters().length===0?t:((function(s,a){let l=s;const c=a.getFlattenedFilters();for(const h of c)pI(l,h),l=Jv(l,h)})(t._query,e),new Pc(t.firestore,t.converter,Jv(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function zS(i,t,e){if(typeof(e=qn(e))=="string"){if(e==="")throw new pt(ot.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!oR(t)&&e.indexOf("/")!==-1)throw new pt(ot.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const n=t.path.child(ge.fromString(e));if(!xt.isDocumentKey(n))throw new pt(ot.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return iS(i,new xt(n))}if(e instanceof nn)return iS(i,e._key);throw new pt(ot.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${vm(e)}.`)}function HS(i,t){if(!Array.isArray(i)||i.length===0)throw new pt(ot.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function pI(i,t){const e=(function(s,a){for(const l of s)for(const c of l.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null})(i.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(t.op));if(e!==null)throw e===t.op?new pt(ot.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new pt(ot.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}function mI(i,t,e){let n;return n=i?e&&(e.merge||e.mergeFields)?i.toFirestore(t,e):i.toFirestore(t):t,n}class nh{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Oo extends fI{constructor(t,e,n,s,a,l){super(t,e,n,s,l),this._firestore=t,this._firestoreImpl=t,this.metadata=a}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new vp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(Pm("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new pt(ot.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=Oo._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}Oo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Oo._jsonSchema={type:en("string",Oo._jsonSchemaVersion),bundleSource:en("string","DocumentSnapshot"),bundleName:en("string"),bundle:en("string")};class vp extends Oo{data(t={}){return super.data(t)}}class rc{constructor(t,e,n,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new nh(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new vp(this._firestore,this._userDataWriter,n.key,n,new nh(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new pt(ot.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(s,a){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map((c=>{const h=new vp(s._firestore,s._userDataWriter,c.doc.key,c.doc,new nh(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:h,oldIndex:-1,newIndex:l++}}))}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>a||c.type!==3)).map((c=>{const h=new vp(s._firestore,s._userDataWriter,c.doc.key,c.doc,new nh(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,p=-1;return c.type!==0&&(d=l.indexOf(c.doc.key),l=l.delete(c.doc.key)),c.type!==1&&(l=l.add(c.doc),p=l.indexOf(c.doc.key)),{type:UF(c.type),doc:h,oldIndex:d,newIndex:p}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new pt(ot.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=rc._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=f0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],n=[],s=[];return this.docs.forEach((a=>{a._document!==null&&(e.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function UF(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Dt(61501,{type:i})}}rc._jsonSchemaVersion="firestore/querySnapshot/1.0",rc._jsonSchema={type:en("string",rc._jsonSchemaVersion),bundleSource:en("string","QuerySnapshot"),bundleName:en("string"),bundle:en("string")};function gI(i){i=kr(i,nn);const t=kr(i.firestore,Mc),e=B0(t);return AF(e,i._key).then((n=>zF(t,i,n)))}function Rh(i){i=kr(i,Pc);const t=kr(i.firestore,Mc),e=B0(t),n=new dI(t);return BF(i._query),EF(e,i._query).then((s=>new rc(t,n,i,s)))}function c_(i,t,e){i=kr(i,nn);const n=kr(i.firestore,Mc),s=mI(i.converter,t,e),a=U0(n);return q0(n,[lI(a,"setDoc",i._key,s,i.converter!==null,e).toMutation(i._key,rs.none())])}function jF(i){return q0(kr(i.firestore,Mc),[new A0(i._key,rs.none())])}function _p(i,t){const e=kr(i.firestore,Mc),n=No(i),s=mI(i.converter,t),a=U0(i.firestore);return q0(e,[lI(a,"addDoc",n._key,s,i.converter!==null,{}).toMutation(n._key,rs.exists(!1))]).then((()=>n))}function q0(i,t){const e=B0(i);return wF(e,t)}function zF(i,t,e){const n=e.docs.get(t._key),s=new dI(i);return new Oo(i,s,t._key,n,new nh(e.hasPendingWrites,e.fromCache),t.converter)}(function(t,e=!0){TL(Wo),Bo(new Da("firestore",((n,{instanceIdentifier:s,options:a})=>{const l=n.getProvider("app").getImmediate(),c=new Mc(new xL(n.getProvider("auth-internal")),new DL(l,n.getProvider("app-check-internal")),WL(l,s),l);return a={useFetchStreams:e,...a},c._setSettings(a),c}),"PUBLIC").setMultipleInstances(!0)),Us(US,jS,t),Us(US,jS,"esm2020")})();const yI="firebasestorage.googleapis.com",HF="storageBucket",qF=120*1e3,GF=600*1e3;class Qs extends Xs{constructor(t,e,n=0){super(hv(t),`Firebase Storage: ${e} (${hv(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Qs.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return hv(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ws;(function(i){i.UNKNOWN="unknown",i.OBJECT_NOT_FOUND="object-not-found",i.BUCKET_NOT_FOUND="bucket-not-found",i.PROJECT_NOT_FOUND="project-not-found",i.QUOTA_EXCEEDED="quota-exceeded",i.UNAUTHENTICATED="unauthenticated",i.UNAUTHORIZED="unauthorized",i.UNAUTHORIZED_APP="unauthorized-app",i.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",i.INVALID_CHECKSUM="invalid-checksum",i.CANCELED="canceled",i.INVALID_EVENT_NAME="invalid-event-name",i.INVALID_URL="invalid-url",i.INVALID_DEFAULT_BUCKET="invalid-default-bucket",i.NO_DEFAULT_BUCKET="no-default-bucket",i.CANNOT_SLICE_BLOB="cannot-slice-blob",i.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",i.NO_DOWNLOAD_URL="no-download-url",i.INVALID_ARGUMENT="invalid-argument",i.INVALID_ARGUMENT_COUNT="invalid-argument-count",i.APP_DELETED="app-deleted",i.INVALID_ROOT_OPERATION="invalid-root-operation",i.INVALID_FORMAT="invalid-format",i.INTERNAL_ERROR="internal-error",i.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ws||(Ws={}));function hv(i){return"storage/"+i}function $F(){const i="An unknown error occurred, please check the error payload for server response.";return new Qs(Ws.UNKNOWN,i)}function WF(){return new Qs(Ws.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function KF(){return new Qs(Ws.CANCELED,"User canceled the upload/download.")}function YF(i){return new Qs(Ws.INVALID_URL,"Invalid URL '"+i+"'.")}function XF(i){return new Qs(Ws.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}function qS(i){return new Qs(Ws.INVALID_ARGUMENT,i)}function vI(){return new Qs(Ws.APP_DELETED,"The Firebase app was deleted.")}function QF(i){return new Qs(Ws.INVALID_ROOT_OPERATION,"The operation '"+i+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class is{constructor(t,e){this.bucket=t,this.path_=e}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let n;try{n=is.makeFromUrl(t,e)}catch{return new is(t,"")}if(n.path==="")return n;throw XF(t)}static makeFromUrl(t,e){let n=null;const s="([A-Za-z0-9.\\-_]+)";function a(B){B.path.charAt(B.path.length-1)==="/"&&(B.path_=B.path_.slice(0,-1))}const l="(/(.*))?$",c=new RegExp("^gs://"+s+l,"i"),h={bucket:1,path:3};function d(B){B.path_=decodeURIComponent(B.path)}const p="v[A-Za-z0-9_]+",m=e.replace(/[.]/g,"\\."),v="(/([^?#]*).*)?$",b=new RegExp(`^https?://${m}/${p}/b/${s}/o${v}`,"i"),w={bucket:1,path:3},E=e===yI?"(?:storage.googleapis.com|storage.cloud.google.com)":e,S="([^?#]*)",C=new RegExp(`^https?://${E}/${s}/${S}`,"i"),I=[{regex:c,indices:h,postModify:a},{regex:b,indices:w,postModify:d},{regex:C,indices:{bucket:1,path:2},postModify:d}];for(let B=0;B<I.length;B++){const F=I[B],j=F.regex.exec(t);if(j){const P=j[F.indices.bucket];let D=j[F.indices.path];D||(D=""),n=new is(P,D),F.postModify(n);break}}if(n==null)throw YF(t);return n}}class JF{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function ZF(i,t,e){let n=1,s=null,a=null,l=!1,c=0;function h(){return c===2}let d=!1;function p(...S){d||(d=!0,t.apply(null,S))}function m(S){s=setTimeout(()=>{s=null,i(b,h())},S)}function v(){a&&clearTimeout(a)}function b(S,...C){if(d){v();return}if(S){v(),p.call(null,S,...C);return}if(h()||l){v(),p.call(null,S,...C);return}n<64&&(n*=2);let I;c===1?(c=2,I=0):I=(n+Math.random())*1e3,m(I)}let w=!1;function E(S){w||(w=!0,v(),!d&&(s!==null?(S||(c=2),clearTimeout(s),m(0)):S||(c=1)))}return m(0),a=setTimeout(()=>{l=!0,E(!0)},e),E}function t3(i){i(!1)}function e3(i){return i!==void 0}function GS(i,t,e,n){if(n<t)throw qS(`Invalid value for '${i}'. Expected ${t} or greater.`);if(n>e)throw qS(`Invalid value for '${i}'. Expected ${e} or less.`)}function n3(i){const t=encodeURIComponent;let e="?";for(const n in i)if(i.hasOwnProperty(n)){const s=t(n)+"="+t(i[n]);e=e+s+"&"}return e=e.slice(0,-1),e}var Yp;(function(i){i[i.NO_ERROR=0]="NO_ERROR",i[i.NETWORK_ERROR=1]="NETWORK_ERROR",i[i.ABORT=2]="ABORT"})(Yp||(Yp={}));function i3(i,t){const e=i>=500&&i<600,s=[408,429].indexOf(i)!==-1,a=t.indexOf(i)!==-1;return e||s||a}class s3{constructor(t,e,n,s,a,l,c,h,d,p,m,v=!0,b=!1){this.url_=t,this.method_=e,this.headers_=n,this.body_=s,this.successCodes_=a,this.additionalRetryCodes_=l,this.callback_=c,this.errorCallback_=h,this.timeout_=d,this.progressCallback_=p,this.connectionFactory_=m,this.retry=v,this.isUsingEmulator=b,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,E)=>{this.resolve_=w,this.reject_=E,this.start_()})}start_(){const t=(n,s)=>{if(s){n(!1,new Yf(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const l=c=>{const h=c.loaded,d=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,d)};this.progressCallback_!==null&&a.addUploadProgressListener(l),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(l),this.pendingConnection_=null;const c=a.getErrorCode()===Yp.NO_ERROR,h=a.getStatus();if(!c||i3(h,this.additionalRetryCodes_)&&this.retry){const p=a.getErrorCode()===Yp.ABORT;n(!1,new Yf(!1,null,p));return}const d=this.successCodes_.indexOf(h)!==-1;n(!0,new Yf(d,a))})},e=(n,s)=>{const a=this.resolve_,l=this.reject_,c=s.connection;if(s.wasSuccessCode)try{const h=this.callback_(c,c.getResponse());e3(h)?a(h):a()}catch(h){l(h)}else if(c!==null){const h=$F();h.serverResponse=c.getErrorText(),this.errorCallback_?l(this.errorCallback_(c,h)):l(h)}else if(s.canceled){const h=this.appDelete_?vI():KF();l(h)}else{const h=WF();l(h)}};this.canceled_?e(!1,new Yf(!1,null,!0)):this.backoffId_=ZF(t,e,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&t3(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Yf{constructor(t,e,n){this.wasSuccessCode=t,this.connection=e,this.canceled=!!n}}function r3(i,t){t!==null&&t.length>0&&(i.Authorization="Firebase "+t)}function a3(i,t){i["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function o3(i,t){t&&(i["X-Firebase-GMPID"]=t)}function l3(i,t){t!==null&&(i["X-Firebase-AppCheck"]=t)}function c3(i,t,e,n,s,a,l=!0,c=!1){const h=n3(i.urlParams),d=i.url+h,p=Object.assign({},i.headers);return o3(p,t),r3(p,e),a3(p,a),l3(p,n),new s3(d,i.method,p,i.body,i.successCodes,i.additionalRetryCodes,i.handler,i.errorHandler,i.timeout,i.progressCallback,s,l,c)}function u3(i){if(i.length===0)return null;const t=i.lastIndexOf("/");return t===-1?"":i.slice(0,t)}function h3(i){const t=i.lastIndexOf("/",i.length-2);return t===-1?i:i.slice(t+1)}class Xp{constructor(t,e){this._service=t,e instanceof is?this._location=e:this._location=is.makeFromUrl(e,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,e){return new Xp(t,e)}get root(){const t=new is(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return h3(this._location.path)}get storage(){return this._service}get parent(){const t=u3(this._location.path);if(t===null)return null;const e=new is(this._location.bucket,t);return new Xp(this._service,e)}_throwIfRoot(t){if(this._location.path==="")throw QF(t)}}function $S(i,t){const e=t?.[HF];return e==null?null:is.makeFromBucketSpec(e,i)}function d3(i,t,e,n={}){i.host=`${t}:${e}`;const s=$o(t);s&&(o0(`https://${i.host}/b`),l0("Storage",!0)),i._isUsingEmulator=!0,i._protocol=s?"https":"http";const{mockUserToken:a}=n;a&&(i._overrideAuthToken=typeof a=="string"?a:Ix(a,i.app.options.projectId))}class f3{constructor(t,e,n,s,a,l=!1){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._url=s,this._firebaseVersion=a,this._isUsingEmulator=l,this._bucket=null,this._host=yI,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=qF,this._maxUploadRetryTime=GF,this._requests=new Set,s!=null?this._bucket=is.makeFromBucketSpec(s,this._host):this._bucket=$S(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=is.makeFromBucketSpec(this._url,t):this._bucket=$S(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){GS("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){GS("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const e=await t.getToken();if(e!==null)return e.accessToken}return null}async _getAppCheckToken(){if(ni(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Xp(this,t)}_makeRequest(t,e,n,s,a=!0){if(this._deleted)return new JF(vI());{const l=c3(t,this._appId,n,s,e,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(t,e){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,e,n,s).getPromise()}}const WS="@firebase/storage",KS="0.14.0";const _I="storage";function p3(i=h0(),t){i=qn(i);const n=ym(i,_I).getImmediate({identifier:t}),s=Cx("storage");return s&&m3(n,...s),n}function m3(i,t,e,n={}){d3(i,t,e,n)}function g3(i,{instanceIdentifier:t}){const e=i.getProvider("app").getImmediate(),n=i.getProvider("auth-internal"),s=i.getProvider("app-check-internal");return new f3(e,n,s,t,Wo)}function y3(){Bo(new Da(_I,g3,"PUBLIC").setMultipleInstances(!0)),Us(WS,KS,""),Us(WS,KS,"esm2020")}y3();function bI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const v3=bI,AI=new qh("auth","Firebase",bI());const Qp=new c0("@firebase/auth");function _3(i,...t){Qp.logLevel<=Gt.WARN&&Qp.warn(`Auth (${Wo}): ${i}`,...t)}function bp(i,...t){Qp.logLevel<=Gt.ERROR&&Qp.error(`Auth (${Wo}): ${i}`,...t)}function Fi(i,...t){throw $0(i,...t)}function os(i,...t){return $0(i,...t)}function G0(i,t,e){const n={...v3(),[t]:e};return new qh("auth","Firebase",n).create(t,{appName:i.name})}function Rr(i){return G0(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function b3(i,t,e){const n=e;if(!(t instanceof n))throw n.name!==t.constructor.name&&Fi(i,"argument-error"),G0(i,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function $0(i,...t){if(typeof i!="string"){const e=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=i.name),i._errorFactory.create(e,...n)}return AI.create(i,...t)}function It(i,t,...e){if(!i)throw $0(t,...e)}function wr(i){const t="INTERNAL ASSERTION FAILED: "+i;throw bp(t),new Error(t)}function Or(i,t){i||wr(t)}function u_(){return typeof self<"u"&&self.location?.href||""}function A3(){return YS()==="http:"||YS()==="https:"}function YS(){return typeof self<"u"&&self.location?.protocol||null}function E3(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(A3()||eO()||"connection"in navigator)?navigator.onLine:!0}function w3(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}class Jh{constructor(t,e){this.shortDelay=t,this.longDelay=e,Or(e>t,"Short delay should be less than long delay!"),this.isMobile=JN()||nO()}get(){return E3()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function W0(i,t){Or(i.emulator,"Emulator should always be set here");const{url:e}=i.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class EI{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;wr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;wr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;wr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const T3={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const S3=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],C3=new Jh(3e4,6e4);function za(i,t){return i.tenantId&&!t.tenantId?{...t,tenantId:i.tenantId}:t}async function Ha(i,t,e,n,s={}){return wI(i,s,async()=>{let a={},l={};n&&(t==="GET"?l=n:a={body:JSON.stringify(n)});const c=Gh({key:i.config.apiKey,...l}).slice(1),h=await i._getAdditionalHeaders();h["Content-Type"]="application/json",i.languageCode&&(h["X-Firebase-Locale"]=i.languageCode);const d={method:t,headers:h,...a};return tO()||(d.referrerPolicy="no-referrer"),i.emulatorConfig&&$o(i.emulatorConfig.host)&&(d.credentials="include"),EI.fetch()(await TI(i,i.config.apiHost,e,c),d)})}async function wI(i,t,e){i._canInitEmulator=!1;const n={...T3,...t};try{const s=new R3(i),a=await Promise.race([e(),s.promise]);s.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw Xf(i,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const c=a.ok?l.errorMessage:l.error.message,[h,d]=c.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xf(i,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw Xf(i,"email-already-in-use",l);if(h==="USER_DISABLED")throw Xf(i,"user-disabled",l);const p=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw G0(i,p,d);Fi(i,p)}}catch(s){if(s instanceof Xs)throw s;Fi(i,"network-request-failed",{message:String(s)})}}async function Zh(i,t,e,n,s={}){const a=await Ha(i,t,e,n,s);return"mfaPendingCredential"in a&&Fi(i,"multi-factor-auth-required",{_serverResponse:a}),a}async function TI(i,t,e,n){const s=`${t}${e}?${n}`,a=i,l=a.config.emulator?W0(i.config,s):`${i.config.apiScheme}://${s}`;return S3.includes(e)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}function x3(i){switch(i){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class R3{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,n)=>{this.timer=setTimeout(()=>n(os(this.auth,"network-request-failed")),C3.get())})}}function Xf(i,t,e){const n={appName:i.name};e.email&&(n.email=e.email),e.phoneNumber&&(n.phoneNumber=e.phoneNumber);const s=os(i,t,n);return s.customData._tokenResponse=e,s}function XS(i){return i!==void 0&&i.enterprise!==void 0}class I3{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return x3(e.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function D3(i,t){return Ha(i,"GET","/v2/recaptchaConfig",za(i,t))}async function P3(i,t){return Ha(i,"POST","/v1/accounts:delete",t)}async function Jp(i,t){return Ha(i,"POST","/v1/accounts:lookup",t)}function fh(i){if(i)try{const t=new Date(Number(i));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function M3(i,t=!1){const e=qn(i),n=await e.getIdToken(t),s=K0(n);It(s&&s.exp&&s.auth_time&&s.iat,e.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,l=a?.sign_in_provider;return{claims:s,token:n,authTime:fh(dv(s.auth_time)),issuedAtTime:fh(dv(s.iat)),expirationTime:fh(dv(s.exp)),signInProvider:l||null,signInSecondFactor:a?.sign_in_second_factor||null}}function dv(i){return Number(i)*1e3}function K0(i){const[t,e,n]=i.split(".");if(t===void 0||e===void 0||n===void 0)return bp("JWT malformed, contained fewer than 3 sections"),null;try{const s=Tx(e);return s?JSON.parse(s):(bp("Failed to decode base64 JWT payload"),null)}catch(s){return bp("Caught error parsing JWT payload as JSON",s?.toString()),null}}function QS(i){const t=K0(i);return It(t,"internal-error"),It(typeof t.exp<"u","internal-error"),It(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}async function Ih(i,t,e=!1){if(e)return t;try{return await t}catch(n){throw n instanceof Xs&&k3(n)&&i.auth.currentUser===i&&await i.auth.signOut(),n}}function k3({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}class N3{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const e=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),e}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){t?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class h_{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=fh(this.lastLoginAt),this.creationTime=fh(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Zp(i){const t=i.auth,e=await i.getIdToken(),n=await Ih(i,Jp(t,{idToken:e}));It(n?.users.length,t,"internal-error");const s=n.users[0];i._notifyReloadListener(s);const a=s.providerUserInfo?.length?SI(s.providerUserInfo):[],l=L3(i.providerData,a),c=i.isAnonymous,h=!(i.email&&s.passwordHash)&&!l?.length,d=c?h:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new h_(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(i,p)}async function O3(i){const t=qn(i);await Zp(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function L3(i,t){return[...i.filter(n=>!t.some(s=>s.providerId===n.providerId)),...t]}function SI(i){return i.map(({providerId:t,...e})=>({providerId:t,uid:e.rawId||"",displayName:e.displayName||null,email:e.email||null,phoneNumber:e.phoneNumber||null,photoURL:e.photoUrl||null}))}async function V3(i,t){const e=await wI(i,{},async()=>{const n=Gh({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:a}=i.config,l=await TI(i,s,"/v1/token",`key=${a}`),c=await i._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:c,body:n};return i.emulatorConfig&&$o(i.emulatorConfig.host)&&(h.credentials="include"),EI.fetch()(l,h)});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function B3(i,t){return Ha(i,"POST","/v2/accounts:revokeToken",za(i,t))}class ac{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){It(t.idToken,"internal-error"),It(typeof t.idToken<"u","internal-error"),It(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):QS(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){It(t.length!==0,"internal-error");const e=QS(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:(It(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:s,expiresIn:a}=await V3(t,e);this.updateTokensAndExpiration(n,s,Number(a))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(t,e){const{refreshToken:n,accessToken:s,expirationTime:a}=e,l=new ac;return n&&(It(typeof n=="string","internal-error",{appName:t}),l.refreshToken=n),s&&(It(typeof s=="string","internal-error",{appName:t}),l.accessToken=s),a&&(It(typeof a=="number","internal-error",{appName:t}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new ac,this.toJSON())}_performRefresh(){return wr("not implemented")}}function ga(i,t){It(typeof i=="string"||typeof i>"u","internal-error",{appName:t})}class ss{constructor({uid:t,auth:e,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new N3(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=e,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new h_(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const e=await Ih(this,this.stsTokenManager.getToken(this.auth,t));return It(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return M3(this,t)}reload(){return O3(this)}_assign(t){this!==t&&(It(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>({...e})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new ss({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return e.metadata._copy(this.metadata),e}_onReload(t){It(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await Zp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ni(this.auth.app))return Promise.reject(Rr(this.auth));const t=await this.getIdToken();return await Ih(this,P3(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){const n=e.displayName??void 0,s=e.email??void 0,a=e.phoneNumber??void 0,l=e.photoURL??void 0,c=e.tenantId??void 0,h=e._redirectEventId??void 0,d=e.createdAt??void 0,p=e.lastLoginAt??void 0,{uid:m,emailVerified:v,isAnonymous:b,providerData:w,stsTokenManager:E}=e;It(m&&E,t,"internal-error");const S=ac.fromJSON(this.name,E);It(typeof m=="string",t,"internal-error"),ga(n,t.name),ga(s,t.name),It(typeof v=="boolean",t,"internal-error"),It(typeof b=="boolean",t,"internal-error"),ga(a,t.name),ga(l,t.name),ga(c,t.name),ga(h,t.name),ga(d,t.name),ga(p,t.name);const C=new ss({uid:m,auth:t,email:s,emailVerified:v,displayName:n,isAnonymous:b,photoURL:l,phoneNumber:a,tenantId:c,stsTokenManager:S,createdAt:d,lastLoginAt:p});return w&&Array.isArray(w)&&(C.providerData=w.map(R=>({...R}))),h&&(C._redirectEventId=h),C}static async _fromIdTokenResponse(t,e,n=!1){const s=new ac;s.updateFromServerResponse(e);const a=new ss({uid:e.localId,auth:t,stsTokenManager:s,isAnonymous:n});return await Zp(a),a}static async _fromGetAccountInfoResponse(t,e,n){const s=e.users[0];It(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?SI(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!a?.length,c=new ac;c.updateFromIdToken(n);const h=new ss({uid:s.localId,auth:t,stsTokenManager:c,isAnonymous:l}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new h_(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!a?.length};return Object.assign(h,d),h}}const JS=new Map;function Tr(i){Or(i instanceof Function,"Expected a class definition");let t=JS.get(i);return t?(Or(t instanceof i,"Instance stored in cache mismatched with class"),t):(t=new i,JS.set(i,t),t)}class CI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}CI.type="NONE";const ZS=CI;function Ap(i,t,e){return`firebase:${i}:${t}:${e}`}class oc{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:s,name:a}=this.auth;this.fullUserKey=Ap(this.userKey,s.apiKey,a),this.fullPersistenceKey=Ap("persistence",s.apiKey,a),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const e=await Jp(this.auth,{idToken:t}).catch(()=>{});return e?ss._fromGetAccountInfoResponse(this.auth,e,t):null}return ss._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new oc(Tr(ZS),t,n);const s=(await Promise.all(e.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=s[0]||Tr(ZS);const l=Ap(n,t.config.apiKey,t.name);let c=null;for(const d of e)try{const p=await d._get(l);if(p){let m;if(typeof p=="string"){const v=await Jp(t,{idToken:p}).catch(()=>{});if(!v)break;m=await ss._fromGetAccountInfoResponse(t,v,p)}else m=ss._fromJSON(t,p);d!==a&&(c=m),a=d;break}}catch{}const h=s.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!h.length?new oc(a,t,n):(a=h[0],c&&await a._set(l,c.toJSON()),await Promise.all(e.map(async d=>{if(d!==a)try{await d._remove(l)}catch{}})),new oc(a,t,n))}}function t1(i){const t=i.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(DI(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(xI(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(MI(t))return"Blackberry";if(kI(t))return"Webos";if(RI(t))return"Safari";if((t.includes("chrome/")||II(t))&&!t.includes("edge/"))return"Chrome";if(PI(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=i.match(e);if(n?.length===2)return n[1]}return"Other"}function xI(i=Nn()){return/firefox\//i.test(i)}function RI(i=Nn()){const t=i.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function II(i=Nn()){return/crios\//i.test(i)}function DI(i=Nn()){return/iemobile/i.test(i)}function PI(i=Nn()){return/android/i.test(i)}function MI(i=Nn()){return/blackberry/i.test(i)}function kI(i=Nn()){return/webos/i.test(i)}function Y0(i=Nn()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function F3(i=Nn()){return Y0(i)&&!!window.navigator?.standalone}function U3(){return iO()&&document.documentMode===10}function NI(i=Nn()){return Y0(i)||PI(i)||kI(i)||MI(i)||/windows phone/i.test(i)||DI(i)}function OI(i,t=[]){let e;switch(i){case"Browser":e=t1(Nn());break;case"Worker":e=`${t1(Nn())}-${i}`;break;default:e=i}const n=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${Wo}/${n}`}class j3{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=a=>new Promise((l,c)=>{try{const h=t(a);l(h)}catch(h){c(h)}});n.onAbort=e,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(n){e.reverse();for(const s of e)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function z3(i,t={}){return Ha(i,"GET","/v2/passwordPolicy",za(i,t))}const H3=6;class q3{constructor(t){const e=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=e.minPasswordLength??H3,e.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=e.maxPasswordLength),e.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=e.containsLowercaseCharacter),e.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=e.containsUppercaseCharacter),e.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=e.containsNumericCharacter),e.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=e.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=t.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const e={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,e),this.validatePasswordCharacterOptions(t,e),e.isValid&&(e.isValid=e.meetsMinPasswordLength??!0),e.isValid&&(e.isValid=e.meetsMaxPasswordLength??!0),e.isValid&&(e.isValid=e.containsLowercaseLetter??!0),e.isValid&&(e.isValid=e.containsUppercaseLetter??!0),e.isValid&&(e.isValid=e.containsNumericCharacter??!0),e.isValid&&(e.isValid=e.containsNonAlphanumericCharacter??!0),e}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),s&&(e.meetsMaxPasswordLength=t.length<=s)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let n;for(let s=0;s<t.length;s++)n=t.charAt(s),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,s,a){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=a))}}class G3{constructor(t,e,n,s){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new e1(this),this.idTokenSubscription=new e1(this),this.beforeStateQueue=new j3(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=AI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=Tr(e)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await oc.create(this,t),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await Jp(this,{idToken:t}),n=await ss._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){if(ni(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const e=await this.assertedPersistence.getCurrentUser();let n=e,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,l=n?._redirectEventId,c=await this.tryRedirectSignIn(t);(!a||a===l)&&c?.user&&(n=c.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=e,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return It(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await Zp(t)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=w3()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(ni(this.app))return Promise.reject(Rr(this));const e=t?qn(t):null;return e&&It(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&It(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return ni(this.app)?Promise.reject(Rr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return ni(this.app)?Promise.reject(Rr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Tr(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await z3(this),e=new q3(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new qh("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(n.tenantId=this.tenantId),await B3(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return t===null?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&Tr(t)||this._popupRedirectResolver;It(e,this,"argument-error"),this.redirectPersistenceManager=await oc.create(this,[Tr(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===t?this._currentUser:this.redirectUser?._redirectEventId===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=this.currentUser?.uid??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,s){if(this._deleted)return()=>{};const a=typeof e=="function"?e:e.next.bind(e);let l=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(It(c,this,"internal-error"),c.then(()=>{l||a(this.currentUser)}),typeof e=="function"){const h=t.addObserver(e,n,s);return()=>{l=!0,h()}}else{const h=t.addObserver(e);return()=>{l=!0,h()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return It(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=OI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const e=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();e&&(t["X-Firebase-Client"]=e);const n=await this._getAppCheckToken();return n&&(t["X-Firebase-AppCheck"]=n),t}async _getAppCheckToken(){if(ni(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return t?.error&&_3(`Error while retrieving App Check token: ${t.error}`),t?.token}}function qa(i){return qn(i)}class e1{constructor(t){this.auth=t,this.observer=null,this.addObserver=hO(e=>this.observer=e)}get next(){return It(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let km={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $3(i){km=i}function LI(i){return km.loadJS(i)}function W3(){return km.recaptchaEnterpriseScript}function K3(){return km.gapiScript}function Y3(i){return`__${i}${Math.floor(Math.random()*1e6)}`}class X3{constructor(){this.enterprise=new Q3}ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}class Q3{ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}const J3="recaptcha-enterprise",VI="NO_RECAPTCHA";class Z3{constructor(t){this.type=J3,this.auth=qa(t)}async verify(t="verify",e=!1){async function n(a){if(!e){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(l,c)=>{D3(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new I3(h);return a.tenantId==null?a._agentRecaptchaConfig=d:a._tenantRecaptchaConfigs[a.tenantId]=d,l(d.siteKey)}}).catch(h=>{c(h)})})}function s(a,l,c){const h=window.grecaptcha;XS(h)?h.enterprise.ready(()=>{h.enterprise.execute(a,{action:t}).then(d=>{l(d)}).catch(()=>{l(VI)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new X3().execute("siteKey",{action:"verify"}):new Promise((a,l)=>{n(this.auth).then(c=>{if(!e&&XS(window.grecaptcha))s(c,a,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let h=W3();h.length!==0&&(h+=c),LI(h).then(()=>{s(c,a,l)}).catch(d=>{l(d)})}}).catch(c=>{l(c)})})}}async function n1(i,t,e,n=!1,s=!1){const a=new Z3(i);let l;if(s)l=VI;else try{l=await a.verify(e)}catch{l=await a.verify(e,!0)}const c={...t};if(e==="mfaSmsEnrollment"||e==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const h=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:d,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const h=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return n?Object.assign(c,{captchaResp:l}):Object.assign(c,{captchaResponse:l}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function d_(i,t,e,n,s){if(i._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await n1(i,t,e,e==="getOobCode");return n(i,a)}else return n(i,t).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${e} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await n1(i,t,e,e==="getOobCode");return n(i,l)}else return Promise.reject(a)})}function tU(i,t){const e=ym(i,"auth");if(e.isInitialized()){const s=e.getImmediate(),a=e.getOptions();if(Vo(a,t??{}))return s;Fi(s,"already-initialized")}return e.initialize({options:t})}function eU(i,t){const e=t?.persistence||[],n=(Array.isArray(e)?e:[e]).map(Tr);t?.errorMap&&i._updateErrorMap(t.errorMap),i._initializeWithPersistence(n,t?.popupRedirectResolver)}function nU(i,t,e){const n=qa(i);It(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const s=!1,a=BI(t),{host:l,port:c}=iU(t),h=c===null?"":`:${c}`,d={url:`${a}//${l}${h}/`},p=Object.freeze({host:l,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){It(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),It(Vo(d,n.config.emulator)&&Vo(p,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=p,n.settings.appVerificationDisabledForTesting=!0,$o(l)?(o0(`${a}//${l}${h}`),l0("Auth",!0)):sU()}function BI(i){const t=i.indexOf(":");return t<0?"":i.substr(0,t+1)}function iU(i){const t=BI(i),e=/(\/\/)?([^?#/]+)/.exec(i.substr(t.length));if(!e)return{host:"",port:null};const n=e[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const a=s[1];return{host:a,port:i1(n.substr(a.length+1))}}else{const[a,l]=n.split(":");return{host:a,port:i1(l)}}}function i1(i){if(!i)return null;const t=Number(i);return isNaN(t)?null:t}function sU(){function i(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}class X0{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return wr("not implemented")}_getIdTokenResponse(t){return wr("not implemented")}_linkToIdToken(t,e){return wr("not implemented")}_getReauthenticationResolver(t){return wr("not implemented")}}async function rU(i,t){return Ha(i,"POST","/v1/accounts:signUp",t)}async function aU(i,t){return Zh(i,"POST","/v1/accounts:signInWithPassword",za(i,t))}async function oU(i,t){return Zh(i,"POST","/v1/accounts:signInWithEmailLink",za(i,t))}async function lU(i,t){return Zh(i,"POST","/v1/accounts:signInWithEmailLink",za(i,t))}class Dh extends X0{constructor(t,e,n,s=null){super("password",n),this._email=t,this._password=e,this._tenantId=s}static _fromEmailAndPassword(t,e){return new Dh(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new Dh(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t;if(e?.email&&e?.password){if(e.signInMethod==="password")return this._fromEmailAndPassword(e.email,e.password);if(e.signInMethod==="emailLink")return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const e={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return d_(t,e,"signInWithPassword",aU);case"emailLink":return oU(t,{email:this._email,oobCode:this._password});default:Fi(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":const n={idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return d_(t,n,"signUpPassword",rU);case"emailLink":return lU(t,{idToken:e,email:this._email,oobCode:this._password});default:Fi(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function lc(i,t){return Zh(i,"POST","/v1/accounts:signInWithIdp",za(i,t))}const cU="http://localhost";class jo extends X0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new jo(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Fi("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:n,signInMethod:s,...a}=e;if(!n||!s)return null;const l=new jo(n,s);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(t){const e=this.buildRequest();return lc(t,e)}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,lc(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,lc(t,e)}buildRequest(){const t={requestUri:cU,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=Gh(e)}return t}}function uU(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function hU(i){const t=Qu(Ju(i)).link,e=t?Qu(Ju(t)).deep_link_id:null,n=Qu(Ju(i)).deep_link_id;return(n?Qu(Ju(n)).link:null)||n||e||t||i}class Q0{constructor(t){const e=Qu(Ju(t)),n=e.apiKey??null,s=e.oobCode??null,a=uU(e.mode??null);It(n&&s&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=s,this.continueUrl=e.continueUrl??null,this.languageCode=e.lang??null,this.tenantId=e.tenantId??null}static parseLink(t){const e=hU(t);try{return new Q0(e)}catch{return null}}}class kc{constructor(){this.providerId=kc.PROVIDER_ID}static credential(t,e){return Dh._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=Q0.parseLink(e);return It(n,"argument-error"),Dh._fromEmailAndCode(t,n.code,n.tenantId)}}kc.PROVIDER_ID="password";kc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";kc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class J0{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class td extends J0{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class va extends td{constructor(){super("facebook.com")}static credential(t){return jo._fromParams({providerId:va.PROVIDER_ID,signInMethod:va.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return va.credentialFromTaggedObject(t)}static credentialFromError(t){return va.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return va.credential(t.oauthAccessToken)}catch{return null}}}va.FACEBOOK_SIGN_IN_METHOD="facebook.com";va.PROVIDER_ID="facebook.com";class Er extends td{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return jo._fromParams({providerId:Er.PROVIDER_ID,signInMethod:Er.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return Er.credentialFromTaggedObject(t)}static credentialFromError(t){return Er.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return Er.credential(e,n)}catch{return null}}}Er.GOOGLE_SIGN_IN_METHOD="google.com";Er.PROVIDER_ID="google.com";class _a extends td{constructor(){super("github.com")}static credential(t){return jo._fromParams({providerId:_a.PROVIDER_ID,signInMethod:_a.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return _a.credentialFromTaggedObject(t)}static credentialFromError(t){return _a.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return _a.credential(t.oauthAccessToken)}catch{return null}}}_a.GITHUB_SIGN_IN_METHOD="github.com";_a.PROVIDER_ID="github.com";class ba extends td{constructor(){super("twitter.com")}static credential(t,e){return jo._fromParams({providerId:ba.PROVIDER_ID,signInMethod:ba.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return ba.credentialFromTaggedObject(t)}static credentialFromError(t){return ba.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return ba.credential(e,n)}catch{return null}}}ba.TWITTER_SIGN_IN_METHOD="twitter.com";ba.PROVIDER_ID="twitter.com";async function dU(i,t){return Zh(i,"POST","/v1/accounts:signUp",za(i,t))}class zo{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,s=!1){const a=await ss._fromIdTokenResponse(t,n,s),l=s1(n);return new zo({user:a,providerId:l,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const s=s1(n);return new zo({user:t,providerId:s,_tokenResponse:n,operationType:e})}}function s1(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}class tm extends Xs{constructor(t,e,n,s){super(e.code,e.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,tm.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,s){return new tm(t,e,n,s)}}function FI(i,t,e,n){return(t==="reauthenticate"?e._getReauthenticationResolver(i):e._getIdTokenResponse(i)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?tm._fromErrorAndOperation(i,a,t,n):a})}async function fU(i,t,e=!1){const n=await Ih(i,t._linkToIdToken(i.auth,await i.getIdToken()),e);return zo._forOperation(i,"link",n)}async function pU(i,t,e=!1){const{auth:n}=i;if(ni(n.app))return Promise.reject(Rr(n));const s="reauthenticate";try{const a=await Ih(i,FI(n,s,t,i),e);It(a.idToken,n,"internal-error");const l=K0(a.idToken);It(l,n,"internal-error");const{sub:c}=l;return It(i.uid===c,n,"user-mismatch"),zo._forOperation(i,s,a)}catch(a){throw a?.code==="auth/user-not-found"&&Fi(n,"user-mismatch"),a}}async function UI(i,t,e=!1){if(ni(i.app))return Promise.reject(Rr(i));const n="signIn",s=await FI(i,n,t),a=await zo._fromIdTokenResponse(i,n,s);return e||await i._updateCurrentUser(a.user),a}async function mU(i,t){return UI(qa(i),t)}async function jI(i){const t=qa(i);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function gU(i,t,e){if(ni(i.app))return Promise.reject(Rr(i));const n=qa(i),l=await d_(n,{returnSecureToken:!0,email:t,password:e,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",dU).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&jI(i),h}),c=await zo._fromIdTokenResponse(n,"signIn",l);return await n._updateCurrentUser(c.user),c}function yU(i,t,e){return ni(i.app)?Promise.reject(Rr(i)):mU(qn(i),kc.credential(t,e)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&jI(i),n})}function vU(i,t,e,n){return qn(i).onIdTokenChanged(t,e,n)}function _U(i,t,e){return qn(i).beforeAuthStateChanged(t,e)}function bU(i,t,e,n){return qn(i).onAuthStateChanged(t,e,n)}const em="__sak";class zI{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(em,"1"),this.storage.removeItem(em),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const AU=1e3,EU=10;class HI extends zI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=NI(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),s=this.localCache[e];n!==s&&t(e,s,n)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((l,c,h)=>{this.notifyListeners(l,h)});return}const n=t.key;e?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(n);!e&&this.localCache[n]===l||this.notifyListeners(n,l)},a=this.storage.getItem(n);U3()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,EU):s()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const s of Array.from(n))s(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)})},AU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}HI.type="LOCAL";const wU=HI;class qI extends zI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}qI.type="SESSION";const GI=qI;function TU(i){return Promise.all(i.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}class Nm{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(s=>s.isListeningto(t));if(e)return e;const n=new Nm(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:s,data:a}=e.data,l=this.handlersMap[s];if(!l?.size)return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const c=Array.from(l).map(async d=>d(e.origin,a)),h=await TU(c);e.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:h})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Nm.receivers=[];function Z0(i="",t=10){let e="";for(let n=0;n<t;n++)e+=Math.floor(Math.random()*10);return i+e}class SU{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,l;return new Promise((c,h)=>{const d=Z0("",20);s.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},n);l={messageChannel:s,onMessage(m){const v=m;if(v.data.eventId===d)switch(v.data.status){case"ack":clearTimeout(p),a=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(v.data.response);break;default:clearTimeout(p),clearTimeout(a),h(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:t,eventId:d,data:e},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}function qs(){return window}function CU(i){qs().location.href=i}function $I(){return typeof qs().WorkerGlobalScope<"u"&&typeof qs().importScripts=="function"}async function xU(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function RU(){return navigator?.serviceWorker?.controller||null}function IU(){return $I()?self:null}const WI="firebaseLocalStorageDb",DU=1,nm="firebaseLocalStorage",KI="fbase_key";class ed{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function Om(i,t){return i.transaction([nm],t?"readwrite":"readonly").objectStore(nm)}function PU(){const i=indexedDB.deleteDatabase(WI);return new ed(i).toPromise()}function f_(){const i=indexedDB.open(WI,DU);return new Promise((t,e)=>{i.addEventListener("error",()=>{e(i.error)}),i.addEventListener("upgradeneeded",()=>{const n=i.result;try{n.createObjectStore(nm,{keyPath:KI})}catch(s){e(s)}}),i.addEventListener("success",async()=>{const n=i.result;n.objectStoreNames.contains(nm)?t(n):(n.close(),await PU(),t(await f_()))})})}async function r1(i,t,e){const n=Om(i,!0).put({[KI]:t,value:e});return new ed(n).toPromise()}async function MU(i,t){const e=Om(i,!1).get(t),n=await new ed(e).toPromise();return n===void 0?null:n.value}function a1(i,t){const e=Om(i,!0).delete(t);return new ed(e).toPromise()}const kU=800,NU=3;class YI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await f_(),this.db)}async _withRetries(t){let e=0;for(;;)try{const n=await this._openDb();return await t(n)}catch(n){if(e++>NU)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $I()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Nm._getInstance(IU()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await xU(),!this.activeServiceWorker)return;this.sender=new SU(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||RU()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await f_();return await r1(t,em,"1"),await a1(t,em),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(n=>r1(n,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(n=>MU(n,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>a1(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(s=>{const a=Om(s,!1).getAll();return new ed(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],n=new Set;if(t.length!==0)for(const{fbase_key:s,value:a}of t)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),e.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),e.push(s));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const s of Array.from(n))s(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),kU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}YI.type="LOCAL";const OU=YI;new Jh(3e4,6e4);function XI(i,t){return t?Tr(t):(It(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}class tb extends X0{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return lc(t,this._buildIdpRequest())}_linkToIdToken(t,e){return lc(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return lc(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function LU(i){return UI(i.auth,new tb(i),i.bypassAuthState)}function VU(i){const{auth:t,user:e}=i;return It(e,t,"internal-error"),pU(e,new tb(i),i.bypassAuthState)}async function BU(i){const{auth:t,user:e}=i;return It(e,t,"internal-error"),fU(e,new tb(i),i.bypassAuthState)}class QI{constructor(t,e,n,s,a=!1){this.auth=t,this.resolver=n,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:s,tenantId:a,error:l,type:c}=t;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:e,sessionId:n,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(h))}catch(d){this.reject(d)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return LU;case"linkViaPopup":case"linkViaRedirect":return BU;case"reauthViaPopup":case"reauthViaRedirect":return VU;default:Fi(this.auth,"internal-error")}}resolve(t){Or(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Or(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const FU=new Jh(2e3,1e4);async function UU(i,t,e){if(ni(i.app))return Promise.reject(os(i,"operation-not-supported-in-this-environment"));const n=qa(i);b3(i,t,J0);const s=XI(n,e);return new xo(n,"signInViaPopup",t,s).executeNotNull()}class xo extends QI{constructor(t,e,n,s,a){super(t,e,s,a),this.provider=n,this.authWindow=null,this.pollId=null,xo.currentPopupAction&&xo.currentPopupAction.cancel(),xo.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return It(t,this.auth,"internal-error"),t}async onExecution(){Or(this.filter.length===1,"Popup operations only handle one event");const t=Z0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(os(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(os(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xo.currentPopupAction=null}pollUserCancellation(){const t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(os(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,FU.get())};t()}}xo.currentPopupAction=null;const jU="pendingRedirect",Ep=new Map;class zU extends QI{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=Ep.get(this.auth._key());if(!t){try{const n=await HU(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}Ep.set(this.auth._key(),t)}return this.bypassAuthState||Ep.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function HU(i,t){const e=$U(t),n=GU(i);if(!await n._isAvailable())return!1;const s=await n._get(e)==="true";return await n._remove(e),s}function qU(i,t){Ep.set(i._key(),t)}function GU(i){return Tr(i._redirectPersistence)}function $U(i){return Ap(jU,i.config.apiKey,i.name)}async function WU(i,t,e=!1){if(ni(i.app))return Promise.reject(Rr(i));const n=qa(i),s=XI(n,t),l=await new zU(n,s,e).execute();return l&&!e&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,t)),l}const KU=600*1e3;class YU{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!XU(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){if(t.error&&!JI(t)){const n=t.error.code?.split("auth/")[1]||"internal-error";e.onError(os(this.auth,n))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=KU&&this.cachedEventUids.clear(),this.cachedEventUids.has(o1(t))}saveEventToCache(t){this.cachedEventUids.add(o1(t)),this.lastProcessedEventTime=Date.now()}}function o1(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(t=>t).join("-")}function JI({type:i,error:t}){return i==="unknown"&&t?.code==="auth/no-auth-event"}function XU(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return JI(i);default:return!1}}async function QU(i,t={}){return Ha(i,"GET","/v1/projects",t)}const JU=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ZU=/^https?/;async function t4(i){if(i.config.emulator)return;const{authorizedDomains:t}=await QU(i);for(const e of t)try{if(e4(e))return}catch{}Fi(i,"unauthorized-domain")}function e4(i){const t=u_(),{protocol:e,hostname:n}=new URL(t);if(i.startsWith("chrome-extension://")){const l=new URL(i);return l.hostname===""&&n===""?e==="chrome-extension:"&&i.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&l.hostname===n}if(!ZU.test(e))return!1;if(JU.test(i))return n===i;const s=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}const n4=new Jh(3e4,6e4);function l1(){const i=qs().___jsl;if(i?.H){for(const t of Object.keys(i.H))if(i.H[t].r=i.H[t].r||[],i.H[t].L=i.H[t].L||[],i.H[t].r=[...i.H[t].L],i.CP)for(let e=0;e<i.CP.length;e++)i.CP[e]=null}}function i4(i){return new Promise((t,e)=>{function n(){l1(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{l1(),e(os(i,"network-request-failed"))},timeout:n4.get()})}if(qs().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(qs().gapi?.load)n();else{const s=Y3("iframefcb");return qs()[s]=()=>{gapi.load?n():e(os(i,"network-request-failed"))},LI(`${K3()}?onload=${s}`).catch(a=>e(a))}}).catch(t=>{throw wp=null,t})}let wp=null;function s4(i){return wp=wp||i4(i),wp}const r4=new Jh(5e3,15e3),a4="__/auth/iframe",o4="emulator/auth/iframe",l4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},c4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function u4(i){const t=i.config;It(t.authDomain,i,"auth-domain-config-required");const e=t.emulator?W0(t,o4):`https://${i.config.authDomain}/${a4}`,n={apiKey:t.apiKey,appName:i.name,v:Wo},s=c4.get(i.config.apiHost);s&&(n.eid=s);const a=i._getFrameworks();return a.length&&(n.fw=a.join(",")),`${e}?${Gh(n).slice(1)}`}async function h4(i){const t=await s4(i),e=qs().gapi;return It(e,i,"internal-error"),t.open({where:document.body,url:u4(i),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:l4,dontclear:!0},n=>new Promise(async(s,a)=>{await n.restyle({setHideOnLeave:!1});const l=os(i,"network-request-failed"),c=qs().setTimeout(()=>{a(l)},r4.get());function h(){qs().clearTimeout(c),s(n)}n.ping(h).then(h,()=>{a(l)})}))}const d4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},f4=500,p4=600,m4="_blank",g4="http://localhost";class c1{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function y4(i,t,e,n=f4,s=p4){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const h={...d4,width:n.toString(),height:s.toString(),top:a,left:l},d=Nn().toLowerCase();e&&(c=II(d)?m4:e),xI(d)&&(t=t||g4,h.scrollbars="yes");const p=Object.entries(h).reduce((v,[b,w])=>`${v}${b}=${w},`,"");if(F3(d)&&c!=="_self")return v4(t||"",c),new c1(null);const m=window.open(t||"",c,p);It(m,i,"popup-blocked");try{m.focus()}catch{}return new c1(m)}function v4(i,t){const e=document.createElement("a");e.href=i,e.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(n)}const _4="__/auth/handler",b4="emulator/auth/handler",A4=encodeURIComponent("fac");async function u1(i,t,e,n,s,a){It(i.config.authDomain,i,"auth-domain-config-required"),It(i.config.apiKey,i,"invalid-api-key");const l={apiKey:i.config.apiKey,appName:i.name,authType:e,redirectUrl:n,v:Wo,eventId:s};if(t instanceof J0){t.setDefaultLanguage(i.languageCode),l.providerId=t.providerId||"",uO(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[p,m]of Object.entries({}))l[p]=m}if(t instanceof td){const p=t.getScopes().filter(m=>m!=="");p.length>0&&(l.scopes=p.join(","))}i.tenantId&&(l.tid=i.tenantId);const c=l;for(const p of Object.keys(c))c[p]===void 0&&delete c[p];const h=await i._getAppCheckToken(),d=h?`#${A4}=${encodeURIComponent(h)}`:"";return`${E4(i)}?${Gh(c).slice(1)}${d}`}function E4({config:i}){return i.emulator?W0(i,b4):`https://${i.authDomain}/${_4}`}const fv="webStorageSupport";class w4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=GI,this._completeRedirectFn=WU,this._overrideRedirectResult=qU}async _openPopup(t,e,n,s){Or(this.eventManagers[t._key()]?.manager,"_initialize() not called before _openPopup()");const a=await u1(t,e,n,u_(),s);return y4(t,a,Z0())}async _openRedirect(t,e,n,s){await this._originValidation(t);const a=await u1(t,e,n,u_(),s);return CU(a),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:s,promise:a}=this.eventManagers[e];return s?Promise.resolve(s):(Or(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch(()=>{delete this.eventManagers[e]}),n}async initAndGetManager(t){const e=await h4(t),n=new YU(t);return e.register("authEvent",s=>(It(s?.authEvent,t,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(fv,{type:fv},s=>{const a=s?.[0]?.[fv];a!==void 0&&e(!!a),Fi(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=t4(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return NI()||RI()||Y0()}}const T4=w4;var h1="@firebase/auth",d1="1.12.0";class S4{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(n=>{t(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){It(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function C4(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function x4(i){Bo(new Da("auth",(t,{options:e})=>{const n=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),a=t.getProvider("app-check-internal"),{apiKey:l,authDomain:c}=n.options;It(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:l,authDomain:c,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:OI(i)},d=new G3(n,s,a,h);return eU(d,e),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider("auth-internal").initialize()})),Bo(new Da("auth-internal",t=>{const e=qa(t.getProvider("auth").getImmediate());return(n=>new S4(n))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),Us(h1,d1,C4(i)),Us(h1,d1,"esm2020")}const R4=300,I4=Rx("authIdTokenMaxAge")||R4;let f1=null;const D4=i=>async t=>{const e=t&&await t.getIdTokenResult(),n=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>I4)return;const s=e?.token;f1!==s&&(f1=s,await fetch(i,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function P4(i=h0()){const t=ym(i,"auth");if(t.isInitialized())return t.getImmediate();const e=tU(i,{popupRedirectResolver:T4,persistence:[OU,wU,GI]}),n=Rx("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const l=D4(a.toString());_U(e,l,()=>l(e.currentUser)),vU(e,c=>l(c))}}const s=Sx("auth");return s&&nU(e,`http://${s}`),e}function M4(){return document.getElementsByTagName("head")?.[0]??document}$3({loadJS(i){return new Promise((t,e)=>{const n=document.createElement("script");n.setAttribute("src",i),n.onload=t,n.onerror=s=>{const a=os("internal-error");a.customData=s,e(a)},n.type="text/javascript",n.charset="UTF-8",M4().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});x4("Browser");const k4={apiKey:"AIzaSyA19clt5dSgNFiku34ME1BMAVuJowKJoTs",authDomain:"ministore-becac.firebaseapp.com",projectId:"ministore-becac",storageBucket:"ministore-becac.firebasestorage.app",messagingSenderId:"848180057265",appId:"1:848180057265:web:ec5fafb90dcc4db5f67e90"},eb=Mx(k4),Un=xF(eb);p3(eb);const ph=P4(eb),ZI=z.createContext(),N4=({children:i})=>{const[t,e]=z.useState(null),[n,s]=z.useState(!0);return z.useEffect(()=>{const a=bU(ph,l=>{e(l),s(!1)});return()=>a()},[]),L.jsx(ZI.Provider,{value:{user:t,loading:n},children:!n&&i})},nb=()=>z.useContext(ZI),tD=z.createContext(),O4=({children:i})=>{const{user:t}=nb(),[e,n]=z.useState(null),[s,a]=z.useState(!0),l=async()=>{if(!t){n(null),a(!1);return}try{const c=Wp(xr(Un,"stores"),Kp("ownerId","==",t.uid)),h=await Rh(c);h.empty?n(null):n({id:h.docs[0].id,...h.docs[0].data()})}catch(c){console.error("Error fetching store:",c)}finally{a(!1)}};return z.useEffect(()=>{l()},[t]),L.jsx(tD.Provider,{value:{store:e,setStore:n,loading:s,refreshStore:l},children:i})},eD=()=>z.useContext(tD);const L4=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),V4=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,n)=>n?n.toUpperCase():e.toLowerCase()),p1=i=>{const t=V4(i);return t.charAt(0).toUpperCase()+t.slice(1)},nD=(...i)=>i.filter((t,e,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===e).join(" ").trim(),B4=i=>{for(const t in i)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var F4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const U4=z.forwardRef(({color:i="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:l,...c},h)=>z.createElement("svg",{ref:h,...F4,width:t,height:t,stroke:i,strokeWidth:n?Number(e)*24/Number(t):e,className:nD("lucide",s),...!a&&!B4(c)&&{"aria-hidden":"true"},...c},[...l.map(([d,p])=>z.createElement(d,p)),...Array.isArray(a)?a:[a]]));const un=(i,t)=>{const e=z.forwardRef(({className:n,...s},a)=>z.createElement(U4,{ref:a,iconNode:t,className:nD(`lucide-${L4(p1(i))}`,`lucide-${i}`,n),...s}));return e.displayName=p1(i),e};const j4=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]],z4=un("arrow-down-wide-narrow",j4);const H4=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],q4=un("arrow-left",H4);const G4=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],$4=un("arrow-right",G4);const W4=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],K4=un("copy",W4);const Y4=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],X4=un("external-link",Y4);const Q4=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],J4=un("file-text",Q4);const Z4=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],t6=un("funnel",Z4);const e6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],n6=un("globe",e6);const i6=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],s6=un("image",i6);const r6=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],a6=un("log-out",r6);const o6=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],p_=un("message-circle",o6);const l6=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],c6=un("plus",l6);const u6=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],h6=un("search",u6);const d6=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],f6=un("settings",d6);const p6=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],Ac=un("shopping-bag",p6);const m6=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],g6=un("smartphone",m6);const y6=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],iD=un("trash-2",y6);const v6=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],_6=un("upload",v6);const b6=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],A6=un("zap",b6),ib=z.createContext({});function sb(i){const t=z.useRef(null);return t.current===null&&(t.current=i()),t.current}const sD=typeof window<"u",rD=sD?z.useLayoutEffect:z.useEffect,Lm=z.createContext(null);function rb(i,t){i.indexOf(t)===-1&&i.push(t)}function ab(i,t){const e=i.indexOf(t);e>-1&&i.splice(e,1)}const Ks=(i,t,e)=>e>t?t:e<i?i:e;let ob=()=>{};const Lr={},aD=i=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(i);function oD(i){return typeof i=="object"&&i!==null}const lD=i=>/^0[^.\s]+$/u.test(i);function lb(i){let t;return()=>(t===void 0&&(t=i()),t)}const Bi=i=>i,E6=(i,t)=>e=>t(i(e)),nd=(...i)=>i.reduce(E6),Ph=(i,t,e)=>{const n=t-i;return n===0?1:(e-i)/n};class cb{constructor(){this.subscriptions=[]}add(t){return rb(this.subscriptions,t),()=>ab(this.subscriptions,t)}notify(t,e,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,e,n);else for(let a=0;a<s;a++){const l=this.subscriptions[a];l&&l(t,e,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ir=i=>i*1e3,Vi=i=>i/1e3;function cD(i,t){return t?i*(1e3/t):0}const uD=(i,t,e)=>(((1-3*e+3*t)*i+(3*e-6*t))*i+3*t)*i,w6=1e-7,T6=12;function S6(i,t,e,n,s){let a,l,c=0;do l=t+(e-t)/2,a=uD(l,n,s)-i,a>0?e=l:t=l;while(Math.abs(a)>w6&&++c<T6);return l}function id(i,t,e,n){if(i===t&&e===n)return Bi;const s=a=>S6(a,0,1,i,e);return a=>a===0||a===1?a:uD(s(a),t,n)}const hD=i=>t=>t<=.5?i(2*t)/2:(2-i(2*(1-t)))/2,dD=i=>t=>1-i(1-t),fD=id(.33,1.53,.69,.99),ub=dD(fD),pD=hD(ub),mD=i=>(i*=2)<1?.5*ub(i):.5*(2-Math.pow(2,-10*(i-1))),hb=i=>1-Math.sin(Math.acos(i)),gD=dD(hb),yD=hD(hb),C6=id(.42,0,1,1),x6=id(0,0,.58,1),vD=id(.42,0,.58,1),R6=i=>Array.isArray(i)&&typeof i[0]!="number",_D=i=>Array.isArray(i)&&typeof i[0]=="number",I6={linear:Bi,easeIn:C6,easeInOut:vD,easeOut:x6,circIn:hb,circInOut:yD,circOut:gD,backIn:ub,backInOut:pD,backOut:fD,anticipate:mD},D6=i=>typeof i=="string",m1=i=>{if(_D(i)){ob(i.length===4);const[t,e,n,s]=i;return id(t,e,n,s)}else if(D6(i))return I6[i];return i},Qf=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function P6(i,t){let e=new Set,n=new Set,s=!1,a=!1;const l=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function h(p){l.has(p)&&(d.schedule(p),i()),p(c)}const d={schedule:(p,m=!1,v=!1)=>{const w=v&&s?e:n;return m&&l.add(p),w.has(p)||w.add(p),p},cancel:p=>{n.delete(p),l.delete(p)},process:p=>{if(c=p,s){a=!0;return}s=!0,[e,n]=[n,e],e.forEach(h),e.clear(),s=!1,a&&(a=!1,d.process(p))}};return d}const M6=40;function bD(i,t){let e=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=()=>e=!0,l=Qf.reduce((I,B)=>(I[B]=P6(a),I),{}),{setup:c,read:h,resolveKeyframes:d,preUpdate:p,update:m,preRender:v,render:b,postRender:w}=l,E=()=>{const I=Lr.useManualTiming?s.timestamp:performance.now();e=!1,Lr.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(I-s.timestamp,M6),1)),s.timestamp=I,s.isProcessing=!0,c.process(s),h.process(s),d.process(s),p.process(s),m.process(s),v.process(s),b.process(s),w.process(s),s.isProcessing=!1,e&&t&&(n=!1,i(E))},S=()=>{e=!0,n=!0,s.isProcessing||i(E)};return{schedule:Qf.reduce((I,B)=>{const F=l[B];return I[B]=(j,P=!1,D=!1)=>(e||S(),F.schedule(j,P,D)),I},{}),cancel:I=>{for(let B=0;B<Qf.length;B++)l[Qf[B]].cancel(I)},state:s,steps:l}}const{schedule:Ae,cancel:Va,state:Tn,steps:pv}=bD(typeof requestAnimationFrame<"u"?requestAnimationFrame:Bi,!0);let Tp;function k6(){Tp=void 0}const jn={now:()=>(Tp===void 0&&jn.set(Tn.isProcessing||Lr.useManualTiming?Tn.timestamp:performance.now()),Tp),set:i=>{Tp=i,queueMicrotask(k6)}},AD=i=>t=>typeof t=="string"&&t.startsWith(i),ED=AD("--"),N6=AD("var(--"),db=i=>N6(i)?O6.test(i.split("/*")[0].trim()):!1,O6=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function g1(i){return typeof i!="string"?!1:i.split("/*")[0].includes("var(--")}const Nc={test:i=>typeof i=="number",parse:parseFloat,transform:i=>i},Mh={...Nc,transform:i=>Ks(0,1,i)},Jf={...Nc,default:1},mh=i=>Math.round(i*1e5)/1e5,fb=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function L6(i){return i==null}const V6=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,pb=(i,t)=>e=>!!(typeof e=="string"&&V6.test(e)&&e.startsWith(i)||t&&!L6(e)&&Object.prototype.hasOwnProperty.call(e,t)),wD=(i,t,e)=>n=>{if(typeof n!="string")return n;const[s,a,l,c]=n.match(fb);return{[i]:parseFloat(s),[t]:parseFloat(a),[e]:parseFloat(l),alpha:c!==void 0?parseFloat(c):1}},B6=i=>Ks(0,255,i),mv={...Nc,transform:i=>Math.round(B6(i))},Ro={test:pb("rgb","red"),parse:wD("red","green","blue"),transform:({red:i,green:t,blue:e,alpha:n=1})=>"rgba("+mv.transform(i)+", "+mv.transform(t)+", "+mv.transform(e)+", "+mh(Mh.transform(n))+")"};function F6(i){let t="",e="",n="",s="";return i.length>5?(t=i.substring(1,3),e=i.substring(3,5),n=i.substring(5,7),s=i.substring(7,9)):(t=i.substring(1,2),e=i.substring(2,3),n=i.substring(3,4),s=i.substring(4,5),t+=t,e+=e,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(e,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const m_={test:pb("#"),parse:F6,transform:Ro.transform},sd=i=>({test:t=>typeof t=="string"&&t.endsWith(i)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${i}`}),ya=sd("deg"),Gs=sd("%"),_t=sd("px"),U6=sd("vh"),j6=sd("vw"),y1={...Gs,parse:i=>Gs.parse(i)/100,transform:i=>Gs.transform(i*100)},Xl={test:pb("hsl","hue"),parse:wD("hue","saturation","lightness"),transform:({hue:i,saturation:t,lightness:e,alpha:n=1})=>"hsla("+Math.round(i)+", "+Gs.transform(mh(t))+", "+Gs.transform(mh(e))+", "+mh(Mh.transform(n))+")"},Ze={test:i=>Ro.test(i)||m_.test(i)||Xl.test(i),parse:i=>Ro.test(i)?Ro.parse(i):Xl.test(i)?Xl.parse(i):m_.parse(i),transform:i=>typeof i=="string"?i:i.hasOwnProperty("red")?Ro.transform(i):Xl.transform(i),getAnimatableNone:i=>{const t=Ze.parse(i);return t.alpha=0,Ze.transform(t)}},z6=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function H6(i){return isNaN(i)&&typeof i=="string"&&(i.match(fb)?.length||0)+(i.match(z6)?.length||0)>0}const TD="number",SD="color",q6="var",G6="var(",v1="${}",$6=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function kh(i){const t=i.toString(),e=[],n={color:[],number:[],var:[]},s=[];let a=0;const c=t.replace($6,h=>(Ze.test(h)?(n.color.push(a),s.push(SD),e.push(Ze.parse(h))):h.startsWith(G6)?(n.var.push(a),s.push(q6),e.push(h)):(n.number.push(a),s.push(TD),e.push(parseFloat(h))),++a,v1)).split(v1);return{values:e,split:c,indexes:n,types:s}}function CD(i){return kh(i).values}function xD(i){const{split:t,types:e}=kh(i),n=t.length;return s=>{let a="";for(let l=0;l<n;l++)if(a+=t[l],s[l]!==void 0){const c=e[l];c===TD?a+=mh(s[l]):c===SD?a+=Ze.transform(s[l]):a+=s[l]}return a}}const W6=i=>typeof i=="number"?0:Ze.test(i)?Ze.getAnimatableNone(i):i;function K6(i){const t=CD(i);return xD(i)(t.map(W6))}const Ba={test:H6,parse:CD,createTransformer:xD,getAnimatableNone:K6};function gv(i,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+(t-i)*6*e:e<1/2?t:e<2/3?i+(t-i)*(2/3-e)*6:i}function Y6({hue:i,saturation:t,lightness:e,alpha:n}){i/=360,t/=100,e/=100;let s=0,a=0,l=0;if(!t)s=a=l=e;else{const c=e<.5?e*(1+t):e+t-e*t,h=2*e-c;s=gv(h,c,i+1/3),a=gv(h,c,i),l=gv(h,c,i-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(l*255),alpha:n}}function im(i,t){return e=>e>0?t:i}const Re=(i,t,e)=>i+(t-i)*e,yv=(i,t,e)=>{const n=i*i,s=e*(t*t-n)+n;return s<0?0:Math.sqrt(s)},X6=[m_,Ro,Xl],Q6=i=>X6.find(t=>t.test(i));function _1(i){const t=Q6(i);if(!t)return!1;let e=t.parse(i);return t===Xl&&(e=Y6(e)),e}const b1=(i,t)=>{const e=_1(i),n=_1(t);if(!e||!n)return im(i,t);const s={...e};return a=>(s.red=yv(e.red,n.red,a),s.green=yv(e.green,n.green,a),s.blue=yv(e.blue,n.blue,a),s.alpha=Re(e.alpha,n.alpha,a),Ro.transform(s))},g_=new Set(["none","hidden"]);function J6(i,t){return g_.has(i)?e=>e<=0?i:t:e=>e>=1?t:i}function Z6(i,t){return e=>Re(i,t,e)}function mb(i){return typeof i=="number"?Z6:typeof i=="string"?db(i)?im:Ze.test(i)?b1:n5:Array.isArray(i)?RD:typeof i=="object"?Ze.test(i)?b1:t5:im}function RD(i,t){const e=[...i],n=e.length,s=i.map((a,l)=>mb(a)(a,t[l]));return a=>{for(let l=0;l<n;l++)e[l]=s[l](a);return e}}function t5(i,t){const e={...i,...t},n={};for(const s in e)i[s]!==void 0&&t[s]!==void 0&&(n[s]=mb(i[s])(i[s],t[s]));return s=>{for(const a in n)e[a]=n[a](s);return e}}function e5(i,t){const e=[],n={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const a=t.types[s],l=i.indexes[a][n[a]],c=i.values[l]??0;e[s]=c,n[a]++}return e}const n5=(i,t)=>{const e=Ba.createTransformer(t),n=kh(i),s=kh(t);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?g_.has(i)&&!s.values.length||g_.has(t)&&!n.values.length?J6(i,t):nd(RD(e5(n,s),s.values),e):im(i,t)};function ID(i,t,e){return typeof i=="number"&&typeof t=="number"&&typeof e=="number"?Re(i,t,e):mb(i)(i,t)}const i5=i=>{const t=({timestamp:e})=>i(e);return{start:(e=!0)=>Ae.update(t,e),stop:()=>Va(t),now:()=>Tn.isProcessing?Tn.timestamp:jn.now()}},DD=(i,t,e=10)=>{let n="";const s=Math.max(Math.round(t/e),2);for(let a=0;a<s;a++)n+=Math.round(i(a/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},sm=2e4;function gb(i){let t=0;const e=50;let n=i.next(t);for(;!n.done&&t<sm;)t+=e,n=i.next(t);return t>=sm?1/0:t}function s5(i,t=100,e){const n=e({...i,keyframes:[0,t]}),s=Math.min(gb(n),sm);return{type:"keyframes",ease:a=>n.next(s*a).value/t,duration:Vi(s)}}const r5=5;function PD(i,t,e){const n=Math.max(t-r5,0);return cD(e-i(n),t-n)}const ke={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},vv=.001;function a5({duration:i=ke.duration,bounce:t=ke.bounce,velocity:e=ke.velocity,mass:n=ke.mass}){let s,a,l=1-t;l=Ks(ke.minDamping,ke.maxDamping,l),i=Ks(ke.minDuration,ke.maxDuration,Vi(i)),l<1?(s=d=>{const p=d*l,m=p*i,v=p-e,b=y_(d,l),w=Math.exp(-m);return vv-v/b*w},a=d=>{const m=d*l*i,v=m*e+e,b=Math.pow(l,2)*Math.pow(d,2)*i,w=Math.exp(-m),E=y_(Math.pow(d,2),l);return(-s(d)+vv>0?-1:1)*((v-b)*w)/E}):(s=d=>{const p=Math.exp(-d*i),m=(d-e)*i+1;return-vv+p*m},a=d=>{const p=Math.exp(-d*i),m=(e-d)*(i*i);return p*m});const c=5/i,h=l5(s,a,c);if(i=Ir(i),isNaN(h))return{stiffness:ke.stiffness,damping:ke.damping,duration:i};{const d=Math.pow(h,2)*n;return{stiffness:d,damping:l*2*Math.sqrt(n*d),duration:i}}}const o5=12;function l5(i,t,e){let n=e;for(let s=1;s<o5;s++)n=n-i(n)/t(n);return n}function y_(i,t){return i*Math.sqrt(1-t*t)}const c5=["duration","bounce"],u5=["stiffness","damping","mass"];function A1(i,t){return t.some(e=>i[e]!==void 0)}function h5(i){let t={velocity:ke.velocity,stiffness:ke.stiffness,damping:ke.damping,mass:ke.mass,isResolvedFromDuration:!1,...i};if(!A1(i,u5)&&A1(i,c5))if(i.visualDuration){const e=i.visualDuration,n=2*Math.PI/(e*1.2),s=n*n,a=2*Ks(.05,1,1-(i.bounce||0))*Math.sqrt(s);t={...t,mass:ke.mass,stiffness:s,damping:a}}else{const e=a5(i);t={...t,...e,mass:ke.mass},t.isResolvedFromDuration=!0}return t}function rm(i=ke.visualDuration,t=ke.bounce){const e=typeof i!="object"?{visualDuration:i,keyframes:[0,1],bounce:t}:i;let{restSpeed:n,restDelta:s}=e;const a=e.keyframes[0],l=e.keyframes[e.keyframes.length-1],c={done:!1,value:a},{stiffness:h,damping:d,mass:p,duration:m,velocity:v,isResolvedFromDuration:b}=h5({...e,velocity:-Vi(e.velocity||0)}),w=v||0,E=d/(2*Math.sqrt(h*p)),S=l-a,C=Vi(Math.sqrt(h/p)),R=Math.abs(S)<5;n||(n=R?ke.restSpeed.granular:ke.restSpeed.default),s||(s=R?ke.restDelta.granular:ke.restDelta.default);let I;if(E<1){const F=y_(C,E);I=j=>{const P=Math.exp(-E*C*j);return l-P*((w+E*C*S)/F*Math.sin(F*j)+S*Math.cos(F*j))}}else if(E===1)I=F=>l-Math.exp(-C*F)*(S+(w+C*S)*F);else{const F=C*Math.sqrt(E*E-1);I=j=>{const P=Math.exp(-E*C*j),D=Math.min(F*j,300);return l-P*((w+E*C*S)*Math.sinh(D)+F*S*Math.cosh(D))/F}}const B={calculatedDuration:b&&m||null,next:F=>{const j=I(F);if(b)c.done=F>=m;else{let P=F===0?w:0;E<1&&(P=F===0?Ir(w):PD(I,F,j));const D=Math.abs(P)<=n,M=Math.abs(l-j)<=s;c.done=D&&M}return c.value=c.done?l:j,c},toString:()=>{const F=Math.min(gb(B),sm),j=DD(P=>B.next(F*P).value,F,30);return F+"ms "+j},toTransition:()=>{}};return B}rm.applyToOptions=i=>{const t=s5(i,100,rm);return i.ease=t.ease,i.duration=Ir(t.duration),i.type="keyframes",i};function v_({keyframes:i,velocity:t=0,power:e=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:l,min:c,max:h,restDelta:d=.5,restSpeed:p}){const m=i[0],v={done:!1,value:m},b=D=>c!==void 0&&D<c||h!==void 0&&D>h,w=D=>c===void 0?h:h===void 0||Math.abs(c-D)<Math.abs(h-D)?c:h;let E=e*t;const S=m+E,C=l===void 0?S:l(S);C!==S&&(E=C-m);const R=D=>-E*Math.exp(-D/n),I=D=>C+R(D),B=D=>{const M=R(D),V=I(D);v.done=Math.abs(M)<=d,v.value=v.done?C:V};let F,j;const P=D=>{b(v.value)&&(F=D,j=rm({keyframes:[v.value,w(v.value)],velocity:PD(I,D,v.value),damping:s,stiffness:a,restDelta:d,restSpeed:p}))};return P(0),{calculatedDuration:null,next:D=>{let M=!1;return!j&&F===void 0&&(M=!0,B(D),P(D)),F!==void 0&&D>=F?j.next(D-F):(!M&&B(D),v)}}}function d5(i,t,e){const n=[],s=e||Lr.mix||ID,a=i.length-1;for(let l=0;l<a;l++){let c=s(i[l],i[l+1]);if(t){const h=Array.isArray(t)?t[l]||Bi:t;c=nd(h,c)}n.push(c)}return n}function f5(i,t,{clamp:e=!0,ease:n,mixer:s}={}){const a=i.length;if(ob(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const l=i[0]===i[1];i[0]>i[a-1]&&(i=[...i].reverse(),t=[...t].reverse());const c=d5(t,n,s),h=c.length,d=p=>{if(l&&p<i[0])return t[0];let m=0;if(h>1)for(;m<i.length-2&&!(p<i[m+1]);m++);const v=Ph(i[m],i[m+1],p);return c[m](v)};return e?p=>d(Ks(i[0],i[a-1],p)):d}function p5(i,t){const e=i[i.length-1];for(let n=1;n<=t;n++){const s=Ph(0,t,n);i.push(Re(e,1,s))}}function m5(i){const t=[0];return p5(t,i.length-1),t}function g5(i,t){return i.map(e=>e*t)}function y5(i,t){return i.map(()=>t||vD).splice(0,i.length-1)}function gh({duration:i=300,keyframes:t,times:e,ease:n="easeInOut"}){const s=R6(n)?n.map(m1):m1(n),a={done:!1,value:t[0]},l=g5(e&&e.length===t.length?e:m5(t),i),c=f5(l,t,{ease:Array.isArray(s)?s:y5(t,s)});return{calculatedDuration:i,next:h=>(a.value=c(h),a.done=h>=i,a)}}const v5=i=>i!==null;function yb(i,{repeat:t,repeatType:e="loop"},n,s=1){const a=i.filter(v5),c=s<0||t&&e!=="loop"&&t%2===1?0:a.length-1;return!c||n===void 0?a[c]:n}const _5={decay:v_,inertia:v_,tween:gh,keyframes:gh,spring:rm};function MD(i){typeof i.type=="string"&&(i.type=_5[i.type])}class vb{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,e){return this.finished.then(t,e)}}const b5=i=>i/100;class _b extends vb{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:e}=this.options;e&&e.updatedAt!==jn.now()&&this.tick(jn.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;MD(t);const{type:e=gh,repeat:n=0,repeatDelay:s=0,repeatType:a,velocity:l=0}=t;let{keyframes:c}=t;const h=e||gh;h!==gh&&typeof c[0]!="number"&&(this.mixKeyframes=nd(b5,ID(c[0],c[1])),c=[0,100]);const d=h({...t,keyframes:c});a==="mirror"&&(this.mirroredGenerator=h({...t,keyframes:[...c].reverse(),velocity:-l})),d.calculatedDuration===null&&(d.calculatedDuration=gb(d));const{calculatedDuration:p}=d;this.calculatedDuration=p,this.resolvedDuration=p+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=d}updateTime(t){const e=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=e}tick(t,e=!1){const{generator:n,totalDuration:s,mixKeyframes:a,mirroredGenerator:l,resolvedDuration:c,calculatedDuration:h}=this;if(this.startTime===null)return n.next(0);const{delay:d=0,keyframes:p,repeat:m,repeatType:v,repeatDelay:b,type:w,onUpdate:E,finalKeyframe:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),e?this.currentTime=t:this.updateTime(t);const C=this.currentTime-d*(this.playbackSpeed>=0?1:-1),R=this.playbackSpeed>=0?C<0:C>s;this.currentTime=Math.max(C,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let I=this.currentTime,B=n;if(m){const D=Math.min(this.currentTime,s)/c;let M=Math.floor(D),V=D%1;!V&&D>=1&&(V=1),V===1&&M--,M=Math.min(M,m+1),M%2&&(v==="reverse"?(V=1-V,b&&(V-=b/c)):v==="mirror"&&(B=l)),I=Ks(0,1,V)*c}const F=R?{done:!1,value:p[0]}:B.next(I);a&&(F.value=a(F.value));let{done:j}=F;!R&&h!==null&&(j=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const P=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&j);return P&&w!==v_&&(F.value=yb(p,this.options,S,this.speed)),E&&E(F.value),P&&this.finish(),F}then(t,e){return this.finished.then(t,e)}get duration(){return Vi(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Vi(t)}get time(){return Vi(this.currentTime)}set time(t){t=Ir(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(jn.now());const e=this.playbackSpeed!==t;this.playbackSpeed=t,e&&(this.time=Vi(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=i5,startTime:e}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),this.options.onPlay?.();const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=e??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(jn.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function A5(i){for(let t=1;t<i.length;t++)i[t]??(i[t]=i[t-1])}const Io=i=>i*180/Math.PI,__=i=>{const t=Io(Math.atan2(i[1],i[0]));return b_(t)},E5={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:i=>(Math.abs(i[0])+Math.abs(i[3]))/2,rotate:__,rotateZ:__,skewX:i=>Io(Math.atan(i[1])),skewY:i=>Io(Math.atan(i[2])),skew:i=>(Math.abs(i[1])+Math.abs(i[2]))/2},b_=i=>(i=i%360,i<0&&(i+=360),i),E1=__,w1=i=>Math.sqrt(i[0]*i[0]+i[1]*i[1]),T1=i=>Math.sqrt(i[4]*i[4]+i[5]*i[5]),w5={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:w1,scaleY:T1,scale:i=>(w1(i)+T1(i))/2,rotateX:i=>b_(Io(Math.atan2(i[6],i[5]))),rotateY:i=>b_(Io(Math.atan2(-i[2],i[0]))),rotateZ:E1,rotate:E1,skewX:i=>Io(Math.atan(i[4])),skewY:i=>Io(Math.atan(i[1])),skew:i=>(Math.abs(i[1])+Math.abs(i[4]))/2};function A_(i){return i.includes("scale")?1:0}function E_(i,t){if(!i||i==="none")return A_(t);const e=i.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(e)n=w5,s=e;else{const c=i.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=E5,s=c}if(!s)return A_(t);const a=n[t],l=s[1].split(",").map(S5);return typeof a=="function"?a(l):l[a]}const T5=(i,t)=>{const{transform:e="none"}=getComputedStyle(i);return E_(e,t)};function S5(i){return parseFloat(i.trim())}const Oc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Lc=new Set(Oc),S1=i=>i===Nc||i===_t,C5=new Set(["x","y","z"]),x5=Oc.filter(i=>!C5.has(i));function R5(i){const t=[];return x5.forEach(e=>{const n=i.getValue(e);n!==void 0&&(t.push([e,n.get()]),n.set(e.startsWith("scale")?1:0))}),t}const Sa={width:({x:i},{paddingLeft:t="0",paddingRight:e="0"})=>i.max-i.min-parseFloat(t)-parseFloat(e),height:({y:i},{paddingTop:t="0",paddingBottom:e="0"})=>i.max-i.min-parseFloat(t)-parseFloat(e),top:(i,{top:t})=>parseFloat(t),left:(i,{left:t})=>parseFloat(t),bottom:({y:i},{top:t})=>parseFloat(t)+(i.max-i.min),right:({x:i},{left:t})=>parseFloat(t)+(i.max-i.min),x:(i,{transform:t})=>E_(t,"x"),y:(i,{transform:t})=>E_(t,"y")};Sa.translateX=Sa.x;Sa.translateY=Sa.y;const Lo=new Set;let w_=!1,T_=!1,S_=!1;function kD(){if(T_){const i=Array.from(Lo).filter(n=>n.needsMeasurement),t=new Set(i.map(n=>n.element)),e=new Map;t.forEach(n=>{const s=R5(n);s.length&&(e.set(n,s),n.render())}),i.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const s=e.get(n);s&&s.forEach(([a,l])=>{n.getValue(a)?.set(l)})}),i.forEach(n=>n.measureEndState()),i.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}T_=!1,w_=!1,Lo.forEach(i=>i.complete(S_)),Lo.clear()}function ND(){Lo.forEach(i=>{i.readKeyframes(),i.needsMeasurement&&(T_=!0)})}function I5(){S_=!0,ND(),kD(),S_=!1}class bb{constructor(t,e,n,s,a,l=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=e,this.name=n,this.motionValue=s,this.element=a,this.isAsync=l}scheduleResolve(){this.state="scheduled",this.isAsync?(Lo.add(this),w_||(w_=!0,Ae.read(ND),Ae.resolveKeyframes(kD))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:e,element:n,motionValue:s}=this;if(t[0]===null){const a=s?.get(),l=t[t.length-1];if(a!==void 0)t[0]=a;else if(n&&e){const c=n.readValue(e,l);c!=null&&(t[0]=c)}t[0]===void 0&&(t[0]=l),s&&a===void 0&&s.set(t[0])}A5(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Lo.delete(this)}cancel(){this.state==="scheduled"&&(Lo.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const D5=i=>i.startsWith("--");function P5(i,t,e){D5(t)?i.style.setProperty(t,e):i.style[t]=e}const M5=lb(()=>window.ScrollTimeline!==void 0),k5={};function N5(i,t){const e=lb(i);return()=>k5[t]??e()}const OD=N5(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),ih=([i,t,e,n])=>`cubic-bezier(${i}, ${t}, ${e}, ${n})`,C1={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ih([0,.65,.55,1]),circOut:ih([.55,0,1,.45]),backIn:ih([.31,.01,.66,-.59]),backOut:ih([.33,1.53,.69,.99])};function LD(i,t){if(i)return typeof i=="function"?OD()?DD(i,t):"ease-out":_D(i)?ih(i):Array.isArray(i)?i.map(e=>LD(e,t)||C1.easeOut):C1[i]}function O5(i,t,e,{delay:n=0,duration:s=300,repeat:a=0,repeatType:l="loop",ease:c="easeOut",times:h}={},d=void 0){const p={[t]:e};h&&(p.offset=h);const m=LD(c,s);Array.isArray(m)&&(p.easing=m);const v={delay:n,duration:s,easing:Array.isArray(m)?"linear":m,fill:"both",iterations:a+1,direction:l==="reverse"?"alternate":"normal"};return d&&(v.pseudoElement=d),i.animate(p,v)}function VD(i){return typeof i=="function"&&"applyToOptions"in i}function L5({type:i,...t}){return VD(i)&&OD()?i.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class V5 extends vb{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!t)return;const{element:e,name:n,keyframes:s,pseudoElement:a,allowFlatten:l=!1,finalKeyframe:c,onComplete:h}=t;this.isPseudoElement=!!a,this.allowFlatten=l,this.options=t,ob(typeof t.type!="string");const d=L5(t);this.animation=O5(e,n,s,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const p=yb(s,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(p):P5(e,n,p),this.animation.cancel()}h?.(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return Vi(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Vi(t)}get time(){return Vi(Number(this.animation.currentTime)||0)}set time(t){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=Ir(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(t){this.manualStartTime=this.animation.startTime=t}attachTimeline({timeline:t,observe:e}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&M5()?(this.animation.timeline=t,Bi):e(this)}}const BD={anticipate:mD,backInOut:pD,circInOut:yD};function B5(i){return i in BD}function F5(i){typeof i.ease=="string"&&B5(i.ease)&&(i.ease=BD[i.ease])}const _v=10;class U5 extends V5{constructor(t){F5(t),MD(t),super(t),t.startTime!==void 0&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:e,onUpdate:n,onComplete:s,element:a,...l}=this.options;if(!e)return;if(t!==void 0){e.set(t);return}const c=new _b({...l,autoplay:!1}),h=Math.max(_v,jn.now()-this.startTime),d=Ks(0,_v,h-_v);e.setWithVelocity(c.sample(Math.max(0,h-d)).value,c.sample(h).value,d),c.stop()}}const x1=(i,t)=>t==="zIndex"?!1:!!(typeof i=="number"||Array.isArray(i)||typeof i=="string"&&(Ba.test(i)||i==="0")&&!i.startsWith("url("));function j5(i){const t=i[0];if(i.length===1)return!0;for(let e=0;e<i.length;e++)if(i[e]!==t)return!0}function z5(i,t,e,n){const s=i[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const a=i[i.length-1],l=x1(s,t),c=x1(a,t);return!l||!c?!1:j5(i)||(e==="spring"||VD(e))&&n}function C_(i){i.duration=0,i.type="keyframes"}const H5=new Set(["opacity","clipPath","filter","transform"]),q5=lb(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function G5(i){const{motionValue:t,name:e,repeatDelay:n,repeatType:s,damping:a,type:l}=i;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:h,transformTemplate:d}=t.owner.getProps();return q5()&&e&&H5.has(e)&&(e!=="transform"||!d)&&!h&&!n&&s!=="mirror"&&a!==0&&l!=="inertia"}const $5=40;class W5 extends vb{constructor({autoplay:t=!0,delay:e=0,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:l="loop",keyframes:c,name:h,motionValue:d,element:p,...m}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=jn.now();const v={autoplay:t,delay:e,type:n,repeat:s,repeatDelay:a,repeatType:l,name:h,motionValue:d,element:p,...m},b=p?.KeyframeResolver||bb;this.keyframeResolver=new b(c,(w,E,S)=>this.onKeyframesResolved(w,E,v,!S),h,d,p),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,e,n,s){this.keyframeResolver=void 0;const{name:a,type:l,velocity:c,delay:h,isHandoff:d,onUpdate:p}=n;this.resolvedAt=jn.now(),z5(t,a,l,c)||((Lr.instantAnimations||!h)&&p?.(yb(t,n,e)),t[0]=t[t.length-1],C_(n),n.repeat=0);const v={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>$5?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:e,...n,keyframes:t},b=!d&&G5(v),w=v.motionValue?.owner?.current,E=b?new U5({...v,element:w}):new _b(v);E.finished.then(()=>{this.notifyFinished()}).catch(Bi),this.pendingTimeline&&(this.stopTimeline=E.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=E}get finished(){return this._animation?this.animation.finished:this._finished}then(t,e){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),I5()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}function FD(i,t,e,n=0,s=1){const a=Array.from(i).sort((d,p)=>d.sortNodePosition(p)).indexOf(t),l=i.size,c=(l-1)*n;return typeof e=="function"?e(a,l):s===1?a*n:c-a*n}const K5=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Y5(i){const t=K5.exec(i);if(!t)return[,];const[,e,n,s]=t;return[`--${e??n}`,s]}function UD(i,t,e=1){const[n,s]=Y5(i);if(!n)return;const a=window.getComputedStyle(t).getPropertyValue(n);if(a){const l=a.trim();return aD(l)?parseFloat(l):l}return db(s)?UD(s,t,e+1):s}const X5={type:"spring",stiffness:500,damping:25,restSpeed:10},Q5=i=>({type:"spring",stiffness:550,damping:i===0?2*Math.sqrt(550):30,restSpeed:10}),J5={type:"keyframes",duration:.8},Z5={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},tj=(i,{keyframes:t})=>t.length>2?J5:Lc.has(i)?i.startsWith("scale")?Q5(t[1]):X5:Z5,ej=i=>i!==null;function nj(i,{repeat:t,repeatType:e="loop"},n){const s=i.filter(ej),a=t&&e!=="loop"&&t%2===1?0:s.length-1;return s[a]}function Ab(i,t){return i?.[t]??i?.default??i}function ij({when:i,delay:t,delayChildren:e,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:l,repeatDelay:c,from:h,elapsed:d,...p}){return!!Object.keys(p).length}const Eb=(i,t,e,n={},s,a)=>l=>{const c=Ab(n,i)||{},h=c.delay||n.delay||0;let{elapsed:d=0}=n;d=d-Ir(h);const p={keyframes:Array.isArray(e)?e:[null,e],ease:"easeOut",velocity:t.getVelocity(),...c,delay:-d,onUpdate:v=>{t.set(v),c.onUpdate&&c.onUpdate(v)},onComplete:()=>{l(),c.onComplete&&c.onComplete()},name:i,motionValue:t,element:a?void 0:s};ij(c)||Object.assign(p,tj(i,p)),p.duration&&(p.duration=Ir(p.duration)),p.repeatDelay&&(p.repeatDelay=Ir(p.repeatDelay)),p.from!==void 0&&(p.keyframes[0]=p.from);let m=!1;if((p.type===!1||p.duration===0&&!p.repeatDelay)&&(C_(p),p.delay===0&&(m=!0)),(Lr.instantAnimations||Lr.skipAnimations)&&(m=!0,C_(p),p.delay=0),p.allowFlatten=!c.type&&!c.ease,m&&!a&&t.get()!==void 0){const v=nj(p.keyframes,c);if(v!==void 0){Ae.update(()=>{p.onUpdate(v),p.onComplete()});return}}return c.isSync?new _b(p):new W5(p)};function R1(i){const t=[{},{}];return i?.values.forEach((e,n)=>{t[0][n]=e.get(),t[1][n]=e.getVelocity()}),t}function wb(i,t,e,n){if(typeof t=="function"){const[s,a]=R1(n);t=t(e!==void 0?e:i.custom,s,a)}if(typeof t=="string"&&(t=i.variants&&i.variants[t]),typeof t=="function"){const[s,a]=R1(n);t=t(e!==void 0?e:i.custom,s,a)}return t}function cc(i,t,e){const n=i.getProps();return wb(n,t,e!==void 0?e:n.custom,i)}const jD=new Set(["width","height","top","left","right","bottom",...Oc]),I1=30,sj=i=>!isNaN(parseFloat(i));class rj{constructor(t,e={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{const s=jn.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=e.owner}setCurrent(t){this.current=t,this.updatedAt=jn.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=sj(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,e){this.events[t]||(this.events[t]=new cb);const n=this.events[t].add(e);return t==="change"?()=>{n(),Ae.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,e){this.passiveEffect=t,this.stopPassiveEffect=e}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,e,n){this.set(e),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,e=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,e&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=jn.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>I1)return 0;const e=Math.min(this.updatedAt-this.prevUpdatedAt,I1);return cD(parseFloat(this.current)-parseFloat(this.prevFrameValue),e)}start(t){return this.stop(),new Promise(e=>{this.hasAnimated=!0,this.animation=t(e),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ec(i,t){return new rj(i,t)}const x_=i=>Array.isArray(i);function aj(i,t,e){i.hasValue(t)?i.getValue(t).set(e):i.addValue(t,Ec(e))}function oj(i){return x_(i)?i[i.length-1]||0:i}function lj(i,t){const e=cc(i,t);let{transitionEnd:n={},transition:s={},...a}=e||{};a={...a,...n};for(const l in a){const c=oj(a[l]);aj(i,l,c)}}const kn=i=>!!(i&&i.getVelocity);function cj(i){return!!(kn(i)&&i.add)}function R_(i,t){const e=i.getValue("willChange");if(cj(e))return e.add(t);if(!e&&Lr.WillChange){const n=new Lr.WillChange("auto");i.addValue("willChange",n),n.add(t)}}function Tb(i){return i.replace(/([A-Z])/g,t=>`-${t.toLowerCase()}`)}const uj="framerAppearId",zD="data-"+Tb(uj);function HD(i){return i.props[zD]}function hj({protectedKeys:i,needsAnimating:t},e){const n=i.hasOwnProperty(e)&&t[e]!==!0;return t[e]=!1,n}function qD(i,t,{delay:e=0,transitionOverride:n,type:s}={}){let{transition:a=i.getDefaultTransition(),transitionEnd:l,...c}=t;n&&(a=n);const h=[],d=s&&i.animationState&&i.animationState.getState()[s];for(const p in c){const m=i.getValue(p,i.latestValues[p]??null),v=c[p];if(v===void 0||d&&hj(d,p))continue;const b={delay:e,...Ab(a||{},p)},w=m.get();if(w!==void 0&&!m.isAnimating&&!Array.isArray(v)&&v===w&&!b.velocity)continue;let E=!1;if(window.MotionHandoffAnimation){const C=HD(i);if(C){const R=window.MotionHandoffAnimation(C,p,Ae);R!==null&&(b.startTime=R,E=!0)}}R_(i,p),m.start(Eb(p,m,v,i.shouldReduceMotion&&jD.has(p)?{type:!1}:b,i,E));const S=m.animation;S&&h.push(S)}return l&&Promise.all(h).then(()=>{Ae.update(()=>{l&&lj(i,l)})}),h}function I_(i,t,e={}){const n=cc(i,t,e.type==="exit"?i.presenceContext?.custom:void 0);let{transition:s=i.getDefaultTransition()||{}}=n||{};e.transitionOverride&&(s=e.transitionOverride);const a=n?()=>Promise.all(qD(i,n,e)):()=>Promise.resolve(),l=i.variantChildren&&i.variantChildren.size?(h=0)=>{const{delayChildren:d=0,staggerChildren:p,staggerDirection:m}=s;return dj(i,t,h,d,p,m,e)}:()=>Promise.resolve(),{when:c}=s;if(c){const[h,d]=c==="beforeChildren"?[a,l]:[l,a];return h().then(()=>d())}else return Promise.all([a(),l(e.delay)])}function dj(i,t,e=0,n=0,s=0,a=1,l){const c=[];for(const h of i.variantChildren)h.notify("AnimationStart",t),c.push(I_(h,t,{...l,delay:e+(typeof n=="function"?0:n)+FD(i.variantChildren,h,n,s,a)}).then(()=>h.notify("AnimationComplete",t)));return Promise.all(c)}function fj(i,t,e={}){i.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(a=>I_(i,a,e));n=Promise.all(s)}else if(typeof t=="string")n=I_(i,t,e);else{const s=typeof t=="function"?cc(i,t,e.custom):t;n=Promise.all(qD(i,s,e))}return n.then(()=>{i.notify("AnimationComplete",t)})}const pj={test:i=>i==="auto",parse:i=>i},GD=i=>t=>t.test(i),$D=[Nc,_t,Gs,ya,j6,U6,pj],D1=i=>$D.find(GD(i));function mj(i){return typeof i=="number"?i===0:i!==null?i==="none"||i==="0"||lD(i):!0}const gj=new Set(["brightness","contrast","saturate","opacity"]);function yj(i){const[t,e]=i.slice(0,-1).split("(");if(t==="drop-shadow")return i;const[n]=e.match(fb)||[];if(!n)return i;const s=e.replace(n,"");let a=gj.has(t)?1:0;return n!==e&&(a*=100),t+"("+a+s+")"}const vj=/\b([a-z-]*)\(.*?\)/gu,D_={...Ba,getAnimatableNone:i=>{const t=i.match(vj);return t?t.map(yj).join(" "):i}},P1={...Nc,transform:Math.round},_j={rotate:ya,rotateX:ya,rotateY:ya,rotateZ:ya,scale:Jf,scaleX:Jf,scaleY:Jf,scaleZ:Jf,skew:ya,skewX:ya,skewY:ya,distance:_t,translateX:_t,translateY:_t,translateZ:_t,x:_t,y:_t,z:_t,perspective:_t,transformPerspective:_t,opacity:Mh,originX:y1,originY:y1,originZ:_t},Sb={borderWidth:_t,borderTopWidth:_t,borderRightWidth:_t,borderBottomWidth:_t,borderLeftWidth:_t,borderRadius:_t,radius:_t,borderTopLeftRadius:_t,borderTopRightRadius:_t,borderBottomRightRadius:_t,borderBottomLeftRadius:_t,width:_t,maxWidth:_t,height:_t,maxHeight:_t,top:_t,right:_t,bottom:_t,left:_t,inset:_t,insetBlock:_t,insetBlockStart:_t,insetBlockEnd:_t,insetInline:_t,insetInlineStart:_t,insetInlineEnd:_t,padding:_t,paddingTop:_t,paddingRight:_t,paddingBottom:_t,paddingLeft:_t,paddingBlock:_t,paddingBlockStart:_t,paddingBlockEnd:_t,paddingInline:_t,paddingInlineStart:_t,paddingInlineEnd:_t,margin:_t,marginTop:_t,marginRight:_t,marginBottom:_t,marginLeft:_t,marginBlock:_t,marginBlockStart:_t,marginBlockEnd:_t,marginInline:_t,marginInlineStart:_t,marginInlineEnd:_t,backgroundPositionX:_t,backgroundPositionY:_t,..._j,zIndex:P1,fillOpacity:Mh,strokeOpacity:Mh,numOctaves:P1},bj={...Sb,color:Ze,backgroundColor:Ze,outlineColor:Ze,fill:Ze,stroke:Ze,borderColor:Ze,borderTopColor:Ze,borderRightColor:Ze,borderBottomColor:Ze,borderLeftColor:Ze,filter:D_,WebkitFilter:D_},WD=i=>bj[i];function KD(i,t){let e=WD(i);return e!==D_&&(e=Ba),e.getAnimatableNone?e.getAnimatableNone(t):void 0}const Aj=new Set(["auto","none","0"]);function Ej(i,t,e){let n=0,s;for(;n<i.length&&!s;){const a=i[n];typeof a=="string"&&!Aj.has(a)&&kh(a).values.length&&(s=i[n]),n++}if(s&&e)for(const a of t)i[a]=KD(e,s)}class wj extends bb{constructor(t,e,n,s,a){super(t,e,n,s,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:e,name:n}=this;if(!e||!e.current)return;super.readKeyframes();for(let p=0;p<t.length;p++){let m=t[p];if(typeof m=="string"&&(m=m.trim(),db(m))){const v=UD(m,e.current);v!==void 0&&(t[p]=v),p===t.length-1&&(this.finalKeyframe=m)}}if(this.resolveNoneKeyframes(),!jD.has(n)||t.length!==2)return;const[s,a]=t,l=D1(s),c=D1(a),h=g1(s),d=g1(a);if(h!==d&&Sa[n]){this.needsMeasurement=!0;return}if(l!==c)if(S1(l)&&S1(c))for(let p=0;p<t.length;p++){const m=t[p];typeof m=="string"&&(t[p]=parseFloat(m))}else Sa[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:e}=this,n=[];for(let s=0;s<t.length;s++)(t[s]===null||mj(t[s]))&&n.push(s);n.length&&Ej(t,n,e)}measureInitialState(){const{element:t,unresolvedKeyframes:e,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Sa[n](t.measureViewportBox(),window.getComputedStyle(t.current)),e[0]=this.measuredOrigin;const s=e[e.length-1];s!==void 0&&t.getValue(n,s).jump(s,!1)}measureEndState(){const{element:t,name:e,unresolvedKeyframes:n}=this;if(!t||!t.current)return;const s=t.getValue(e);s&&s.jump(this.measuredOrigin,!1);const a=n.length-1,l=n[a];n[a]=Sa[e](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),this.removedTransforms?.length&&this.removedTransforms.forEach(([c,h])=>{t.getValue(c).set(h)}),this.resolveNoneKeyframes()}}function Tj(i,t,e){if(i==null)return[];if(i instanceof EventTarget)return[i];if(typeof i=="string"){let n=document;const s=e?.[i]??n.querySelectorAll(i);return s?Array.from(s):[]}return Array.from(i).filter(n=>n!=null)}const YD=(i,t)=>t&&typeof i=="number"?t.transform(i):i;function P_(i){return oD(i)&&"offsetHeight"in i}const{schedule:Cb}=bD(queueMicrotask,!1),ts={x:!1,y:!1};function XD(){return ts.x||ts.y}function Sj(i){return i==="x"||i==="y"?ts[i]?null:(ts[i]=!0,()=>{ts[i]=!1}):ts.x||ts.y?null:(ts.x=ts.y=!0,()=>{ts.x=ts.y=!1})}function QD(i,t){const e=Tj(i),n=new AbortController,s={passive:!0,...t,signal:n.signal};return[e,s,()=>n.abort()]}function M1(i){return!(i.pointerType==="touch"||XD())}function Cj(i,t,e={}){const[n,s,a]=QD(i,e),l=c=>{if(!M1(c))return;const{target:h}=c,d=t(h,c);if(typeof d!="function"||!h)return;const p=m=>{M1(m)&&(d(m),h.removeEventListener("pointerleave",p))};h.addEventListener("pointerleave",p,s)};return n.forEach(c=>{c.addEventListener("pointerenter",l,s)}),a}const JD=(i,t)=>t?i===t?!0:JD(i,t.parentElement):!1,xb=i=>i.pointerType==="mouse"?typeof i.button!="number"||i.button<=0:i.isPrimary!==!1,xj=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function ZD(i){return xj.has(i.tagName)||i.isContentEditable===!0}const Sp=new WeakSet;function k1(i){return t=>{t.key==="Enter"&&i(t)}}function bv(i,t){i.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const Rj=(i,t)=>{const e=i.currentTarget;if(!e)return;const n=k1(()=>{if(Sp.has(e))return;bv(e,"down");const s=k1(()=>{bv(e,"up")}),a=()=>bv(e,"cancel");e.addEventListener("keyup",s,t),e.addEventListener("blur",a,t)});e.addEventListener("keydown",n,t),e.addEventListener("blur",()=>e.removeEventListener("keydown",n),t)};function N1(i){return xb(i)&&!XD()}function Ij(i,t,e={}){const[n,s,a]=QD(i,e),l=c=>{const h=c.currentTarget;if(!N1(c))return;Sp.add(h);const d=t(h,c),p=(b,w)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",v),Sp.has(h)&&Sp.delete(h),N1(b)&&typeof d=="function"&&d(b,{success:w})},m=b=>{p(b,h===window||h===document||e.useGlobalTarget||JD(h,b.target))},v=b=>{p(b,!1)};window.addEventListener("pointerup",m,s),window.addEventListener("pointercancel",v,s)};return n.forEach(c=>{(e.useGlobalTarget?window:c).addEventListener("pointerdown",l,s),P_(c)&&(c.addEventListener("focus",d=>Rj(d,s)),!ZD(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),a}function tP(i){return oD(i)&&"ownerSVGElement"in i}function Dj(i){return tP(i)&&i.tagName==="svg"}const Pj=[...$D,Ze,Ba],Mj=i=>Pj.find(GD(i)),O1=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ql=()=>({x:O1(),y:O1()}),L1=()=>({min:0,max:0}),on=()=>({x:L1(),y:L1()}),M_={current:null},eP={current:!1},kj=typeof window<"u";function Nj(){if(eP.current=!0,!!kj)if(window.matchMedia){const i=window.matchMedia("(prefers-reduced-motion)"),t=()=>M_.current=i.matches;i.addEventListener("change",t),t()}else M_.current=!1}const Oj=new WeakMap;function Vm(i){return i!==null&&typeof i=="object"&&typeof i.start=="function"}function Nh(i){return typeof i=="string"||Array.isArray(i)}const Rb=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Ib=["initial",...Rb];function Bm(i){return Vm(i.animate)||Ib.some(t=>Nh(i[t]))}function nP(i){return!!(Bm(i)||i.variants)}function Lj(i,t,e){for(const n in t){const s=t[n],a=e[n];if(kn(s))i.addValue(n,s);else if(kn(a))i.addValue(n,Ec(s,{owner:i}));else if(a!==s)if(i.hasValue(n)){const l=i.getValue(n);l.liveStyle===!0?l.jump(s):l.hasAnimated||l.set(s)}else{const l=i.getStaticValue(n);i.addValue(n,Ec(l!==void 0?l:s,{owner:i}))}}for(const n in e)t[n]===void 0&&i.removeValue(n);return t}const V1=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let am={};function iP(i){am=i}function Vj(){return am}class Bj{scrapeMotionValuesFromProps(t,e,n){return{}}constructor({parent:t,props:e,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:a,visualState:l},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=bb,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=jn.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,Ae.render(this.render,!1,!0))};const{latestValues:h,renderState:d}=l;this.latestValues=h,this.baseTarget={...h},this.initialValues=e.initial?{...h}:{},this.renderState=d,this.parent=t,this.props=e,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=c,this.blockInitialAnimation=!!a,this.isControllingVariants=Bm(e),this.isVariantNode=nP(e),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:p,...m}=this.scrapeMotionValuesFromProps(e,{},this);for(const v in m){const b=m[v];h[v]!==void 0&&kn(b)&&b.set(h[v])}}mount(t){this.current=t,Oj.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,n)=>this.bindToMotionValue(n,e)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(eP.current||Nj(),this.shouldReduceMotion=M_.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Va(this.notifyUpdate),Va(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,e){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=Lc.has(t);n&&this.onBindTransform&&this.onBindTransform();const s=e.on("change",l=>{this.latestValues[t]=l,this.props.onUpdate&&Ae.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;typeof window<"u"&&window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,e)),this.valueSubscriptions.set(t,()=>{s(),a&&a(),e.owner&&e.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in am){const e=am[t];if(!e)continue;const{isEnabled:n,Feature:s}=e;if(!this.features[t]&&s&&n(this.props)&&(this.features[t]=new s(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):on()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,e){this.latestValues[t]=e}update(t,e){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=e;for(let n=0;n<V1.length;n++){const s=V1[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a="on"+s,l=t[a];l&&(this.propEventSubscriptions[s]=this.on(s,l))}this.prevMotionValues=Lj(this,this.scrapeMotionValuesFromProps(t,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const e=this.getClosestVariantNode();if(e)return e.variantChildren&&e.variantChildren.add(t),()=>e.variantChildren.delete(t)}addValue(t,e){const n=this.values.get(t);e!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,e),this.values.set(t,e),this.latestValues[t]=e.get())}removeValue(t){this.values.delete(t);const e=this.valueSubscriptions.get(t);e&&(e(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,e){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&e!==void 0&&(n=Ec(e===null?void 0:e,{owner:this}),this.addValue(t,n)),n}readValue(t,e){let n=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return n!=null&&(typeof n=="string"&&(aD(n)||lD(n))?n=parseFloat(n):!Mj(n)&&Ba.test(e)&&(n=KD(t,e)),this.setBaseTarget(t,kn(n)?n.get():n)),kn(n)?n.get():n}setBaseTarget(t,e){this.baseTarget[t]=e}getBaseTarget(t){const{initial:e}=this.props;let n;if(typeof e=="string"||typeof e=="object"){const a=wb(this.props,e,this.presenceContext?.custom);a&&(n=a[t])}if(e&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!kn(s)?s:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,e){return this.events[t]||(this.events[t]=new cb),this.events[t].add(e)}notify(t,...e){this.events[t]&&this.events[t].notify(...e)}scheduleRenderMicrotask(){Cb.render(this.render)}}class sP extends Bj{constructor(){super(...arguments),this.KeyframeResolver=wj}sortInstanceNodePosition(t,e){return t.compareDocumentPosition(e)&2?1:-1}getBaseTargetFromProps(t,e){const n=t.style;return n?n[e]:void 0}removeValueFromRenderState(t,{vars:e,style:n}){delete e[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;kn(t)&&(this.childSubscription=t.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}class Ga{constructor(t){this.isMounted=!1,this.node=t}update(){}}function rP({top:i,left:t,right:e,bottom:n}){return{x:{min:t,max:e},y:{min:i,max:n}}}function Fj({x:i,y:t}){return{top:t.min,right:i.max,bottom:t.max,left:i.min}}function Uj(i,t){if(!t)return i;const e=t({x:i.left,y:i.top}),n=t({x:i.right,y:i.bottom});return{top:e.y,left:e.x,bottom:n.y,right:n.x}}function Av(i){return i===void 0||i===1}function k_({scale:i,scaleX:t,scaleY:e}){return!Av(i)||!Av(t)||!Av(e)}function So(i){return k_(i)||aP(i)||i.z||i.rotate||i.rotateX||i.rotateY||i.skewX||i.skewY}function aP(i){return B1(i.x)||B1(i.y)}function B1(i){return i&&i!=="0%"}function om(i,t,e){const n=i-e,s=t*n;return e+s}function F1(i,t,e,n,s){return s!==void 0&&(i=om(i,s,n)),om(i,e,n)+t}function N_(i,t=0,e=1,n,s){i.min=F1(i.min,t,e,n,s),i.max=F1(i.max,t,e,n,s)}function oP(i,{x:t,y:e}){N_(i.x,t.translate,t.scale,t.originPoint),N_(i.y,e.translate,e.scale,e.originPoint)}const U1=.999999999999,j1=1.0000000000001;function jj(i,t,e,n=!1){const s=e.length;if(!s)return;t.x=t.y=1;let a,l;for(let c=0;c<s;c++){a=e[c],l=a.projectionDelta;const{visualElement:h}=a.options;h&&h.props.style&&h.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Zl(i,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),l&&(t.x*=l.x.scale,t.y*=l.y.scale,oP(i,l)),n&&So(a.latestValues)&&Zl(i,a.latestValues))}t.x<j1&&t.x>U1&&(t.x=1),t.y<j1&&t.y>U1&&(t.y=1)}function Jl(i,t){i.min=i.min+t,i.max=i.max+t}function z1(i,t,e,n,s=.5){const a=Re(i.min,i.max,s);N_(i,t,e,a,n)}function Zl(i,t){z1(i.x,t.x,t.scaleX,t.scale,t.originX),z1(i.y,t.y,t.scaleY,t.scale,t.originY)}function lP(i,t){return rP(Uj(i.getBoundingClientRect(),t))}function zj(i,t,e){const n=lP(i,e),{scroll:s}=t;return s&&(Jl(n.x,s.offset.x),Jl(n.y,s.offset.y)),n}const Hj={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},qj=Oc.length;function Gj(i,t,e){let n="",s=!0;for(let a=0;a<qj;a++){const l=Oc[a],c=i[l];if(c===void 0)continue;let h=!0;if(typeof c=="number")h=c===(l.startsWith("scale")?1:0);else{const d=parseFloat(c);h=l.startsWith("scale")?d===1:d===0}if(!h||e){const d=YD(c,Sb[l]);if(!h){s=!1;const p=Hj[l]||l;n+=`${p}(${d}) `}e&&(t[l]=d)}}return n=n.trim(),e?n=e(t,s?"":n):s&&(n="none"),n}function Db(i,t,e){const{style:n,vars:s,transformOrigin:a}=i;let l=!1,c=!1;for(const h in t){const d=t[h];if(Lc.has(h)){l=!0;continue}else if(ED(h)){s[h]=d;continue}else{const p=YD(d,Sb[h]);h.startsWith("origin")?(c=!0,a[h]=p):n[h]=p}}if(t.transform||(l||e?n.transform=Gj(t,i.transform,e):n.transform&&(n.transform="none")),c){const{originX:h="50%",originY:d="50%",originZ:p=0}=a;n.transformOrigin=`${h} ${d} ${p}`}}function cP(i,{style:t,vars:e},n,s){const a=i.style;let l;for(l in t)a[l]=t[l];s?.applyProjectionStyles(a,n);for(l in e)a.setProperty(l,e[l])}function H1(i,t){return t.max===t.min?0:i/(t.max-t.min)*100}const Gu={correct:(i,t)=>{if(!t.target)return i;if(typeof i=="string")if(_t.test(i))i=parseFloat(i);else return i;const e=H1(i,t.target.x),n=H1(i,t.target.y);return`${e}% ${n}%`}},$j={correct:(i,{treeScale:t,projectionDelta:e})=>{const n=i,s=Ba.parse(i);if(s.length>5)return n;const a=Ba.createTransformer(i),l=typeof s[0]!="number"?1:0,c=e.x.scale*t.x,h=e.y.scale*t.y;s[0+l]/=c,s[1+l]/=h;const d=Re(c,h,.5);return typeof s[2+l]=="number"&&(s[2+l]/=d),typeof s[3+l]=="number"&&(s[3+l]/=d),a(s)}},O_={borderRadius:{...Gu,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Gu,borderTopRightRadius:Gu,borderBottomLeftRadius:Gu,borderBottomRightRadius:Gu,boxShadow:$j};function uP(i,{layout:t,layoutId:e}){return Lc.has(i)||i.startsWith("origin")||(t||e!==void 0)&&(!!O_[i]||i==="opacity")}function Pb(i,t,e){const n=i.style,s=t?.style,a={};if(!n)return a;for(const l in n)(kn(n[l])||s&&kn(s[l])||uP(l,i)||e?.getValue(l)?.liveStyle!==void 0)&&(a[l]=n[l]);return a}function Wj(i){return window.getComputedStyle(i)}class Kj extends sP{constructor(){super(...arguments),this.type="html",this.renderInstance=cP}readValueFromInstance(t,e){if(Lc.has(e))return this.projection?.isProjecting?A_(e):T5(t,e);{const n=Wj(t),s=(ED(e)?n.getPropertyValue(e):n[e])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:e}){return lP(t,e)}build(t,e,n){Db(t,e,n.transformTemplate)}scrapeMotionValuesFromProps(t,e,n){return Pb(t,e,n)}}const Yj={offset:"stroke-dashoffset",array:"stroke-dasharray"},Xj={offset:"strokeDashoffset",array:"strokeDasharray"};function Qj(i,t,e=1,n=0,s=!0){i.pathLength=1;const a=s?Yj:Xj;i[a.offset]=`${-n}`,i[a.array]=`${t} ${e}`}const Jj=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function hP(i,{attrX:t,attrY:e,attrScale:n,pathLength:s,pathSpacing:a=1,pathOffset:l=0,...c},h,d,p){if(Db(i,c,d),h){i.style.viewBox&&(i.attrs.viewBox=i.style.viewBox);return}i.attrs=i.style,i.style={};const{attrs:m,style:v}=i;m.transform&&(v.transform=m.transform,delete m.transform),(v.transform||m.transformOrigin)&&(v.transformOrigin=m.transformOrigin??"50% 50%",delete m.transformOrigin),v.transform&&(v.transformBox=p?.transformBox??"fill-box",delete m.transformBox);for(const b of Jj)m[b]!==void 0&&(v[b]=m[b],delete m[b]);t!==void 0&&(m.x=t),e!==void 0&&(m.y=e),n!==void 0&&(m.scale=n),s!==void 0&&Qj(m,s,a,l,!1)}const dP=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),fP=i=>typeof i=="string"&&i.toLowerCase()==="svg";function Zj(i,t,e,n){cP(i,t,void 0,n);for(const s in t.attrs)i.setAttribute(dP.has(s)?s:Tb(s),t.attrs[s])}function pP(i,t,e){const n=Pb(i,t,e);for(const s in i)if(kn(i[s])||kn(t[s])){const a=Oc.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[a]=i[s]}return n}class tz extends sP{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=on}getBaseTargetFromProps(t,e){return t[e]}readValueFromInstance(t,e){if(Lc.has(e)){const n=WD(e);return n&&n.default||0}return e=dP.has(e)?e:Tb(e),t.getAttribute(e)}scrapeMotionValuesFromProps(t,e,n){return pP(t,e,n)}build(t,e,n){hP(t,e,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(t,e,n,s){Zj(t,e,n,s)}mount(t){this.isSVGTag=fP(t.tagName),super.mount(t)}}const ez=Ib.length;function mP(i){if(!i)return;if(!i.isControllingVariants){const e=i.parent?mP(i.parent)||{}:{};return i.props.initial!==void 0&&(e.initial=i.props.initial),e}const t={};for(let e=0;e<ez;e++){const n=Ib[e],s=i.props[n];(Nh(s)||s===!1)&&(t[n]=s)}return t}function gP(i,t){if(!Array.isArray(t))return!1;const e=t.length;if(e!==i.length)return!1;for(let n=0;n<e;n++)if(t[n]!==i[n])return!1;return!0}const nz=[...Rb].reverse(),iz=Rb.length;function sz(i){return t=>Promise.all(t.map(({animation:e,options:n})=>fj(i,e,n)))}function rz(i){let t=sz(i),e=q1(),n=!0;const s=h=>(d,p)=>{const m=cc(i,p,h==="exit"?i.presenceContext?.custom:void 0);if(m){const{transition:v,transitionEnd:b,...w}=m;d={...d,...w,...b}}return d};function a(h){t=h(i)}function l(h){const{props:d}=i,p=mP(i.parent)||{},m=[],v=new Set;let b={},w=1/0;for(let S=0;S<iz;S++){const C=nz[S],R=e[C],I=d[C]!==void 0?d[C]:p[C],B=Nh(I),F=C===h?R.isActive:null;F===!1&&(w=S);let j=I===p[C]&&I!==d[C]&&B;if(j&&n&&i.manuallyAnimateOnMount&&(j=!1),R.protectedKeys={...b},!R.isActive&&F===null||!I&&!R.prevProp||Vm(I)||typeof I=="boolean")continue;const P=az(R.prevProp,I);let D=P||C===h&&R.isActive&&!j&&B||S>w&&B,M=!1;const V=Array.isArray(I)?I:[I];let O=V.reduce(s(C),{});F===!1&&(O={});const{prevResolvedValues:G={}}=R,U={...G,...O},gt=K=>{D=!0,v.has(K)&&(M=!0,v.delete(K)),R.needsAnimating[K]=!0;const tt=i.getValue(K);tt&&(tt.liveStyle=!1)};for(const K in U){const tt=O[K],ut=G[K];if(b.hasOwnProperty(K))continue;let At=!1;x_(tt)&&x_(ut)?At=!gP(tt,ut):At=tt!==ut,At?tt!=null?gt(K):v.add(K):tt!==void 0&&v.has(K)?gt(K):R.protectedKeys[K]=!0}R.prevProp=I,R.prevResolvedValues=O,R.isActive&&(b={...b,...O}),n&&i.blockInitialAnimation&&(D=!1);const Pt=j&&P;D&&(!Pt||M)&&m.push(...V.map(K=>{const tt={type:C};if(typeof K=="string"&&n&&!Pt&&i.manuallyAnimateOnMount&&i.parent){const{parent:ut}=i,At=cc(ut,K);if(ut.enteringChildren&&At){const{delayChildren:H}=At.transition||{};tt.delay=FD(ut.enteringChildren,i,H)}}return{animation:K,options:tt}}))}if(v.size){const S={};if(typeof d.initial!="boolean"){const C=cc(i,Array.isArray(d.initial)?d.initial[0]:d.initial);C&&C.transition&&(S.transition=C.transition)}v.forEach(C=>{const R=i.getBaseTarget(C),I=i.getValue(C);I&&(I.liveStyle=!0),S[C]=R??null}),m.push({animation:S})}let E=!!m.length;return n&&(d.initial===!1||d.initial===d.animate)&&!i.manuallyAnimateOnMount&&(E=!1),n=!1,E?t(m):Promise.resolve()}function c(h,d){if(e[h].isActive===d)return Promise.resolve();i.variantChildren?.forEach(m=>m.animationState?.setActive(h,d)),e[h].isActive=d;const p=l(h);for(const m in e)e[m].protectedKeys={};return p}return{animateChanges:l,setActive:c,setAnimateFunction:a,getState:()=>e,reset:()=>{e=q1()}}}function az(i,t){return typeof t=="string"?t!==i:Array.isArray(t)?!gP(t,i):!1}function wo(i=!1){return{isActive:i,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function q1(){return{animate:wo(!0),whileInView:wo(),whileHover:wo(),whileTap:wo(),whileDrag:wo(),whileFocus:wo(),exit:wo()}}function G1(i,t){i.min=t.min,i.max=t.max}function Zi(i,t){G1(i.x,t.x),G1(i.y,t.y)}function $1(i,t){i.translate=t.translate,i.scale=t.scale,i.originPoint=t.originPoint,i.origin=t.origin}const yP=1e-4,oz=1-yP,lz=1+yP,vP=.01,cz=0-vP,uz=0+vP;function zn(i){return i.max-i.min}function hz(i,t,e){return Math.abs(i-t)<=e}function W1(i,t,e,n=.5){i.origin=n,i.originPoint=Re(t.min,t.max,i.origin),i.scale=zn(e)/zn(t),i.translate=Re(e.min,e.max,i.origin)-i.originPoint,(i.scale>=oz&&i.scale<=lz||isNaN(i.scale))&&(i.scale=1),(i.translate>=cz&&i.translate<=uz||isNaN(i.translate))&&(i.translate=0)}function yh(i,t,e,n){W1(i.x,t.x,e.x,n?n.originX:void 0),W1(i.y,t.y,e.y,n?n.originY:void 0)}function K1(i,t,e){i.min=e.min+t.min,i.max=i.min+zn(t)}function dz(i,t,e){K1(i.x,t.x,e.x),K1(i.y,t.y,e.y)}function Y1(i,t,e){i.min=t.min-e.min,i.max=i.min+zn(t)}function lm(i,t,e){Y1(i.x,t.x,e.x),Y1(i.y,t.y,e.y)}function X1(i,t,e,n,s){return i-=t,i=om(i,1/e,n),s!==void 0&&(i=om(i,1/s,n)),i}function fz(i,t=0,e=1,n=.5,s,a=i,l=i){if(Gs.test(t)&&(t=parseFloat(t),t=Re(l.min,l.max,t/100)-l.min),typeof t!="number")return;let c=Re(a.min,a.max,n);i===a&&(c-=t),i.min=X1(i.min,t,e,c,s),i.max=X1(i.max,t,e,c,s)}function Q1(i,t,[e,n,s],a,l){fz(i,t[e],t[n],t[s],t.scale,a,l)}const pz=["x","scaleX","originX"],mz=["y","scaleY","originY"];function J1(i,t,e,n){Q1(i.x,t,pz,e?e.x:void 0,n?n.x:void 0),Q1(i.y,t,mz,e?e.y:void 0,n?n.y:void 0)}function Z1(i){return i.translate===0&&i.scale===1}function _P(i){return Z1(i.x)&&Z1(i.y)}function tC(i,t){return i.min===t.min&&i.max===t.max}function gz(i,t){return tC(i.x,t.x)&&tC(i.y,t.y)}function eC(i,t){return Math.round(i.min)===Math.round(t.min)&&Math.round(i.max)===Math.round(t.max)}function bP(i,t){return eC(i.x,t.x)&&eC(i.y,t.y)}function nC(i){return zn(i.x)/zn(i.y)}function iC(i,t){return i.translate===t.translate&&i.scale===t.scale&&i.originPoint===t.originPoint}function ki(i){return[i("x"),i("y")]}function yz(i,t,e){let n="";const s=i.x.translate/t.x,a=i.y.translate/t.y,l=e?.z||0;if((s||a||l)&&(n=`translate3d(${s}px, ${a}px, ${l}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),e){const{transformPerspective:d,rotate:p,rotateX:m,rotateY:v,skewX:b,skewY:w}=e;d&&(n=`perspective(${d}px) ${n}`),p&&(n+=`rotate(${p}deg) `),m&&(n+=`rotateX(${m}deg) `),v&&(n+=`rotateY(${v}deg) `),b&&(n+=`skewX(${b}deg) `),w&&(n+=`skewY(${w}deg) `)}const c=i.x.scale*t.x,h=i.y.scale*t.y;return(c!==1||h!==1)&&(n+=`scale(${c}, ${h})`),n||"none"}const AP=["TopLeft","TopRight","BottomLeft","BottomRight"],vz=AP.length,sC=i=>typeof i=="string"?parseFloat(i):i,rC=i=>typeof i=="number"||_t.test(i);function _z(i,t,e,n,s,a){s?(i.opacity=Re(0,e.opacity??1,bz(n)),i.opacityExit=Re(t.opacity??1,0,Az(n))):a&&(i.opacity=Re(t.opacity??1,e.opacity??1,n));for(let l=0;l<vz;l++){const c=`border${AP[l]}Radius`;let h=aC(t,c),d=aC(e,c);if(h===void 0&&d===void 0)continue;h||(h=0),d||(d=0),h===0||d===0||rC(h)===rC(d)?(i[c]=Math.max(Re(sC(h),sC(d),n),0),(Gs.test(d)||Gs.test(h))&&(i[c]+="%")):i[c]=d}(t.rotate||e.rotate)&&(i.rotate=Re(t.rotate||0,e.rotate||0,n))}function aC(i,t){return i[t]!==void 0?i[t]:i.borderRadius}const bz=EP(0,.5,gD),Az=EP(.5,.95,Bi);function EP(i,t,e){return n=>n<i?0:n>t?1:e(Ph(i,t,n))}function Ez(i,t,e){const n=kn(i)?i:Ec(i);return n.start(Eb("",n,t,e)),n.animation}function Oh(i,t,e,n={passive:!0}){return i.addEventListener(t,e,n),()=>i.removeEventListener(t,e)}const wz=(i,t)=>i.depth-t.depth;class Tz{constructor(){this.children=[],this.isDirty=!1}add(t){rb(this.children,t),this.isDirty=!0}remove(t){ab(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(wz),this.isDirty=!1,this.children.forEach(t)}}function Sz(i,t){const e=jn.now(),n=({timestamp:s})=>{const a=s-e;a>=t&&(Va(n),i(a-t))};return Ae.setup(n,!0),()=>Va(n)}function Cp(i){return kn(i)?i.get():i}class Cz{constructor(){this.members=[]}add(t){rb(this.members,t),t.scheduleRender()}remove(t){if(ab(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(t){const e=this.members.findIndex(s=>t===s);if(e===0)return!1;let n;for(let s=e;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(t,e){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,e&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:e,resumingFrom:n}=t;e.onExitComplete&&e.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const xp={hasAnimatedSinceResize:!0,hasEverUpdated:!1},Ev=["","X","Y","Z"],xz=1e3;let Rz=0;function wv(i,t,e,n){const{latestValues:s}=t;s[i]&&(e[i]=s[i],t.setStaticValue(i,0),n&&(n[i]=0))}function wP(i){if(i.hasCheckedOptimisedAppear=!0,i.root===i)return;const{visualElement:t}=i.options;if(!t)return;const e=HD(t);if(window.MotionHasOptimisedAnimation(e,"transform")){const{layout:s,layoutId:a}=i.options;window.MotionCancelOptimisedAnimation(e,"transform",Ae,!(s||a))}const{parent:n}=i;n&&!n.hasCheckedOptimisedAppear&&wP(n)}function TP({attachResizeListener:i,defaultParent:t,measureScroll:e,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(l={},c=t?.()){this.id=Rz++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Pz),this.nodes.forEach(Oz),this.nodes.forEach(Lz),this.nodes.forEach(Mz)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=l,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let h=0;h<this.path.length;h++)this.path[h].shouldResetTransform=!0;this.root===this&&(this.nodes=new Tz)}addEventListener(l,c){return this.eventHandlers.has(l)||this.eventHandlers.set(l,new cb),this.eventHandlers.get(l).add(c)}notifyListeners(l,...c){const h=this.eventHandlers.get(l);h&&h.notify(...c)}hasListeners(l){return this.eventHandlers.has(l)}mount(l){if(this.instance)return;this.isSVG=tP(l)&&!Dj(l),this.instance=l;const{layoutId:c,layout:h,visualElement:d}=this.options;if(d&&!d.current&&d.mount(l),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(h||c)&&(this.isLayoutDirty=!0),i){let p,m=0;const v=()=>this.root.updateBlockedByResize=!1;Ae.read(()=>{m=window.innerWidth}),i(l,()=>{const b=window.innerWidth;b!==m&&(m=b,this.root.updateBlockedByResize=!0,p&&p(),p=Sz(v,250),xp.hasAnimatedSinceResize&&(xp.hasAnimatedSinceResize=!1,this.nodes.forEach(cC)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||h)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:m,hasRelativeLayoutChanged:v,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const w=this.options.transition||d.getDefaultTransition()||jz,{onLayoutAnimationStart:E,onLayoutAnimationComplete:S}=d.getProps(),C=!this.targetLayout||!bP(this.targetLayout,b),R=!m&&v;if(this.options.layoutRoot||this.resumeFrom||R||m&&(C||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const I={...Ab(w,"layout"),onPlay:E,onComplete:S};(d.shouldReduceMotion||this.options.layoutRoot)&&(I.delay=0,I.type=!1),this.startAnimation(I),this.setAnimationOrigin(p,R)}else m||cC(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const l=this.getStack();l&&l.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Va(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Vz),this.animationId++)}getTransformTemplate(){const{visualElement:l}=this.options;return l&&l.getProps().transformTemplate}willUpdate(l=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&wP(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let p=0;p<this.path.length;p++){const m=this.path[p];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:c,layout:h}=this.options;if(c===void 0&&!h)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),l&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(oC);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(lC);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Nz),this.nodes.forEach(Iz),this.nodes.forEach(Dz)):this.nodes.forEach(lC),this.clearAllSnapshots();const c=jn.now();Tn.delta=Ks(0,1e3/60,c-Tn.timestamp),Tn.timestamp=c,Tn.isProcessing=!0,pv.update.process(Tn),pv.preRender.process(Tn),pv.render.process(Tn),Tn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Cb.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(kz),this.sharedNodes.forEach(Bz)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ae.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ae.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!zn(this.snapshot.measuredBox.x)&&!zn(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let h=0;h<this.path.length;h++)this.path[h].updateScroll();const l=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=on(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,l?l.layoutBox:void 0)}updateScroll(l="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===l&&(c=!1),c&&this.instance){const h=n(this.instance);this.scroll={animationId:this.root.animationId,phase:l,isRoot:h,offset:e(this.instance),wasRoot:this.scroll?this.scroll.isRoot:h}}}resetTransform(){if(!s)return;const l=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!_P(this.projectionDelta),h=this.getTransformTemplate(),d=h?h(this.latestValues,""):void 0,p=d!==this.prevTransformTemplateValue;l&&this.instance&&(c||So(this.latestValues)||p)&&(s(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(l=!0){const c=this.measurePageBox();let h=this.removeElementScroll(c);return l&&(h=this.removeTransform(h)),zz(h),{animationId:this.root.animationId,measuredBox:c,layoutBox:h,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:l}=this.options;if(!l)return on();const c=l.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(Hz))){const{scroll:d}=this.root;d&&(Jl(c.x,d.offset.x),Jl(c.y,d.offset.y))}return c}removeElementScroll(l){const c=on();if(Zi(c,l),this.scroll?.wasRoot)return c;for(let h=0;h<this.path.length;h++){const d=this.path[h],{scroll:p,options:m}=d;d!==this.root&&p&&m.layoutScroll&&(p.wasRoot&&Zi(c,l),Jl(c.x,p.offset.x),Jl(c.y,p.offset.y))}return c}applyTransform(l,c=!1){const h=on();Zi(h,l);for(let d=0;d<this.path.length;d++){const p=this.path[d];!c&&p.options.layoutScroll&&p.scroll&&p!==p.root&&Zl(h,{x:-p.scroll.offset.x,y:-p.scroll.offset.y}),So(p.latestValues)&&Zl(h,p.latestValues)}return So(this.latestValues)&&Zl(h,this.latestValues),h}removeTransform(l){const c=on();Zi(c,l);for(let h=0;h<this.path.length;h++){const d=this.path[h];if(!d.instance||!So(d.latestValues))continue;k_(d.latestValues)&&d.updateSnapshot();const p=on(),m=d.measurePageBox();Zi(p,m),J1(c,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,p)}return So(this.latestValues)&&J1(c,this.latestValues),c}setTargetDelta(l){this.targetDelta=l,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(l){this.options={...this.options,...l,crossfade:l.crossfade!==void 0?l.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Tn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(l=!1){const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==c;if(!(l||h&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:m}=this.options;if(!this.layout||!(p||m))return;this.resolvedRelativeTargetAt=Tn.timestamp;const v=this.getClosestProjectingParent();v&&this.linkedParentVersion!==v.layoutVersion&&!v.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(v&&v.layout?this.createRelativeTarget(v,this.layout.layoutBox,v.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=on(),this.targetWithTransforms=on()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),dz(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Zi(this.target,this.layout.layoutBox),oP(this.target,this.targetDelta)):Zi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?this.createRelativeTarget(v,this.target,v.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||k_(this.parent.latestValues)||aP(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(l,c,h){this.relativeParent=l,this.linkedParentVersion=l.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=on(),this.relativeTargetOrigin=on(),lm(this.relativeTargetOrigin,c,h),Zi(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const l=this.getLead(),c=!!this.resumingFrom||this!==l;let h=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(h=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===Tn.timestamp&&(h=!1),h)return;const{layout:d,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||p))return;Zi(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,v=this.treeScale.y;jj(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=on());const{target:b}=l;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():($1(this.prevProjectionDelta.x,this.projectionDelta.x),$1(this.prevProjectionDelta.y,this.projectionDelta.y)),yh(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==v||!iC(this.projectionDelta.x,this.prevProjectionDelta.x)||!iC(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(l=!0){if(this.options.visualElement?.scheduleRender(),l){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Ql(),this.projectionDelta=Ql(),this.projectionDeltaWithTransform=Ql()}setAnimationOrigin(l,c=!1){const h=this.snapshot,d=h?h.latestValues:{},p={...this.latestValues},m=Ql();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const v=on(),b=h?h.source:void 0,w=this.layout?this.layout.source:void 0,E=b!==w,S=this.getStack(),C=!S||S.members.length<=1,R=!!(E&&!C&&this.options.crossfade===!0&&!this.path.some(Uz));this.animationProgress=0;let I;this.mixTargetDelta=B=>{const F=B/1e3;uC(m.x,l.x,F),uC(m.y,l.y,F),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(lm(v,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Fz(this.relativeTarget,this.relativeTargetOrigin,v,F),I&&gz(this.relativeTarget,I)&&(this.isProjectionDirty=!1),I||(I=on()),Zi(I,this.relativeTarget)),E&&(this.animationValues=p,_z(p,d,this.latestValues,F,R,C)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(l){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Va(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ae.update(()=>{xp.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Ec(0)),this.currentAnimation=Ez(this.motionValue,[0,1e3],{...l,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),l.onUpdate&&l.onUpdate(c)},onStop:()=>{},onComplete:()=>{l.onComplete&&l.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const l=this.getStack();l&&l.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(xz),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const l=this.getLead();let{targetWithTransforms:c,target:h,layout:d,latestValues:p}=l;if(!(!c||!h||!d)){if(this!==l&&this.layout&&d&&SP(this.options.animationType,this.layout.layoutBox,d.layoutBox)){h=this.target||on();const m=zn(this.layout.layoutBox.x);h.x.min=l.target.x.min,h.x.max=h.x.min+m;const v=zn(this.layout.layoutBox.y);h.y.min=l.target.y.min,h.y.max=h.y.min+v}Zi(c,h),Zl(c,p),yh(this.projectionDeltaWithTransform,this.layoutCorrected,c,p)}}registerSharedNode(l,c){this.sharedNodes.has(l)||this.sharedNodes.set(l,new Cz),this.sharedNodes.get(l).add(c);const d=c.options.initialPromotionConfig;c.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(c):void 0})}isLead(){const l=this.getStack();return l?l.lead===this:!0}getLead(){const{layoutId:l}=this.options;return l?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:l}=this.options;return l?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:l}=this.options;if(l)return this.root.sharedNodes.get(l)}promote({needsReset:l,transition:c,preserveFollowOpacity:h}={}){const d=this.getStack();d&&d.promote(this,h),l&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const l=this.getStack();return l?l.relegate(this):!1}resetSkewAndRotation(){const{visualElement:l}=this.options;if(!l)return;let c=!1;const{latestValues:h}=l;if((h.z||h.rotate||h.rotateX||h.rotateY||h.rotateZ||h.skewX||h.skewY)&&(c=!0),!c)return;const d={};h.z&&wv("z",l,d,this.animationValues);for(let p=0;p<Ev.length;p++)wv(`rotate${Ev[p]}`,l,d,this.animationValues),wv(`skew${Ev[p]}`,l,d,this.animationValues);l.render();for(const p in d)l.setStaticValue(p,d[p]),this.animationValues&&(this.animationValues[p]=d[p]);l.scheduleRender()}applyProjectionStyles(l,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){l.visibility="hidden";return}const h=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,l.visibility="",l.opacity="",l.pointerEvents=Cp(c?.pointerEvents)||"",l.transform=h?h(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(l.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,l.pointerEvents=Cp(c?.pointerEvents)||""),this.hasProjected&&!So(this.latestValues)&&(l.transform=h?h({},""):"none",this.hasProjected=!1);return}l.visibility="";const p=d.animationValues||d.latestValues;this.applyTransformsToTarget();let m=yz(this.projectionDeltaWithTransform,this.treeScale,p);h&&(m=h(p,m)),l.transform=m;const{x:v,y:b}=this.projectionDelta;l.transformOrigin=`${v.origin*100}% ${b.origin*100}% 0`,d.animationValues?l.opacity=d===this?p.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:l.opacity=d===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const w in O_){if(p[w]===void 0)continue;const{correct:E,applyTo:S,isCSSVariable:C}=O_[w],R=m==="none"?p[w]:E(p[w],d);if(S){const I=S.length;for(let B=0;B<I;B++)l[S[B]]=R}else C?this.options.visualElement.renderState.vars[w]=R:l[w]=R}this.options.layoutId&&(l.pointerEvents=d===this?Cp(c?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(l=>l.currentAnimation?.stop()),this.root.nodes.forEach(oC),this.root.sharedNodes.clear()}}}function Iz(i){i.updateLayout()}function Dz(i){const t=i.resumeFrom?.snapshot||i.snapshot;if(i.isLead()&&i.layout&&t&&i.hasListeners("didUpdate")){const{layoutBox:e,measuredBox:n}=i.layout,{animationType:s}=i.options,a=t.source!==i.layout.source;s==="size"?ki(p=>{const m=a?t.measuredBox[p]:t.layoutBox[p],v=zn(m);m.min=e[p].min,m.max=m.min+v}):SP(s,t.layoutBox,e)&&ki(p=>{const m=a?t.measuredBox[p]:t.layoutBox[p],v=zn(e[p]);m.max=m.min+v,i.relativeTarget&&!i.currentAnimation&&(i.isProjectionDirty=!0,i.relativeTarget[p].max=i.relativeTarget[p].min+v)});const l=Ql();yh(l,e,t.layoutBox);const c=Ql();a?yh(c,i.applyTransform(n,!0),t.measuredBox):yh(c,e,t.layoutBox);const h=!_P(l);let d=!1;if(!i.resumeFrom){const p=i.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:m,layout:v}=p;if(m&&v){const b=on();lm(b,t.layoutBox,m.layoutBox);const w=on();lm(w,e,v.layoutBox),bP(b,w)||(d=!0),p.options.layoutRoot&&(i.relativeTarget=w,i.relativeTargetOrigin=b,i.relativeParent=p)}}}i.notifyListeners("didUpdate",{layout:e,snapshot:t,delta:c,layoutDelta:l,hasLayoutChanged:h,hasRelativeLayoutChanged:d})}else if(i.isLead()){const{onExitComplete:e}=i.options;e&&e()}i.options.transition=void 0}function Pz(i){i.parent&&(i.isProjecting()||(i.isProjectionDirty=i.parent.isProjectionDirty),i.isSharedProjectionDirty||(i.isSharedProjectionDirty=!!(i.isProjectionDirty||i.parent.isProjectionDirty||i.parent.isSharedProjectionDirty)),i.isTransformDirty||(i.isTransformDirty=i.parent.isTransformDirty))}function Mz(i){i.isProjectionDirty=i.isSharedProjectionDirty=i.isTransformDirty=!1}function kz(i){i.clearSnapshot()}function oC(i){i.clearMeasurements()}function lC(i){i.isLayoutDirty=!1}function Nz(i){const{visualElement:t}=i.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),i.resetTransform()}function cC(i){i.finishAnimation(),i.targetDelta=i.relativeTarget=i.target=void 0,i.isProjectionDirty=!0}function Oz(i){i.resolveTargetDelta()}function Lz(i){i.calcProjection()}function Vz(i){i.resetSkewAndRotation()}function Bz(i){i.removeLeadSnapshot()}function uC(i,t,e){i.translate=Re(t.translate,0,e),i.scale=Re(t.scale,1,e),i.origin=t.origin,i.originPoint=t.originPoint}function hC(i,t,e,n){i.min=Re(t.min,e.min,n),i.max=Re(t.max,e.max,n)}function Fz(i,t,e,n){hC(i.x,t.x,e.x,n),hC(i.y,t.y,e.y,n)}function Uz(i){return i.animationValues&&i.animationValues.opacityExit!==void 0}const jz={duration:.45,ease:[.4,0,.1,1]},dC=i=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(i),fC=dC("applewebkit/")&&!dC("chrome/")?Math.round:Bi;function pC(i){i.min=fC(i.min),i.max=fC(i.max)}function zz(i){pC(i.x),pC(i.y)}function SP(i,t,e){return i==="position"||i==="preserve-aspect"&&!hz(nC(t),nC(e),.2)}function Hz(i){return i!==i.root&&i.scroll?.wasRoot}const qz=TP({attachResizeListener:(i,t)=>Oh(i,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body?.scrollLeft||0,y:document.documentElement.scrollTop||document.body?.scrollTop||0}),checkIsScrollRoot:()=>!0}),Tv={current:void 0},CP=TP({measureScroll:i=>({x:i.scrollLeft,y:i.scrollTop}),defaultParent:()=>{if(!Tv.current){const i=new qz({});i.mount(window),i.setOptions({layoutScroll:!0}),Tv.current=i}return Tv.current},resetTransform:(i,t)=>{i.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:i=>window.getComputedStyle(i).position==="fixed"}),Mb=z.createContext({transformPagePoint:i=>i,isStatic:!1,reducedMotion:"never"});function mC(i,t){if(typeof i=="function")return i(t);i!=null&&(i.current=t)}function Gz(...i){return t=>{let e=!1;const n=i.map(s=>{const a=mC(s,t);return!e&&typeof a=="function"&&(e=!0),a});if(e)return()=>{for(let s=0;s<n.length;s++){const a=n[s];typeof a=="function"?a():mC(i[s],null)}}}}function $z(...i){return z.useCallback(Gz(...i),i)}class Wz extends z.Component{getSnapshotBeforeUpdate(t){const e=this.props.childRef.current;if(e&&t.isPresent&&!this.props.isPresent){const n=e.offsetParent,s=P_(n)&&n.offsetWidth||0,a=P_(n)&&n.offsetHeight||0,l=this.props.sizeRef.current;l.height=e.offsetHeight||0,l.width=e.offsetWidth||0,l.top=e.offsetTop,l.left=e.offsetLeft,l.right=s-l.width-l.left,l.bottom=a-l.height-l.top}return null}componentDidUpdate(){}render(){return this.props.children}}function Kz({children:i,isPresent:t,anchorX:e,anchorY:n,root:s}){const a=z.useId(),l=z.useRef(null),c=z.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:h}=z.useContext(Mb),d=i.props?.ref??i?.ref,p=$z(l,d);return z.useInsertionEffect(()=>{const{width:m,height:v,top:b,left:w,right:E,bottom:S}=c.current;if(t||!l.current||!m||!v)return;const C=e==="left"?`left: ${w}`:`right: ${E}`,R=n==="bottom"?`bottom: ${S}`:`top: ${b}`;l.current.dataset.motionPopId=a;const I=document.createElement("style");h&&(I.nonce=h);const B=s??document.head;return B.appendChild(I),I.sheet&&I.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${m}px !important;
            height: ${v}px !important;
            ${C}px !important;
            ${R}px !important;
          }
        `),()=>{B.contains(I)&&B.removeChild(I)}},[t]),L.jsx(Wz,{isPresent:t,childRef:l,sizeRef:c,children:z.cloneElement(i,{ref:p})})}const Yz=({children:i,initial:t,isPresent:e,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:l,anchorX:c,anchorY:h,root:d})=>{const p=sb(Xz),m=z.useId();let v=!0,b=z.useMemo(()=>(v=!1,{id:m,initial:t,isPresent:e,custom:s,onExitComplete:w=>{p.set(w,!0);for(const E of p.values())if(!E)return;n&&n()},register:w=>(p.set(w,!1),()=>p.delete(w))}),[e,p,n]);return a&&v&&(b={...b}),z.useMemo(()=>{p.forEach((w,E)=>p.set(E,!1))},[e]),z.useEffect(()=>{!e&&!p.size&&n&&n()},[e]),l==="popLayout"&&(i=L.jsx(Kz,{isPresent:e,anchorX:c,anchorY:h,root:d,children:i})),L.jsx(Lm.Provider,{value:b,children:i})};function Xz(){return new Map}function xP(i=!0){const t=z.useContext(Lm);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:s}=t,a=z.useId();z.useEffect(()=>{if(i)return s(a)},[i]);const l=z.useCallback(()=>i&&n&&n(a),[a,n,i]);return!e&&n?[!1,l]:[!0]}const Zf=i=>i.key||"";function gC(i){const t=[];return z.Children.forEach(i,e=>{z.isValidElement(e)&&t.push(e)}),t}const Qz=({children:i,custom:t,initial:e=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:a="sync",propagate:l=!1,anchorX:c="left",anchorY:h="top",root:d})=>{const[p,m]=xP(l),v=z.useMemo(()=>gC(i),[i]),b=l&&!p?[]:v.map(Zf),w=z.useRef(!0),E=z.useRef(v),S=sb(()=>new Map),C=z.useRef(new Set),[R,I]=z.useState(v),[B,F]=z.useState(v);rD(()=>{w.current=!1,E.current=v;for(let D=0;D<B.length;D++){const M=Zf(B[D]);b.includes(M)?(S.delete(M),C.current.delete(M)):S.get(M)!==!0&&S.set(M,!1)}},[B,b.length,b.join("-")]);const j=[];if(v!==R){let D=[...v];for(let M=0;M<B.length;M++){const V=B[M],O=Zf(V);b.includes(O)||(D.splice(M,0,V),j.push(V))}return a==="wait"&&j.length&&(D=j),F(gC(D)),I(v),null}const{forceRender:P}=z.useContext(ib);return L.jsx(L.Fragment,{children:B.map(D=>{const M=Zf(D),V=l&&!p?!1:v===B||b.includes(M),O=()=>{if(C.current.has(M))return;if(C.current.add(M),S.has(M))S.set(M,!0);else return;let G=!0;S.forEach(U=>{U||(G=!1)}),G&&(P?.(),F(E.current),l&&m?.(),n&&n())};return L.jsx(Yz,{isPresent:V,initial:!w.current||e?void 0:!1,custom:t,presenceAffectsLayout:s,mode:a,root:d,onExitComplete:V?void 0:O,anchorX:c,anchorY:h,children:D},M)})})},RP=z.createContext({strict:!1}),yC={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let vC=!1;function Jz(){if(vC)return;const i={};for(const t in yC)i[t]={isEnabled:e=>yC[t].some(n=>!!e[n])};iP(i),vC=!0}function IP(){return Jz(),Vj()}function Zz(i){const t=IP();for(const e in i)t[e]={...t[e],...i[e]};iP(t)}const tH=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function cm(i){return i.startsWith("while")||i.startsWith("drag")&&i!=="draggable"||i.startsWith("layout")||i.startsWith("onTap")||i.startsWith("onPan")||i.startsWith("onLayout")||tH.has(i)}let DP=i=>!cm(i);function eH(i){typeof i=="function"&&(DP=t=>t.startsWith("on")?!cm(t):i(t))}try{eH(require("@emotion/is-prop-valid").default)}catch{}function nH(i,t,e){const n={};for(const s in i)s==="values"&&typeof i.values=="object"||(DP(s)||e===!0&&cm(s)||!t&&!cm(s)||i.draggable&&s.startsWith("onDrag"))&&(n[s]=i[s]);return n}const Fm=z.createContext({});function iH(i,t){if(Bm(i)){const{initial:e,animate:n}=i;return{initial:e===!1||Nh(e)?e:void 0,animate:Nh(n)?n:void 0}}return i.inherit!==!1?t:{}}function sH(i){const{initial:t,animate:e}=iH(i,z.useContext(Fm));return z.useMemo(()=>({initial:t,animate:e}),[_C(t),_C(e)])}function _C(i){return Array.isArray(i)?i.join(" "):i}const kb=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function PP(i,t,e){for(const n in t)!kn(t[n])&&!uP(n,e)&&(i[n]=t[n])}function rH({transformTemplate:i},t){return z.useMemo(()=>{const e=kb();return Db(e,t,i),Object.assign({},e.vars,e.style)},[t])}function aH(i,t){const e=i.style||{},n={};return PP(n,e,i),Object.assign(n,rH(i,t)),n}function oH(i,t){const e={},n=aH(i,t);return i.drag&&i.dragListener!==!1&&(e.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=i.drag===!0?"none":`pan-${i.drag==="x"?"y":"x"}`),i.tabIndex===void 0&&(i.onTap||i.onTapStart||i.whileTap)&&(e.tabIndex=0),e.style=n,e}const MP=()=>({...kb(),attrs:{}});function lH(i,t,e,n){const s=z.useMemo(()=>{const a=MP();return hP(a,t,fP(n),i.transformTemplate,i.style),{...a.attrs,style:{...a.style}}},[t]);if(i.style){const a={};PP(a,i.style,i),s.style={...a,...s.style}}return s}const cH=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Nb(i){return typeof i!="string"||i.includes("-")?!1:!!(cH.indexOf(i)>-1||/[A-Z]/u.test(i))}function uH(i,t,e,{latestValues:n},s,a=!1,l){const h=(l??Nb(i)?lH:oH)(t,n,s,i),d=nH(t,typeof i=="string",a),p=i!==z.Fragment?{...d,...h,ref:e}:{},{children:m}=t,v=z.useMemo(()=>kn(m)?m.get():m,[m]);return z.createElement(i,{...p,children:v})}function hH({scrapeMotionValuesFromProps:i,createRenderState:t},e,n,s){return{latestValues:dH(e,n,s,i),renderState:t()}}function dH(i,t,e,n){const s={},a=n(i,{});for(const v in a)s[v]=Cp(a[v]);let{initial:l,animate:c}=i;const h=Bm(i),d=nP(i);t&&d&&!h&&i.inherit!==!1&&(l===void 0&&(l=t.initial),c===void 0&&(c=t.animate));let p=e?e.initial===!1:!1;p=p||l===!1;const m=p?c:l;if(m&&typeof m!="boolean"&&!Vm(m)){const v=Array.isArray(m)?m:[m];for(let b=0;b<v.length;b++){const w=wb(i,v[b]);if(w){const{transitionEnd:E,transition:S,...C}=w;for(const R in C){let I=C[R];if(Array.isArray(I)){const B=p?I.length-1:0;I=I[B]}I!==null&&(s[R]=I)}for(const R in E)s[R]=E[R]}}}return s}const kP=i=>(t,e)=>{const n=z.useContext(Fm),s=z.useContext(Lm),a=()=>hH(i,t,n,s);return e?a():sb(a)},fH=kP({scrapeMotionValuesFromProps:Pb,createRenderState:kb}),pH=kP({scrapeMotionValuesFromProps:pP,createRenderState:MP}),mH=Symbol.for("motionComponentSymbol");function gH(i,t,e){const n=z.useRef(e);z.useInsertionEffect(()=>{n.current=e});const s=z.useRef(null);return z.useCallback(a=>{a&&i.onMount?.(a),t&&(a?t.mount(a):t.unmount());const l=n.current;if(typeof l=="function")if(a){const c=l(a);typeof c=="function"&&(s.current=c)}else s.current?(s.current(),s.current=null):l(a);else l&&(l.current=a)},[t])}const NP=z.createContext({});function sh(i){return i&&typeof i=="object"&&Object.prototype.hasOwnProperty.call(i,"current")}function yH(i,t,e,n,s,a){const{visualElement:l}=z.useContext(Fm),c=z.useContext(RP),h=z.useContext(Lm),d=z.useContext(Mb).reducedMotion,p=z.useRef(null);n=n||c.renderer,!p.current&&n&&(p.current=n(i,{visualState:t,parent:l,props:e,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:d,isSVG:a}));const m=p.current,v=z.useContext(NP);m&&!m.projection&&s&&(m.type==="html"||m.type==="svg")&&vH(p.current,e,s,v);const b=z.useRef(!1);z.useInsertionEffect(()=>{m&&b.current&&m.update(e,h)});const w=e[zD],E=z.useRef(!!w&&!window.MotionHandoffIsComplete?.(w)&&window.MotionHasOptimisedAnimation?.(w));return rD(()=>{m&&(b.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),m.scheduleRenderMicrotask(),E.current&&m.animationState&&m.animationState.animateChanges())}),z.useEffect(()=>{m&&(!E.current&&m.animationState&&m.animationState.animateChanges(),E.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(w)}),E.current=!1),m.enteringChildren=void 0)}),m}function vH(i,t,e,n){const{layoutId:s,layout:a,drag:l,dragConstraints:c,layoutScroll:h,layoutRoot:d,layoutCrossfade:p}=t;i.projection=new e(i.latestValues,t["data-framer-portal-id"]?void 0:OP(i.parent)),i.projection.setOptions({layoutId:s,layout:a,alwaysMeasureLayout:!!l||c&&sh(c),visualElement:i,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:p,layoutScroll:h,layoutRoot:d})}function OP(i){if(i)return i.options.allowProjection!==!1?i.projection:OP(i.parent)}function Sv(i,{forwardMotionProps:t=!1,type:e}={},n,s){n&&Zz(n);const a=e?e==="svg":Nb(i),l=a?pH:fH;function c(d,p){let m;const v={...z.useContext(Mb),...d,layoutId:_H(d)},{isStatic:b}=v,w=sH(d),E=l(d,b);if(!b&&sD){bH();const S=AH(v);m=S.MeasureLayout,w.visualElement=yH(i,E,v,s,S.ProjectionNode,a)}return L.jsxs(Fm.Provider,{value:w,children:[m&&w.visualElement?L.jsx(m,{visualElement:w.visualElement,...v}):null,uH(i,d,gH(E,w.visualElement,p),E,b,t,a)]})}c.displayName=`motion.${typeof i=="string"?i:`create(${i.displayName??i.name??""})`}`;const h=z.forwardRef(c);return h[mH]=i,h}function _H({layoutId:i}){const t=z.useContext(ib).id;return t&&i!==void 0?t+"-"+i:i}function bH(i,t){z.useContext(RP).strict}function AH(i){const t=IP(),{drag:e,layout:n}=t;if(!e&&!n)return{};const s={...e,...n};return{MeasureLayout:e?.isEnabled(i)||n?.isEnabled(i)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function EH(i,t){if(typeof Proxy>"u")return Sv;const e=new Map,n=(a,l)=>Sv(a,l,i,t),s=(a,l)=>n(a,l);return new Proxy(s,{get:(a,l)=>l==="create"?n:(e.has(l)||e.set(l,Sv(l,void 0,i,t)),e.get(l))})}const wH=(i,t)=>t.isSVG??Nb(i)?new tz(t):new Kj(t,{allowProjection:i!==z.Fragment});class TH extends Ga{constructor(t){super(t),t.animationState||(t.animationState=rz(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Vm(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:e}=this.node.prevProps||{};t!==e&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let SH=0;class CH extends Ga{constructor(){super(...arguments),this.id=SH++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:e}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const s=this.node.animationState.setActive("exit",!t);e&&!t&&s.then(()=>{e(this.id)})}mount(){const{register:t,onExitComplete:e}=this.node.presenceContext||{};e&&e(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const xH={animation:{Feature:TH},exit:{Feature:CH}};function rd(i){return{point:{x:i.pageX,y:i.pageY}}}const RH=i=>t=>xb(t)&&i(t,rd(t));function vh(i,t,e,n){return Oh(i,t,RH(e),n)}const LP=({current:i})=>i?i.ownerDocument.defaultView:null,bC=(i,t)=>Math.abs(i-t);function IH(i,t){const e=bC(i.x,t.x),n=bC(i.y,t.y);return Math.sqrt(e**2+n**2)}const AC=new Set(["auto","scroll"]);class VP{constructor(t,e,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:a=!1,distanceThreshold:l=3,element:c}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=b=>{this.handleScroll(b.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const b=xv(this.lastMoveEventInfo,this.history),w=this.startEvent!==null,E=IH(b.offset,{x:0,y:0})>=this.distanceThreshold;if(!w&&!E)return;const{point:S}=b,{timestamp:C}=Tn;this.history.push({...S,timestamp:C});const{onStart:R,onMove:I}=this.handlers;w||(R&&R(this.lastMoveEvent,b),this.startEvent=this.lastMoveEvent),I&&I(this.lastMoveEvent,b)},this.handlePointerMove=(b,w)=>{this.lastMoveEvent=b,this.lastMoveEventInfo=Cv(w,this.transformPagePoint),Ae.update(this.updatePoint,!0)},this.handlePointerUp=(b,w)=>{this.end();const{onEnd:E,onSessionEnd:S,resumeAnimation:C}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&C&&C(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const R=xv(b.type==="pointercancel"?this.lastMoveEventInfo:Cv(w,this.transformPagePoint),this.history);this.startEvent&&E&&E(b,R),S&&S(b,R)},!xb(t))return;this.dragSnapToOrigin=a,this.handlers=e,this.transformPagePoint=n,this.distanceThreshold=l,this.contextWindow=s||window;const h=rd(t),d=Cv(h,this.transformPagePoint),{point:p}=d,{timestamp:m}=Tn;this.history=[{...p,timestamp:m}];const{onSessionStart:v}=e;v&&v(t,xv(d,this.history)),this.removeListeners=nd(vh(this.contextWindow,"pointermove",this.handlePointerMove),vh(this.contextWindow,"pointerup",this.handlePointerUp),vh(this.contextWindow,"pointercancel",this.handlePointerUp)),c&&this.startScrollTracking(c)}startScrollTracking(t){let e=t.parentElement;for(;e;){const n=getComputedStyle(e);(AC.has(n.overflowX)||AC.has(n.overflowY))&&this.scrollPositions.set(e,{x:e.scrollLeft,y:e.scrollTop}),e=e.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(t){const e=this.scrollPositions.get(t);if(!e)return;const n=t===window,s=n?{x:window.scrollX,y:window.scrollY}:{x:t.scrollLeft,y:t.scrollTop},a={x:s.x-e.x,y:s.y-e.y};a.x===0&&a.y===0||(n?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=a.x,this.lastMoveEventInfo.point.y+=a.y):this.history.length>0&&(this.history[0].x-=a.x,this.history[0].y-=a.y),this.scrollPositions.set(t,s),Ae.update(this.updatePoint,!0))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),Va(this.updatePoint)}}function Cv(i,t){return t?{point:t(i.point)}:i}function EC(i,t){return{x:i.x-t.x,y:i.y-t.y}}function xv({point:i},t){return{point:i,delta:EC(i,BP(t)),offset:EC(i,DH(t)),velocity:PH(t,.1)}}function DH(i){return i[0]}function BP(i){return i[i.length-1]}function PH(i,t){if(i.length<2)return{x:0,y:0};let e=i.length-1,n=null;const s=BP(i);for(;e>=0&&(n=i[e],!(s.timestamp-n.timestamp>Ir(t)));)e--;if(!n)return{x:0,y:0};const a=Vi(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const l={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return l.x===1/0&&(l.x=0),l.y===1/0&&(l.y=0),l}function MH(i,{min:t,max:e},n){return t!==void 0&&i<t?i=n?Re(t,i,n.min):Math.max(i,t):e!==void 0&&i>e&&(i=n?Re(e,i,n.max):Math.min(i,e)),i}function wC(i,t,e){return{min:t!==void 0?i.min+t:void 0,max:e!==void 0?i.max+e-(i.max-i.min):void 0}}function kH(i,{top:t,left:e,bottom:n,right:s}){return{x:wC(i.x,e,s),y:wC(i.y,t,n)}}function TC(i,t){let e=t.min-i.min,n=t.max-i.max;return t.max-t.min<i.max-i.min&&([e,n]=[n,e]),{min:e,max:n}}function NH(i,t){return{x:TC(i.x,t.x),y:TC(i.y,t.y)}}function OH(i,t){let e=.5;const n=zn(i),s=zn(t);return s>n?e=Ph(t.min,t.max-n,i.min):n>s&&(e=Ph(i.min,i.max-s,t.min)),Ks(0,1,e)}function LH(i,t){const e={};return t.min!==void 0&&(e.min=t.min-i.min),t.max!==void 0&&(e.max=t.max-i.min),e}const L_=.35;function VH(i=L_){return i===!1?i=0:i===!0&&(i=L_),{x:SC(i,"left","right"),y:SC(i,"top","bottom")}}function SC(i,t,e){return{min:CC(i,t),max:CC(i,e)}}function CC(i,t){return typeof i=="number"?i:i[t]||0}const BH=new WeakMap;class FH{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=on(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:e=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const a=m=>{e?(this.stopAnimation(),this.snapToCursor(rd(m).point)):this.pauseAnimation()},l=(m,v)=>{this.stopAnimation();const{drag:b,dragPropagation:w,onDragStart:E}=this.getProps();if(b&&!w&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Sj(b),!this.openDragLock))return;this.latestPointerEvent=m,this.latestPanInfo=v,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ki(C=>{let R=this.getAxisMotionValue(C).get()||0;if(Gs.test(R)){const{projection:I}=this.visualElement;if(I&&I.layout){const B=I.layout.layoutBox[C];B&&(R=zn(B)*(parseFloat(R)/100))}}this.originPoint[C]=R}),E&&Ae.postRender(()=>E(m,v)),R_(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},c=(m,v)=>{this.latestPointerEvent=m,this.latestPanInfo=v;const{dragPropagation:b,dragDirectionLock:w,onDirectionLock:E,onDrag:S}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:C}=v;if(w&&this.currentDirection===null){this.currentDirection=UH(C),this.currentDirection!==null&&E&&E(this.currentDirection);return}this.updateAxis("x",v.point,C),this.updateAxis("y",v.point,C),this.visualElement.render(),S&&S(m,v)},h=(m,v)=>{this.latestPointerEvent=m,this.latestPanInfo=v,this.stop(m,v),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>ki(m=>this.getAnimationState(m)==="paused"&&this.getAxisMotionValue(m).animation?.play()),{dragSnapToOrigin:p}=this.getProps();this.panSession=new VP(t,{onSessionStart:a,onStart:l,onMove:c,onSessionEnd:h,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:p,distanceThreshold:n,contextWindow:LP(this.visualElement),element:this.visualElement.current})}stop(t,e){const n=t||this.latestPointerEvent,s=e||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!s||!n)return;const{velocity:l}=s;this.startAnimation(l);const{onDragEnd:c}=this.getProps();c&&Ae.postRender(()=>c(n,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:e}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),e&&e.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(t,e,n){const{drag:s}=this.getProps();if(!n||!tp(t,s,this.currentDirection))return;const a=this.getAxisMotionValue(t);let l=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(l=MH(l,this.constraints[t],this.elastic[t])),a.set(l)}resolveConstraints(){const{dragConstraints:t,dragElastic:e}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;t&&sh(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=kH(n.layoutBox,t):this.constraints=!1,this.elastic=VH(e),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&ki(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=LH(n.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:e}=this.getProps();if(!t||!sh(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=zj(n,s.root,this.visualElement.getTransformPagePoint());let l=NH(s.layout.layoutBox,a);if(e){const c=e(Fj(l));this.hasMutatedConstraints=!!c,c&&(l=rP(c))}return l}startAnimation(t){const{drag:e,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:l,onDragTransitionEnd:c}=this.getProps(),h=this.constraints||{},d=ki(p=>{if(!tp(p,e,this.currentDirection))return;let m=h&&h[p]||{};l&&(m={min:0,max:0});const v=s?200:1e6,b=s?40:1e7,w={type:"inertia",velocity:n?t[p]:0,bounceStiffness:v,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...a,...m};return this.startAxisValueAnimation(p,w)});return Promise.all(d).then(c)}startAxisValueAnimation(t,e){const n=this.getAxisMotionValue(t);return R_(this.visualElement,t),n.start(Eb(t,n,0,e,this.visualElement,!1))}stopAnimation(){ki(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){ki(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const e=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),s=n[e];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){ki(e=>{const{drag:n}=this.getProps();if(!tp(e,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(e);if(s&&s.layout){const{min:l,max:c}=s.layout.layoutBox[e],h=a.get()||0;a.set(t[e]-Re(l,c,.5)+h)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:e}=this.getProps(),{projection:n}=this.visualElement;if(!sh(e)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};ki(l=>{const c=this.getAxisMotionValue(l);if(c&&this.constraints!==!1){const h=c.get();s[l]=OH({min:h,max:h},this.constraints[l])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),ki(l=>{if(!tp(l,t,null))return;const c=this.getAxisMotionValue(l),{min:h,max:d}=this.constraints[l];c.set(Re(h,d,s[l]))})}addListeners(){if(!this.visualElement.current)return;BH.set(this.visualElement,this);const t=this.visualElement.current,e=vh(t,"pointerdown",h=>{const{drag:d,dragListener:p=!0}=this.getProps(),m=h.target,v=m!==t&&ZD(m);d&&p&&!v&&this.start(h)}),n=()=>{const{dragConstraints:h}=this.getProps();sh(h)&&h.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),Ae.read(n);const l=Oh(window,"resize",()=>this.scalePositionWithinConstraints()),c=s.addEventListener("didUpdate",(({delta:h,hasLayoutChanged:d})=>{this.isDragging&&d&&(ki(p=>{const m=this.getAxisMotionValue(p);m&&(this.originPoint[p]+=h[p].translate,m.set(m.get()+h[p].translate))}),this.visualElement.render())}));return()=>{l(),e(),a(),c&&c()}}getProps(){const t=this.visualElement.getProps(),{drag:e=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:l=L_,dragMomentum:c=!0}=t;return{...t,drag:e,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:l,dragMomentum:c}}}function tp(i,t,e){return(t===!0||t===i)&&(e===null||e===i)}function UH(i,t=10){let e=null;return Math.abs(i.y)>t?e="y":Math.abs(i.x)>t&&(e="x"),e}class jH extends Ga{constructor(t){super(t),this.removeGroupControls=Bi,this.removeListeners=Bi,this.controls=new FH(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Bi}update(){const{dragControls:t}=this.node.getProps(),{dragControls:e}=this.node.prevProps||{};t!==e&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.endPanSession()}}const xC=i=>(t,e)=>{i&&Ae.postRender(()=>i(t,e))};class zH extends Ga{constructor(){super(...arguments),this.removePointerDownListener=Bi}onPointerDown(t){this.session=new VP(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:LP(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:e,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:xC(t),onStart:xC(e),onMove:n,onEnd:(a,l)=>{delete this.session,s&&Ae.postRender(()=>s(a,l))}}}mount(){this.removePointerDownListener=vh(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let Rv=!1;class HH extends z.Component{componentDidMount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=t;a&&(e.group&&e.group.add(a),n&&n.register&&s&&n.register(a),Rv&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),xp.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:e,visualElement:n,drag:s,isPresent:a}=this.props,{projection:l}=n;return l&&(l.isPresent=a,Rv=!0,s||t.layoutDependency!==e||e===void 0||t.isPresent!==a?l.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?l.promote():l.relegate()||Ae.postRender(()=>{const c=l.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Cb.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:n}=this.props,{projection:s}=t;Rv=!0,s&&(s.scheduleCheckAfterUnmount(),e&&e.group&&e.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function FP(i){const[t,e]=xP(),n=z.useContext(ib);return L.jsx(HH,{...i,layoutGroup:n,switchLayoutGroup:z.useContext(NP),isPresent:t,safeToRemove:e})}const qH={pan:{Feature:zH},drag:{Feature:jH,ProjectionNode:CP,MeasureLayout:FP}};function RC(i,t,e){const{props:n}=i;i.animationState&&n.whileHover&&i.animationState.setActive("whileHover",e==="Start");const s="onHover"+e,a=n[s];a&&Ae.postRender(()=>a(t,rd(t)))}class GH extends Ga{mount(){const{current:t}=this.node;t&&(this.unmount=Cj(t,(e,n)=>(RC(this.node,n,"Start"),s=>RC(this.node,s,"End"))))}unmount(){}}class $H extends Ga{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=nd(Oh(this.node.current,"focus",()=>this.onFocus()),Oh(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function IC(i,t,e){const{props:n}=i;if(i.current instanceof HTMLButtonElement&&i.current.disabled)return;i.animationState&&n.whileTap&&i.animationState.setActive("whileTap",e==="Start");const s="onTap"+(e==="End"?"":e),a=n[s];a&&Ae.postRender(()=>a(t,rd(t)))}class WH extends Ga{mount(){const{current:t}=this.node;t&&(this.unmount=Ij(t,(e,n)=>(IC(this.node,n,"Start"),(s,{success:a})=>IC(this.node,s,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const V_=new WeakMap,Iv=new WeakMap,KH=i=>{const t=V_.get(i.target);t&&t(i)},YH=i=>{i.forEach(KH)};function XH({root:i,...t}){const e=i||document;Iv.has(e)||Iv.set(e,{});const n=Iv.get(e),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(YH,{root:i,...t})),n[s]}function QH(i,t,e){const n=XH(t);return V_.set(i,e),n.observe(i),()=>{V_.delete(i),n.unobserve(i)}}const JH={some:0,all:1};class ZH extends Ga{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:e,margin:n,amount:s="some",once:a}=t,l={root:e?e.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:JH[s]},c=h=>{const{isIntersecting:d}=h;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:p,onViewportLeave:m}=this.node.getProps(),v=d?p:m;v&&v(h)};return QH(this.node.current,l,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:e}=this.node;["amount","margin","root"].some(t9(t,e))&&this.startObserver()}unmount(){}}function t9({viewport:i={}},{viewport:t={}}={}){return e=>i[e]!==t[e]}const e9={inView:{Feature:ZH},tap:{Feature:WH},focus:{Feature:$H},hover:{Feature:GH}},n9={layout:{ProjectionNode:CP,MeasureLayout:FP}},i9={...xH,...e9,...qH,...n9},wc=EH(i9,wH),s9=()=>{const[i,t]=z.useState([]),[e,n]=z.useState(!0);return z.useEffect(()=>{(async()=>{try{const a=await Rh(xr(Un,"stores"));t(a.docs.map(l=>({id:l.id,...l.data()})))}catch(a){console.error("Error fetching stores:",a)}finally{n(!1)}})()},[]),L.jsxs("div",{className:"home-container",children:[L.jsxs("nav",{className:"glass",style:{padding:"1rem 5%",display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,zIndex:1e3},children:[L.jsx(wa,{to:"/",style:{textDecoration:"none"},children:L.jsxs("h2",{style:{display:"flex",alignItems:"center",gap:"0.5rem",background:"linear-gradient(135deg, #6366f1, #ec4899)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",margin:0},children:[L.jsx(Ac,{color:"#6366f1"})," miniStore"]})}),L.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[L.jsx(wa,{to:"/login",className:"btn btn-secondary",style:{padding:"0.5rem 1rem"},children:"Seller Login"}),L.jsx(wa,{to:"/login",className:"btn btn-primary",style:{padding:"0.5rem 1.25rem"},children:"Create Your Store"})]})]}),L.jsxs("header",{style:{padding:"80px 5% 40px",textAlign:"center",maxWidth:"800px",margin:"0 auto"},children:[L.jsxs(wc.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},style:{fontSize:"3rem",marginBottom:"1rem",lineHeight:1.1},children:["Discover & Shop from ",L.jsx("span",{style:{color:"#6366f1"},children:"Local miniStores"})]}),L.jsx(wc.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},style:{fontSize:"1.1rem",color:"var(--text-muted)",marginBottom:"2rem"},children:"The easiest way for small businesses to sell directly on WhatsApp. No complex checkouts, just real conversations."})]}),L.jsxs("section",{style:{padding:"40px 5%",maxWidth:"1200px",margin:"0 auto"},children:[L.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:"2rem",flexWrap:"wrap",gap:"1rem"},children:[L.jsx("h2",{style:{fontSize:"1.75rem"},children:"Explore Stores"}),L.jsxs("p",{style:{color:"var(--text-muted)"},children:[i.length," stores active"]})]}),e?L.jsx("div",{style:{textAlign:"center",padding:"4rem"},children:"Loading stores..."}):i.length===0?L.jsxs("div",{className:"glass glass-card",style:{textAlign:"center",padding:"4rem"},children:[L.jsx("p",{style:{color:"var(--text-muted)"},children:"No stores have been created yet. Be the first!"}),L.jsx(wa,{to:"/login",className:"btn btn-primary",style:{marginTop:"1.5rem"},children:"Create My Store"})]}):L.jsx("div",{className:"grid grid-cols-2",style:{gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:"1.5rem"},children:i.map(s=>L.jsx(r9,{store:s},s.id))})]}),L.jsxs("section",{id:"features",style:{padding:"80px 5%",background:"rgba(255,255,255,0.02)",marginTop:"4rem"},children:[L.jsxs("div",{style:{textAlign:"center",marginBottom:"4rem"},children:[L.jsx("h2",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"Why sell with miniStore?"}),L.jsx("p",{style:{color:"var(--text-muted)"},children:"Built for the modern mobile entrepreneur."})]}),L.jsxs("div",{className:"grid grid-cols-2",style:{maxWidth:"1000px",margin:"0 auto"},children:[L.jsx(ep,{icon:L.jsx(g6,{color:"#6366f1"}),title:"Mobile First",desc:"Optimized for phone screens to give your customers the best shopping experience."}),L.jsx(ep,{icon:L.jsx(p_,{color:"#22c55e"}),title:"WhatsApp Orders",desc:"Get order details directly on your WhatsApp. No intermediaries, no fees."}),L.jsx(ep,{icon:L.jsx(A6,{color:"#f59e0b"}),title:"Fast Setup",desc:"Launch your store in under 2 minutes with simple, intuitive tools."}),L.jsx(ep,{icon:L.jsx(n6,{color:"#ec4899"}),title:"Public Directory",desc:"Every store is automatically listed here for anyone in the world to find and shop."})]})]}),L.jsx("footer",{style:{padding:"40px 5%",textAlign:"center",borderTop:"1px solid var(--surface-border)",marginTop:"4rem"},children:L.jsx("p",{style:{color:"var(--text-muted)"},children:" 2026 miniStore. Simple Commerce for Everyone."})})]})},r9=({store:i})=>L.jsxs(wc.div,{whileHover:{y:-5,borderColor:i.themeColor||"#6366f1"},className:"glass glass-card",style:{position:"relative",display:"flex",flexDirection:"column",gap:"1rem",border:"1px solid transparent",transition:"border-color 0.3s ease"},children:[L.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[L.jsx("div",{style:{width:"70px",height:"70px",borderRadius:"14px",background:`${i.themeColor||"#6366f1"}22`,display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",border:`1px solid ${i.themeColor||"#6366f1"}44`},children:i.logo?L.jsx("img",{src:i.logo,style:{width:"100%",height:"100%",objectFit:"cover"},alt:i.name}):L.jsx(Ac,{color:i.themeColor||"#6366f1",size:32})}),L.jsxs("div",{style:{flex:1},children:[L.jsx("h3",{style:{fontSize:"1.25rem",marginBottom:"0.25rem"},children:i.name}),L.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",background:"rgba(255,255,255,0.05)",padding:"0.25rem 0.6rem",borderRadius:"20px"},children:["@",i.id]})]})]}),L.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.9rem",minHeight:"2.7em",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:i.description||"Everything you need, just a text away. Browse our products and order instantly!"}),L.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"auto",paddingTop:"0.5rem"},children:[L.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[L.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#22c55e",boxShadow:"0 0 10px #22c55e"}}),L.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Open for orders"})]}),L.jsxs(wa,{to:`/s/${i.id}`,className:"btn btn-primary",style:{padding:"0.6rem 1.2rem",fontSize:"0.875rem",background:i.themeColor||"#6366f1",gap:"0.5rem"},children:["View Store ",L.jsx($4,{size:16})]})]})]}),ep=({icon:i,title:t,desc:e})=>L.jsxs(wc.div,{whileHover:{scale:1.02,background:"rgba(255,255,255,0.05)"},className:"glass glass-card",children:[L.jsx("div",{style:{marginBottom:"1rem"},children:i}),L.jsx("h3",{style:{marginBottom:"0.5rem"},children:t}),L.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.9rem",lineHeight:1.5},children:e})]}),a9=()=>{const[i,t]=z.useState(""),[e,n]=z.useState(""),[s,a]=z.useState(!0),[l,c]=z.useState(""),h=zh(),d=async m=>{m.preventDefault(),c("");try{let v;s?v=await yU(ph,i,e):(v=await gU(ph,i,e),await c_(No(Un,"users",v.user.uid),{email:v.user.email,createdAt:new Date().toISOString()})),h("/dashboard")}catch(v){c(v.message)}},p=async()=>{const m=new Er;try{const b=(await UU(ph,m)).user;(await gI(No(Un,"users",b.uid))).exists()||await c_(No(Un,"users",b.uid),{email:b.email,displayName:b.displayName,photoURL:b.photoURL,createdAt:new Date().toISOString()}),h("/dashboard")}catch(v){c(v.message)}};return L.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},children:L.jsxs("div",{className:"glass glass-card",style:{width:"100%",maxWidth:"400px"},children:[L.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[L.jsxs("h2",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",marginBottom:"1rem"},children:[L.jsx(Ac,{color:"#6366f1"})," miniStore"]}),L.jsx("p",{style:{color:"var(--text-muted)"},children:s?"Welcome back! Login to manage your store.":"Create your account to start selling."})]}),L.jsxs("form",{onSubmit:d,children:[L.jsxs("div",{className:"input-group",children:[L.jsx("label",{className:"label",children:"Email Address"}),L.jsx("input",{type:"email",className:"input",value:i,onChange:m=>t(m.target.value),required:!0})]}),L.jsxs("div",{className:"input-group",children:[L.jsx("label",{className:"label",children:"Password"}),L.jsx("input",{type:"password",className:"input",value:e,onChange:m=>n(m.target.value),required:!0})]}),l&&L.jsx("p",{style:{color:"var(--error)",fontSize:"0.875rem",marginBottom:"1rem"},children:l}),L.jsx("button",{type:"submit",className:"btn btn-primary",style:{width:"100%"},children:s?"Login":"Create Account"})]}),L.jsxs("div",{style:{margin:"1.5rem 0",textAlign:"center",position:"relative"},children:[L.jsx("hr",{style:{border:"none",borderTop:"1px solid var(--surface-border)"}}),L.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"var(--background)",padding:"0 10px",fontSize:"0.75rem",color:"var(--text-muted)"},children:"OR"})]}),L.jsx("button",{onClick:p,className:"btn btn-secondary",style:{width:"100%",marginBottom:"1.5rem"},children:"Continue with Google"}),L.jsxs("p",{style:{textAlign:"center",fontSize:"0.875rem"},children:[s?"Don't have an account?":"Already have an account?",L.jsx("button",{onClick:()=>a(!s),style:{background:"none",border:"none",color:"var(--primary)",cursor:"pointer",marginLeft:"0.5rem",fontWeight:"600"},children:s?"Sign Up":"Login"})]})]})})},Rp=async i=>{const t="7c2634ea043bffa1de4bb29180e394ea",e=new FormData;e.append("image",i);try{const s=await(await fetch(`https://api.imgbb.com/1/upload?key=${t}`,{method:"POST",body:e})).json();if(s.success)return s.data.url;throw new Error(s.error.message||"Upload failed")}catch(n){throw console.error("Cloud Upload Error:",n),n}},B_=(i,t=800,e=.7)=>new Promise((n,s)=>{const a=new FileReader;a.readAsDataURL(i),a.onload=l=>{const c=new Image;c.src=l.target.result,c.onload=()=>{const h=document.createElement("canvas");let d=c.width,p=c.height;d>t&&(p=t/d*p,d=t),h.width=d,h.height=p,h.getContext("2d").drawImage(c,0,0,d,p),h.toBlob(v=>{n(v)},"image/jpeg",e)},c.onerror=h=>s(h)},a.onerror=l=>s(l)}),o9=()=>{const{store:i,setStore:t,loading:e,refreshStore:n}=eD(),{user:s}=nb(),a=zh(),[l,c]=z.useState([]),[h,d]=z.useState(!1),[p,m]=z.useState(!1),[v,b]=z.useState(!1),[w,E]=z.useState(""),[S,C]=z.useState(""),[R,I]=z.useState(""),[B,F]=z.useState(""),[j,P]=z.useState("#6366f1"),[D,M]=z.useState(null);z.useEffect(()=>{i&&(V(),E(i.name||""),C(i.handle||""),I(i.description||""),F(i.whatsapp||""),P(i.themeColor||"#6366f1"))},[i]),z.useEffect(()=>{document.documentElement.style.setProperty("--primary",j)},[j]);const V=async()=>{const K=Wp(xr(Un,"products"),Kp("storeId","==",i.id)),tt=await Rh(K);c(tt.docs.map(ut=>({id:ut.id,...ut.data()})))},O=async K=>{if(!K)return null;const tt=await B_(K,400,.8);return await Rp(tt)},G=async K=>{K.preventDefault(),b(!0);try{let tt=i?.logo||null;D&&(tt=await O(D));const ut={name:w,handle:S.toLowerCase().replace(/\s+/g,"-"),description:R,whatsapp:B,themeColor:j,logo:tt,ownerId:s.uid,updatedAt:new Date().toISOString()};if(i?.id)await c_(No(Un,"stores",i.id),ut,{merge:!0}),t({...i,...ut});else{const At=await _p(xr(Un,"stores"),{...ut,createdAt:new Date().toISOString()});t({id:At.id,...ut})}d(!1),m(!1),document.documentElement.style.setProperty("--primary",j)}catch(tt){console.error("Error saving store:",tt),alert("Error saving settings")}finally{b(!1)}},U=async K=>{window.confirm("Delete this product?")&&(await jF(No(Un,"products",K)),V())},gt=()=>{ph.signOut(),a("/")};if(e)return L.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading..."});if(!i&&!h)return L.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"2rem"},children:L.jsxs("div",{className:"glass glass-card",style:{textAlign:"center",maxWidth:"400px"},children:[L.jsx(Ac,{size:48,color:"var(--primary)",style:{marginBottom:"1rem"}}),L.jsx("h3",{children:"No store found"}),L.jsx("p",{style:{color:"var(--text-muted)",margin:"1rem 0"},children:"You haven't created a store yet. Let's set it up!"}),L.jsx("button",{onClick:()=>d(!0),className:"btn btn-primary",children:"Create Your Store"})]})});if(h||p)return L.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"2rem"},children:L.jsxs("form",{onSubmit:G,className:"glass glass-card",style:{width:"100%",maxWidth:"500px"},children:[L.jsx("h2",{style:{marginBottom:"1.5rem"},children:"Store Settings"}),L.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"1.5rem"},children:L.jsxs("div",{style:{textAlign:"center"},children:[L.jsx("div",{className:"glass",style:{width:"80px",height:"80px",borderRadius:"50%",margin:"0 auto 0.5rem",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:D||i?.logo?L.jsx("img",{src:D?URL.createObjectURL(D):i.logo,style:{width:"100%",height:"100%",objectFit:"cover"},alt:"Logo"}):L.jsx(Ac,{color:"var(--text-muted)"})}),L.jsxs("label",{className:"btn btn-secondary",style:{padding:"0.4rem 0.8rem",fontSize:"0.75rem"},children:["Change Logo",L.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:K=>M(K.target.files[0])})]})]})}),L.jsxs("div",{className:"input-group",children:[L.jsx("label",{className:"label",children:"Store Name"}),L.jsx("input",{className:"input",placeholder:"e.g. My Awesome Shop",value:w,onChange:K=>E(K.target.value),required:!0})]}),L.jsxs("div",{className:"input-group",children:[L.jsx("label",{className:"label",children:"Unique Store Handle (URL name)"}),L.jsx("input",{className:"input",placeholder:"e.g. footballhouse",value:S,onChange:K=>C(K.target.value),required:!0}),L.jsxs("span",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:["This will be your link: ministore.com/s/",S||"your-handle"]})]}),L.jsxs("div",{className:"input-group",children:[L.jsx("label",{className:"label",children:"Store Description (Short)"}),L.jsx("textarea",{className:"input",placeholder:"e.g. Handmade jewelry and accessories",value:R,onChange:K=>I(K.target.value),rows:"2"})]}),L.jsxs("div",{className:"input-group",children:[L.jsx("label",{className:"label",children:"WhatsApp Number (with country code)"}),L.jsx("input",{className:"input",placeholder:"e.g. 919876543210",value:B,onChange:K=>F(K.target.value),required:!0})]}),L.jsxs("div",{className:"input-group",children:[L.jsx("label",{className:"label",children:"Theme Color"}),L.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[L.jsx("input",{type:"color",className:"input",style:{width:"60px",height:"40px",padding:"2px"},value:j,onChange:K=>P(K.target.value)}),L.jsx("span",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:j})]})]}),L.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[L.jsx("button",{type:"submit",className:"btn btn-primary",style:{flex:1},disabled:v,children:v?"Saving...":"Save Settings"}),L.jsx("button",{type:"button",onClick:()=>{d(!1),m(!1)},className:"btn btn-secondary",children:"Cancel"})]})]})});const Pt=i.handle||i.id,W=window.location.origin+"/#/s/"+Pt;return L.jsxs("div",{style:{padding:"2rem 5%"},children:[L.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"3rem",flexWrap:"wrap",gap:"1rem"},children:[L.jsxs("div",{style:{display:"flex",gap:"1.5rem",alignItems:"center"},children:[i.logo&&L.jsx("img",{src:i.logo,style:{width:"64px",height:"64px",borderRadius:"12px",objectFit:"cover"},alt:"Store Logo"}),L.jsxs("div",{children:[L.jsx("h1",{style:{fontSize:"2rem",marginBottom:"0.25rem"},children:i.name}),L.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",background:"rgba(255,255,255,0.05)",padding:"0.4rem 0.8rem",borderRadius:"20px"},children:[L.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:W}),L.jsx("button",{onClick:()=>{navigator.clipboard.writeText(W),alert("Copied!")},style:{background:"none",border:"none",cursor:"pointer",display:"flex"},children:L.jsx(K4,{size:12,color:"var(--text-muted)"})}),L.jsx("a",{href:W,target:"_blank",rel:"noreferrer",style:{display:"flex"},children:L.jsx(X4,{size:12,color:"var(--primary)"})})]})]})]}),L.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[L.jsxs("button",{onClick:()=>m(!0),className:"btn btn-secondary",children:[L.jsx(f6,{size:18})," Settings"]}),L.jsxs("button",{onClick:gt,className:"btn btn-secondary",children:[L.jsx(a6,{size:18})," Logout"]})]})]}),L.jsxs("section",{style:{marginBottom:"3rem"},children:[L.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[L.jsx("h2",{children:"Your Products"}),L.jsxs(wa,{to:"/dashboard/add",className:"btn btn-primary",children:[L.jsx(c6,{size:18})," Add Product"]})]}),l.length===0?L.jsx("div",{className:"glass glass-card",style:{textAlign:"center",padding:"3rem"},children:L.jsx("p",{style:{color:"var(--text-muted)"},children:"No products yet. Start adding items to your store."})}):L.jsx("div",{className:"grid grid-cols-2",style:{gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))"},children:l.map(K=>L.jsxs("div",{className:"glass glass-card",style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[L.jsx("img",{src:K.image,alt:K.name,style:{width:"100%",height:"200px",objectFit:"cover",borderRadius:"8px"}}),L.jsxs("div",{style:{flex:1},children:[L.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.25rem"},children:[L.jsx("h3",{style:{fontSize:"1.1rem"},children:K.name}),K.category&&L.jsx("span",{style:{fontSize:"0.7rem",background:"rgba(255,255,255,0.1)",padding:"0.2rem 0.5rem",borderRadius:"10px",color:"var(--text-muted)",textTransform:"capitalize"},children:K.category})]}),L.jsxs("p",{style:{color:"var(--primary)",fontWeight:"700"},children:["",K.price]})]}),L.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:L.jsx("button",{onClick:()=>U(K.id),style:{background:"none",border:"none",cursor:"pointer",color:"var(--error)"},children:L.jsx(iD,{size:18})})})]},K.id))})]})]})},Bn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),F_=[.001,0,0,.001,0,0],Dv=1.35,di={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Aa={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Lh="pdfjs_internal_editor_",Vt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Yt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},l9={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},U_={TRIANGLES:1,LATTICE:2},an={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Ip={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Qe={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Wl={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Um={ERRORS:0,WARNINGS:1,INFOS:5},Vh={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},$u={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},c9={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let jm=Um.WARNINGS;function u9(i){Number.isInteger(i)&&(jm=i)}function h9(){return jm}function zm(i){jm>=Um.INFOS&&console.info(`Info: ${i}`)}function Nt(i){jm>=Um.WARNINGS&&console.warn(`Warning: ${i}`)}function me(i){throw new Error(i)}function Xt(i,t){i||me(t)}function d9(i){switch(i?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function UP(i,t=null,e=null){if(!i)return null;if(e&&typeof i=="string"&&(e.addDefaultProtocol&&i.startsWith("www.")&&i.match(/\./g)?.length>=2&&(i=`http://${i}`),e.tryConvertEncoding))try{i=y9(i)}catch{}const n=t?URL.parse(i,t):URL.parse(i);return d9(n)?n:null}function jP(i,t,e=!1){const n=URL.parse(i);return n?(n.hash=t,n.href):e&&UP(i,"http://example.com")?i.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Ot(i,t,e,n=!1){return Object.defineProperty(i,t,{value:e,enumerable:!n,configurable:!0,writable:!1}),e}const Jo=(function(){function t(e,n){this.message=e,this.name=n}return t.prototype=new Error,t.constructor=t,t})();class DC extends Jo{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Pv extends Jo{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class j_ extends Jo{constructor(t){super(t,"InvalidPDFException")}}class um extends Jo{constructor(t,e,n){super(t,"ResponseException"),this.status=e,this.missing=n}}class f9 extends Jo{constructor(t){super(t,"FormatError")}}class Fa extends Jo{constructor(t){super(t,"AbortException")}}function zP(i){(typeof i!="object"||i?.length===void 0)&&me("Invalid argument for bytesToString");const t=i.length,e=8192;if(t<e)return String.fromCharCode.apply(null,i);const n=[];for(let s=0;s<t;s+=e){const a=Math.min(s+e,t),l=i.subarray(s,a);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function ad(i){typeof i!="string"&&me("Invalid argument for stringToBytes");const t=i.length,e=new Uint8Array(t);for(let n=0;n<t;++n)e[n]=i.charCodeAt(n)&255;return e}function p9(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function m9(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function g9(){try{return new Function(""),!0}catch{return!1}}class cn{static get isLittleEndian(){return Ot(this,"isLittleEndian",m9())}static get isEvalSupported(){return Ot(this,"isEvalSupported",g9())}static get isOffscreenCanvasSupported(){return Ot(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ot(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return Ot(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return Ot(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Ot(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return Ot(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Mv=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));class ft{static makeHexColor(t,e,n){return`#${Mv[t]}${Mv[e]}${Mv[n]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,n=0){const s=t[n],a=t[n+1];t[n]=s*e[0]+a*e[2]+e[4],t[n+1]=s*e[1]+a*e[3]+e[5]}static applyTransformToBezier(t,e,n=0){const s=e[0],a=e[1],l=e[2],c=e[3],h=e[4],d=e[5];for(let p=0;p<6;p+=2){const m=t[n+p],v=t[n+p+1];t[n+p]=m*s+v*l+h,t[n+p+1]=m*a+v*c+d}}static applyInverseTransform(t,e){const n=t[0],s=t[1],a=e[0]*e[3]-e[1]*e[2];t[0]=(n*e[3]-s*e[2]+e[2]*e[5]-e[4]*e[3])/a,t[1]=(-n*e[1]+s*e[0]+e[4]*e[1]-e[5]*e[0])/a}static axialAlignedBoundingBox(t,e,n){const s=e[0],a=e[1],l=e[2],c=e[3],h=e[4],d=e[5],p=t[0],m=t[1],v=t[2],b=t[3];let w=s*p+h,E=w,S=s*v+h,C=S,R=c*m+d,I=R,B=c*b+d,F=B;if(a!==0||l!==0){const j=a*p,P=a*v,D=l*m,M=l*b;w+=D,C+=D,S+=M,E+=M,R+=j,F+=j,B+=P,I+=P}n[0]=Math.min(n[0],w,S,E,C),n[1]=Math.min(n[1],R,B,I,F),n[2]=Math.max(n[2],w,S,E,C),n[3]=Math.max(n[3],R,B,I,F)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const n=t[0],s=t[1],a=t[2],l=t[3],c=n**2+s**2,h=n*a+s*l,d=a**2+l**2,p=(c+d)/2,m=Math.sqrt(p**2-(c*d-h**2));e[0]=Math.sqrt(p+m||1),e[1]=Math.sqrt(p-m||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),s=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>s)return null;const a=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),l=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return a>l?null:[n,a,s,l]}static pointBoundingBox(t,e,n){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}static rectBoundingBox(t,e,n,s,a){a[0]=Math.min(a[0],t,n),a[1]=Math.min(a[1],e,s),a[2]=Math.max(a[2],t,n),a[3]=Math.max(a[3],e,s)}static#t(t,e,n,s,a,l,c,h,d,p){if(d<=0||d>=1)return;const m=1-d,v=d*d,b=v*d,w=m*(m*(m*t+3*d*e)+3*v*n)+b*s,E=m*(m*(m*a+3*d*l)+3*v*c)+b*h;p[0]=Math.min(p[0],w),p[1]=Math.min(p[1],E),p[2]=Math.max(p[2],w),p[3]=Math.max(p[3],E)}static#e(t,e,n,s,a,l,c,h,d,p,m,v){if(Math.abs(d)<1e-12){Math.abs(p)>=1e-12&&this.#t(t,e,n,s,a,l,c,h,-m/p,v);return}const b=p**2-4*m*d;if(b<0)return;const w=Math.sqrt(b),E=2*d;this.#t(t,e,n,s,a,l,c,h,(-p+w)/E,v),this.#t(t,e,n,s,a,l,c,h,(-p-w)/E,v)}static bezierBoundingBox(t,e,n,s,a,l,c,h,d){d[0]=Math.min(d[0],t,c),d[1]=Math.min(d[1],e,h),d[2]=Math.max(d[2],t,c),d[3]=Math.max(d[3],e,h),this.#e(t,n,a,c,e,s,l,h,3*(-t+3*(n-a)+c),6*(t-2*n+a),3*(n-t),d),this.#e(t,n,a,c,e,s,l,h,3*(-e+3*(s-l)+h),6*(e-2*s+l),3*(s-e),d)}}function y9(i){return decodeURIComponent(escape(i))}let kv=null,PC=null;function v9(i){return kv||(kv=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,PC=new Map([["","t"]])),i.replaceAll(kv,(t,e,n)=>e?e.normalize("NFKC"):PC.get(n))}function HP(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),zP(i)}const tc="pdfjs_internal_id_";function _9(i,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[n,s,...a]=e;if(!i(n)&&!Number.isInteger(n)||!t(s))return!1;const l=a.length;let c=!0;switch(s.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;c=!1;break;default:return!1}for(const h of a)if(!(typeof h=="number"||c&&h===null))return!1;return!0}function Fn(i,t,e){return Math.min(Math.max(i,t),e)}function qP(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(zP(i))}function b9(i){return Uint8Array.fromBase64?Uint8Array.fromBase64(i):ad(atob(i))}typeof Promise.try!="function"&&(Promise.try=function(i,...t){return new Promise(e=>{e(i(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(i){return i.reduce((t,e)=>t+e,0)});class Bh{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};function s(a){if(!a)return;let l=null;const c=a.name;if(c==="#text")l=a.value;else if(Bh.shouldBuildText(c))a?.attributes?.textContent?l=a.attributes.textContent:a.value&&(l=a.value);else return;if(l!==null&&e.push({str:l}),!!a.children)for(const h of a.children)s(h)}return s(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class GP{static setupStorage(t,e,n,s,a){const l=s.getValue(e,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(t.textContent=l.value),a==="print")break;t.addEventListener("input",c=>{s.setValue(e,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?t.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&t.removeAttribute("checked"),a==="print")break;t.addEventListener("change",c=>{s.setValue(e,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&t.setAttribute("value",l.value),a==="print")break;t.addEventListener("input",c=>{s.setValue(e,{value:c.target.value})})}break;case"select":if(l.value!==null){t.setAttribute("value",l.value);for(const c of n.children)c.attributes.value===l.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}t.addEventListener("input",c=>{const h=c.target.options,d=h.selectedIndex===-1?"":h[h.selectedIndex].value;s.setValue(e,{value:d})});break}}static setAttributes({html:t,element:e,storage:n=null,intent:s,linkService:a}){const{attributes:l}=e,c=t instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${s}`);for(const[h,d]of Object.entries(l))if(d!=null)switch(h){case"class":d.length&&t.setAttribute(h,d.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",d);break;case"style":Object.assign(t.style,d);break;case"textContent":t.textContent=d;break;default:(!c||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,d)}c&&a.addLinkAttributes(t,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(t,l.dataId,e,n)}static render(t){const e=t.annotationStorage,n=t.linkService,s=t.xfaHtml,a=t.intent||"display",l=document.createElement(s.name);s.attributes&&this.setAttributes({html:l,element:s,intent:a,linkService:n});const c=a!=="richText",h=t.div;if(h.append(l),t.viewport){const m=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=m}c&&h.setAttribute("class","xfaLayer xfaFont");const d=[];if(s.children.length===0){if(s.value){const m=document.createTextNode(s.value);l.append(m),c&&Bh.shouldBuildText(s.name)&&d.push(m)}return{textDivs:d}}const p=[[s,-1,l]];for(;p.length>0;){const[m,v,b]=p.at(-1);if(v+1===m.children.length){p.pop();continue}const w=m.children[++p.at(-1)[1]];if(w===null)continue;const{name:E}=w;if(E==="#text"){const C=document.createTextNode(w.value);d.push(C),b.append(C);continue}const S=w?.attributes?.xmlns?document.createElementNS(w.attributes.xmlns,E):document.createElement(E);if(b.append(S),w.attributes&&this.setAttributes({html:S,element:w,storage:e,intent:a,linkService:n}),w.children?.length>0)p.push([w,-1,S]);else if(w.value){const C=document.createTextNode(w.value);c&&Bh.shouldBuildText(E)&&d.push(C),S.append(C)}}for(const m of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:d}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const _r="http://www.w3.org/2000/svg";class Tc{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function od(i,t="text"){if(rh(i,document.baseURI)){const e=await fetch(i);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,n)=>{const s=new XMLHttpRequest;s.open("GET",i,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(s.response);return}e(s.responseText);return}n(new Error(s.statusText))}},s.send(null)})}class ld{constructor({viewBox:t,userUnit:e,scale:n,rotation:s,offsetX:a=0,offsetY:l=0,dontFlip:c=!1}){this.viewBox=t,this.userUnit=e,this.scale=n,this.rotation=s,this.offsetX=a,this.offsetY=l,n*=e;const h=(t[2]+t[0])/2,d=(t[3]+t[1])/2;let p,m,v,b;switch(s%=360,s<0&&(s+=360),s){case 180:p=-1,m=0,v=0,b=1;break;case 90:p=0,m=1,v=1,b=0;break;case 270:p=0,m=-1,v=-1,b=0;break;case 0:p=1,m=0,v=0,b=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(v=-v,b=-b);let w,E,S,C;p===0?(w=Math.abs(d-t[1])*n+a,E=Math.abs(h-t[0])*n+l,S=(t[3]-t[1])*n,C=(t[2]-t[0])*n):(w=Math.abs(h-t[0])*n+a,E=Math.abs(d-t[1])*n+l,S=(t[2]-t[0])*n,C=(t[3]-t[1])*n),this.transform=[p*n,m*n,v*n,b*n,w-p*n*h-v*n*d,E-m*n*h-b*n*d],this.width=S,this.height=C}get rawDims(){const t=this.viewBox;return Ot(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:a=!1}={}){return new ld({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:s,dontFlip:a})}convertToViewportPoint(t,e){const n=[t,e];return ft.applyTransform(n,this.transform),n}convertToViewportRectangle(t){const e=[t[0],t[1]];ft.applyTransform(e,this.transform);const n=[t[2],t[3]];return ft.applyTransform(n,this.transform),[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){const n=[t,e];return ft.applyInverseTransform(n,this.transform),n}}class Ob extends Jo{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function Hm(i){const t=i.length;let e=0;for(;e<t&&i[e].trim()==="";)e++;return i.substring(e,e+5).toLowerCase()==="data:"}function Lb(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function A9(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function E9(i,t="document.pdf"){if(typeof i!="string")return t;if(Hm(i))return Nt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(i);if(!n)return t;const s=c=>{try{let h=decodeURIComponent(c);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:c):h}catch{return c}},a=/\.pdf$/i,l=n.pathname.split("/").at(-1);if(a.test(l))return s(l);if(n.searchParams.size>0){const c=Array.from(n.searchParams.values()).reverse();for(const d of c)if(a.test(d))return s(d);const h=Array.from(n.searchParams.keys()).reverse();for(const d of h)if(a.test(d))return s(d)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return s(h[0])}return t}class MC{started=Object.create(null);times=[];time(t){t in this.started&&Nt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Nt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:n}of this.times)e=Math.max(n.length,e);for(const{name:n,start:s,end:a}of this.times)t.push(`${n.padEnd(e)} ${a-s}ms
`);return t.join("")}}function rh(i,t){const e=t?URL.parse(i,t):URL.parse(i);return e?.protocol==="http:"||e?.protocol==="https:"}function Ui(i){i.preventDefault()}function Ne(i){i.preventDefault(),i.stopPropagation()}function w9(i){console.log("Deprecated API usage: "+i)}class z_{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const n=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let a=parseInt(e[3],10);a=a>=1&&a<=31?a:1;let l=parseInt(e[4],10);l=l>=0&&l<=23?l:0;let c=parseInt(e[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const d=e[7]||"Z";let p=parseInt(e[8],10);p=p>=0&&p<=23?p:0;let m=parseInt(e[9],10)||0;return m=m>=0&&m<=59?m:0,d==="-"?(l+=p,c+=m):d==="+"&&(l-=p,c-=m),new Date(Date.UTC(n,s,a,l,c,h))}}function T9(i,{scale:t=1,rotation:e=0}){const{width:n,height:s}=i.attributes.style,a=[0,0,parseInt(n),parseInt(s)];return new ld({viewBox:a,userUnit:1,scale:t,rotation:e})}function cd(i){if(i.startsWith("#")){const t=parseInt(i.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(t=>parseInt(t)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Nt(`Not a valid color format: "${i}"`),[0,0,0])}function S9(i){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of i.keys()){t.style.color=e;const n=window.getComputedStyle(t).color;i.set(e,cd(n))}t.remove()}function xe(i){const{a:t,b:e,c:n,d:s,e:a,f:l}=i.getTransform();return[t,e,n,s,a,l]}function Os(i){const{a:t,b:e,c:n,d:s,e:a,f:l}=i.getTransform().invertSelf();return[t,e,n,s,a,l]}function Ho(i,t,e=!1,n=!0){if(t instanceof ld){const{pageWidth:s,pageHeight:a}=t.rawDims,{style:l}=i,c=cn.isCSSRoundSupported,h=`var(--total-scale-factor) * ${s}px`,d=`var(--total-scale-factor) * ${a}px`,p=c?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,m=c?`round(down, ${d}, var(--scale-round-y))`:`calc(${d})`;!e||t.rotation%180===0?(l.width=p,l.height=m):(l.width=m,l.height=p)}n&&i.setAttribute("data-main-rotation",t.rotation)}class Ys{constructor(){const{pixelRatio:t}=Ys;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,n,s,a=-1){let l=1/0,c=1/0,h=1/0;n=Ys.capPixels(n,a),n>0&&(l=Math.sqrt(n/(t*e))),s!==-1&&(c=s/t,h=s/e);const d=Math.min(l,c,h);return this.sx>d||this.sy>d?(this.sx=d,this.sy=d,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,n):n}return t}}const H_=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class C9{static get isDarkMode(){return Ot(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class x9{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:n}=window.getComputedStyle(t);return t.remove(),Ot(this,"commentForegroundColor",cd(n))}}function R9(i,t,e,n){n=Math.min(Math.max(n??1,0),1);const s=255*(1-n);return i=Math.round(i*n+s),t=Math.round(t*n+s),e=Math.round(e*n+s),[i,t,e]}function kC(i,t){const e=i[0]/255,n=i[1]/255,s=i[2]/255,a=Math.max(e,n,s),l=Math.min(e,n,s),c=(a+l)/2;if(a===l)t[0]=t[1]=0;else{const h=a-l;switch(t[1]=c<.5?h/(a+l):h/(2-a-l),a){case e:t[0]=((n-s)/h+(n<s?6:0))*60;break;case n:t[0]=((s-e)/h+2)*60;break;case s:t[0]=((e-n)/h+4)*60;break}}t[2]=c}function q_(i,t){const e=i[0],n=i[1],s=i[2],a=(1-Math.abs(2*s-1))*n,l=a*(1-Math.abs(e/60%2-1)),c=s-a/2;switch(Math.floor(e/60)){case 0:t[0]=a+c,t[1]=l+c,t[2]=c;break;case 1:t[0]=l+c,t[1]=a+c,t[2]=c;break;case 2:t[0]=c,t[1]=a+c,t[2]=l+c;break;case 3:t[0]=c,t[1]=l+c,t[2]=a+c;break;case 4:t[0]=l+c,t[1]=c,t[2]=a+c;break;case 5:case 6:t[0]=a+c,t[1]=c,t[2]=l+c;break}}function NC(i){return i<=.03928?i/12.92:((i+.055)/1.055)**2.4}function OC(i,t,e){q_(i,e),e.map(NC);const n=.2126*e[0]+.7152*e[1]+.0722*e[2];q_(t,e),e.map(NC);const s=.2126*e[0]+.7152*e[1]+.0722*e[2];return n>s?(n+.05)/(s+.05):(s+.05)/(n+.05)}const LC=new Map;function I9(i,t){const e=i[0]+i[1]*256+i[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let n=LC.get(e);if(n)return n;const s=new Float32Array(9),a=s.subarray(0,3),l=s.subarray(3,6);kC(i,l);const c=s.subarray(6,9);kC(t,c);const h=c[2]<.5,d=h?12:4.5;if(l[2]=h?Math.sqrt(l[2]):1-Math.sqrt(1-l[2]),OC(l,c,a)<d){let p,m;h?(p=l[2],m=1):(p=0,m=l[2]);const v=.005;for(;m-p>v;){const b=l[2]=(p+m)/2;h===OC(l,c,a)<d?p=b:m=b}l[2]=h?m:p}return q_(l,a),n=ft.makeHexColor(Math.round(a[0]*255),Math.round(a[1]*255),Math.round(a[2]*255)),LC.set(e,n),n}function $P({html:i,dir:t,className:e},n){const s=document.createDocumentFragment();if(typeof i=="string"){const a=document.createElement("p");a.dir=t||"auto";const l=i.split(/(?:\r\n?|\n)/);for(let c=0,h=l.length;c<h;++c){const d=l[c];a.append(document.createTextNode(d)),c<h-1&&a.append(document.createElement("br"))}s.append(a)}else GP.render({xfaHtml:i,div:s,intent:"richText"});s.firstElementChild.classList.add("richText",e),n.append(s)}function WP(i){const t=new Path2D;if(!i)return t;for(let e=0,n=i.length;e<n;)switch(i[e++]){case $u.moveTo:t.moveTo(i[e++],i[e++]);break;case $u.lineTo:t.lineTo(i[e++],i[e++]);break;case $u.curveTo:t.bezierCurveTo(i[e++],i[e++],i[e++],i[e++],i[e++],i[e++]);break;case $u.quadraticCurveTo:t.quadraticCurveTo(i[e++],i[e++],i[e++],i[e++]);break;case $u.closePath:t.closePath();break;default:Nt(`Unrecognized drawing path operator: ${i[e-1]}`);break}return t}class _h{#t=null;#e=null;#i;#n=null;#a=null;#r=null;#s=null;#o=null;static#c=null;constructor(t){this.#i=t,_h.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#i._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",Ui,{signal:e}),t.addEventListener("pointerdown",_h.#l,{signal:e}));const n=this.#n=document.createElement("div");n.className="buttons",t.append(n);const s=this.#i.toolbarPosition;if(s){const{style:a}=t,l=this.#i._uiManager.direction==="ltr"?1-s[0]:s[0];a.insetInlineEnd=`${100*l}%`,a.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#i._focusEventsAllowed=!1,Ne(t)}#h(t){this.#i._focusEventsAllowed=!0,Ne(t)}#f(t){const e=this.#i._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Ui,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#a?.shown(),this.#r?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#i,n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",_h.#c[t]),this.#f(n)&&n.addEventListener("click",s=>{e.delete()},{signal:e._signal}),this.#n.append(n)}get#g(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#f(e),this.#n.append(e,this.#g),this.#a=t}addComment(t,e=null){if(this.#r)return;const n=t.renderForToolbar();if(!n)return;this.#f(n);const s=this.#s=this.#g;e?(this.#n.insertBefore(n,e),this.#n.insertBefore(s,e)):this.#n.append(n,s),this.#r=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#f(e),this.#n.append(e,this.#g)}async addEditSignatureButton(t){const e=this.#o=await t.renderEditButton(this.#i);this.#f(e),this.#n.append(e,this.#g)}removeButton(t){t==="comment"&&(this.#r?.removeToolbarCommentButton(),this.#r=null,this.#s?.remove(),this.#s=null)}async addButton(t,e){switch(t){case"colorPicker":e&&this.addColorPicker(e);break;case"altText":e&&await this.addAltText(e);break;case"editSignature":e&&await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":e&&this.addComment(e);break}}async addButtonBefore(t,e,n){if(!e&&t==="comment")return;const s=this.#n.querySelector(n);s&&t==="comment"&&this.addComment(e,s)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class D9{#t=null;#e=null;#i;constructor(t){this.#i=t}#n(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#i._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",Ui,{signal:e});const n=this.#t=document.createElement("div");return n.className="buttons",t.append(n),this.#i.hasCommentManager()&&this.#r("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#r("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),t}#a(t,e){let n=0,s=0;for(const a of t){const l=a.y+a.height;if(l<n)continue;const c=a.x+(e?a.width:0);if(l>n){s=c,n=l;continue}e?c>s&&(s=c):c<s&&(s=c)}return[e?1-s:s,n]}show(t,e,n){const[s,a]=this.#a(e,n),{style:l}=this.#e||=this.#n();t.append(this.#e),l.insetInlineEnd=`${100*s}%`,l.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#r(t,e,n,s){const a=document.createElement("button");a.classList.add("basic",t),a.tabIndex=0,a.setAttribute("data-l10n-id",e);const l=document.createElement("span");a.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",n);const c=this.#i._signal;c instanceof AbortSignal&&!c.aborted&&(a.addEventListener("contextmenu",Ui,{signal:c}),a.addEventListener("click",s,{signal:c})),this.#t.append(a)}}function KP(i,t,e){for(const n of e)t.addEventListener(n,i[n].bind(i))}class ie{static#t=NaN;static#e=null;static#i=NaN;static#n=null;static initializeAndAddPointerId(t){(ie.#e||=new Set).add(t)}static setPointer(t,e){ie.#t||=e,ie.#n??=t}static setTimeStamp(t){ie.#i=t}static isSamePointerId(t){return ie.#t===t}static isSamePointerIdOrRemove(t){return ie.#t===t?!0:(ie.#e?.delete(t),!1)}static isSamePointerType(t){return ie.#n===t}static isInitializedAndDifferentPointerType(t){return ie.#n!==null&&!ie.isSamePointerType(t)}static isSameTimeStamp(t){return ie.#i===t}static isUsingMultiplePointers(){return ie.#e?.size>=1}static clearPointerType(){ie.#n=null}static clearPointerIds(){ie.#t=NaN,ie.#e=null}static clearTimeStamp(){ie.#i=NaN}}class P9{#t=0;get id(){return`${Lh}${this.#t++}`}}class Vb{#t=HP();#e=0;#i=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=t;const a=s.decode().then(()=>(n.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Ot(this,"_isSVGFittingCanvas",a)}async#n(t,e){this.#i||=new Map;let n=this.#i.get(t);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let s;if(typeof e=="string"?(n.url=e,s=await od(e,"blob")):e instanceof File?s=n.file=e:e instanceof Blob&&(s=e),s.type==="image/svg+xml"){const a=Vb._isSVGFittingCanvas,l=new FileReader,c=new Image,h=new Promise((d,p)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,d()},l.onload=async()=>{const m=n.svgUrl=l.result;c.src=await a?`${m}#svgView(preserveAspectRatio(none))`:m},c.onerror=l.onerror=p});l.readAsDataURL(s),await h}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){Nt(s),n=null}return this.#i.set(t,n),n&&this.#i.set(n.id,n),n}async getFromFile(t){const{lastModified:e,name:n,size:s,type:a}=t;return this.#n(`${e}_${n}_${s}_${a}`,t)}async getFromUrl(t){return this.#n(t,t)}async getFromBlob(t,e){const n=await e;return this.#n(t,n)}async getFromId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:n}=e;return delete e.blobPromise,this.getFromBlob(e.id,n)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#i||=new Map;let n=this.#i.get(t);if(n?.bitmap)return n.refCounter+=1,n;const s=new OffscreenCanvas(e.width,e.height);return s.getContext("2d").drawImage(e,0,0),n={bitmap:s.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#i.set(t,n),this.#i.set(n.id,n),n}getSvgUrl(t){const e=this.#i.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:n}=e;if(!e.url&&!e.file){const s=new OffscreenCanvas(n.width,n.height);s.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=s.convertToBlob()}n.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class M9{#t=[];#e=!1;#i;#n=-1;constructor(t=128){this.#i=t}add({cmd:t,undo:e,post:n,mustExec:s,type:a=NaN,overwriteIfSameType:l=!1,keepUndo:c=!1}){if(s&&t(),this.#e)return;const h={cmd:t,undo:e,post:n,type:a};if(this.#n===-1){this.#t.length>0&&(this.#t.length=0),this.#n=0,this.#t.push(h);return}if(l&&this.#t[this.#n].type===a){c&&(h.undo=this.#t[this.#n].undo),this.#t[this.#n]=h;return}const d=this.#n+1;d===this.#i?this.#t.splice(0,1):(this.#n=d,d<this.#t.length&&this.#t.splice(d)),this.#t.push(h)}undo(){if(this.#n===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1,this.#n-=1}redo(){if(this.#n<this.#t.length-1){this.#n+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#t.length-1}cleanType(t){if(this.#n!==-1){for(let e=this.#n;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#n-e),this.#n=e;return}this.#t.length=0,this.#n=-1}}destroy(){this.#t=null}}class ud{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=cn.platform;for(const[n,s,a={}]of t)for(const l of n){const c=l.startsWith("mac+");e&&c?(this.callbacks.set(l.slice(4),{callback:s,options:a}),this.allKeys.add(l.split("+").at(-1))):!e&&!c&&(this.callbacks.set(l,{callback:s,options:a}),this.allKeys.add(l.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(this.#t(e));if(!n)return;const{callback:s,options:{bubbles:a=!1,args:l=[],checker:c=null}}=n;c&&!c(t,e)||(s.bind(t,...l,e)(),a||Ne(e))}}class Bb{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return S9(t),Ot(this,"_colors",t)}convert(t){const e=cd(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[n,s]of this._colors)if(s.every((a,l)=>a===e[l]))return Bb._colorsMapping.get(n);return e}getHexCode(t){const e=this._colors.get(t);return e?ft.makeHexColor(...e):t}}class Ua{#t=new AbortController;#e=null;#i=null;#n=new Map;#a=new Map;#r=null;#s=null;#o=null;#c=new M9;#l=null;#d=null;#h=null;#f=0;#g=new Set;#m=null;#u=null;#p=new Set;_editorUndoBar=null;#y=!1;#_=!1;#v=!1;#S=null;#w=null;#A=null;#x=null;#b=!1;#T=null;#D=new P9;#R=!1;#I=!1;#V=!1;#M=null;#N=null;#B=null;#O=null;#q=null;#C=Vt.NONE;#E=new Set;#k=null;#F=null;#j=null;#W=null;#$=null;#K={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#z=[0,0];#L=null;#G=null;#J=null;#Z=null;#U=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Ua.prototype,e=l=>l.#G.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},s=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return Ot(this,"_keyboardManager",new ud([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#G.contains(c)&&!l.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#G.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}]]))}constructor(t,e,n,s,a,l,c,h,d,p,m,v,b,w,E,S){const C=this._signal=this.#t.signal;this.#G=t,this.#J=e,this.#Z=n,this.#r=s,this.#l=a,this.#F=l,this.#$=h,this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:C}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:C}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:C}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:C}),c._on("setpreference",this.onSetPreference.bind(this),{signal:C}),c._on("switchannotationeditorparams",R=>this.updateParams(R.type,R.value),{signal:C}),window.addEventListener("pointerdown",()=>{this.#I=!0},{capture:!0,signal:C}),window.addEventListener("pointerup",()=>{this.#I=!1},{capture:!0,signal:C}),this.#at(),this.#dt(),this.#et(),this.#s=h.annotationStorage,this.#S=h.filterFactory,this.#j=d,this.#x=p||null,this.#y=m,this.#_=v,this.#v=b,this.#q=w||null,this.viewParameters={realScale:Tc.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=E||null,this._supportsPinchToZoom=S!==!1,a?.setSidebarUiManager(this)}destroy(){this.#U?.resolve(),this.#U=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#a.values())t.destroy();this.#a.clear(),this.#n.clear(),this.#p.clear(),this.#O?.clear(),this.#e=null,this.#E.clear(),this.#c.destroy(),this.#r?.destroy(),this.#l?.destroy(),this.#F?.destroy(),this.#T?.hide(),this.#T=null,this.#B?.destroy(),this.#B=null,this.#i=null,this.#w&&(clearTimeout(this.#w),this.#w=null),this.#L&&(clearTimeout(this.#L),this.#L=null),this._editorUndoBar?.destroy(),this.#$=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#q}get useNewAltTextFlow(){return this.#_}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return Ot(this,"hcmFilter",this.#j?this.#S.addHCMFilter(this.#j.foreground,this.#j.background):"none")}get direction(){return Ot(this,"direction",getComputedStyle(this.#G).direction)}get _highlightColors(){return Ot(this,"_highlightColors",this.#x?new Map(this.#x.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return Ot(this,"highlightColors",null);const e=new Map,n=!!this.#j;for(const[s,a]of t){const l=s.endsWith("_HCM");if(n&&l){e.set(s.replace("_HCM",""),a);continue}!n&&!l&&e.set(s,a)}return Ot(this,"highlightColors",e)}get highlightColorNames(){return Ot(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#B=t}editAltText(t,e=!1){this.#r?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e,n,s){this.#l?.showDialog(this,t,e,n,s)}selectComment(t,e){this.#a.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}toggleComment(t,e,n=void 0){this.#l?.toggleCommentPopup(t,e,n)}makeCommentColor(t,e){return t&&this.#l?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#a.has(t-1))return;const{resolve:e,promise:n}=Promise.withResolvers(),s=a=>{a.pageNumber===t&&(this._eventBus._off("editorsrendered",s),e())};this._eventBus.on("editorsrendered",s),await n}getSignature(t){this.#F?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#F}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){t==="enableNewAltTextWhenAddingImage"&&(this.#v=e)}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#G.focus()}findParent(t,e){for(const n of this.#a.values()){const{x:s,y:a,width:l,height:c}=n.div.getBoundingClientRect();if(t>=s&&t<=s+l&&e>=a&&e<=a+c)return n}return null}disableUserSelect(t=!1){this.#J.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Tc.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of this.#a.values())if(n.hasTextLayer(t))return n;return null}highlightSelection(t="",e=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:s,anchorOffset:a,focusNode:l,focusOffset:c}=n,h=n.toString(),p=this.#Q(n).closest(".textLayer"),m=this.getSelectionBoxes(p);if(!m)return;n.empty();const v=this.#tt(p),b=this.#C===Vt.NONE,w=()=>{const E=v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:m,anchorNode:s,anchorOffset:a,focusNode:l,focusOffset:c,text:h});b&&this.showAllEditors("highlight",!0,!0),e&&E?.editComment()};if(b){this.switchToMode(Vt.HIGHLIGHT,w);return}w()}commentSelection(t=""){this.highlightSelection(t,!0)}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=this.#Q(t).closest(".textLayer"),s=this.getSelectionBoxes(n);s&&(this.#T||=new D9(this),this.#T.show(n,s,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#s)return null;const e=`${Lh}${t}`,n=this.#s.getRawValue(e);return n&&this.#s.remove(e),n}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}a11yAlert(t,e=null){const n=this.#Z;n&&(n.setAttribute("data-l10n-id",t),e?n.setAttribute("data-l10n-args",JSON.stringify(e)):n.removeAttribute("data-l10n-args"))}#rt(){const t=document.getSelection();if(!t||t.isCollapsed){this.#k&&(this.#T?.hide(),this.#k=null,this.#P({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#k)return;const s=this.#Q(t).closest(".textLayer");if(!s){this.#k&&(this.#T?.hide(),this.#k=null,this.#P({hasSelectedText:!1}));return}if(this.#T?.hide(),this.#k=e,this.#P({hasSelectedText:!0}),!(this.#C!==Vt.HIGHLIGHT&&this.#C!==Vt.NONE)&&(this.#C===Vt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#b=this.isShiftKeyDown,!this.isShiftKeyDown)){const a=this.#C===Vt.HIGHLIGHT?this.#tt(s):null;if(a?.toggleDrawing(),this.#I){const l=new AbortController,c=this.combinedSignal(l),h=d=>{d.type==="pointerup"&&d.button!==0||(l.abort(),a?.toggleDrawing(!0),d.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",h,{signal:c}),window.addEventListener("blur",h,{signal:c})}else a?.toggleDrawing(!0),this.#Y("main_toolbar")}}#Y(t=""){this.#C===Vt.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#st()}#at(){document.addEventListener("selectionchange",this.#rt.bind(this),{signal:this._signal})}#ot(){if(this.#A)return;this.#A=new AbortController;const t=this.combinedSignal(this.#A);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#lt(){this.#A?.abort(),this.#A=null}blur(){if(this.isShiftKeyDown=!1,this.#b&&(this.#b=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#E)if(e.div.contains(t)){this.#N=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#N)return;const[t,e]=this.#N;this.#N=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#M)return;this.#M=new AbortController;const t=this.combinedSignal(this.#M);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#M?.abort(),this.#M=null}#ut(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(e.type)){n.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const n of this.#E){const s=n.serialize(!0);s&&e.push(s)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const a of e.items)for(const l of this.#u)if(l.isHandlingMimeForPasting(a.type)){l.paste(a,this.currentLayer);return}let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(a){Nt(`paste: "${a.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const a=[];for(const h of n){const d=await s.deserialize(h);if(!d)return;a.push(d)}const l=()=>{for(const h of a)this.#nt(h);this.#it(a)},c=()=>{for(const h of a)h.remove()};this.addCommands({cmd:l,undo:c,mustExec:!0})}catch(a){Nt(`paste: "${a.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#C!==Vt.NONE&&!this.isEditorHandlingKeyboard&&Ua._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#b&&(this.#b=!1,this.#Y("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#P(t){Object.entries(t).some(([n,s])=>this.#K[n]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#K,t)}),this.#C===Vt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#H([[Yt.HIGHLIGHT_FREE,!0]]))}#H(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ot(),this.#ut(),this.#P({isEditing:this.#C!==Vt.NONE,isEmpty:this.#X(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#lt(),this.#ht(),this.#P({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const e of this.#u)this.#H(e.defaultPropertiesToUpdate)}}getId(){return this.#D.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(t){return this.#a.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#a.set(t.pageIndex,t),this.#R?t.enable():t.disable()}removeLayer(t){this.#a.delete(t.pageIndex)}async updateMode(t,e=null,n=!1,s=!1,a=!1,l=!1){if(this.#C!==t&&!(this.#U&&(await this.#U.promise,!this.#U))){if(this.#U=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#C===Vt.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#C=t,t===Vt.NONE){this.setEditingState(!1),this.#pt();for(const c of this.#n.values())c.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#U.resolve();return}for(const c of this.#n.values())c.addStandaloneCommentButton();t===Vt.SIGNATURE&&await this.#F?.loadSignatures(),n&&ie.clearPointerType(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const c of this.#a.values())c.updateMode(t);if(t===Vt.POPUP){this.#i||=await this.#$.getAnnotationsByType(new Set(this.#u.map(d=>d._editorType)));const c=new Set,h=[];for(const d of this.#n.values()){const{annotationElementId:p,hasComment:m,deleted:v}=d;p&&c.add(p),m&&!v&&h.push(d.getData())}for(const d of this.#i){const{id:p,popupRef:m,contentsObj:v}=d;m&&v?.str&&!c.has(p)&&!this.#g.has(p)&&h.push(d)}this.#l?.showSidebar(h)}if(!e){s&&this.addNewEditorFromKeyboard(),this.#U.resolve();return}for(const c of this.#n.values())c.uid===e?(this.setSelected(c),l?c.editComment():a?c.enterInEditMode():c.focus()):c.unselect();this.#U.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#C&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#u){switch(t){case Yt.CREATE:this.currentLayer.addNewEditor(e);return;case Yt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#W||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const n of this.#E)n.updateParams(t,e);else for(const n of this.#u)n.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){for(const a of this.#n.values())a.editorType===t&&a.show(e);(this.#W?.get(Yt.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#H([[Yt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#V!==t){this.#V=t;for(const e of this.#a.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#R){this.#R=!0;const t=[];for(const e of this.#a.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#pt(){if(this.unselectAll(),this.#R){this.#R=!1;for(const t of this.#a.values())t.disable();for(const t of this.#n.values())t.disable()}}*getEditors(t){for(const e of this.#n.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#w&&clearTimeout(this.#w),this.#w=setTimeout(()=>{this.focusMainContainer(),this.#w=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#O?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#g.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#g.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#g.has(t)}removeDeletedAnnotationElement(t){this.#g.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#nt(t){const e=this.#a.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#H(t.propertiesToUpdate))}get#mt(){let t=null;for(t of this.#E);return t}updateUI(t){this.#mt===t&&this.#H(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#H(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#E.has(t)){this.#E.delete(t),t.unselect(),this.#P({hasSelectedEditor:this.hasSelection});return}this.#E.add(t),t.select(),this.#H(t.propertiesToUpdate),this.#P({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const e of this.#E)e!==t&&e.unselect();this.#E.clear(),this.#E.add(t),t.select(),this.#H(t.propertiesToUpdate),this.#P({hasSelectedEditor:!0})}isSelected(t){return this.#E.has(t)}get firstSelectedEditor(){return this.#E.values().next().value}unselect(t){t.unselect(),this.#E.delete(t),this.#P({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#E.size!==0}get isEnterHandled(){return this.#E.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#P({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#X()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#P({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#X()})}addCommands(t){this.#c.add(t),this.#P({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#X()})}cleanUndoStack(t){this.#c.cleanType(t)}#X(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#E],n=()=>{this._editorUndoBar?.show(s,e.length===1?e[0].editorType:e.length);for(const a of e)a.remove()},s=()=>{for(const a of e)this.#nt(a)};this.addCommands({cmd:n,undo:s,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#it(t){for(const e of this.#E)e.unselect();this.#E.clear();for(const e of t)e.isEmpty()||(this.#E.add(e),e.select());this.#P({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#E)t.commit();this.#it(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#C!==Vt.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#E)t.unselect();this.#E.clear(),this.#P({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#z[0]+=t,this.#z[1]+=e;const[s,a]=this.#z,l=[...this.#E],c=1e3;this.#L&&clearTimeout(this.#L),this.#L=setTimeout(()=>{this.#L=null,this.#z[0]=this.#z[1]=0,this.addCommands({cmd:()=>{for(const h of l)this.#n.has(h.id)&&(h.translateInPage(s,a),h.translationDone())},undo:()=>{for(const h of l)this.#n.has(h.id)&&(h.translateInPage(-s,-a),h.translationDone())},mustExec:!1})},c);for(const h of l)h.translateInPage(t,e),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#m=new Map;for(const t of this.#E)this.#m.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#m)return!1;this.disableUserSelect(!1);const t=this.#m;this.#m=null;let e=!1;for(const[{x:s,y:a,pageIndex:l},c]of t)c.newX=s,c.newY=a,c.newPageIndex=l,e||=s!==c.savedX||a!==c.savedY||l!==c.savedPageIndex;if(!e)return!1;const n=(s,a,l,c)=>{if(this.#n.has(s.id)){const h=this.#a.get(c);h?s._setParentAndPosition(h,a,l):(s.pageIndex=c,s.x=a,s.y=l)}};return this.addCommands({cmd:()=>{for(const[s,{newX:a,newY:l,newPageIndex:c}]of t)n(s,a,l,c)},undo:()=>{for(const[s,{savedX:a,savedY:l,savedPageIndex:c}]of t)n(s,a,l,c)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#m)for(const n of this.#m.keys())n.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#E.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#C}isEditingMode(){return this.#C!==Vt.NONE}get imageManager(){return Ot(this,"imageManager",new Vb)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let d=0,p=e.rangeCount;d<p;d++)if(!t.contains(e.getRangeAt(d).commonAncestorContainer))return null;const{x:n,y:s,width:a,height:l}=t.getBoundingClientRect();let c;switch(t.getAttribute("data-main-rotation")){case"90":c=(d,p,m,v)=>({x:(p-s)/l,y:1-(d+m-n)/a,width:v/l,height:m/a});break;case"180":c=(d,p,m,v)=>({x:1-(d+m-n)/a,y:1-(p+v-s)/l,width:m/a,height:v/l});break;case"270":c=(d,p,m,v)=>({x:1-(p+v-s)/l,y:(d-n)/a,width:v/l,height:m/a});break;default:c=(d,p,m,v)=>({x:(d-n)/a,y:(p-s)/l,width:m/a,height:v/l});break}const h=[];for(let d=0,p=e.rangeCount;d<p;d++){const m=e.getRangeAt(d);if(!m.collapsed)for(const{x:v,y:b,width:w,height:E}of m.getClientRects())w===0||E===0||h.push(c(v,b,w,E))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const n=this.#s.getRawValue(e);n&&(this.#C===Vt.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}setMissingCanvas(t,e,n){const s=this.#O?.get(t);s&&(s.setCanvas(e,n),this.#O.delete(t))}addMissingCanvas(t,e){(this.#O||=new Map).set(t,e)}}class Fs{#t=null;#e=!1;#i=null;#n=null;#a=null;#r=null;#s=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,Fs.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Fs._l10n??=t}async render(){const t=this.#i=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#n=document.createElement("span");t.append(e),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",Fs.#f.missing),e.setAttribute("data-l10n-id",Fs.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#c._uiManager._signal;t.addEventListener("contextmenu",Ui,{signal:n}),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const s=a=>{a.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return t.addEventListener("click",s,{capture:!0,signal:n}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(this.#s=!0,s(a))},{signal:n}),await this.#m(),t}get#g(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await Fs._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#m())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:s,cancel:a=!1}){n&&(this.#l=n,this.#d=s),!(this.#t===t&&this.#e===e)&&(a||(this.#t=t,this.#e=e),this.#m())}toggle(t=!1){this.#i&&(!t&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#i.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#a=null,this.#o?.remove(),this.#o=null}async#m(){const t=this.#i;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Fs.#f[this.#g]),this.#n?.setAttribute("data-l10n-id",Fs.#f[`${this.#g}-label`]),!this.#t){this.#a?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#a?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#a;if(!e){this.#a=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const s=100,a=this.#c._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#a.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:a}),t.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#a?.classList.remove("show")},{signal:a})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class np{#t=null;#e=null;#i=!1;#n=null;#a=null;#r=null;#s=null;#o=null;#c=!1;#l=null;constructor(t){this.#n=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#n.commentButtonPosition;if(e){const{style:n}=t;n.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const s=this.#n.commentButtonColor;s&&(n.backgroundColor=s)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#n.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:e,height:n}=this.#t.getBoundingClientRect(),{x:s,y:a,width:l,height:c}=this.#n.parent.boundingClientRect;return[(t-s)/l,(e+n-a)/c]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#d(t,e){if(!this.#n._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const n=this.#n._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return t;t.addEventListener("contextmenu",Ui,{signal:n}),e&&(t.addEventListener("focusin",a=>{this.#n._focusEventsAllowed=!1,Ne(a)},{capture:!0,signal:n}),t.addEventListener("focusout",a=>{this.#n._focusEventsAllowed=!0,Ne(a)},{capture:!0,signal:n})),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const s=a=>{a.preventDefault(),t===this.#e?this.edit():this.#n.toggleComment(!0)};return t.addEventListener("click",s,{capture:!0,signal:n}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(this.#i=!0,s(a))},{signal:n}),t.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:n}),t.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:n}),t}edit(t){const e=this.commentPopupPositionInLayer;let n,s;if(e)[n,s]=e;else{[n,s]=this.#n.commentButtonPosition;const{width:p,height:m,x:v,y:b}=this.#n;n=v+n*p,s=b+s*m}const a=this.#n.parent.boundingClientRect,{x:l,y:c,width:h,height:d}=a;this.#n._uiManager.editComment(this.#n,l+n*h,c+s*d,{...t,parentDimensions:a})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#i}),this.#i=!1)}isDeleted(){return this.#c||this.#s===""}isEmpty(){return this.#s===null}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#a}serialize(){return this.data}get data(){return{text:this.#s,richText:this.#r,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#s&&(this.#r=null),t===null){this.#s="",this.#c=!0;return}this.#s=t,this.#o=new Date,this.#c=!1}setInitialText(t,e=null){this.#a=t,this.data=t,this.#o=null,this.#r=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#s="",this.#r=null,this.#o=null,this.#n=null,this.#i=!1,this.#c=!1}}class qm{#t;#e=!1;#i=null;#n;#a;#r;#s;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:n=null,onPinchStart:s=null,onPinching:a=null,onPinchEnd:l=null,signal:c}){this.#t=t,this.#i=n,this.#n=e,this.#a=s,this.#r=a,this.#s=l,this.#d=new AbortController,this.#c=AbortSignal.any([c,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ys.pixelRatio}#f(t){if(this.#n?.())return;if(t.touches.length===1){if(this.#o)return;const s=this.#o=new AbortController,a=AbortSignal.any([this.#c,s.signal]),l=this.#t,c={capture:!0,signal:a,passive:!1},h=d=>{d.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};l.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(Ne(d),h(d))},c),l.addEventListener("pointerup",h,c),l.addEventListener("pointercancel",h,c);return}if(!this.#h){this.#h=new AbortController;const s=AbortSignal.any([this.#c,this.#h.signal]),a=this.#t,l={signal:s,capture:!1,passive:!1};a.addEventListener("touchmove",this.#g.bind(this),l);const c=this.#m.bind(this);a.addEventListener("touchend",c,l),a.addEventListener("touchcancel",c,l),l.capture=!0,a.addEventListener("pointerdown",Ne,l),a.addEventListener("pointermove",Ne,l),a.addEventListener("pointercancel",Ne,l),a.addEventListener("pointerup",Ne,l),this.#a?.()}if(Ne(t),t.touches.length!==2||this.#i?.()){this.#l=null;return}let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#g(t){if(!this.#l||t.touches.length!==2)return;Ne(t);let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]);const{screenX:s,screenY:a}=e,{screenX:l,screenY:c}=n,h=this.#l,{touch0X:d,touch0Y:p,touch1X:m,touch1Y:v}=h,b=m-d,w=v-p,E=l-s,S=c-a,C=Math.hypot(E,S)||1,R=Math.hypot(b,w)||1;if(!this.#e&&Math.abs(R-C)<=qm.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=s,h.touch0Y=a,h.touch1X=l,h.touch1Y=c,!this.#e){this.#e=!0;return}const I=[(s+l)/2,(a+c)/2];this.#r?.(I,R,C)}#m(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#s?.()),this.#l&&(Ne(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class Ct{#t=null;#e=null;#i=null;#n=null;#a=null;#r=!1;#s=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#g="";#m=!1;#u=null;#p=!1;#y=!1;#_=!1;#v=null;#S=0;#w=0;#A=null;#x=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#b=!1;#T=Ct._zIndex++;static _borderLineWidth=-1;static _colorManager=new Bb;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Ct.prototype._resizeWithKeyboard,e=Ua.TRANSLATE_SMALL,n=Ua.TRANSLATE_BIG;return Ot(this,"_resizerKeyboardManager",new ud([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],Ct.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:e,rawDims:{pageWidth:n,pageHeight:s,pageX:a,pageY:l}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[a,l];const[c,h]=this.parentDimensions;this.x=t.x/c,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Ot(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new k9({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Ct._l10n??=t,Ct._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Ct._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Ct._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){me("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#b}set _isDraggable(t){this.#b=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#T}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#L(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#m?this.#m=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,s){const[a,l]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(t+n)/a,this.y=(e+s)/l,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[n,s]=this.parentDimensions;this.setAt(t*n,e*s,this.width*n,this.height*s),this._onTranslated()}#D([t,e],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/t,this.y+=s/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#D(this.parentDimensions,t,e)}translateInPage(t,e){this.#u||=[this.x,this.y,this.width,this.height],this.#D(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#u||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[s,a]}=this;if(this.x+=t/s,this.y+=e/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:m,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:c}=this;const[h,d]=this.getBaseTranslation();l+=h,c+=d;const{style:p}=n;p.left=`${(100*l).toFixed(2)}%`,p.top=`${(100*c).toFixed(2)}%`,this._onTranslating(l,c),n.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=Ct,s=n/t,a=n/e;switch(this.rotation){case 90:return[-s,a];case 180:return[s,a];case 270:return[s,-a];default:return[-s,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[n,s]}=this;let{x:a,y:l,width:c,height:h}=this;if(c*=n,h*=s,a*=n,l*=s,this._mustFixPosition)switch(t){case 0:a=Fn(a,0,n-c),l=Fn(l,0,s-h);break;case 90:a=Fn(a,0,n-h),l=Fn(l,c,s);break;case 180:a=Fn(a,c,n),l=Fn(l,h,s);break;case 270:a=Fn(a,h,n),l=Fn(l,0,s-c);break}this.x=a/=n,this.y=l/=s;const[d,p]=this.getBaseTranslation();a+=d,l+=p,e.left=`${(100*a).toFixed(2)}%`,e.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#R(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Ct.#R(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Ct.#R(t,e,360-this.parentRotation)}#I(t){switch(t){case 90:{const[e,n]=this.pageDimensions;return[0,-e/n,n/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,n]=this.pageDimensions;return[0,e/n,-n/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(){const{div:{style:t},width:e,height:n}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#V(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const s=document.createElement("div");this.#c.append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",this.#M.bind(this,n),{signal:e}),s.addEventListener("contextmenu",Ui,{signal:e}),s.tabIndex=-1}this.div.prepend(this.#c)}#M(t,e){e.preventDefault();const{isMac:n}=cn.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#i?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const a=new AbortController,l=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#O.bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",Ne,{passive:!1,signal:l}),window.addEventListener("contextmenu",Ui,{signal:l}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const d=()=>{a.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=c,this.div.style.cursor=h,this.#B()};window.addEventListener("pointerup",d,{signal:l}),window.addEventListener("blur",d,{signal:l})}#N(t,e,n,s){this.width=n,this.height=s,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#B(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:n,savedHeight:s}=this.#d;this.#d=null;const a=this.x,l=this.y,c=this.width,h=this.height;a===t&&l===e&&c===n&&h===s||this.addCommands({cmd:this.#N.bind(this,a,l,c,h),undo:this.#N.bind(this,t,e,n,s),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#O(t,e){const[n,s]=this.parentDimensions,a=this.x,l=this.y,c=this.width,h=this.height,d=Ct.MIN_SIZE/n,p=Ct.MIN_SIZE/s,m=this.#I(this.rotation),v=(W,K)=>[m[0]*W+m[2]*K,m[1]*W+m[3]*K],b=this.#I(360-this.rotation),w=(W,K)=>[b[0]*W+b[2]*K,b[1]*W+b[3]*K];let E,S,C=!1,R=!1;switch(t){case"topLeft":C=!0,E=(W,K)=>[0,0],S=(W,K)=>[W,K];break;case"topMiddle":E=(W,K)=>[W/2,0],S=(W,K)=>[W/2,K];break;case"topRight":C=!0,E=(W,K)=>[W,0],S=(W,K)=>[0,K];break;case"middleRight":R=!0,E=(W,K)=>[W,K/2],S=(W,K)=>[0,K/2];break;case"bottomRight":C=!0,E=(W,K)=>[W,K],S=(W,K)=>[0,0];break;case"bottomMiddle":E=(W,K)=>[W/2,K],S=(W,K)=>[W/2,0];break;case"bottomLeft":C=!0,E=(W,K)=>[0,K],S=(W,K)=>[W,0];break;case"middleLeft":R=!0,E=(W,K)=>[0,K/2],S=(W,K)=>[W,K/2];break}const I=E(c,h),B=S(c,h);let F=v(...B);const j=Ct._round(a+F[0]),P=Ct._round(l+F[1]);let D=1,M=1,V,O;if(e.fromKeyboard)({deltaX:V,deltaY:O}=e);else{const{screenX:W,screenY:K}=e,[tt,ut]=this.#l;[V,O]=this.screenToPageTranslation(W-tt,K-ut),this.#l[0]=W,this.#l[1]=K}if([V,O]=w(V/n,O/s),C){const W=Math.hypot(c,h);D=M=Math.max(Math.min(Math.hypot(B[0]-I[0]-V,B[1]-I[1]-O)/W,1/c,1/h),d/c,p/h)}else R?D=Fn(Math.abs(B[0]-I[0]-V),d,1)/c:M=Fn(Math.abs(B[1]-I[1]-O),p,1)/h;const G=Ct._round(c*D),U=Ct._round(h*M);F=v(...S(G,U));const gt=j-F[0],Pt=P-F[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=G,this.height=U,this.x=gt,this.y=Pt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new _h(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,n]of t)await this._editToolbar.addButton(e,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#i?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(Fs.initialize(Ct._l10n),this.#i=new Fs(this),this.#t&&(this.#i.data=this.#t,this.#t=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(t){this.#i&&(this.#i.data=t)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(t){await this.#i?.setGuessedText(t)}serializeAltText(t){return this.#i?.serialize(t)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.canAddComment?this.#n||=new np(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#n.renderForStandalone(),this.div.append(this.#a))}}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){const{data:{richText:t,text:e,date:n,deleted:s}}=this.#n;return{text:e,richText:t,date:n,deleted:s,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#n||=new np(this),this.#n.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:n}){if(!e||(this.#n||=new np(this),this.#n.setInitialText(t,n),!this.annotationElementId))return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(t){this.#n||=new np(this),this.#n.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#n.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,s]=t.rect,[a]=this.pageDimensions,[l]=this.pageTranslation,c=l+a+1,h=s-100,d=c+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[c,h,d,s]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#n.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#r?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#j();const[e,n]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*n/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/n).toFixed(2)}%`);const[s,a]=this.getInitialTranslation();return this.translate(s,a),KP(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#x||=new qm({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#q.bind(this),onPinching:this.#C.bind(this),onPinchEnd:this.#E.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#q(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#C(t,e,n){let a=.7*(n/e)+1-.7;if(a===1)return;const l=this.#I(this.rotation),c=(j,P)=>[l[0]*j+l[2]*P,l[1]*j+l[3]*P],[h,d]=this.parentDimensions,p=this.x,m=this.y,v=this.width,b=this.height,w=Ct.MIN_SIZE/h,E=Ct.MIN_SIZE/d;a=Math.max(Math.min(a,1/v,1/b),w/v,E/b);const S=Ct._round(v*a),C=Ct._round(b*a);if(S===v&&C===b)return;this.#u||=[p,m,v,b];const R=c(v/2,b/2),I=Ct._round(p+R[0]),B=Ct._round(m+R[1]),F=c(S/2,C/2);this.x=I-F[0],this.y=B-F[1],this.width=S,this.height=C,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#E(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#B()}pointerdown(t){const{isMac:e}=cn.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#m=!0,this._isDraggable){this.#F(t);return}this.#k(t)}#k(t){const{isMac:e}=cn.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#F(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,a=this._uiManager.combinedSignal(s),l={capture:!0,passive:!1,signal:a},c=d=>{s.abort(),this.#s=null,this.#m=!1,this._uiManager.endDragSession()||this.#k(d),n&&this._onStopDragging()};e&&(this.#S=t.clientX,this.#w=t.clientY,this.#s=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",d=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:m,pointerId:v}=d;if(v!==this.#s){Ne(d);return}const[b,w]=this.screenToPageTranslation(p-this.#S,m-this.#w);this.#S=p,this.#w=m,this._uiManager.dragSelectedEditors(b,w)},l),window.addEventListener("touchmove",Ne,l),window.addEventListener("pointerdown",d=>{d.pointerType===this.#o&&(this.#x||d.isPrimary)&&c(d),Ne(d)},l));const h=d=>{if(!this.#s||this.#s===d.pointerId){c(d);return}Ne(d)};window.addEventListener("pointerup",h,{signal:a}),window.addEventListener("blur",h,{signal:a})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,n=this.rotation){const s=this.parentScale,[a,l]=this.pageDimensions,[c,h]=this.pageTranslation,d=t/s,p=e/s,m=this.x*a,v=this.y*l,b=this.width*a,w=this.height*l;switch(n){case 0:return[m+d+c,l-v-p-w+h,m+d+b+c,l-v-p+h];case 90:return[m+p+c,l-v+d+h,m+p+w+c,l-v+d+b+h];case 180:return[m-d-b+c,l-v+p+h,m-d+c,l-v+p+w+h];case 270:return[m-p-w+c,l-v-d-b+h,m-p+c,l-v-d+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,s,a,l]=t,c=a-n,h=l-s;switch(this.rotation){case 0:return[n,e-l,c,h];case 90:return[n,e-s,h,c];case 180:return[a,e-s,c,h];case 270:return[a,e-l,h,c];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Ct._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:n,opacity:s,deleted:a,richText:l},uid:c,pageIndex:h,creationDate:d,modificationDate:p}=this;return{id:c,pageIndex:h,rect:this.getPDFRect(),richText:l,contentsObj:{str:t},creationDate:d,modificationDate:n||p,popupRef:!a,color:e,opacity:s}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#_}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:n,right:s}=this.getClientDimensions(),{innerHeight:a,innerWidth:l}=window;return e<l&&s>0&&t<a&&n>0}#j(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#j()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,n){const s=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});s.rotation=t.rotation,s.#t=t.accessibilityData,s._isCopy=t.isCopy||!1;const[a,l]=s.pageDimensions,[c,h,d,p]=s.getRectInCurrentCoords(t.rect,l);return s.x=c/a,s.y=h/l,s.width=d/a,s.height=p/l,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#L(),this.removeEditToolbar(),this.#A){for(const t of this.#A.values())clearTimeout(t);this.#A=null}this.parent=null,this.#x?.destroy(),this.#x=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#V(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[n,s,a,l]=this.getPDFRect();return[Ct._round(n+(a-n)*t),Ct._round(s+(l-s)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(t){this.#n.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#n?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#c.children;if(!this.#e){this.#e=Array.from(e);const l=this.#W.bind(this),c=this.#$.bind(this),h=this._uiManager._signal;for(const d of this.#e){const p=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",l,{signal:h}),d.addEventListener("blur",c,{signal:h}),d.addEventListener("focus",this.#K.bind(this,p),{signal:h}),d.setAttribute("data-l10n-id",Ct._l10nResizer[p])}}const n=this.#e[0];let s=0;for(const l of e){if(l===n)break;s++}const a=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(a!==s){if(a<s)for(let c=0;c<s-a;c++)this.#c.append(this.#c.firstElementChild);else if(a>s)for(let c=0;c<a-s;c++)this.#c.firstElementChild.before(this.#c.lastElementChild);let l=0;for(const c of e){const d=this.#e[l++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",Ct._l10nResizer[d])}}this.#z(0),this.#_=!0,this.#c.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#W(t){Ct._resizerKeyboardManager.exec(this,t)}#$(t){this.#_&&t.relatedTarget?.parentNode!==this.#c&&this.#L()}#K(t){this.#g=this.#_?t:""}#z(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#_&&this.#O(this.#g,{deltaX:t,deltaY:e,fromKeyboard:!0})}#L(){this.#_=!1,this.#z(-1),this.#B()}_stopResizingWithKeyboard(){this.#L(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#A||=new Map;const{action:n}=t;let s=this.#A.get(n);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(t),this.#A.delete(n),this.#A.size===0&&(this.#A=null)},Ct._telemetryTimeout),this.#A.set(n,s);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const n=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),n.before(e)}return e}resetAnnotationElement(t){const{firstElementChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class k9 extends Ct{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const VC=3285377520,Pi=4294901760,Ls=65535;class YP{constructor(t){this.h1=t?t&4294967295:VC,this.h2=t?t&4294967295:VC}update(t){let e,n;if(typeof t=="string"){e=new Uint8Array(t.length*2),n=0;for(let E=0,S=t.length;E<S;E++){const C=t.charCodeAt(E);C<=255?e[n++]=C:(e[n++]=C>>>8,e[n++]=C&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),n=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=n>>2,a=n-s*4,l=new Uint32Array(e.buffer,0,s);let c=0,h=0,d=this.h1,p=this.h2;const m=3432918353,v=461845907,b=m&Ls,w=v&Ls;for(let E=0;E<s;E++)E&1?(c=l[E],c=c*m&Pi|c*b&Ls,c=c<<15|c>>>17,c=c*v&Pi|c*w&Ls,d^=c,d=d<<13|d>>>19,d=d*5+3864292196):(h=l[E],h=h*m&Pi|h*b&Ls,h=h<<15|h>>>17,h=h*v&Pi|h*w&Ls,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(c=0,a){case 3:c^=e[s*4+2]<<16;case 2:c^=e[s*4+1]<<8;case 1:c^=e[s*4],c=c*m&Pi|c*b&Ls,c=c<<15|c>>>17,c=c*v&Pi|c*w&Ls,s&1?d^=c:p^=c}this.h1=d,this.h2=p}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Pi|t*36045&Ls,e=e*4283543511&Pi|((e<<16|t>>>16)*2950163797&Pi)>>>16,t^=e>>>1,t=t*444984403&Pi|t*60499&Ls,e=e*3301882366&Pi|((e<<16|t>>>16)*3120437893&Pi)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const G_=Object.freeze({map:null,hash:"",transfer:void 0});class Fb{#t=!1;#e=null;#i=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=this.#n.get(t);return n===void 0?e:Object.assign(e,n)}getRawValue(t){return this.#n.get(t)}remove(t){const e=this.#n.get(t);if(e!==void 0&&(e instanceof Ct&&this.#i.delete(e.annotationElementId),this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of this.#n.values())if(n instanceof Ct)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=this.#n.get(t);let s=!1;if(n!==void 0)for(const[a,l]of Object.entries(e))n[a]!==l&&(s=!0,n[a]=l);else s=!0,this.#n.set(t,e);s&&this.#a(),e instanceof Ct&&((this.#i||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#n.has(t)}get size(){return this.#n.size}#a(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new XP(this)}get serializable(){if(this.#n.size===0)return G_;const t=new Map,e=new YP,n=[],s=Object.create(null);let a=!1;for(const[l,c]of this.#n){const h=c instanceof Ct?c.serialize(!1,s):c;h&&(t.set(l,h),e.update(`${l}:${JSON.stringify(h)}`),a||=!!h.bitmap)}if(a)for(const l of t.values())l.bitmap&&n.push(l.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:G_}get editorStats(){let t=null;const e=new Map;let n=0,s=0;for(const a of this.#n.values()){if(!(a instanceof Ct)){a.popup&&(a.popup.deleted?s+=1:n+=1);continue}a.isCommentDeleted?s+=1:a.hasEditedComment&&(n+=1);const l=a.telemetryFinalData;if(!l)continue;const{type:c}=l;e.has(c)||e.set(c,Object.getPrototypeOf(a).constructor),t||=Object.create(null);const h=t[c]||=new Map;for(const[d,p]of Object.entries(l)){if(d==="type")continue;let m=h.get(d);m||(m=new Map,h.set(d,m));const v=m.get(p)??0;m.set(p,v+1)}}if((s>0||n>0)&&(t||=Object.create(null),t.comments={deleted:s,edited:n}),!t)return null;for(const[a,l]of e)t[a]=l.computeTelemetryFinalData(t[a]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const n=this.#i?.get(t);return n?(n.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#i?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#i)for(const e of this.#i.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class XP extends Fb{#t;constructor(t){super();const{map:e,hash:n,transfer:s}=t.serializable,a=structuredClone(e,s?{transfer:s}:null);this.#t={map:a,hash:n,transfer:s}}get print(){me("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Ot(this,"modifiedIds",{ids:new Set,hash:""})}}class N9{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:n}){if(!(!t||this.#t.has(t.loadedName))){if(Xt(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:a,style:l}=t,c=new FontFace(s,a,l);this.addNativeFontFace(c);try{await c.load(),this.#t.add(s),n?.(t)}catch{Nt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}me("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(s){throw Nt(`Failed to load font '${n.family}': '${s}'.`),t.disableFontFace=!0,s}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const s=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,s)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Ot(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Ot(this,"isSyncFontLoadingSupported",Bn||cn.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Xt(!s.done,"completeRequest() cannot be called twice."),s.done=!0;n.length>0&&n[0].done;){const a=n.shift();setTimeout(a.callback,0)}}const{loadingRequests:n}=this,s={done:!1,complete:e,callback:t};return n.push(s),s}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ot(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function n(B,F){return B.charCodeAt(F)<<24|B.charCodeAt(F+1)<<16|B.charCodeAt(F+2)<<8|B.charCodeAt(F+3)&255}function s(B,F,j,P){const D=B.substring(0,F),M=B.substring(F+j);return D+P+M}let a,l;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let d=0;function p(B,F){if(++d>30){Nt("Load test font never loaded."),F();return}if(h.font="30px "+B,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){F();return}setTimeout(p.bind(null,B,F))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=s(v,976,m.length,m);const w=16,E=1482184792;let S=n(v,w);for(a=0,l=m.length-3;a<l;a+=4)S=S-E+n(m,a)|0;a<m.length&&(S=S-E+n(m+"XXX",a)|0),v=s(v,w,4,p9(S));const C=`url(data:font/opentype;base64,${btoa(v)});`,R=`@font-face {font-family:"${m}";src:${C}}`;this.insertRule(R);const I=this._document.createElement("div");I.style.visibility="hidden",I.style.width=I.style.height="10px",I.style.position="absolute",I.style.top=I.style.left="0px";for(const B of[t.loadedName,m]){const F=this._document.createElement("span");F.textContent="Hi",F.style.fontFamily=B,I.append(F)}this._document.body.append(I),p(m,()=>{I.remove(),e.complete()})}}class O9{#t;constructor(t,e=null,n,s){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,n&&Object.assign(this,n),s&&(this.charProcOperatorList=s)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${qP(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const n=this.loadedName+"_path_"+e;let s;try{s=t.get(n)}catch(l){Nt(`getPathGenerator - ignoring character: "${l}".`)}const a=WP(s?.path);return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[e]=a}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){Ot(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){Ot(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class uc{#t;#e;#i;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,n={};let s=0;for(const d of uc.strings){const p=e.encode(t[d]);n[d]=p,s+=4+p.length}const a=new ArrayBuffer(s),l=new Uint8Array(a),c=new DataView(a);let h=0;for(const d of uc.strings){const p=n[d],m=p.length;c.setUint32(h,m),l.set(p,h+4),h+=4+m}return Xt(h===a.byteLength,"CssFontInfo.write: Buffer overflow"),a}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}#n(t){Xt(t<uc.strings.length,"Invalid string index");let e=0;for(let s=0;s<t;s++)e+=this.#e.getUint32(e)+4;const n=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,n))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class hc{#t;#e;#i;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,n={};let s=0;for(const v of hc.strings){const b=e.encode(t[v]);n[v]=b,s+=4+b.length}s+=4;let a,l,c=1+s;t.style&&(a=e.encode(t.style.style),l=e.encode(t.style.weight),c+=4+a.length+4+l.length);const h=new ArrayBuffer(c),d=new Uint8Array(h),p=new DataView(h);let m=0;p.setUint8(m++,t.guessFallback?1:0),p.setUint32(m,0),m+=4,s=0;for(const v of hc.strings){const b=n[v],w=b.length;s+=4+w,p.setUint32(m,w),d.set(b,m+4),m+=4+w}return p.setUint32(m-s-4,s),t.style&&(p.setUint32(m,a.length),d.set(a,m+4),m+=4+a.length,p.setUint32(m,l.length),d.set(l,m+4),m+=4+l.length),Xt(m<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(m)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#n(t){Xt(t<hc.strings.length,"Invalid string index");let e=5;for(let s=0;s<t;s++)e+=this.#e.getUint32(e)+4;const n=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,n))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),n=this.#i.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const s=this.#e.getUint32(t),a=this.#i.decode(new Uint8Array(this.#t,t+4,s));return{style:n,weight:a}}}class fe{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#i=this.#e+1+8;static#n=this.#i+1+48;static#a=this.#n+1+6;#r;#s;#o;constructor({data:t,extra:e}){this.#r=t,this.#s=new TextDecoder,this.#o=new DataView(this.#r),e&&Object.assign(this,e)}#c(t){Xt(t<fe.bools.length,"Invalid boolean index");const e=Math.floor(t/4),n=t*2%8,s=this.#o.getUint8(e)>>n&3;return s===0?void 0:s===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Xt(t<fe.numbers.length,"Invalid number index"),this.#o.getFloat64(fe.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=fe.#e;if(this.#o.getUint8(t)===0)return;t+=1;const n=[];for(let s=0;s<4;s++)n.push(this.#o.getInt16(t,!0)),t+=2;return n}get fontMatrix(){let t=fe.#i;if(this.#o.getUint8(t)===0)return;t+=1;const n=[];for(let s=0;s<6;s++)n.push(this.#o.getFloat64(t,!0)),t+=8;return n}get defaultVMetrics(){let t=fe.#n;if(this.#o.getUint8(t)===0)return;t+=1;const n=[];for(let s=0;s<3;s++)n.push(this.#o.getInt16(t,!0)),t+=2;return n}#d(t){Xt(t<fe.strings.length,"Invalid string index");let e=fe.#a+4;for(let a=0;a<t;a++)e+=this.#o.getUint32(e)+4;const n=this.#o.getUint32(e),s=new Uint8Array(n);return s.set(new Uint8Array(this.#r,e+4,n)),this.#s.decode(s)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=fe.#a;const e=this.#o.getUint32(t);t+=4+e;const n=this.#o.getUint32(t);t+=4+n;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);if(a!==0)return new Uint8Array(this.#r,t+4,a)}clearData(){let t=fe.#a;const e=this.#o.getUint32(t);t+=4+e;const n=this.#o.getUint32(t);t+=4+n;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);new Uint8Array(this.#r,t+4,a).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=fe.#a;const e=this.#o.getUint32(t);t+=4+e;const n=this.#o.getUint32(t);t+=4+n;const s=this.#o.getUint32(t);if(s===0)return null;const a=new Uint8Array(s);return a.set(new Uint8Array(this.#r,t+4,s)),new uc(a.buffer)}get systemFontInfo(){let t=fe.#a;const e=this.#o.getUint32(t);t+=4+e;const n=this.#o.getUint32(t);if(n===0)return null;const s=new Uint8Array(n);return s.set(new Uint8Array(this.#r,t+4,n)),new hc(s.buffer)}static write(t){const e=t.systemFontInfo?hc.write(t.systemFontInfo):null,n=t.cssFontInfo?uc.write(t.cssFontInfo):null,s=new TextEncoder,a={};let l=0;for(const E of fe.strings)a[E]=s.encode(t[E]),l+=4+a[E].length;const c=fe.#a+4+l+4+(e?e.byteLength:0)+4+(n?n.byteLength:0)+4+(t.data?t.data.length:0),h=new ArrayBuffer(c),d=new Uint8Array(h),p=new DataView(h);let m=0;const v=fe.bools.length;let b=0,w=0;for(let E=0;E<v;E++){const S=t[fe.bools[E]];b|=(S===void 0?0:S?2:1)<<w,w+=2,(w===8||E===v-1)&&(p.setUint8(m++,b),b=0,w=0)}Xt(m===fe.#t,"FontInfo.write: Boolean properties offset mismatch");for(const E of fe.numbers)p.setFloat64(m,t[E]),m+=8;if(Xt(m===fe.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){p.setUint8(m++,4);for(const E of t.bbox)p.setInt16(m,E,!0),m+=2}else p.setUint8(m++,0),m+=8;if(Xt(m===fe.#i,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){p.setUint8(m++,6);for(const E of t.fontMatrix)p.setFloat64(m,E,!0),m+=8}else p.setUint8(m++,0),m+=48;if(Xt(m===fe.#n,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){p.setUint8(m++,1);for(const E of t.defaultVMetrics)p.setInt16(m,E,!0),m+=2}else p.setUint8(m++,0),m+=6;Xt(m===fe.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(fe.#a,0),m+=4;for(const E of fe.strings){const S=a[E],C=S.length;p.setUint32(m,C),d.set(S,m+4),m+=4+C}if(p.setUint32(fe.#a,m-fe.#a-4),!e)p.setUint32(m,0),m+=4;else{const E=e.byteLength;p.setUint32(m,E),Xt(m+4+E<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),d.set(new Uint8Array(e),m+4),m+=4+E}if(!n)p.setUint32(m,0),m+=4;else{const E=n.byteLength;p.setUint32(m,E),Xt(m+4+E<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),d.set(new Uint8Array(n),m+4),m+=4+E}return t.data===void 0?(p.setUint32(m,0),m+=4):(p.setUint32(m,t.data.length),d.set(t.data,m+4),m+=4+t.data.length),Xt(m<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(m)}}class pn{static#t=0;static#e=1;static#i=2;static#n=3;static#a=4;static#r=8;static#s=12;static#o=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let e,n=null,s=[],a=[],l=[],c=[],h=null,d=null;switch(t[0]){case"RadialAxial":e=t[1]==="axial"?1:2,n=t[2],l=t[3],e===1?s.push(...t[4],...t[5]):s.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":e=3,h=t[1],s=t[2],a=t[3],c=t[4]||[],n=t[6],d=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const p=Math.floor(s.length/2),m=Math.floor(a.length/3),v=l.length,b=c.length;let w=0;for(const F of c)w+=1,w=Math.ceil(w/4)*4,w+=4+F.coords.length*4,w+=4+F.colors.length*4,F.verticesPerRow!==void 0&&(w+=4);const E=20+p*8+m*3+v*8+(n?16:0)+(d?3:0)+w,S=new ArrayBuffer(E),C=new DataView(S),R=new Uint8Array(S);C.setUint8(pn.#t,e),C.setUint8(pn.#e,n?1:0),C.setUint8(pn.#i,d?1:0),C.setUint8(pn.#n,h),C.setUint32(pn.#a,p,!0),C.setUint32(pn.#r,m,!0),C.setUint32(pn.#s,v,!0),C.setUint32(pn.#o,b,!0);let I=20;new Float32Array(S,I,p*2).set(s),I+=p*8,R.set(a,I),I+=m*3;for(const[F,j]of l)C.setFloat32(I,F,!0),I+=4,C.setUint32(I,parseInt(j.slice(1),16),!0),I+=4;if(n)for(const F of n)C.setFloat32(I,F,!0),I+=4;d&&(R.set(d,I),I+=3);for(let F=0;F<c.length;F++){const j=c[F];C.setUint8(I,j.type),I+=1,I=Math.ceil(I/4)*4,C.setUint32(I,j.coords.length,!0),I+=4,new Int32Array(S,I,j.coords.length).set(j.coords),I+=j.coords.length*4,C.setUint32(I,j.colors.length,!0),I+=4,new Int32Array(S,I,j.colors.length).set(j.colors),I+=j.colors.length*4,j.verticesPerRow!==void 0&&(C.setUint32(I,j.verticesPerRow,!0),I+=4)}return S}getIR(){const t=this.view,e=this.data[pn.#t],n=!!this.data[pn.#e],s=!!this.data[pn.#i],a=t.getUint32(pn.#a,!0),l=t.getUint32(pn.#r,!0),c=t.getUint32(pn.#s,!0),h=t.getUint32(pn.#o,!0);let d=20;const p=new Float32Array(this.buffer,d,a*2);d+=a*8;const m=new Uint8Array(this.buffer,d,l*3);d+=l*3;const v=[];for(let S=0;S<c;++S){const C=t.getFloat32(d,!0);d+=4;const R=t.getUint32(d,!0);d+=4,v.push([C,`#${R.toString(16).padStart(6,"0")}`])}let b=null;if(n){b=[];for(let S=0;S<4;++S)b.push(t.getFloat32(d,!0)),d+=4}let w=null;s&&(w=new Uint8Array(this.buffer,d,3),d+=3);const E=[];for(let S=0;S<h;++S){const C=t.getUint8(d);d+=1,d=Math.ceil(d/4)*4;const R=t.getUint32(d,!0);d+=4;const I=new Int32Array(this.buffer,d,R);d+=R*4;const B=t.getUint32(d,!0);d+=4;const F=new Int32Array(this.buffer,d,B);d+=B*4;const j={type:C,coords:I,colors:F};C===U_.LATTICE&&(j.verticesPerRow=t.getUint32(d,!0),d+=4),E.push(j)}if(e===1)return["RadialAxial","axial",b,v,Array.from(p.slice(0,2)),Array.from(p.slice(2,4)),null,null];if(e===2)return["RadialAxial","radial",b,v,[p[0],p[1]],[p[3],p[4]],p[2],p[5]];if(e===3){const S=this.data[pn.#n];let C=null;if(p.length>0){let R=p[0],I=p[0],B=p[1],F=p[1];for(let j=0;j<p.length;j+=2){const P=p[j],D=p[j+1];R=R>P?P:R,B=B>D?D:B,I=I<P?P:I,F=F<D?D:F}C=[R,B,I,F]}return["Mesh",S,p,m,E,C,b,w]}throw new Error(`Unsupported pattern kind: ${e}`)}}class L9{static write(t){let e,n;return cn.isFloat16ArraySupported?(n=new ArrayBuffer(t.length*2),e=new Float16Array(n)):(n=new ArrayBuffer(t.length*4),e=new Float32Array(n)),e.set(t),n}#t;constructor(t){this.#t=t}get path(){return cn.isFloat16ArraySupported?new Float16Array(this.#t):new Float32Array(this.#t)}}function V9(i){if(i instanceof URL)return i.href;if(typeof i=="string"){if(Bn)return i;const t=URL.parse(i,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function B9(i){if(Bn&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return ad(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i?.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function ip(i){if(typeof i!="string")return null;if(i.endsWith("/"))return i;throw new Error(`Invalid factory url: "${i}" must include trailing slash.`)}const $_=i=>typeof i=="object"&&Number.isInteger(i?.num)&&i.num>=0&&Number.isInteger(i?.gen)&&i.gen>=0,F9=i=>typeof i=="object"&&typeof i?.name=="string",U9=_9.bind(null,$_,F9);class j9{#t=new Map;#e=Promise.resolve();postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[s]of this.#t)s.call(this,n)})}addEventListener(t,e,n=null){let s=null;if(n?.signal instanceof AbortSignal){const{signal:a}=n;if(a.aborted){Nt("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(t,e);s=()=>a.removeEventListener("abort",l),a.addEventListener("abort",l)}this.#t.set(e,s)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const sp={DATA:1,ERROR:2},Xe={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function BC(){}function Zn(i){if(i instanceof Fa||i instanceof j_||i instanceof DC||i instanceof um||i instanceof Pv)return i;switch(i instanceof Error||typeof i=="object"&&i!==null||me('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new Fa(i.message);case"InvalidPDFException":return new j_(i.message);case"PasswordException":return new DC(i.message,i.code);case"ResponseException":return new um(i.message,i.status,i.missing);case"UnknownErrorException":return new Pv(i.message,i.details)}return new Pv(i.message,i.toString())}class ah{#t=new AbortController;constructor(t,e,n){this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#n(t);return}if(t.callback){const n=t.callbackId,s=this.callbackCapabilities[n];if(!s)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===sp.DATA)s.resolve(t.data);else if(t.callback===sp.ERROR)s.reject(Zn(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,s=t.sourceName,a=this.comObj;Promise.try(e,t.data).then(function(l){a.postMessage({sourceName:n,targetName:s,callback:sp.DATA,callbackId:t.callbackId,data:l})},function(l){a.postMessage({sourceName:n,targetName:s,callback:sp.ERROR,callbackId:t.callbackId,reason:Zn(l)})});return}if(t.streamId){this.#i(t);return}e(t.data)}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const s=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[s]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:s,data:e},n)}catch(l){a.reject(l)}return a.promise}sendWithStream(t,e,n,s){const a=this.streamId++,l=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:d=>{const p=Promise.withResolvers();return this.streamControllers[a]={controller:d,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:c,action:t,streamId:a,data:e,desiredSize:d.desiredSize},s),p.promise},pull:d=>{const p=Promise.withResolvers();return this.streamControllers[a].pullCall=p,h.postMessage({sourceName:l,targetName:c,stream:Xe.PULL,streamId:a,desiredSize:d.desiredSize}),p.promise},cancel:d=>{Xt(d instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[a].cancelCall=p,this.streamControllers[a].isClosed=!0,h.postMessage({sourceName:l,targetName:c,stream:Xe.CANCEL,streamId:a,reason:Zn(d)}),p.promise}},n)}#i(t){const e=t.streamId,n=this.sourceName,s=t.sourceName,a=this.comObj,l=this,c=this.actionHandler[t.action],h={enqueue(d,p=1,m){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=p,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:n,targetName:s,stream:Xe.ENQUEUE,streamId:e,chunk:d},m)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:s,stream:Xe.CLOSE,streamId:e}),delete l.streamSinks[e])},error(d){Xt(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:s,stream:Xe.ERROR,streamId:e,reason:Zn(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,Promise.try(c,t.data,h).then(function(){a.postMessage({sourceName:n,targetName:s,stream:Xe.START_COMPLETE,streamId:e,success:!0})},function(d){a.postMessage({sourceName:n,targetName:s,stream:Xe.START_COMPLETE,streamId:e,reason:Zn(d)})})}#n(t){const e=t.streamId,n=this.sourceName,s=t.sourceName,a=this.comObj,l=this.streamControllers[e],c=this.streamSinks[e];switch(t.stream){case Xe.START_COMPLETE:t.success?l.startCall.resolve():l.startCall.reject(Zn(t.reason));break;case Xe.PULL_COMPLETE:t.success?l.pullCall.resolve():l.pullCall.reject(Zn(t.reason));break;case Xe.PULL:if(!c){a.postMessage({sourceName:n,targetName:s,stream:Xe.PULL_COMPLETE,streamId:e,success:!0});break}c.desiredSize<=0&&t.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=t.desiredSize,Promise.try(c.onPull||BC).then(function(){a.postMessage({sourceName:n,targetName:s,stream:Xe.PULL_COMPLETE,streamId:e,success:!0})},function(d){a.postMessage({sourceName:n,targetName:s,stream:Xe.PULL_COMPLETE,streamId:e,reason:Zn(d)})});break;case Xe.ENQUEUE:if(Xt(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(t.chunk);break;case Xe.CLOSE:if(Xt(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#a(l,e);break;case Xe.ERROR:Xt(l,"error should have stream controller"),l.controller.error(Zn(t.reason)),this.#a(l,e);break;case Xe.CANCEL_COMPLETE:t.success?l.cancelCall.resolve():l.cancelCall.reject(Zn(t.reason)),this.#a(l,e);break;case Xe.CANCEL:if(!c)break;const h=Zn(t.reason);Promise.try(c.onCancel||BC,h).then(function(){a.postMessage({sourceName:n,targetName:s,stream:Xe.CANCEL_COMPLETE,streamId:e,success:!0})},function(d){a.postMessage({sourceName:n,targetName:s,stream:Xe.CANCEL_COMPLETE,streamId:e,reason:Zn(d)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#a(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class QP{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){me("Abstract method `_createCanvas` called.")}}class z9 extends QP{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}}class JP{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){me("Abstract method `_fetch` called.")}}class FC extends JP{async _fetch(t){const e=await od(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):ad(e)}}class ZP{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,s,a){return"none"}destroy(t=!1){}}class H9 extends ZP{#t;#e;#i;#n;#a;#r;#s=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#n=t,this.#a=e}get#o(){return this.#e||=new Map}get#c(){return this.#r||=new Map}get#l(){if(!this.#i){const t=this.#a.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const n=this.#a.createElementNS(_r,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#i=this.#a.createElementNS(_r,"defs"),t.append(n),n.append(this.#i),this.#a.body.append(t)}return this.#i}#d(t){if(t.length===1){const h=t[0],d=new Array(256);for(let m=0;m<256;m++)d[m]=h[m]/255;const p=d.join(",");return[p,p,p]}const[e,n,s]=t,a=new Array(256),l=new Array(256),c=new Array(256);for(let h=0;h<256;h++)a[h]=e[h]/255,l[h]=n[h]/255,c[h]=s[h]/255;return[a.join(","),l.join(","),c.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const e=this.#a.URL;e!==this.#a.baseURI&&(Hm(e)?Nt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=jP(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[n,s,a]=this.#d(t),l=t.length===1?n:`${n}${s}${a}`;if(e=this.#o.get(l),e)return this.#o.set(t,e),e;const c=`g_${this.#n}_transfer_map_${this.#s++}`,h=this.#h(c);this.#o.set(t,h),this.#o.set(l,h);const d=this.#m(c);return this.#p(n,s,a,d),h}addHCMFilter(t,e){const n=`${t}-${e}`,s="base";let a=this.#c.get(s);if(a?.key===n||(a?(a.filter?.remove(),a.key=n,a.url="none",a.filter=null):(a={key:n,url:"none",filter:null},this.#c.set(s,a)),!t||!e))return a.url;const l=this.#_(t);t=ft.makeHexColor(...l);const c=this.#_(e);if(e=ft.makeHexColor(...c),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return a.url;const h=new Array(256);for(let b=0;b<=255;b++){const w=b/255;h[b]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const d=h.join(","),p=`g_${this.#n}_hcm_filter`,m=a.filter=this.#m(p);this.#p(d,d,d,m),this.#g(m);const v=(b,w)=>{const E=l[b]/255,S=c[b]/255,C=new Array(w+1);for(let R=0;R<=w;R++)C[R]=E+R/w*(S-E);return C.join(",")};return this.#p(v(0,5),v(1,5),v(2,5),m),a.url=this.#h(p),a.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[n]=this.#d([t]),s=`alpha_${n}`;if(e=this.#o.get(s),e)return this.#o.set(t,e),e;const a=`g_${this.#n}_alpha_map_${this.#s++}`,l=this.#h(a);this.#o.set(t,l),this.#o.set(s,l);const c=this.#m(a);return this.#y(n,c),l}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let n,s;if(t?([n]=this.#d([t]),s=`luminosity_${n}`):s="luminosity",e=this.#o.get(s),e)return this.#o.set(t,e),e;const a=`g_${this.#n}_luminosity_map_${this.#s++}`,l=this.#h(a);this.#o.set(t,l),this.#o.set(s,l);const c=this.#m(a);return this.#f(c),t&&this.#y(n,c),l}addHighlightHCMFilter(t,e,n,s,a){const l=`${e}-${n}-${s}-${a}`;let c=this.#c.get(t);if(c?.key===l||(c?(c.filter?.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},this.#c.set(t,c)),!e||!n))return c.url;const[h,d]=[e,n].map(this.#_.bind(this));let p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),m=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[v,b]=[s,a].map(this.#_.bind(this));m<p&&([p,m,v,b]=[m,p,b,v]),this.#l.style.color="";const w=(C,R,I)=>{const B=new Array(256),F=(m-p)/I,j=C/255,P=(R-C)/(255*I);let D=0;for(let M=0;M<=I;M++){const V=Math.round(p+M*F),O=j+M*P;for(let G=D;G<=V;G++)B[G]=O;D=V+1}for(let M=D;M<256;M++)B[M]=B[D-1];return B.join(",")},E=`g_${this.#n}_hcm_${t}_filter`,S=c.filter=this.#m(E);return this.#g(S),this.#p(w(v[0],b[0],5),w(v[1],b[1],5),w(v[2],b[2],5),S),c.url=this.#h(E),c.url}destroy(t=!1){t&&this.#r?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#e?.clear(),this.#e=null,this.#r?.clear(),this.#r=null,this.#s=0)}#f(t){const e=this.#a.createElementNS(_r,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#g(t){const e=this.#a.createElementNS(_r,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#m(t){const e=this.#a.createElementNS(_r,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#u(t,e,n){const s=this.#a.createElementNS(_r,e);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),t.append(s)}#p(t,e,n,s){const a=this.#a.createElementNS(_r,"feComponentTransfer");s.append(a),this.#u(a,"feFuncR",t),this.#u(a,"feFuncG",e),this.#u(a,"feFuncB",n)}#y(t,e){const n=this.#a.createElementNS(_r,"feComponentTransfer");e.append(n),this.#u(n,"feFuncA",t)}#_(t){return this.#l.style.color=t,cd(getComputedStyle(this.#l).getPropertyValue("color"))}}class t2{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){me("Abstract method `_fetch` called.")}}class UC extends t2{async _fetch(t){const e=await od(t,"arraybuffer");return new Uint8Array(e)}}class e2{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){me("Abstract method `_fetch` called.")}}class jC extends e2{async _fetch(t){const e=await od(t,"arraybuffer");return new Uint8Array(e)}}Bn&&Nt("Please use the `legacy` build in Node.js environments.");async function Ub(i){const e=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(e)}class q9 extends ZP{}class G9 extends QP{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class $9 extends JP{async _fetch(t){return Ub(t)}}class W9 extends t2{async _fetch(t){return Ub(t)}}class K9 extends e2{async _fetch(t){return Ub(t)}}const jl="__forcedDependency",{floor:zC,ceil:HC}=Math;function rp(i,t,e,n,s,a){i[t*4+0]=Math.min(i[t*4+0],e),i[t*4+1]=Math.min(i[t*4+1],n),i[t*4+2]=Math.max(i[t*4+2],s),i[t*4+3]=Math.max(i[t*4+3],a)}const W_=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class Y9{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===W_}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const ap=(i,t)=>{if(!i)return;let e=i.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},i.set(t,e)),e};class X9{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[jl]:[]};#i=new Map;#n=[];#a=[];#r=[[1,0,0,1,0,0]];#s=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#g;#m;#u;#p;constructor(t,e,n=!1){this.#f=t.width,this.#g=t.height,this.#y(e),n&&(this.#p=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,e){const n=new ArrayBuffer(t*4);this.#m=new Uint8ClampedArray(n),this.#u=new Uint32Array(n),e&&e.length>0?(this.#u.set(e),this.#u.fill(W_,e.length)):this.#u.fill(W_)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[jl]:{__proto__:this.#e[jl]}},this.#s={__proto__:this.#s},this.#n.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#s=Object.getPrototypeOf(this.#s);const n=this.#n.pop();return n!==void 0&&(ap(this.#p,t)?.dependencies.add(n),this.#u[t]=this.#u[n]),this}recordOpenMarker(t){return this.#n.push(t),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(t){const e=this.#n.pop();return e!==void 0&&(ap(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}beginMarkedContent(t){return this.#a.push(t),this}endMarkedContent(t){const e=this.#a.pop();return e!==void 0&&(ap(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}pushBaseTransform(t){return this.#r.push(ft.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform())),this}popBaseTransform(){return this.#r.length>1&&this.#r.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#i.set(t,e),this}recordSimpleDataFromNamed(t,e,n){this.#t[t]=this.#i.get(e)??n}recordFutureForcedDependency(t,e){return this.recordIncrementalData(jl,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(jl,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,e,n,s,a,l){const c=ft.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform()),h=[1/0,1/0,-1/0,-1/0];ft.axialAlignedBoundingBox([n,a,s,l],c,h);const d=ft.intersect(this.#s,h);return d?(this.#s[0]=d[0],this.#s[1]=d[1],this.#s[2]=d[2],this.#s[3]=d[3]):(this.#s[0]=this.#s[1]=1/0,this.#s[2]=this.#s[3]=-1/0),this}recordBBox(t,e,n,s,a,l){const c=this.#s;if(c[0]===1/0)return this;const h=ft.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform());if(c[0]===-1/0)return ft.axialAlignedBoundingBox([n,a,s,l],h,this.#o),this;const d=[1/0,1/0,-1/0,-1/0];return ft.axialAlignedBoundingBox([n,a,s,l],h,d),this.#o[0]=Math.min(this.#o[0],Math.max(d[0],c[0])),this.#o[1]=Math.min(this.#o[1],Math.max(d[1],c[1])),this.#o[2]=Math.max(this.#o[2],Math.min(d[2],c[2])),this.#o[3]=Math.max(this.#o[3],Math.min(d[3],c[3])),this}recordCharacterBBox(t,e,n,s=1,a=0,l=0,c){const h=n.bbox;let d,p;if(h&&(d=h[2]!==h[0]&&h[3]!==h[1]&&this.#h.get(n),d!==!1&&(p=[0,0,0,0],ft.axialAlignedBoundingBox(h,n.fontMatrix,p),(s!==1||a!==0||l!==0)&&ft.scaleMinMax([s,0,0,-s,a,l],p),d)))return this.recordBBox(t,e,p[0],p[2],p[1],p[3]);if(!c)return this.recordFullPageBBox(t);const m=c();return h&&p&&d===void 0&&(d=p[0]<=a-m.actualBoundingBoxLeft&&p[2]>=a+m.actualBoundingBoxRight&&p[1]<=l-m.actualBoundingBoxAscent&&p[3]>=l+m.actualBoundingBoxDescent,this.#h.set(n,d),d)?this.recordBBox(t,e,p[0],p[2],p[1],p[3]):this.recordBBox(t,e,a-m.actualBoundingBoxLeft,a+m.actualBoundingBoxRight,l-m.actualBoundingBoxAscent,l+m.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#s[0]),this.#o[1]=Math.max(0,this.#s[1]),this.#o[2]=Math.min(this.#f,this.#s[2]),this.#o[3]=Math.min(this.#g,this.#s[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const n=this.#l,s=this.#t,a=this.#e;for(const l of e)l in this.#t?n.add(s[l]):l in a&&a[l].forEach(n.add,n);return this}recordNamedDependency(t,e){return this.#i.has(e)&&this.#l.add(this.#i.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[jl]),this.#p){const n=ap(this.#p,t),{dependencies:s}=n;this.#l.forEach(s.add,s),this.#n.forEach(s.add,s),this.#a.forEach(s.add,s),s.delete(t),n.isRenderingOperation=!0}if(this.#c===t){const n=zC(this.#o[0]*256/this.#f),s=zC(this.#o[1]*256/this.#g),a=HC(this.#o[2]*256/this.#f),l=HC(this.#o[3]*256/this.#g);rp(this.#m,t,n,s,a,l);for(const c of this.#l)c!==t&&rp(this.#m,c,n,s,a,l);for(const c of this.#n)c!==t&&rp(this.#m,c,n,s,a,l);for(const c of this.#a)c!==t&&rp(this.#m,c,n,s,a,l);e||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,e=!1){const n=Array.from(this.#l);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const s of n)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#c===t&&(this.#c=-1,this.#s[0]=Math.max(this.#s[0],this.#o[0]),this.#s[1]=Math.max(this.#s[1],this.#o[1]),this.#s[2]=Math.min(this.#s[2],this.#o[2]),this.#s[3]=Math.min(this.#s[3],this.#o[3]),e||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#h.clear(),new Y9(this.#u,this.#m)}takeDebugMetadata(){return this.#p}}class hm{#t;#e;#i;#n=0;#a=0;constructor(t,e,n){if(t instanceof hm&&t.#i===!!n)return t;this.#t=t,this.#e=e,this.#i=!!n}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#a++,this.#t.save(this.#e),this}restore(t){return this.#a>0&&(this.#t.restore(this.#e),this.#a--),this}recordOpenMarker(t){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#n--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,n){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#i||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,n,s,a,l){return this.#i||this.#t.recordClipBox(this.#e,e,n,s,a,l),this}recordBBox(t,e,n,s,a,l){return this.#i||this.#t.recordBBox(this.#e,e,n,s,a,l),this}recordCharacterBBox(t,e,n,s,a,l,c){return this.#i||this.#t.recordCharacterBBox(this.#e,e,n,s,a,l,c),this}recordFullPageBBox(t){return this.#i||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#i||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const Mi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Cn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function K_(i,t){if(!t)return;const e=t[2]-t[0],n=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],e,n),i.clip(s)}class jb{isModifyingCurrentTransform(){return!1}getPattern(){me("Abstract method `getPattern` called.")}}class Q9 extends jb{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(t,e=null){let n,s=this._p0,a=this._p1;if(e&&(s=s.slice(),a=a.slice(),ft.applyTransform(s,e),ft.applyTransform(a,e)),this._type==="axial")n=t.createLinearGradient(s[0],s[1],a[0],a[1]);else if(this._type==="radial"){let l=this._r0,c=this._r1;if(e){const h=new Float32Array(2);ft.singularValueDecompose2dScale(e,h),l*=h[0],c*=h[0]}n=t.createRadialGradient(s[0],s[1],l,a[0],a[1],c)}for(const l of this._colorStops)n.addColorStop(l[0],l[1]);return n}getPattern(t,e,n,s){let a;if(s===Cn.STROKE||s===Cn.FILL){if(this.isOriginBased()){let v=ft.transform(n,e.baseTransform);this.matrix&&(v=ft.transform(v,this.matrix));const b=.001,w=Math.hypot(v[0],v[1]),E=Math.hypot(v[2],v[3]),S=(v[0]*v[2]+v[1]*v[3])/(w*E);if(Math.abs(S)<b)if(this.isRadial()){if(Math.abs(w-E)<b)return this._createGradient(t,v)}else return this._createGradient(t,v)}const l=e.current.getClippedPathBoundingBox(s,xe(t))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,d=e.cachedCanvases.getCanvas("pattern",c,h),p=d.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-l[0],-l[1]),n=ft.transform(n,[1,0,0,1,l[0],l[1]]),p.transform(...e.baseTransform),this.matrix&&p.transform(...this.matrix),K_(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),a=t.createPattern(d.canvas,"no-repeat");const m=new DOMMatrix(n);a.setTransform(m)}else K_(t,this._bbox),a=this._createGradient(t);return a}}function Nv(i,t,e,n,s,a,l,c){const h=t.coords,d=t.colors,p=i.data,m=i.width*4;let v;h[e+1]>h[n+1]&&(v=e,e=n,n=v,v=a,a=l,l=v),h[n+1]>h[s+1]&&(v=n,n=s,s=v,v=l,l=c,c=v),h[e+1]>h[n+1]&&(v=e,e=n,n=v,v=a,a=l,l=v);const b=(h[e]+t.offsetX)*t.scaleX,w=(h[e+1]+t.offsetY)*t.scaleY,E=(h[n]+t.offsetX)*t.scaleX,S=(h[n+1]+t.offsetY)*t.scaleY,C=(h[s]+t.offsetX)*t.scaleX,R=(h[s+1]+t.offsetY)*t.scaleY;if(w>=R)return;const I=d[a],B=d[a+1],F=d[a+2],j=d[l],P=d[l+1],D=d[l+2],M=d[c],V=d[c+1],O=d[c+2],G=Math.round(w),U=Math.round(R);let gt,Pt,W,K,tt,ut,At,H;for(let et=G;et<=U;et++){if(et<S){const wt=et<w?0:(w-et)/(w-S);gt=b-(b-E)*wt,Pt=I-(I-j)*wt,W=B-(B-P)*wt,K=F-(F-D)*wt}else{let wt;et>R?wt=1:S===R?wt=0:wt=(S-et)/(S-R),gt=E-(E-C)*wt,Pt=j-(j-M)*wt,W=P-(P-V)*wt,K=D-(D-O)*wt}let ct;et<w?ct=0:et>R?ct=1:ct=(w-et)/(w-R),tt=b-(b-C)*ct,ut=I-(I-M)*ct,At=B-(B-V)*ct,H=F-(F-O)*ct;const dt=Math.round(Math.min(gt,tt)),Et=Math.round(Math.max(gt,tt));let Tt=m*et+dt*4;for(let wt=dt;wt<=Et;wt++)ct=(gt-wt)/(gt-tt),ct<0?ct=0:ct>1&&(ct=1),p[Tt++]=Pt-(Pt-ut)*ct|0,p[Tt++]=W-(W-At)*ct|0,p[Tt++]=K-(K-H)*ct|0,p[Tt++]=255}}function J9(i,t,e){const n=t.coords,s=t.colors;let a,l;switch(t.type){case U_.LATTICE:const c=t.verticesPerRow,h=Math.floor(n.length/c)-1,d=c-1;for(a=0;a<h;a++){let p=a*c;for(let m=0;m<d;m++,p++)Nv(i,e,n[p],n[p+1],n[p+c],s[p],s[p+1],s[p+c]),Nv(i,e,n[p+c+1],n[p+1],n[p+c],s[p+c+1],s[p+1],s[p+c])}break;case U_.TRIANGLES:for(a=0,l=n.length;a<l;a+=3)Nv(i,e,n[a],n[a+1],n[a+2],s[a],s[a+1],s[a+2]);break;default:throw new Error("illegal figure")}}class Z9 extends jb{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,n){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-c,p=Math.ceil(this._bounds[3])-h,m=Math.min(Math.ceil(Math.abs(d*t[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),b=d/m,w=p/v,E={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/b,scaleY:1/w},S=m+4,C=v+4,R=n.getCanvas("mesh",S,C),I=R.context,B=I.createImageData(m,v);if(e){const j=B.data;for(let P=0,D=j.length;P<D;P+=4)j[P]=e[0],j[P+1]=e[1],j[P+2]=e[2],j[P+3]=255}for(const j of this._figures)J9(B,j,E);return I.putImageData(B,2,2),{canvas:R.canvas,offsetX:c-2*b,offsetY:h-2*w,scaleX:b,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(t,e,n,s){K_(t,this._bbox);const a=new Float32Array(2);if(s===Cn.SHADING)ft.singularValueDecompose2dScale(xe(t),a);else if(this.matrix){ft.singularValueDecompose2dScale(this.matrix,a);const[c,h]=a;ft.singularValueDecompose2dScale(e.baseTransform,a),a[0]*=c,a[1]*=h}else ft.singularValueDecompose2dScale(e.baseTransform,a);const l=this._createMeshCanvas(a,s===Cn.SHADING?null:this._background,e.cachedCanvases);return s!==Cn.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class t8 extends jb{getPattern(){return"hotpink"}}function e8(i){switch(i[0]){case"RadialAxial":return new Q9(i);case"Mesh":return new Z9(i);case"Dummy":return new t8}throw new Error(`Unknown IR type: ${i[0]}`)}const qC={COLORED:1,UNCOLORED:2};class zb{static MAX_PATTERN_SIZE=3e3;constructor(t,e,n,s){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(t,e){const{bbox:n,operatorList:s,paintType:a,tilingType:l,color:c,canvasGraphicsFactory:h}=this;let{xstep:d,ystep:p}=this;d=Math.abs(d),p=Math.abs(p),zm("TilingType: "+l);const m=n[0],v=n[1],b=n[2],w=n[3],E=b-m,S=w-v,C=new Float32Array(2);ft.singularValueDecompose2dScale(this.matrix,C);const[R,I]=C;ft.singularValueDecompose2dScale(this.baseTransform,C);const B=R*C[0],F=I*C[1];let j=E,P=S,D=!1,M=!1;const V=Math.ceil(d*B),O=Math.ceil(p*F),G=Math.ceil(E*B),U=Math.ceil(S*F);V>=G?j=d:D=!0,O>=U?P=p:M=!0;const gt=this.getSizeAndScale(j,this.ctx.canvas.width,B),Pt=this.getSizeAndScale(P,this.ctx.canvas.height,F),W=t.cachedCanvases.getCanvas("pattern",gt.size,Pt.size),K=W.context,tt=h.createCanvasGraphics(K,e);if(tt.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(tt,a,c),K.translate(-gt.scale*m,-Pt.scale*v),tt.transform(0,gt.scale,0,0,Pt.scale,0,0),K.save(),tt.dependencyTracker?.save(),this.clipBbox(tt,m,v,b,w),tt.baseTransform=xe(tt.ctx),tt.executeOperatorList(s),tt.endDrawing(),tt.dependencyTracker?.restore(),K.restore(),D||M){const ut=W.canvas;D&&(j=d),M&&(P=p);const At=this.getSizeAndScale(j,this.ctx.canvas.width,B),H=this.getSizeAndScale(P,this.ctx.canvas.height,F),et=At.size,ct=H.size,dt=t.cachedCanvases.getCanvas("pattern-workaround",et,ct),Et=dt.context,Tt=D?Math.floor(E/d):0,wt=M?Math.floor(S/p):0;for(let ye=0;ye<=Tt;ye++)for(let se=0;se<=wt;se++)Et.drawImage(ut,et*ye,ct*se,et,ct,0,0,et,ct);return{canvas:dt.canvas,scaleX:At.scale,scaleY:H.scale,offsetX:m,offsetY:v}}return{canvas:W.canvas,scaleX:gt.scale,scaleY:Pt.scale,offsetX:m,offsetY:v}}getSizeAndScale(t,e,n){const s=Math.max(zb.MAX_PATTERN_SIZE,e);let a=Math.ceil(t*n);return a>=s?a=s:n=a/t,{scale:n,size:a}}clipBbox(t,e,n,s,a){const l=s-e,c=a-n;t.ctx.rect(e,n,l,c),ft.axialAlignedBoundingBox([e,n,s,a],xe(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const s=t.ctx,a=t.current;switch(e){case qC.COLORED:const{fillStyle:l,strokeStyle:c}=this.ctx;s.fillStyle=a.fillColor=l,s.strokeStyle=a.strokeColor=c;break;case qC.UNCOLORED:s.fillStyle=s.strokeStyle=n,a.fillColor=a.strokeColor=n;break;default:throw new f9(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,n,s,a){let l=n;s!==Cn.SHADING&&(l=ft.transform(l,e.baseTransform),this.matrix&&(l=ft.transform(l,this.matrix)));const c=this.createPatternCanvas(e,a);let h=new DOMMatrix(l);h=h.translate(c.offsetX,c.offsetY),h=h.scale(1/c.scaleX,1/c.scaleY);const d=t.createPattern(c.canvas,"repeat");return d.setTransform(h),d}}function n8({src:i,srcPos:t=0,dest:e,width:n,height:s,nonBlackColor:a=4294967295,inverseDecode:l=!1}){const c=cn.isLittleEndian?4278190080:255,[h,d]=l?[a,c]:[c,a],p=n>>3,m=n&7,v=i.length;e=new Uint32Array(e.buffer);let b=0;for(let w=0;w<s;w++){for(const S=t+p;t<S;t++){const C=t<v?i[t]:255;e[b++]=C&128?d:h,e[b++]=C&64?d:h,e[b++]=C&32?d:h,e[b++]=C&16?d:h,e[b++]=C&8?d:h,e[b++]=C&4?d:h,e[b++]=C&2?d:h,e[b++]=C&1?d:h}if(m===0)continue;const E=t<v?i[t++]:255;for(let S=0;S<m;S++)e[b++]=E&1<<7-S?d:h}return{srcPos:t,destPos:b}}const GC=16,$C=100,i8=15,WC=10,ti=16,Ov=new DOMMatrix,pi=new Float32Array(2),ec=new Float32Array([1/0,1/0,-1/0,-1/0]);function s8(i,t){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){t.save(),this.__originalSave()},i.restore=function(){t.restore(),this.__originalRestore()},i.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},i.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},i.transform=function(e,n,s,a,l,c){t.transform(e,n,s,a,l,c),this.__originalTransform(e,n,s,a,l,c)},i.setTransform=function(e,n,s,a,l,c){t.setTransform(e,n,s,a,l,c),this.__originalSetTransform(e,n,s,a,l,c)},i.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},i.rotate=function(e){t.rotate(e),this.__originalRotate(e)},i.clip=function(e){t.clip(e),this.__originalClip(e)},i.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},i.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},i.bezierCurveTo=function(e,n,s,a,l,c){t.bezierCurveTo(e,n,s,a,l,c),this.__originalBezierCurveTo(e,n,s,a,l,c)},i.rect=function(e,n,s,a){t.rect(e,n,s,a),this.__originalRect(e,n,s,a)},i.closePath=function(){t.closePath(),this.__originalClosePath()},i.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class r8{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let s;return this.cache[t]!==void 0?(s=this.cache[t],this.canvasFactory.reset(s,e,n)):(s=this.canvasFactory.create(e,n),this.cache[t]=s),s}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function op(i,t,e,n,s,a,l,c,h,d){const[p,m,v,b,w,E]=xe(i);if(m===0&&v===0){const R=l*p+w,I=Math.round(R),B=c*b+E,F=Math.round(B),j=(l+h)*p+w,P=Math.abs(Math.round(j)-I)||1,D=(c+d)*b+E,M=Math.abs(Math.round(D)-F)||1;return i.setTransform(Math.sign(p),0,0,Math.sign(b),I,F),i.drawImage(t,e,n,s,a,0,0,P,M),i.setTransform(p,m,v,b,w,E),[P,M]}if(p===0&&b===0){const R=c*v+w,I=Math.round(R),B=l*m+E,F=Math.round(B),j=(c+d)*v+w,P=Math.abs(Math.round(j)-I)||1,D=(l+h)*m+E,M=Math.abs(Math.round(D)-F)||1;return i.setTransform(0,Math.sign(m),Math.sign(v),0,I,F),i.drawImage(t,e,n,s,a,0,0,M,P),i.setTransform(p,m,v,b,w,E),[M,P]}i.drawImage(t,e,n,s,a,l,c,h,d);const S=Math.hypot(p,m),C=Math.hypot(v,b);return[S*h,C*d]}class KC{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=F_;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=an.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,n){n?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=ec.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Cn.FILL,e=null){const n=this.minMax.slice();if(t===Cn.STROKE){e||me("Stroke bounding box must include transform."),ft.singularValueDecompose2dScale(e,pi);const s=pi[0]*this.lineWidth/2,a=pi[1]*this.lineWidth/2;n[0]-=s,n[1]-=a,n[2]+=s,n[3]+=a}return n}updateClipFromPath(){const t=ft.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(ec,0)}getClippedPathBoundingBox(t=Cn.FILL,e=null){return ft.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function YC(i,t){if(t instanceof ImageData){i.putImageData(t,0,0);return}const e=t.height,n=t.width,s=e%ti,a=(e-s)/ti,l=s===0?a:a+1,c=i.createImageData(n,ti);let h=0,d;const p=t.data,m=c.data;let v,b,w,E;if(t.kind===Ip.GRAYSCALE_1BPP){const S=p.byteLength,C=new Uint32Array(m.buffer,0,m.byteLength>>2),R=C.length,I=n+7>>3,B=4294967295,F=cn.isLittleEndian?4278190080:255;for(v=0;v<l;v++){for(w=v<a?ti:s,d=0,b=0;b<w;b++){const j=S-h;let P=0;const D=j>I?n:j*8-7,M=D&-8;let V=0,O=0;for(;P<M;P+=8)O=p[h++],C[d++]=O&128?B:F,C[d++]=O&64?B:F,C[d++]=O&32?B:F,C[d++]=O&16?B:F,C[d++]=O&8?B:F,C[d++]=O&4?B:F,C[d++]=O&2?B:F,C[d++]=O&1?B:F;for(;P<D;P++)V===0&&(O=p[h++],V=128),C[d++]=O&V?B:F,V>>=1}for(;d<R;)C[d++]=0;i.putImageData(c,0,v*ti)}}else if(t.kind===Ip.RGBA_32BPP){for(b=0,E=n*ti*4,v=0;v<a;v++)m.set(p.subarray(h,h+E)),h+=E,i.putImageData(c,0,b),b+=ti;v<l&&(E=n*s*4,m.set(p.subarray(h,h+E)),i.putImageData(c,0,b))}else if(t.kind===Ip.RGB_24BPP)for(w=ti,E=n*w,v=0;v<l;v++){for(v>=a&&(w=s,E=n*w),d=0,b=E;b--;)m[d++]=p[h++],m[d++]=p[h++],m[d++]=p[h++],m[d++]=255;i.putImageData(c,0,v*ti)}else throw new Error(`bad image kind: ${t.kind}`)}function XC(i,t){if(t.bitmap){i.drawImage(t.bitmap,0,0);return}const e=t.height,n=t.width,s=e%ti,a=(e-s)/ti,l=s===0?a:a+1,c=i.createImageData(n,ti);let h=0;const d=t.data,p=c.data;for(let m=0;m<l;m++){const v=m<a?ti:s;({srcPos:h}=n8({src:d,srcPos:h,dest:p,width:n,height:v,nonBlackColor:0})),i.putImageData(c,0,m*ti)}}function Wu(i,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of e)i[n]!==void 0&&(t[n]=i[n]);i.setLineDash!==void 0&&(t.setLineDash(i.getLineDash()),t.lineDashOffset=i.lineDashOffset)}function lp(i){i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0);const{filter:t}=i;t!=="none"&&t!==""&&(i.filter="none")}function QC(i,t){if(t)return!0;ft.singularValueDecompose2dScale(i,pi);const e=Math.fround(Ys.pixelRatio*Tc.PDF_TO_CSS_UNITS);return pi[0]<=e&&pi[1]<=e}const a8=["butt","round","square"],o8=["miter","round","bevel"],l8={},JC={};class dc{constructor(t,e,n,s,a,{optionalContentConfig:l,markedContentStack:c=null},h,d,p){this.ctx=t,this.current=new KC(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=s,this.filterFactory=a,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new r8(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(t,e,n=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):n}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:s=null}){const a=this.ctx.canvas.width,l=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,a,l),this.ctx.fillStyle=c,n){const h=this.cachedCanvases.getCanvas("transparent",a,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...xe(this.compositeCtx))}this.ctx.save(),lp(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=xe(this.ctx)}executeOperatorList(t,e,n,s,a){const l=t.argsArray,c=t.fnArray;let h=e||0;const d=l.length;if(d===h)return h;const p=d-h>WC&&typeof n=="function",m=p?Date.now()+i8:0;let v=0;const b=this.commonObjs,w=this.objs;let E,S;for(;;){if(s!==void 0&&h===s.nextBreakPoint)return s.breakIt(h,n),h;if(!a||a(h))if(E=c[h],S=l[h]??null,E!==Vh.dependency)S===null?this[E](h):this[E](h,...S);else for(const C of S){this.dependencyTracker?.recordNamedData(C,h);const R=C.startsWith("g_")?b:w;if(!R.has(C))return R.get(C,n),h}if(h++,h===d)return h;if(p&&++v>WC){if(Date.now()>m)return n(),h;v=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const n=t.width??t.displayWidth,s=t.height??t.displayHeight;let a=Math.max(Math.hypot(e[0],e[1]),1),l=Math.max(Math.hypot(e[2],e[3]),1),c=n,h=s,d="prescale1",p,m;for(;a>2&&c>1||l>2&&h>1;){let v=c,b=h;a>2&&c>1&&(v=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),a/=c/v),l>2&&h>1&&(b=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/b),p=this.cachedCanvases.getCanvas(d,v,b),m=p.context,m.clearRect(0,0,v,b),m.drawImage(t,0,0,c,h,0,0,v,b),t=p.canvas,c=v,h=b,d=d==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:c,paintHeight:h}}_createMaskCanvas(t,e){const n=this.ctx,{width:s,height:a}=e,l=this.current.fillColor,c=this.current.patternFill,h=xe(n);let d,p,m,v;if((e.bitmap||e.data)&&e.count>1){const V=e.bitmap||e.data.buffer;p=JSON.stringify(c?h:[h.slice(0,4),l]),d=this._cachedBitmapsMap.get(V),d||(d=new Map,this._cachedBitmapsMap.set(V,d));const O=d.get(p);if(O&&!c){const G=Math.round(Math.min(h[0],h[2])+h[4]),U=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(t,Mi.transformAndFill),{canvas:O,offsetX:G,offsetY:U}}m=O}m||(v=this.cachedCanvases.getCanvas("maskCanvas",s,a),XC(v.context,e));let b=ft.transform(h,[1/s,0,0,-1/a,0,0]);b=ft.transform(b,[1,0,0,1,0,-a]);const w=ec.slice();ft.axialAlignedBoundingBox([0,0,s,a],b,w);const[E,S,C,R]=w,I=Math.round(C-E)||1,B=Math.round(R-S)||1,F=this.cachedCanvases.getCanvas("fillCanvas",I,B),j=F.context,P=E,D=S;j.translate(-P,-D),j.transform(...b),m||(m=this._scaleImage(v.canvas,Os(j)),m=m.img,d&&c&&d.set(p,m)),j.imageSmoothingEnabled=QC(xe(j),e.interpolate),op(j,m,0,0,m.width,m.height,0,0,s,a),j.globalCompositeOperation="source-in";const M=ft.transform(Os(j),[1,0,0,1,-P,-D]);return j.fillStyle=c?l.getPattern(n,this,M,Cn.FILL,t):l,j.fillRect(0,0,s,a),d&&!c&&(this.cachedCanvases.delete("fillCanvas"),d.set(p,F.canvas)),this.dependencyTracker?.recordDependencies(t,Mi.transformAndFill),{canvas:F.canvas,offsetX:Math.round(P),offsetY:Math.round(D)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=a8[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=o8[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,n){this.dependencyTracker?.recordSimpleData("dash",t);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=n)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[n,s]of e)switch(n){case"LW":this.setLineWidth(t,s);break;case"LC":this.setLineCap(t,s);break;case"LJ":this.setLineJoin(t,s);break;case"ML":this.setMiterLimit(t,s);break;case"D":this.setDash(t,s[0],s[1]);break;case"RI":this.setRenderingIntent(t,s);break;case"FL":this.setFlatness(t,s);break;case"Font":this.setFont(t,s[0],s[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=s;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=s;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,n=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(s,e,n);this.suspendedCtx=this.ctx;const l=this.ctx=a.context;l.setTransform(this.suspendedCtx.getTransform()),Wu(this.suspendedCtx,l),s8(l,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Wu(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,s){const a=s[0],l=s[1],c=s[2]-a,h=s[3]-l;c===0||h===0||(this.genericComposeSMask(e.context,n,c,h,e.subtype,e.backdrop,e.transferMap,a,l,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,s,a,l,c,h,d,p,m){let v=t.canvas,b=h-p,w=d-m;if(l)if(b<0||w<0||b+n>v.width||w+s>v.height){const S=this.cachedCanvases.getCanvas("maskExtension",n,s),C=S.context;C.drawImage(v,-b,-w),C.globalCompositeOperation="destination-atop",C.fillStyle=l,C.fillRect(0,0,n,s),C.globalCompositeOperation="source-over",v=S.canvas,b=w=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const S=new Path2D;S.rect(b,w,n,s),t.clip(S),t.globalCompositeOperation="destination-atop",t.fillStyle=l,t.fillRect(b,w,n,s),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),a==="Alpha"&&c?e.filter=this.filterFactory.addAlphaFilter(c):a==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(c));const E=new Path2D;E.rect(h,d,n,s),e.clip(E),e.globalCompositeOperation="destination-in",e.drawImage(v,b,w,n,s,h,d,n,s),e.restore()}save(t){this.inSMaskMode&&Wu(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Wu(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,n,s,a,l,c){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,n,s,a,l,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n,s){let[a]=n;if(!s){a||=n[0]=new Path2D,this[e](t,a);return}if(this.dependencyTracker!==null){const l=e===Vh.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,s[0]-l,s[2]+l,s[1]-l,s[3]+l).recordDependencies(t,["transform"])}a instanceof Path2D||(a=n[0]=WP(a)),ft.axialAlignedBoundingBox(s,xe(this.ctx),this.current.minMax),this[e](t,a),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,n=!0){const s=this.ctx,a=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof a=="object"&&a?.getPattern){const l=a.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=a.getPattern(s,this,Os(s),Cn.STROKE,t),l){const c=new Path2D;c.addPath(e,s.getTransform().invertSelf().multiplySelf(l)),e=c}this.rescaleAndStroke(e,!1),s.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,Mi.stroke),n&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(Cn.STROKE,xe(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,n=!0){const s=this.ctx,a=this.current.fillColor,l=this.current.patternFill;let c=!1;if(l){const d=a.isModifyingCurrentTransform()?s.getTransform():null;if(this.dependencyTracker?.save(t),s.save(),s.fillStyle=a.getPattern(s,this,Os(s),Cn.FILL,t),d){const p=new Path2D;p.addPath(e,s.getTransform().invertSelf().multiplySelf(d)),e=p}c=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(s.fill(e,"evenodd"),this.pendingEOFill=!1):s.fill(e)),this.dependencyTracker?.recordDependencies(t,Mi.fill),c&&(s.restore(),this.dependencyTracker?.restore(t)),n&&this.consumePath(t,e,h)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,Mi.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=l8}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=JC}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;e!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",t),s.recordCloseMarker(t)}if(e!==void 0){const s=new Path2D,a=n.getTransform().invertSelf();for(const{transform:l,x:c,y:h,fontSize:d,path:p}of e)p&&s.addPath(p,new DOMMatrix(l).preMultiplySelf(a).translate(c,h).scale(d,-d));n.clip(s)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,n){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const s=this.commonObjs.get(e),a=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(a.fontMatrix=s.fontMatrix||F_,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&Nt("Invalid font matrix for font "+e),n<0?(n=-n,a.fontDirection=-1):a.fontDirection=1,this.current.font=s,this.current.fontSize=n,s.isType3Font)return;const l=s.loadedName||"sans-serif",c=s.systemFontInfo?.css||`"${l}", ${s.fallbackName}`;let h="normal";s.black?h="900":s.bold&&(h="bold");const d=s.italic?"italic":"normal";let p=n;n<GC?p=GC:n>$C&&(p=$C),this.current.fontSizeScale=n/p,this.ctx.font=`${d} ${h} ${p}px ${c}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,n){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=n}setLeadingMoveText(t,e,n){this.setLeading(t,-n),this.moveText(t,e,n)}setTextMatrix(t,e){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:n}=this;n.textMatrix=e,n.textMatrixScale=Math.hypot(e[0],e[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#i(t,e,n){const s=new Path2D;return s.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),s}paintChar(t,e,n,s,a,l){const c=this.ctx,h=this.current,d=h.font,p=h.textRenderingMode,m=h.fontSize/h.fontSizeScale,v=p&an.FILL_STROKE_MASK,b=!!(p&an.ADD_TO_PATH_FLAG),w=h.patternFill&&!d.missingFile,E=h.patternStroke&&!d.missingFile;let S;if((d.disableFontFace||b||w||E)&&!d.missingFile&&(S=d.getPathGenerator(this.commonObjs,e)),S&&(d.disableFontFace||w||E)){c.save(),c.translate(n,s),c.scale(m,-m),this.dependencyTracker?.recordCharacterBBox(t,c,d);let C;if(v===an.FILL||v===an.FILL_STROKE)if(a){C=c.getTransform(),c.setTransform(...a);const R=this.#i(S,C,a);c.fill(R)}else c.fill(S);if(v===an.STROKE||v===an.FILL_STROKE)if(l){C||=c.getTransform(),c.setTransform(...l);const{a:R,b:I,c:B,d:F}=C,j=ft.inverseTransform(l),P=ft.transform([R,I,B,F,0,0],j);ft.singularValueDecompose2dScale(P,pi),c.lineWidth*=Math.max(pi[0],pi[1])/m,c.stroke(this.#i(S,C,l))}else c.lineWidth/=m,c.stroke(S);c.restore()}else(v===an.FILL||v===an.FILL_STROKE)&&(c.fillText(e,n,s),this.dependencyTracker?.recordCharacterBBox(t,c,d,m,n,s,()=>c.measureText(e))),(v===an.STROKE||v===an.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,c,d,m,n,s,()=>c.measureText(e)).recordDependencies(t,Mi.stroke),c.strokeText(e,n,s));b&&((this.pendingTextPaths||=[]).push({transform:xe(c),x:n,y:s,fontSize:m,path:S}),this.dependencyTracker?.recordCharacterBBox(t,c,d,m,n,s))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<e.length;s+=4)if(e[s]>0&&e[s]<255){n=!0;break}return Ot(this,"isFontSubpixelAAEnabled",n)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,Mi.showText).resetBBox(t),this.current.textRenderingMode&an.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,s=n.font;if(s.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const a=n.fontSize;if(a===0){this.dependencyTracker?.recordOperation(t);return}const l=this.ctx,c=n.fontSizeScale,h=n.charSpacing,d=n.wordSpacing,p=n.fontDirection,m=n.textHScale*p,v=e.length,b=s.vertical,w=b?1:-1,E=s.defaultVMetrics,S=a*n.fontMatrix[0],C=n.textRenderingMode===an.FILL&&!s.disableFontFace&&!n.patternFill;l.save(),n.textMatrix&&l.transform(...n.textMatrix),l.translate(n.x,n.y+n.textRise),p>0?l.scale(m,-1):l.scale(m,1);let R,I;const B=n.textRenderingMode&an.FILL_STROKE_MASK,F=B===an.FILL||B===an.FILL_STROKE,j=B===an.STROKE||B===an.FILL_STROKE;if(F&&n.patternFill){l.save();const O=n.fillColor.getPattern(l,this,Os(l),Cn.FILL,t);R=xe(l),l.restore(),l.fillStyle=O}if(j&&n.patternStroke){l.save();const O=n.strokeColor.getPattern(l,this,Os(l),Cn.STROKE,t);I=xe(l),l.restore(),l.strokeStyle=O}let P=n.lineWidth;const D=n.textMatrixScale;if(D===0||P===0?j&&(P=this.getSinglePixelWidth()):P/=D,c!==1&&(l.scale(c,c),P/=c),l.lineWidth=P,s.isInvalidPDFjsFont){const O=[];let G=0;for(const gt of e)O.push(gt.unicode),G+=gt.width;const U=O.join("");if(l.fillText(U,0,0),this.dependencyTracker!==null){const gt=l.measureText(U);this.dependencyTracker.recordBBox(t,this.ctx,-gt.actualBoundingBoxLeft,gt.actualBoundingBoxRight,-gt.actualBoundingBoxAscent,gt.actualBoundingBoxDescent).recordShowTextOperation(t)}n.x+=G*S*m,l.restore(),this.compose();return}let M=0,V;for(V=0;V<v;++V){const O=e[V];if(typeof O=="number"){M+=w*O*a/1e3;continue}let G=!1;const U=(O.isSpace?d:0)+h,gt=O.fontChar,Pt=O.accent;let W,K,tt=O.width;if(b){const H=O.vmetric||E,et=-(O.vmetric?H[1]:tt*.5)*S,ct=H[2]*S;tt=H?-H[0]:tt,W=et/c,K=(M+ct)/c}else W=M/c,K=0;let ut;if(s.remeasure&&tt>0){ut=l.measureText(gt);const H=ut.width*1e3/a*c;if(tt<H&&this.isFontSubpixelAAEnabled){const et=tt/H;G=!0,l.save(),l.scale(et,1),W/=et}else tt!==H&&(W+=(tt-H)/2e3*a/c)}if(this.contentVisible&&(O.isInFont||s.missingFile)){if(C&&!Pt)l.fillText(gt,W,K),this.dependencyTracker?.recordCharacterBBox(t,l,ut?{bbox:null}:s,a/c,W,K,()=>ut??l.measureText(gt));else if(this.paintChar(t,gt,W,K,R,I),Pt){const H=W+a*Pt.offset.x/c,et=K-a*Pt.offset.y/c;this.paintChar(t,Pt.fontChar,H,et,R,I)}}const At=b?tt*S-U*p:tt*S+U*p;M+=At,G&&l.restore()}b?n.y-=M:n.x+=M*m,l.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const n=this.ctx,s=this.current,a=s.font,l=s.fontSize,c=s.fontDirection,h=a.vertical?1:-1,d=s.charSpacing,p=s.wordSpacing,m=s.textHScale*c,v=s.fontMatrix||F_,b=e.length,w=s.textRenderingMode===an.INVISIBLE;let E,S,C,R;if(w||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),s.textMatrix&&n.transform(...s.textMatrix),n.translate(s.x,s.y+s.textRise),n.scale(m,c);const I=this.dependencyTracker;for(this.dependencyTracker=I?new hm(I,t):null,E=0;E<b;++E){if(S=e[E],typeof S=="number"){R=h*S*l/1e3,this.ctx.translate(R,0),s.x+=R*m;continue}const B=(S.isSpace?p:0)+d,F=a.charProcOperatorList[S.operatorListId];F?this.contentVisible&&(this.save(),n.scale(l,l),n.transform(...v),this.executeOperatorList(F),this.restore()):Nt(`Type3 character "${S.operatorListId}" is not available.`);const j=[S.width,0];ft.applyTransform(j,v),C=j[0]*l+B,n.translate(C,0),s.x+=C*m}n.restore(),I&&(this.dependencyTracker=I)}setCharWidth(t,e,n){}setCharWidthAndBounds(t,e,n,s,a,l,c){const h=new Path2D;h.rect(s,a,l-s,c-a),this.ctx.clip(h),this.dependencyTracker?.recordBBox(t,this.ctx,s,l,a,c).recordClipBox(t,this.ctx,s,l,a,c),this.endPath(t)}getColorN_Pattern(t,e){let n;if(e[0]==="TilingPattern"){const s=this.baseTransform||xe(this.ctx),a={createCanvasGraphics:(l,c)=>new dc(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new hm(this.dependencyTracker,c,!0):null)};n=new zb(e,this.ctx,a,s)}else n=this._getPattern(t,e[1],e[2]);return n}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,n=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=e8(this.getObject(t,e)),this.cachedPatterns.set(e,s)),n&&(s.matrix=n),s}shadingFill(t,e){if(!this.contentVisible)return;const n=this.ctx;this.save(t);const s=this._getPattern(t,e);n.fillStyle=s.getPattern(n,this,Os(n),Cn.SHADING,t);const a=Os(n);if(a){const{width:l,height:c}=n.canvas,h=ec.slice();ft.axialAlignedBoundingBox([0,0,l,c],a,h);const[d,p,m,v]=h;this.ctx.fillRect(d,p,m-d,v-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,Mi.transform).recordDependencies(t,Mi.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){me("Should not call beginInlineImage")}beginImageData(){me("Should not call beginImageData")}paintFormXObjectBegin(t,e,n){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=xe(this.ctx),n)){ft.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[s,a,l,c]=n,h=new Path2D;h.rect(s,a,l-s,c-a),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(t,this.ctx,s,l,a,c),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;e.isolated||zm("TODO: Support non-isolated groups."),e.knockout&&Nt("Knockout groups not supported.");const s=xe(n);if(e.matrix&&n.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let a=ec.slice();ft.axialAlignedBoundingBox(e.bbox,xe(n),a);const l=[0,0,n.canvas.width,n.canvas.height];a=ft.intersect(a,l)||[0,0,0,0];const c=Math.floor(a[0]),h=Math.floor(a[1]),d=Math.max(Math.ceil(a[2])-c,1),p=Math.max(Math.ceil(a[3])-h,1);this.current.startNewPathAndClipBox([0,0,d,p]);let m="groupAt"+this.groupLevel;e.smask&&(m+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(m,d,p),b=v.context;b.translate(-c,-h),b.transform(...s);let w=new Path2D;const[E,S,C,R]=e.bbox;if(w.rect(E,S,C-E,R-S),e.matrix){const I=new Path2D;I.addPath(w,new DOMMatrix(e.matrix)),w=I}b.clip(w),e.smask&&this.smaskStack.push({canvas:v.canvas,context:b,offsetX:c,offsetY:h,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(c,h),n.save()),Wu(n,b),this.ctx=b,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=xe(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...a);const l=ec.slice();ft.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],a,l),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(t,e,n,s,a,l){if(this.#t(),lp(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const c=n[2]-n[0],h=n[3]-n[1];if(l&&this.annotationCanvasMap){s=s.slice(),s[4]-=n[0],s[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=c,n[3]=h,ft.singularValueDecompose2dScale(xe(this.ctx),pi);const{viewportScale:d}=this,p=Math.ceil(c*this.outputScaleX*d),m=Math.ceil(h*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(p,m);const{canvas:v,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(e,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.save(),this.ctx.setTransform(pi[0],0,0,-pi[1],0,h*pi[1]),lp(this.ctx)}else{lp(this.ctx),this.endPath(t);const d=new Path2D;d.rect(n[0],n[1],c,h),this.ctx.clip(d)}}this.current=new KC(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...s),this.transform(t,...a)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const n=e.count;e=this.getObject(t,e.data,e),e.count=n;const s=this.ctx,a=this._createMaskCanvas(t,e),l=a.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(l,a.offsetX,a.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,a.offsetX,a.offsetX+l.width,a.offsetY,a.offsetY+l.height).recordOperation(t),s.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n,s=0,a=0,l,c){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const h=this.ctx;h.save();const d=xe(h);h.transform(n,s,a,l,0,0);const p=this._createMaskCanvas(t,e);h.setTransform(1,0,0,1,p.offsetX-d[4],p.offsetY-d[5]),this.dependencyTracker?.resetBBox(t);for(let m=0,v=c.length;m<v;m+=2){const b=ft.transform(d,[n,s,a,l,c[m],c[m+1]]);h.drawImage(p.canvas,b[4],b[5]),this.dependencyTracker?.recordBBox(t,this.ctx,b[4],b[4]+p.canvas.width,b[5],b[5]+p.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx,s=this.current.fillColor,a=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,Mi.transformAndFill);for(const l of e){const{data:c,width:h,height:d,transform:p}=l,m=this.cachedCanvases.getCanvas("maskCanvas",h,d),v=m.context;v.save();const b=this.getObject(t,c,l);XC(v,b),v.globalCompositeOperation="source-in",v.fillStyle=a?s.getPattern(v,this,Os(n),Cn.FILL,t):s,v.fillRect(0,0,h,d),v.restore(),n.save(),n.transform(...p),n.scale(1,-1),op(n,m.canvas,0,0,h,d,0,-1,1,1),this.dependencyTracker?.recordBBox(t,n,0,h,0,d),n.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const n=this.getObject(t,e);if(!n){Nt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,n)}paintImageXObjectRepeat(t,e,n,s,a){if(!this.contentVisible)return;const l=this.getObject(t,e);if(!l){Nt("Dependent image isn't ready yet");return}const c=l.width,h=l.height,d=[];for(let p=0,m=a.length;p<m;p+=2)d.push({transform:[n,0,0,s,a[p],a[p+1]],x:0,y:0,w:c,h});this.paintInlineImageXObjectGroup(t,l,d)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:n,height:s}=t,a=this.cachedCanvases.getCanvas("inlineImage",n,s),l=a.context;return l.filter=this.current.transferMaps,l.drawImage(e,0,0),l.filter="none",a.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const n=e.width,s=e.height,a=this.ctx;this.save(t);const{filter:l}=a;l!=="none"&&l!==""&&(a.filter="none"),a.scale(1/n,-1/s);let c;if(e.bitmap)c=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)c=e;else{const p=this.cachedCanvases.getCanvas("inlineImage",n,s).context;YC(p,e),c=this.applyTransferMapsToCanvas(p)}const h=this._scaleImage(c,Os(a));a.imageSmoothingEnabled=QC(xe(a),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,a,0,n,-s,0).recordDependencies(t,Mi.imageXObject).recordOperation(t),op(a,h.img,0,0,h.paintWidth,h.paintHeight,0,-s,n,s),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,n){if(!this.contentVisible)return;const s=this.ctx;let a;if(e.bitmap)a=e.bitmap;else{const l=e.width,c=e.height,d=this.cachedCanvases.getCanvas("inlineImage",l,c).context;YC(d,e),a=this.applyTransferMapsToCanvas(d)}this.dependencyTracker?.resetBBox(t);for(const l of n)s.save(),s.transform(...l.transform),s.scale(1,-1),op(s,a,l.x,l.y,l.w,l.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,1,-1,0),s.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,Mi.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,n){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,n){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,n){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const a=this.ctx;this.pendingClip?(s||(this.pendingClip===JC?a.clip(e,"evenodd"):a.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=xe(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),s=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:n,c:s,d:a}=this.ctx.getTransform();let l,c;if(n===0&&s===0){const h=Math.abs(e),d=Math.abs(a);if(h===d)if(t===0)l=c=1/h;else{const p=h*t;l=c=p<1?1/p:1}else if(t===0)l=1/h,c=1/d;else{const p=h*t,m=d*t;l=p<1?1/p:1,c=m<1?1/m:1}}else{const h=Math.abs(e*a-n*s),d=Math.hypot(e,n),p=Math.hypot(s,a);if(t===0)l=p/h,c=d/h;else{const m=t*h;l=p>m?p/m:1,c=d>m?d/m:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:n,current:{lineWidth:s}}=this,[a,l]=this.getScaleForStroking();if(a===l){n.lineWidth=(s||1)*a,n.stroke(t);return}const c=n.getLineDash();e&&n.save(),n.scale(a,l),Ov.a=1/a,Ov.d=1/l;const h=new Path2D;if(h.addPath(t,Ov),c.length>0){const d=Math.max(a,l);n.setLineDash(c.map(p=>p/d)),n.lineDashOffset/=d}n.lineWidth=s||1,n.stroke(h),e&&n.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const i in Vh)dc.prototype[i]!==void 0&&(dc.prototype[Vh[i]]=dc.prototype[i]);class fc{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class c8{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Kl=Symbol("INTERNAL");class u8{#t=!1;#e=!1;#i=!1;#n=!0;constructor(t,{name:e,intent:n,usage:s,rbGroups:a}){this.#t=!!(t&di.DISPLAY),this.#e=!!(t&di.PRINT),this.name=e,this.intent=n,this.usage=s,this.rbGroups=a}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,n=!1){t!==Kl&&me("Internal method `_setVisible` called."),this.#i=n,this.#n=e}}class h8{#t=null;#e=new Map;#i=null;#n=null;constructor(t,e=di.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#n=t.order;for(const n of t.groups)this.#e.set(n.id,new u8(e,n));if(t.baseState==="OFF")for(const n of this.#e.values())n._setVisible(Kl,!1);for(const n of t.on)this.#e.get(n)._setVisible(Kl,!0);for(const n of t.off)this.#e.get(n)._setVisible(Kl,!1);this.#i=this.getHash()}}#a(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let s=1;s<e;s++){const a=t[s];let l;if(Array.isArray(a))l=this.#a(a);else if(this.#e.has(a))l=this.#e.get(a).visible;else return Nt(`Optional content group not found: ${a}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return zm("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(Nt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#a(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return Nt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return Nt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return Nt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return Nt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return Nt(`Unknown optional content policy ${t.policy}.`),!0}return Nt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){const s=this.#e.get(t);if(!s){Nt(`Optional content group not found: ${t}`);return}if(n&&e&&s.rbGroups.length)for(const a of s.rbGroups)for(const l of a)l!==t&&this.#e.get(l)?._setVisible(Kl,!1,!0);s._setVisible(Kl,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let n;for(const s of t){switch(s){case"ON":case"OFF":case"Toggle":n=s;continue}const a=this.#e.get(s);if(a)switch(n){case"ON":this.setVisibility(s,!0,e);break;case"OFF":this.setVisibility(s,!1,e);break;case"Toggle":this.setVisibility(s,!a.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#n?this.#n.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new YP;for(const[e,n]of this.#e)t.update(`${e}:${n.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class d8{constructor(t,{disableRange:e=!1,disableStream:n=!1}){Xt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:a,progressiveDone:l,contentDispositionFilename:c}=t;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=c,a?.length>0){const h=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,d)=>{this._onReceiveData({begin:h,chunk:d})}),t.addProgressListener((h,d)=>{this._onProgress({loaded:h,total:d})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const s=this._rangeReaders.some(function(a){return a._begin!==t?!1:(a._enqueue(n),!0)});Xt(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Xt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new f8(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new p8(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class f8{constructor(t,e,n=!1,s=null){this._stream=t,this._done=n||!1,this._filename=Lb(s)?s:null,this._queuedChunks=e||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class p8{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function m8(i){let t=!0,e=n("filename\\*","i").exec(i);if(e){e=e[1];let p=c(e);return p=unescape(p),p=h(p),p=d(p),a(p)}if(e=l(i),e){const p=d(e);return a(p)}if(e=n("filename","i").exec(i),e){e=e[1];let p=c(e);return p=d(p),a(p)}function n(p,m){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function s(p,m){if(p){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const v=new TextDecoder(p,{fatal:!0}),b=ad(m);m=v.decode(b),t=!1}catch{}}return m}function a(p){return t&&/[\x80-\xff]/.test(p)&&(p=s("utf-8",p),t&&(p=s("iso-8859-1",p))),p}function l(p){const m=[];let v;const b=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=b.exec(p))!==null;){let[,E,S,C]=v;if(E=parseInt(E,10),E in m){if(E===0)break;continue}m[E]=[S,C]}const w=[];for(let E=0;E<m.length&&E in m;++E){let[S,C]=m[E];C=c(C),S&&(C=unescape(C),E===0&&(C=h(C))),w.push(C)}return w.join("")}function c(p){if(p.startsWith('"')){const m=p.slice(1).split('\\"');for(let v=0;v<m.length;++v){const b=m[v].indexOf('"');b!==-1&&(m[v]=m[v].slice(0,b),m.length=v+1),m[v]=m[v].replaceAll(/\\(.)/g,"$1")}p=m.join('"')}return p}function h(p){const m=p.indexOf("'");if(m===-1)return p;const v=p.slice(0,m),w=p.slice(m+1).replace(/^[^']*'/,"");return s(v,w)}function d(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,v,b,w){if(b==="q"||b==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(E,S){return String.fromCharCode(parseInt(S,16))}),s(v,w);try{w=atob(w)}catch{}return s(v,w)})}return""}function n2(i,t){const e=new Headers;if(!i||!t||typeof t!="object")return e;for(const n in t){const s=t[n];s!==void 0&&e.append(n,s)}return e}function Gm(i){return URL.parse(i)?.origin??null}function i2({responseHeaders:i,isHttp:t,rangeChunkSize:e,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(i.get("Content-Length"),10);return!Number.isInteger(a)||(s.suggestedLength=a,a<=2*e)||n||!t||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function s2(i){const t=i.get("Content-Disposition");if(t){let e=m8(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Lb(e))return e}return null}function hd(i,t){return new um(`Unexpected server response (${i}) while retrieving PDF "${t}".`,i,i===404||i===0&&t.startsWith("file:"))}function r2(i){return i===200||i===206}function a2(i,t,e){return{method:"GET",headers:i,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function o2(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(Nt(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class g8{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=n2(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Xt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new y8(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new v8(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class y8{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),s=e.url;fetch(s,a2(n,this._withCredentials,this._abortController)).then(a=>{if(t._responseOrigin=Gm(a.url),!r2(a.status))throw hd(a.status,s);this._reader=a.body.getReader(),this._headersCapability.resolve();const l=a.headers,{allowRangeRequests:c,suggestedLength:h}=i2({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=h||this._contentLength,this._filename=s2(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Fa("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:o2(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class v8{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const s=t.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const a=new Headers(t.headers);a.append("Range",`bytes=${e}-${n-1}`);const l=s.url;fetch(l,a2(a,this._withCredentials,this._abortController)).then(c=>{const h=Gm(c.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!r2(c.status))throw hd(c.status,l);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:o2(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const Lv=200,Vv=206;function _8(i){const t=i.response;return typeof t!="string"?t:ad(t).buffer}class b8{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:n}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=n2(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,s=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[a,l]of this.headers)e.setRequestHeader(a,l);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.expectedStatus=Vv):s.expectedStatus=Lv,e.responseType="arraybuffer",Xt(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),s.onHeadersReceived=t.onHeadersReceived,s.onDone=t.onDone,s.onError=t.onError,s.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){const n=this.pendingRequests[t];n&&n.onProgress?.(e)}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const s=n.xhr;if(s.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),s.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],s.status===0&&this.isHttp){n.onError(s.status);return}const a=s.status||Lv;if(!(a===Lv&&n.expectedStatus===Vv)&&a!==n.expectedStatus){n.onError(s.status);return}const c=_8(s);if(a===Vv){const h=s.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);d?n.onDone({begin:parseInt(d[1],10),chunk:c}):(Nt('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(s.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class A8{constructor(t){this._source=t,this._manager=new b8(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Xt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new E8(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new w8(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class E8{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=Gm(e.responseURL);const n=e.getAllResponseHeaders(),s=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[h,...d]=c.split(": ");return[h,d.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:l}=i2({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=s2(s),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=hd(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class w8{constructor(t,e,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=Gm(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=hd(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const T8=/^[a-z][a-z0-9\-+.]+:/i;function S8(i){if(T8.test(i))return new URL(i);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(i))}class C8{constructor(t){this.source=t,this.url=S8(t.url),Xt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Xt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new x8(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new R8(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class x8{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=hd(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Fa("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class R8{constructor(t,e,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=t.source;this._isStreamingSupported=!s.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:e,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Ku=Symbol("INITIAL_DATA");class l2{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Ku}}get(t,e=null){if(e){const s=this.#e(t);return s.promise.then(()=>e(s.data)),null}const n=this.#t[t];if(!n||n.data===Ku)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=this.#t[t];return!!e&&e.data!==Ku}delete(t){const e=this.#t[t];return!e||e.data===Ku?!1:(delete this.#t[t],!0)}resolve(t,e=null){const n=this.#e(t);n.data=e,n.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==Ku&&(yield[t,e])}}}const I8=1e5,ZC=30;class fi{#t=Promise.withResolvers();#e=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#a=null;#r=null;#s=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#g=[];#m=null;#u=[];#p=new WeakMap;#y=null;static#_=new Map;static#v=new Map;static#S=new WeakMap;static#w=null;static#A=new Set;constructor({textContentSource:t,container:e,viewport:n}){if(t instanceof ReadableStream)this.#m=t;else if(typeof t=="object")this.#m=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#h=n.scale*Ys.pixelRatio,this.#d=n.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:a,pageX:l,pageY:c}=n.rawDims;this.#y=[1,0,0,-1,-l,c+a],this.#o=s,this.#s=a,fi.#I(),e.style.setProperty("--min-font-size",fi.#w),Ho(e,n),this.#t.promise.finally(()=>{fi.#A.delete(this),this.#r=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=cn.platform;return Ot(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:n})=>{if(n){this.#t.resolve();return}this.#a??=e.lang,Object.assign(this.#f,e.styles),this.#x(e.items),t()},this.#t.reject)};return this.#c=this.#m.getReader(),fi.#A.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const n=t.scale*Ys.pixelRatio,s=t.rotation;if(s!==this.#d&&(e?.(),this.#d=s,Ho(this.#l,{rotation:s})),n!==this.#h){e?.(),this.#h=n;const a={div:null,properties:null,ctx:fi.#D(this.#a)};for(const l of this.#u)a.properties=this.#p.get(l),a.div=l,this.#T(a)}}cancel(){const t=new Fa("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#g}#x(t){if(this.#i)return;this.#r.ctx??=fi.#D(this.#a);const e=this.#u,n=this.#g;for(const s of t){if(e.length>I8){Nt("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const a=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),s.id&&this.#e.setAttribute("id",`${s.id}`),a.append(this.#e)}else s.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}n.push(s.str),this.#b(s)}}#b(t){const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(e);const s=ft.transform(this.#y,t.transform);let a=Math.atan2(s[1],s[0]);const l=this.#f[t.fontName];l.vertical&&(a+=Math.PI/2);let c=this.#n&&l.fontSubstitution||l.fontFamily;c=fi.fontFamilyMap.get(c)||c;const h=Math.hypot(s[2],s[3]),d=h*fi.#V(c,l,this.#a);let p,m;a===0?(p=s[4],m=s[5]-d):(p=s[4]+d*Math.sin(a),m=s[5]-d*Math.cos(a));const v=e.style;v.left=`${(100*p/this.#o).toFixed(2)}%`,v.top=`${(100*m/this.#s).toFixed(2)}%`,v.setProperty("--font-height",`${h.toFixed(2)}px`),v.fontFamily=c,n.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#n&&(e.dataset.fontName=l.fontSubstitutionLoadedName||t.fontName),a!==0&&(n.angle=a*(180/Math.PI));let b=!1;if(t.str.length>1)b=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const w=Math.abs(t.transform[0]),E=Math.abs(t.transform[3]);w!==E&&Math.max(w,E)/Math.min(w,E)>1.5&&(b=!0)}if(b&&(n.canvasWidth=l.vertical?t.height:t.width),this.#p.set(e,n),this.#r.div=e,this.#r.properties=n,this.#T(this.#r),n.hasText&&this.#e.append(e),n.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),this.#e.append(w)}}#T(t){const{div:e,properties:n,ctx:s}=t,{style:a}=e;if(n.canvasWidth!==0&&n.hasText){const{fontFamily:l}=a,{canvasWidth:c,fontSize:h}=n;fi.#R(s,h*this.#h,l);const{width:d}=s.measureText(e.textContent);d>0&&a.setProperty("--scale-x",c*this.#h/d)}n.angle!==0&&a.setProperty("--rotate",`${n.angle}deg`)}static cleanup(){if(!(this.#A.size>0)){this.#_.clear();for(const{canvas:t}of this.#v.values())t.remove();this.#v.clear()}}static#D(t=null){let e=this.#v.get(t||="");if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#v.set(t,e),this.#S.set(e,{size:0,family:""})}return e}static#R(t,e,n){const s=this.#S.get(t);e===s.size&&n===s.family||(t.font=`${e}px ${n}`,s.size=e,s.family=n)}static#I(){if(this.#w!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#w=t.getBoundingClientRect().height,t.remove()}static#V(t,e,n){const s=this.#_.get(t);if(s)return s;const a=this.#D(n);a.canvas.width=a.canvas.height=ZC,this.#R(a,ZC,t);const l=a.measureText(""),c=l.fontBoundingBoxAscent,h=Math.abs(l.fontBoundingBoxDescent);a.canvas.width=a.canvas.height=0;let d=.8;return c?d=c/(c+h):(cn.platform.isFirefox&&Nt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?d=e.ascent:e.descent&&(d=1+e.descent)),this.#_.set(t,d),d}}const D8=100;function c2(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const t=new Hb,{docId:e}=t,n=i.url?V9(i.url):null,s=i.data?B9(i.data):null,a=i.httpHeaders||null,l=i.withCredentials===!0,c=i.password??null,h=i.range instanceof u2?i.range:null,d=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:2**16;let p=i.worker instanceof Fh?i.worker:null;const m=i.verbosity,v=typeof i.docBaseUrl=="string"&&!Hm(i.docBaseUrl)?i.docBaseUrl:null,b=ip(i.cMapUrl),w=i.cMapPacked!==!1,E=i.CMapReaderFactory||(Bn?$9:FC),S=ip(i.iccUrl),C=ip(i.standardFontDataUrl),R=i.StandardFontDataFactory||(Bn?W9:UC),I=ip(i.wasmUrl),B=i.WasmFactory||(Bn?K9:jC),F=i.stopAtErrors!==!0,j=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,P=i.isEvalSupported!==!1,D=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!Bn,M=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!Bn&&(cn.platform.isFirefox||!globalThis.chrome),V=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,O=typeof i.disableFontFace=="boolean"?i.disableFontFace:Bn,G=i.fontExtraProperties===!0,U=i.enableXfa===!0,gt=i.ownerDocument||globalThis.document,Pt=i.disableRange===!0,W=i.disableStream===!0,K=i.disableAutoFetch===!0,tt=i.pdfBug===!0,ut=i.CanvasFactory||(Bn?G9:z9),At=i.FilterFactory||(Bn?q9:H9),H=i.enableHWA===!0,et=i.useWasm!==!1,ct=h?h.length:i.length??NaN,dt=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!Bn&&!O,Et=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:!!(E===FC&&R===UC&&B===jC&&b&&C&&I&&rh(b,document.baseURI)&&rh(C,document.baseURI)&&rh(I,document.baseURI)),Tt=null;u9(m);const wt={canvasFactory:new ut({ownerDocument:gt,enableHWA:H}),filterFactory:new At({docId:e,ownerDocument:gt}),cMapReaderFactory:Et?null:new E({baseUrl:b,isCompressed:w}),standardFontDataFactory:Et?null:new R({baseUrl:C}),wasmFactory:Et?null:new B({baseUrl:I})};p||(p=Fh.create({verbosity:m,port:fc.workerPort}),t._worker=p);const ye={docId:e,apiVersion:"5.4.530",data:s,password:c,disableAutoFetch:K,rangeChunkSize:d,length:ct,docBaseUrl:v,enableXfa:U,evaluatorOptions:{maxImageSize:j,disableFontFace:O,ignoreErrors:F,isEvalSupported:P,isOffscreenCanvasSupported:D,isImageDecoderSupported:M,canvasMaxAreaInBytes:V,fontExtraProperties:G,useSystemFonts:dt,useWasm:et,useWorkerFetch:Et,cMapUrl:b,iccUrl:S,standardFontDataUrl:C,wasmUrl:I}},se={ownerDocument:gt,pdfBug:tt,styleElement:Tt,loadingParams:{disableAutoFetch:K,enableXfa:U}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Js=p.messageHandler.sendWithPromise("GetDocRequest",ye,s?[s.buffer]:null);let us;if(h)us=new d8(h,{disableRange:Pt,disableStream:W});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");const hs=rh(n)?g8:Bn?C8:A8;us=new hs({url:n,length:ct,httpHeaders:a,withCredentials:l,rangeChunkSize:d,disableRange:Pt,disableStream:W})}return Js.then(hs=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Zs=new ah(e,hs,p.port),yi=new k8(Zs,t,us,se,wt,H);t._transport=yi,Zs.send("Ready",null)})}).catch(t._capability.reject),t}class Hb{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Hb.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class u2{#t=Promise.withResolvers();#e=[];#i=[];#n=[];#a=[];constructor(t,e,n=!1,s=null){this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=s}addRangeListener(t){this.#a.push(t)}addProgressListener(t){this.#n.push(t)}addProgressiveReadListener(t){this.#i.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const n of this.#a)n(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const n of this.#n)n(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#i)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){me("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class P8{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ot(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class M8{#t=!1;constructor(t,e,n,s=!1){this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=s?new MC:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new l2,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:a=!1}={}){return new ld({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:s,dontFlip:a})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ot(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:n,intent:s="display",annotationMode:a=Aa.ENABLE,transform:l=null,background:c=null,optionalContentConfigPromise:h=null,annotationCanvasMap:d=null,pageColors:p=null,printAnnotationStorage:m=null,isEditing:v=!1,recordOperations:b=!1,operationsFilter:w=null}){this._stats?.time("Overall");const E=this._transport.getRenderingIntent(s,a,m,v),{renderingIntent:S,cacheKey:C}=E;this.#t=!1,h||=this._transport.getOptionalContentConfig(S);let R=this._intentStates.get(C);R||(R=Object.create(null),this._intentStates.set(C,R)),R.streamReaderCancelTimeout&&(clearTimeout(R.streamReaderCancelTimeout),R.streamReaderCancelTimeout=null);const I=!!(S&di.PRINT);R.displayReadyCapability||(R.displayReadyCapability=Promise.withResolvers(),R.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(E));const B=!!(this._pdfBug&&globalThis.StepperManager?.enabled),F=!this.recordedBBoxes&&(b||B),j=M=>{if(R.renderTasks.delete(P),F){const V=P.gfx?.dependencyTracker.take();V&&(P.stepper&&P.stepper.setOperatorBBoxes(V,P.gfx.dependencyTracker.takeDebugMetadata()),b&&(this.recordedBBoxes=V))}I&&(this.#t=!0),this.#e(),M?(P.capability.reject(M),this._abortOperatorList({intentState:R,reason:M instanceof Error?M:new Error(M)})):P.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},P=new nc({callback:j,params:{canvas:e,canvasContext:t,dependencyTracker:F?new X9(e,R.operatorList.length,B):null,viewport:n,transform:l,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:R.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!I,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:w});(R.renderTasks||=new Set).add(P);const D=P.task;return Promise.all([R.displayReadyCapability.promise,h]).then(([M,V])=>{if(this.destroyed){j();return}if(this._stats?.time("Rendering"),!(V.renderingIntent&S))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");P.initializeGraphics({transparency:M,optionalContentConfig:V}),P.operatorListChanged()}).catch(j),D}getOperatorList({intent:t="display",annotationMode:e=Aa.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}={}){function a(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(t,e,n,s,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=a,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>Bh.textContent(n));const e=this.streamTextContent(t);return new Promise(function(n,s){function a(){l.read().then(function({value:h,done:d}){if(d){n(c);return}c.lang??=h.lang,Object.assign(c.styles,h.styles),c.items.push(...h.items),a()},s)}const l=e.getReader(),c={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new MC),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const n=this._intentStates.get(e);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let n=0,s=t.length;n<s;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const n of e.renderTasks)n.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:s}){const{map:a,transfer:l}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:a,modifiedIds:s},l).getReader(),d=this._intentStates.get(e);d.streamReader=h;const p=()=>{h.read().then(({value:m,done:v})=>{if(v){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,d),p())},m=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const v of d.renderTasks)v.operatorListChanged();this.#e()}if(d.displayReadyCapability)d.displayReadyCapability.reject(m);else if(d.opListReadCapability)d.opListReadCapability.reject(m);else throw m}})};p()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof Ob){let s=D8;e.extraDelay>0&&e.extraDelay<1e3&&(s+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},s);return}}if(t.streamReader.cancel(new Fa(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[s,a]of this._intentStates)if(a===t){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}var Ea,es,Ar,Po,fm,Mo,ko,Hn,Dp,h2,d2,oh,pc,Pp;const Se=class Se{constructor({name:t=null,port:e=null,verbosity:n=h9()}={}){ks(this,Hn);ks(this,Ea,Promise.withResolvers());ks(this,es,null);ks(this,Ar,null);ks(this,Po,null);if(this.name=t,this.destroyed=!1,this.verbosity=n,e){if(Te(Se,ko).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Te(Se,ko).set(e,this),Ns(this,Hn,h2).call(this,e)}else Ns(this,Hn,d2).call(this)}get promise(){return Te(this,Ea).promise}get port(){return Te(this,Ar)}get messageHandler(){return Te(this,es)}destroy(){this.destroyed=!0,Te(this,Po)?.terminate(),Jn(this,Po,null),Te(Se,ko).delete(Te(this,Ar)),Jn(this,Ar,null),Te(this,es)?.destroy(),Jn(this,es,null)}static create(t){const e=Te(this,ko).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Se(t)}static get workerSrc(){if(fc.workerSrc)return fc.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ot(this,"_setupFakeWorkerGlobal",(async()=>Te(this,pc,Pp)?Te(this,pc,Pp):(await import(this.workerSrc)).WorkerMessageHandler)())}};Ea=new WeakMap,es=new WeakMap,Ar=new WeakMap,Po=new WeakMap,fm=new WeakMap,Mo=new WeakMap,ko=new WeakMap,Hn=new WeakSet,Dp=function(){Te(this,Ea).resolve(),Te(this,es).send("configure",{verbosity:this.verbosity})},h2=function(t){Jn(this,Ar,t),Jn(this,es,new ah("main","worker",t)),Te(this,es).on("ready",()=>{}),Ns(this,Hn,Dp).call(this)},d2=function(){if(Te(Se,Mo)||Te(Se,pc,Pp)){Ns(this,Hn,oh).call(this);return}let{workerSrc:t}=Se;try{Se._isSameOrigin(window.location,t)||(t=Se._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new ah("main","worker",e),s=()=>{a.abort(),n.destroy(),e.terminate(),this.destroyed?Te(this,Ea).reject(new Error("Worker was destroyed")):Ns(this,Hn,oh).call(this)},a=new AbortController;e.addEventListener("error",()=>{Te(this,Po)||s()},{signal:a.signal}),n.on("test",c=>{if(a.abort(),this.destroyed||!c){s();return}Jn(this,es,n),Jn(this,Ar,e),Jn(this,Po,e),Ns(this,Hn,Dp).call(this)}),n.on("ready",c=>{if(a.abort(),this.destroyed){s();return}try{l()}catch{Ns(this,Hn,oh).call(this)}});const l=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};l();return}catch{zm("The worker has been disabled.")}Ns(this,Hn,oh).call(this)},oh=function(){Te(Se,Mo)||(Nt("Setting up fake worker."),Jn(Se,Mo,!0)),Se._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Te(this,Ea).reject(new Error("Worker was destroyed"));return}const e=new j9;Jn(this,Ar,e);const n=`fake${yT(Se,fm)._++}`,s=new ah(n+"_worker",n,e);t.setup(s,e),Jn(this,es,new ah(n,n+"_worker",e)),Ns(this,Hn,Dp).call(this)}).catch(t=>{Te(this,Ea).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},pc=new WeakSet,Pp=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},ks(Se,pc),ks(Se,fm,0),ks(Se,Mo,!1),ks(Se,ko,new WeakMap),Bn&&(Jn(Se,Mo,!0),fc.workerSrc||="./pdf.worker.mjs"),Se._isSameOrigin=(t,e)=>{const n=URL.parse(t);if(!n?.origin||n.origin==="null")return!1;const s=new URL(e,n);return n.origin===s.origin},Se._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Se.fromPort=t=>{if(w9("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Se.create(t)};let Fh=Se;class k8{#t=new Map;#e=new Map;#i=new Map;#n=new Map;#a=null;constructor(t,e,n,s,a,l){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new l2,this.fontLoader=new N9({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.wasmFactory=a.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}#r(t,e=null){const n=this.#t.get(t);if(n)return n;const s=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,s),s}get annotationStorage(){return Ot(this,"annotationStorage",new Fb)}getRenderingIntent(t,e=Aa.ENABLE,n=null,s=!1,a=!1){let l=di.DISPLAY,c=G_;switch(t){case"any":l=di.ANY;break;case"display":break;case"print":l=di.PRINT;break;default:Nt(`getRenderingIntent - invalid intent: ${t}`)}const h=l&di.PRINT&&n instanceof XP?n:this.annotationStorage;switch(e){case Aa.DISABLE:l+=di.ANNOTATIONS_DISABLE;break;case Aa.ENABLE:break;case Aa.ENABLE_FORMS:l+=di.ANNOTATIONS_FORMS;break;case Aa.ENABLE_STORAGE:l+=di.ANNOTATIONS_STORAGE,c=h.serializable;break;default:Nt(`getRenderingIntent - invalid annotationMode: ${e}`)}s&&(l+=di.IS_EDITING),a&&(l+=di.OPLIST);const{ids:d,hash:p}=h.modifiedIds,m=[l,c.hash,p];return{renderingIntent:l,cacheKey:m.join("_"),annotationStorageSerializable:c,modifiedIds:d}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const n of this.#e.values())t.push(n._destroy());this.#e.clear(),this.#i.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),fi.cleanup(),this._networkStream?.cancelAllRequests(new Fa("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(n,s)=>{Xt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},s.onPull=()=>{this._fullReader.read().then(function({value:a,done:l}){if(l){s.close();return}Xt(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{this._fullReader.cancel(a),s.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:a,contentLength:l}=this._fullReader;return(!s||!a)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=c=>{e.onProgress?.({loaded:c.loaded,total:c.total})}),{isStreamingSupported:s,isRangeSupported:a,contentLength:l}}),t.on("GetRangeReader",(n,s)=>{Xt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(n.begin,n.end);if(!a){s.close();return}s.onPull=()=>{a.read().then(function({value:l,done:c}){if(c){s.close();return}Xt(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{s.error(l)})},s.onCancel=l=>{a.cancel(l),s.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,e._capability.resolve(new P8(n,this))}),t.on("DocException",n=>{e._capability.reject(Zn(n))}),t.on("PasswordRequest",n=>{this.#a=Promise.withResolvers();try{if(!e.onPassword)throw Zn(n);const s=a=>{a instanceof Error?this.#a.reject(a):this.#a.resolve({password:a})};e.onPassword(s,n.code)}catch(s){this.#a.reject(s)}return this.#a.promise}),t.on("DataLoaded",n=>{e.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;this.#e.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,s,a])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(s){case"Font":if("error"in a){const m=a.error;Nt(`Error during font loading: ${m}`),this.commonObjs.resolve(n,m);break}const l=new fe(a),c=this._params.pdfBug&&globalThis.FontInspector?.enabled?(m,v)=>globalThis.FontInspector.fontAdded(m,v):null,h=new O9(l,c,a.extra,a.charProcOperatorList);this.fontLoader.bind(h).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(n,h)});break;case"CopyLocalImage":const{imageRef:d}=a;Xt(d,"The imageRef must be defined.");for(const m of this.#e.values())for(const[,v]of m.objs)if(v?.ref===d)return v.dataLen?(this.commonObjs.resolve(n,structuredClone(v)),v.dataLen):null;break;case"FontPath":this.commonObjs.resolve(n,new L9(a));break;case"Image":this.commonObjs.resolve(n,a);break;case"Pattern":const p=new pn(a);this.commonObjs.resolve(n,p.getIR());break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),t.on("obj",([n,s,a,l])=>{if(this.destroyed)return;const c=this.#e.get(s);if(!c.objs.has(n)){if(c._intentStates.size===0){l?.bitmap?.close();return}switch(a){case"Image":case"Pattern":c.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${a}`)}}}),t.on("DocProgress",n=>{this.destroyed||e.onProgress?.({loaded:n.loaded,total:n.total})}),t.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[n.type];if(!s)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Nt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=this.#i.get(e);if(n)return n;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&this.#n.set(a.refStr,t);const l=new M8(e,a,this,this._params.pdfBug);return this.#e.set(e,l),l});return this.#i.set(e,s),s}getPageIndex(t){return $_(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#r("GetFieldObjects")}hasJSActions(){return this.#r("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#r("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#r("GetOptionalContentConfig").then(e=>new h8(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then(s=>({info:s[0],metadata:s[1]?new c8(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null,hasStructTree:s[2]}));return this.#t.set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),fi.cleanup()}}cachedPageNumber(t){if(!$_(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#n.get(e)??null}}class N8{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class nc{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:n,commonObjs:s,annotationCanvasMap:a,operatorList:l,pageIndex:c,canvasFactory:h,filterFactory:d,useRequestAnimationFrame:p=!1,pdfBug:m=!1,pageColors:v=null,enableHWA:b=!1,operationsFilter:w=null}){this.callback=t,this.params=e,this.objs=n,this.commonObjs=s,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=d,this._pdfBug=m,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new N8(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=b,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=w}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(nc.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");nc.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:s,background:a,dependencyTracker:l}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new dc(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:s,viewport:n,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),nc.#e.delete(this._canvas),t||=new Ob(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),nc.#e.delete(this._canvas),this.callback())))}}const f2="5.4.530",O8="50cc4adac";class Ni{#t=null;#e=null;#i;#n=null;#a=!1;#r=!1;#s=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return Ot(this,"_keyboardManager",new ud([[["Escape","mac+Escape"],Ni.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Ni.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Ni.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Ni.prototype._moveToPrevious],[["Home","mac+Home"],Ni.prototype._moveToBeginning],[["End","mac+End"],Ni.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#r=!1,this.#s=t):this.#r=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#i=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Ni.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#s&&(t.ariaControls=`${this.#s.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#m.bind(this),{signal:e}),t.addEventListener("keydown",this.#g.bind(this),{signal:e});const n=this.#e=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#i,t.append(n),t}renderMainDropdown(){const t=this.#n=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",Ui,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#s&&(t.id=`${this.#s.id}_colorpicker_dropdown`);for(const[n,s]of this.#l.highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",s),a.title=n,a.setAttribute("data-l10n-id",Ni.#d[n]);const l=document.createElement("span");a.append(l),l.className="swatch",l.style.backgroundColor=s,a.ariaSelected=s===this.#i,a.addEventListener("click",this.#f.bind(this,s),{signal:e}),t.append(a)}return t.addEventListener("keydown",this.#g.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Yt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#m(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#p){this.#m(t);return}if(t.target===this.#t){this.#n.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#n?.firstElementChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#m(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#m(t);return}this.#n.firstElementChild?.focus()}_moveToEnd(t){if(!this.#p){this.#m(t);return}this.#n.lastElementChild?.focus()}#g(t){Ni._keyboardManager.exec(this,t)}#m(t){if(this.#p){this.hideDropdown();return}if(this.#a=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const e=this.#n=this.#h();this.#t.append(e)}#u(t){this.#n?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#p){this.#s?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#n)return;const e=this.#l.highlightColors.values();for(const n of this.#n.children)n.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#n?.remove(),this.#n=null}}class Uh{#t=null;#e=null;#i=null;static#n=null;constructor(t){this.#e=t,this.#i=t._uiManager,Uh.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,color:n}=this.#e,s=this.#t=document.createElement("input");return s.type="color",s.value=n||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",Uh.#n[t]),s.addEventListener("input",()=>{this.#i.updateParams(e,s.value)},{signal:this.#i._signal}),s}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function tx(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function Yu(i){return Math.max(0,Math.min(255,255*i))}class ex{static CMYK_G([t,e,n,s]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+s)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Yu(t),[t,t,t]}static G_HTML([t]){const e=tx(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(Yu)}static RGB_HTML(t){return`#${t.map(tx).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,s]){return["RGB",1-Math.min(1,t+s),1-Math.min(1,n+s),1-Math.min(1,e+s)]}static CMYK_rgb([t,e,n,s]){return[Yu(1-Math.min(1,t+s)),Yu(1-Math.min(1,n+s)),Yu(1-Math.min(1,e+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const s=1-t,a=1-e,l=1-n,c=Math.min(s,a,l);return["CMYK",s,a,l,c]}}class L8{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width",`${t}px`),s.setAttribute("height",`${e}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${t} ${e}`),s}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){me("Abstract method `_createSVG` called.")}}class dm extends L8{_createSVG(t){return document.createElementNS(_r,t)}}const V8=9,qo=new WeakSet,B8=new Date().getTimezoneOffset()*60*1e3;class Bv{static create(t){switch(t.data.annotationType){case Qe.LINK:return new qb(t);case Qe.TEXT:return new U8(t);case Qe.WIDGET:switch(t.data.fieldType){case"Tx":return new j8(t);case"Btn":return t.data.radioButton?new p2(t):t.data.checkBox?new H8(t):new q8(t);case"Ch":return new G8(t);case"Sig":return new z8(t)}return new Zo(t);case Qe.POPUP:return new Y_(t);case Qe.FREETEXT:return new m2(t);case Qe.LINE:return new W8(t);case Qe.SQUARE:return new K8(t);case Qe.CIRCLE:return new Y8(t);case Qe.POLYLINE:return new g2(t);case Qe.CARET:return new Q8(t);case Qe.INK:return new Gb(t);case Qe.POLYGON:return new X8(t);case Qe.HIGHLIGHT:return new y2(t);case Qe.UNDERLINE:return new J8(t);case Qe.SQUIGGLY:return new Z8(t);case Qe.STRIKEOUT:return new tq(t);case Qe.STAMP:return new v2(t);case Qe.FILEATTACHMENT:return new eq(t);default:return new Ie(t)}}}class Ie{#t=null;#e=!1;#i=null;constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,e&&(this.contentElement=this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Ie._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:n,rect:s}=this.data;let a=-1/0,l=-1/0;if(e?.length>=8){for(let c=0;c<e.length;c+=8)e[c+1]>l?(l=e[c+1],a=e[c+2]):e[c+1]===l&&(a=Math.max(a,e[c+2]));return[a,l]}if(n?.length>=1){for(const c of n)for(let h=0,d=c.length;h<d;h+=2)c[h+1]>l?(l=c[h+1],a=c[h]):c[h+1]===l&&(a=Math.max(a,c[h]));if(a!==1/0)return[a,l]}return s?[s[2],s[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:n,pageHeight:s,pageX:a,pageY:l}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-a)/n,t[1]=100*(t[1]-l)/s,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${Lh}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,n={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:n})||this.annotationStorage.setValue(`${Lh}${e.id}`,{id:e.id,annotationType:e.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#i?.popup||this.popup)?.remove(),this.#i=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:n}=t;e&&this.#n(e);let s=this.#i?.popup||this.popup;!s&&n?.text&&(this._createPopup(n),s=this.#i.popup),s&&(s.updateEdited(t),n?.deleted&&(s.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#t&&(this.#n(this.#t.rect),this.#i?.popup.resetEdited(),this.#t=null)}#n(t){const{container:{style:e},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:l,pageX:c,pageY:h}}}}=this;n?.splice(0,4,...t),e.left=`${100*(t[0]-c)/a}%`,e.top=`${100*(l-t[3]+h)/l}%`,s===0?(e.width=`${100*(t[2]-t[0])/a}%`,e.height=`${100*(t[3]-t[1])/l}%`):this.setRotation(s)}_createContainer(t){const{data:e,parent:{page:n,viewport:s}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",e.id),!(this instanceof Zo)&&!(this instanceof qb)&&(a.tabIndex=0);const{style:l}=a;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(a.title=e.alternativeText),e.noRotate&&a.classList.add("norotate"),!e.rect||this instanceof Y_){const{rotation:E}=e;return!e.hasOwnCanvas&&E!==0&&this.setRotation(E,a),a}const{width:c,height:h}=this;if(!t&&e.borderStyle.width>0){l.borderWidth=`${e.borderStyle.width}px`;const E=e.borderStyle.horizontalCornerRadius,S=e.borderStyle.verticalCornerRadius;if(E>0||S>0){const R=`calc(${E}px * var(--total-scale-factor)) / calc(${S}px * var(--total-scale-factor))`;l.borderRadius=R}else if(this instanceof p2){const R=`calc(${c}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;l.borderRadius=R}switch(e.borderStyle.style){case Wl.SOLID:l.borderStyle="solid";break;case Wl.DASHED:l.borderStyle="dashed";break;case Wl.BEVELED:Nt("Unimplemented border style: beveled");break;case Wl.INSET:Nt("Unimplemented border style: inset");break;case Wl.UNDERLINE:l.borderBottomStyle="solid";break}const C=e.borderColor||null;C?(this.#e=!0,l.borderColor=ft.makeHexColor(C[0]|0,C[1]|0,C[2]|0)):l.borderWidth=0}const d=ft.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:p,pageHeight:m,pageX:v,pageY:b}=s.rawDims;l.left=`${100*(d[0]-v)/p}%`,l.top=`${100*(d[1]-b)/m}%`;const{rotation:w}=e;return e.hasOwnCanvas||w===0?(l.width=`${100*c/p}%`,l.height=`${100*h/m}%`):this.setRotation(w,a),a}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims;let{width:a,height:l}=this;t%180!==0&&([a,l]=[l,a]),e.style.width=`${100*a/n}%`,e.style.height=`${100*l/s}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,n,s)=>{const a=s.detail[e],l=a[0],c=a.slice(1);s.target.style[n]=ex[`${l}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:ex[`${l}_rgb`](c)})};return Ot(this,"_commonActions",{display:e=>{const{display:n}=e.detail,s=n%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:n===1||n===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:n}=e.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const n=e.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const s of Object.keys(e.detail))(t[s]||n[s])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[s,a]of Object.entries(e)){const l=n[s];if(l){const c={detail:{[s]:a},target:t};l(c),delete e[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,s,a]=this.data.rect.map(E=>Math.fround(E));if(t.length===8){const[E,S,C,R]=t.subarray(2,6);if(s===E&&a===S&&e===C&&n===R)return}const{style:l}=this.container;let c;if(this.#e){const{borderColor:E,borderWidth:S}=l;l.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${E}" stroke-width="${S}">`],this.container.classList.add("hasBorder")}const h=s-e,d=a-n,{svgFactory:p}=this,m=p.createElement("svg");m.classList.add("quadrilateralsContainer"),m.setAttribute("width",0),m.setAttribute("height",0),m.role="none";const v=p.createElement("defs");m.append(v);const b=p.createElement("clipPath"),w=`clippath_${this.data.id}`;b.setAttribute("id",w),b.setAttribute("clipPathUnits","objectBoundingBox"),v.append(b);for(let E=2,S=t.length;E<S;E+=8){const C=t[E],R=t[E+1],I=t[E+2],B=t[E+3],F=p.createElement("rect"),j=(I-e)/h,P=(a-R)/d,D=(C-I)/h,M=(R-B)/d;F.setAttribute("x",j),F.setAttribute("y",P),F.setAttribute("width",D),F.setAttribute("height",M),b.append(F),c?.push(`<rect vector-effect="non-scaling-stroke" x="${j}" y="${P}" width="${D}" height="${M}"/>`)}this.#e&&(c.push("</g></svg>')"),l.backgroundImage=c.join("")),this.container.append(m),this.container.style.clipPath=`url(#${w})`}_createPopup(t=null){const{data:e}=this;let n,s;t?(n={str:t.text},s=t.date):(n=e.contentsObj,s=e.modificationDate),this.#i=new Y_({data:{color:e.color,titleObj:e.titleObj,modificationDate:s,contentsObj:n,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#i}render(){me("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const s=this._fieldObjects[t];if(s)for(const{page:a,id:l,exportValues:c}of s){if(a===-1||l===e)continue;const h=typeof c=="string"?c:null,d=document.querySelector(`[data-element-id="${l}"]`);if(d&&!qo.has(d)){Nt(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:h,domElement:d})}return n}for(const s of document.getElementsByName(t)){const{exportValue:a}=s,l=s.getAttribute("data-element-id");l!==e&&qo.has(s)&&n.push({id:l,exportValue:a,domElement:s})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class F8 extends Ie{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class qb extends Ie{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,n=document.createElement("a");n.setAttribute("data-element-id",t.id);let s=!1;return t.url?(e.addLinkAttributes(n,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(n,t.action,t.overlaidText),s=!0):t.attachment?(this.#e(n,t.attachment,t.overlaidText,t.attachmentDest),s=!0):t.setOCGState?(this.#i(n,t.setOCGState,t.overlaidText),s=!0):t.dest?(this._bindLink(n,t.dest,t.overlaidText),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),s=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(n,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&(this.contentElement=n,this.container.append(n)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,n=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),n&&(t.title=n)}_bindNamedAction(t,e,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),n&&(t.title=n),this.#t()}#e(t,e,n="",s=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:n&&(t.title=n),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,s),!1),this.#t()}#i(t,e,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),n&&(t.title=n),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(e.actions)){const a=n.get(s);a&&(t[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:s}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){Nt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(t.onclick=()=>!1);return}t.onclick=()=>{n?.();const{fields:s,refs:a,include:l}=e,c=[];if(s.length!==0||a.length!==0){const p=new Set(a);for(const m of s){const v=this._fieldObjects[m]||[];for(const{id:b}of v)p.add(b)}for(const m of Object.values(this._fieldObjects))for(const v of m)p.has(v.id)===l&&c.push(v)}else for(const p of Object.values(this._fieldObjects))c.push(...p);const h=this.annotationStorage,d=[];for(const p of c){const{id:m}=p;switch(d.push(m),p.type){case"text":{const b=p.defaultValue||"";h.setValue(m,{value:b});break}case"checkbox":case"radiobutton":{const b=p.defaultValue===p.exportValues;h.setValue(m,{value:b});break}case"combobox":case"listbox":{const b=p.defaultValue||"";h.setValue(m,{value:b});break}default:continue}const v=document.querySelector(`[data-element-id="${m}"]`);if(v){if(!qo.has(v)){Nt(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}}),!1}}}class U8 extends Ie{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class Zo extends Ie{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return cn.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,s,a){n.includes("mouse")?t.addEventListener(n,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:a(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):t.addEventListener(n,l=>{if(n==="blur"){if(!e.focused||!l.relatedTarget)return;e.focused=!1}else if(n==="focus"){if(e.focused)return;e.focused=!0}a&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:a(l)}})})}_setEventListeners(t,e,n,s){for(const[a,l]of n)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,a,l,s),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":ft.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||V8,a=t.style;let l;const c=2,h=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-c),p=Math.round(d/(Dv*s))||1,m=d/p;l=Math.min(s,h(m/Dv))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-c);l=Math.min(s,h(d/Dv))}a.fontSize=`calc(${l}px * var(--total-scale-factor))`,a.color=ft.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(a.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class j8 extends Zo{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,n,s){const a=this.annotationStorage;for(const l of this._getElementsByName(t.name,t.id))l.domElement&&(l.domElement[e]=n),a.setValue(l.id,{[s]:n})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const s=t.getValue(e,{value:this.data.fieldValue});let a=s.value||"";const l=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;l&&a.length>l&&(a=a.slice(0,l));let c=s.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:a,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=c??a,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",c??a),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),qo.add(n),this.contentElement=n,n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:d,datetimeType:p,timeStep:m}=this.data,v=!!p&&this.enableScripting;d&&(n.title=d),this._setRequired(n,this.data.required),l&&(n.maxLength=l),n.addEventListener("input",w=>{t.setValue(e,{value:w.target.value}),this.setPropertyOnSiblings(n,"value",w.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",w=>{const E=this.data.defaultFieldValue??"";n.value=h.userValue=E,h.formattedValue=null});let b=w=>{const{formattedValue:E}=h;E!=null&&(w.target.value=E),w.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",E=>{if(h.focused)return;const{target:S}=E;if(v&&(S.type=p,m&&(S.step=m)),h.userValue){const C=h.userValue;if(v)if(p==="time"){const R=new Date(C),I=[R.getHours(),R.getMinutes(),R.getSeconds()];S.value=I.map(B=>B.toString().padStart(2,"0")).join(":")}else S.value=new Date(C-B8).toISOString().split(p==="date"?"T":".",1)[0];else S.value=C}h.lastCommittedValue=S.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",E=>{this.showElementAndHideCanvas(E.target);const S={value(C){h.userValue=C.detail.value??"",v||t.setValue(e,{value:h.userValue.toString()}),C.target.value=h.userValue},formattedValue(C){const{formattedValue:R}=C.detail;h.formattedValue=R,R!=null&&C.target!==document.activeElement&&(C.target.value=R);const I={formattedValue:R};v&&(I.value=R),t.setValue(e,I)},selRange(C){C.target.setSelectionRange(...C.detail.selRange)},charLimit:C=>{const{charLimit:R}=C.detail,{target:I}=C;if(R===0){I.removeAttribute("maxLength");return}I.setAttribute("maxLength",R);let B=h.userValue;!B||B.length<=R||(B=B.slice(0,R),I.value=h.userValue=B,t.setValue(e,{value:B}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:B,willCommit:!0,commitKey:1,selStart:I.selectionStart,selEnd:I.selectionEnd}}))}};this._dispatchEventFromSandbox(S,E)}),n.addEventListener("keydown",E=>{h.commitKey=1;let S=-1;if(E.key==="Escape"?S=0:E.key==="Enter"&&!this.data.multiLine?S=2:E.key==="Tab"&&(h.commitKey=3),S===-1)return;const{value:C}=E.target;h.lastCommittedValue!==C&&(h.lastCommittedValue=C,h.userValue=C,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:C,willCommit:!0,commitKey:S,selStart:E.target.selectionStart,selEnd:E.target.selectionEnd}}))});const w=b;b=null,n.addEventListener("blur",E=>{if(!h.focused||!E.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:S}=E;let{value:C}=S;if(v){if(C&&p==="time"){const R=C.split(":").map(I=>parseInt(I,10));C=new Date(2e3,0,1,R[0],R[1],R[2]||0).valueOf(),S.step=""}else C.includes("T")||(C=`${C}T00:00`),C=new Date(C).valueOf();S.type="text"}h.userValue=C,h.lastCommittedValue!==C&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:C,willCommit:!0,commitKey:h.commitKey,selStart:E.target.selectionStart,selEnd:E.target.selectionEnd}}),w(E)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",E=>{h.lastCommittedValue=null;const{data:S,target:C}=E,{value:R,selectionStart:I,selectionEnd:B}=C;let F=I,j=B;switch(E.inputType){case"deleteWordBackward":{const P=R.substring(0,I).match(/\w*[^\w]*$/);P&&(F-=P[0].length);break}case"deleteWordForward":{const P=R.substring(I).match(/^[^\w]*\w*/);P&&(j+=P[0].length);break}case"deleteContentBackward":I===B&&(F-=1);break;case"deleteContentForward":I===B&&(j+=1);break}E.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:R,change:S||"",willCommit:!1,selStart:F,selEnd:j}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],E=>E.target.value)}if(b&&n.addEventListener("blur",b),this.data.comb){const E=(this.data.rect[2]-this.data.rect[0])/l;n.classList.add("comb"),n.style.letterSpacing=`calc(${E}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class z8 extends Zo{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class H8 extends Zo{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let s=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",t.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return qo.add(a),a.setAttribute("data-element-id",n),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=e.fieldName,s&&a.setAttribute("checked",!0),a.setAttribute("exportValue",e.exportValue),a.tabIndex=0,a.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const d of this._getElementsByName(c,n)){const p=h&&d.exportValue===e.exportValue;d.domElement&&(d.domElement.checked=p),t.setValue(d.id,{value:p})}t.setValue(n,{value:h})}),a.addEventListener("resetform",l=>{const c=e.defaultFieldValue||"Off";l.target.checked=c===e.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",l=>{const c={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class p2 extends Zo{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let s=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if(typeof s=="string"&&(s=s!==e.buttonValue,t.setValue(n,{value:s})),s)for(const l of this._getElementsByName(e.fieldName,n))t.setValue(l.id,{value:!1});const a=document.createElement("input");if(qo.add(a),a.setAttribute("data-element-id",n),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=e.fieldName,s&&a.setAttribute("checked",!0),a.tabIndex=0,a.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const d of this._getElementsByName(c,n))t.setValue(d.id,{value:!1});t.setValue(n,{value:h})}),a.addEventListener("resetform",l=>{const c=e.defaultFieldValue;l.target.checked=c!=null&&c===e.buttonValue}),this.enableScripting&&this.hasJSActions){const l=e.buttonValue;a.addEventListener("updatefromsandbox",c=>{const h={value:d=>{const p=l===d.detail.value;for(const m of this._getElementsByName(d.target.name)){const v=p&&m.id===n;m.domElement&&(m.domElement.checked=v),t.setValue(m.id,{value:v})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class q8 extends qb{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}}class G8 extends Zo{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),s=document.createElement("select");qo.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",p=>{const m=this.data.defaultFieldValue;for(const v of s.options)v.selected=v.value===m});for(const p of this.data.options){const m=document.createElement("option");m.textContent=p.displayValue,m.value=p.exportValue,n.value.includes(p.exportValue)&&(m.setAttribute("selected",!0),a=!1),s.append(m)}let l=null;if(a){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),s.prepend(p),l=()=>{p.remove(),s.removeEventListener("input",l),l=null},s.addEventListener("input",l)}const c=p=>{const m=p?"value":"textContent",{options:v,multiple:b}=s;return b?Array.prototype.filter.call(v,w=>w.selected).map(w=>w[m]):v.selectedIndex===-1?null:v[v.selectedIndex][m]};let h=c(!1);const d=p=>{const m=p.target.options;return Array.prototype.map.call(m,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",p=>{const m={value(v){l?.();const b=v.detail.value,w=new Set(Array.isArray(b)?b:[b]);for(const E of s.options)E.selected=w.has(E.value);t.setValue(e,{value:c(!0)}),h=c(!1)},multipleSelection(v){s.multiple=!0},remove(v){const b=s.options,w=v.detail.remove;b[w].selected=!1,s.remove(w),b.length>0&&Array.prototype.findIndex.call(b,S=>S.selected)===-1&&(b[0].selected=!0),t.setValue(e,{value:c(!0),items:d(v)}),h=c(!1)},clear(v){for(;s.length!==0;)s.remove(0);t.setValue(e,{value:null,items:[]}),h=c(!1)},insert(v){const{index:b,displayValue:w,exportValue:E}=v.detail.insert,S=s.children[b],C=document.createElement("option");C.textContent=w,C.value=E,S?S.before(C):s.append(C),t.setValue(e,{value:c(!0),items:d(v)}),h=c(!1)},items(v){const{items:b}=v.detail;for(;s.length!==0;)s.remove(0);for(const w of b){const{displayValue:E,exportValue:S}=w,C=document.createElement("option");C.textContent=E,C.value=S,s.append(C)}s.options.length>0&&(s.options[0].selected=!0),t.setValue(e,{value:c(!0),items:d(v)}),h=c(!1)},indices(v){const b=new Set(v.detail.indices);for(const w of v.target.options)w.selected=b.has(w.index);t.setValue(e,{value:c(!0)}),h=c(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(m,p)}),s.addEventListener("input",p=>{const m=c(!0),v=c(!1);t.setValue(e,{value:m}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:v,changeEx:m,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):s.addEventListener("input",function(p){t.setValue(e,{value:c(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Y_ extends Ie{constructor(t){const{data:e,elements:n,parent:s}=t,a=!!s._commentManager;if(super(t,{isRenderable:!a&&Ie._hasPopupData(e)}),this.elements=n,a&&Ie._hasPopupData(e)){const l=this.popup=this.#t();for(const c of n)c.popup=l}else this.popup=null}#t(){return new $8({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),n=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",n.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(s=>`${tc}${s}`).join(",")),this.container}}class $8{#t=null;#e=this.#q.bind(this);#i=this.#F.bind(this);#n=this.#k.bind(this);#a=this.#E.bind(this);#r=null;#s=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#g=null;#m=null;#u=null;#p=null;#y=null;#_=null;#v=null;#S=null;#w=null;#A=null;#x=!1;#b=null;#T=null;constructor({container:t,color:e,elements:n,titleObj:s,modificationDate:a,contentsObj:l,richText:c,parent:h,rect:d,parentRect:p,open:m,commentManager:v=null}){this.#s=t,this.#w=s,this.#o=l,this.#S=c,this.#d=h,this.#r=e,this.#v=d,this.#h=p,this.#l=n,this.#t=v,this.#b=n[0],this.#c=z_.toDateObject(a),this.trigger=n.flatMap(b=>b.getElementsToTriggerPopup()),v||(this.#D(),this.#s.hidden=!0,m&&this.#E())}#D(){if(this.#m)return;this.#m=new AbortController;const{signal:t}=this.#m;for(const e of this.trigger)e.addEventListener("click",this.#a,{signal:t}),e.addEventListener("pointerenter",this.#n,{signal:t}),e.addEventListener("pointerleave",this.#i,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#e,{signal:t})}#R(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#b.container.after(this.#p);return}if(this.#y||this.#R(),!this.#y)return;const{signal:t}=this.#m=new AbortController,e=this.#b.hasOwnCommentButton,n=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},s=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},a=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#p=this.#b.container;for(const l of this.trigger)l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.addEventListener("keydown",this.#e,{signal:t}),l.addEventListener("click",n,{signal:t}),l.addEventListener("pointerenter",s,{signal:t}),l.addEventListener("pointerleave",a,{signal:t}),l.classList.add("popupTriggerArea")}else{const l=this.#p=document.createElement("button");l.className="annotationCommentButton";const c=this.#b.container;l.style.zIndex=c.style.zIndex+1,l.tabIndex=0,l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#V(),this.#I(),l.addEventListener("keydown",this.#e,{signal:t}),l.addEventListener("click",n,{signal:t}),l.addEventListener("pointerenter",s,{signal:t}),l.addEventListener("pointerleave",a,{signal:t}),c.after(l)}}#I(){if(this.#b.extraPopupElement&&!this.#b.editor)return;this.#p||this.renderCommentButton();const[t,e]=this.#y,{style:n}=this.#p;n.left=`calc(${t}%)`,n.top=`calc(${e}% - var(--comment-button-dim))`}#V(){this.#b.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#b.commentData;return t?this.#d._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:e,opacity:n,creationDate:s,modificationDate:a}=this.#b.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:n,creationDate:s,modificationDate:a}}get elementBeforePopup(){return this.#p}get comment(){return this.#T||=this.#b.commentText,this.#T}set comment(t){t!==this.comment&&(this.#b.commentText=this.#T=t)}focus(){this.#b.container?.focus()}get parentBoundingClientRect(){return this.#b.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=e)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#_)return this.#_;const{x:t,y:e,height:n}=this.#p.getBoundingClientRect(),{x:s,y:a,width:l,height:c}=this.#b.layer.getBoundingClientRect();return[(t-s)/l,(e+n-a)/c]}set commentPopupPosition(t){this.#_=t}hasDefaultPopupPosition(){return this.#_===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,n]=this.#_||this.commentButtonPosition.map(d=>d/100),s=this.parentBoundingClientRect,{x:a,y:l,width:c,height:h}=s;this.#t.showDialog(null,this,a+e*c,l+n*h,{...t,parentDimensions:s})}render(){if(this.#g)return;const t=this.#g=document.createElement("div");if(t.className="popup",this.#r){const n=t.style.outlineColor=ft.makeHexColor(...this.#r);t.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#w?.str){const n=document.createElement("span");n.className="title",e.append(n),{dir:n.dir,str:n.textContent}=this.#w}if(t.append(e),this.#c){const n=document.createElement("time");n.className="popupDate",n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),n.dateTime=this.#c.toISOString(),e.append(n)}$P({html:this.#M||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#s.append(t)}get#M(){const t=this.#S,e=this.#o;return t?.str&&(!e?.str||e.str===t.str)&&this.#S.html||null}get#N(){return this.#M?.attributes?.style?.fontSize||0}get#B(){return this.#M?.attributes?.style?.color||null}#O(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},s={style:{color:this.#B,fontSize:this.#N?`calc(${this.#N}px * var(--total-scale-factor))`:""}};for(const a of t.split(`
`))e.push({name:"span",value:a,attributes:s});return n}#q(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#E()}updateEdited({rect:t,popup:e,deleted:n}){if(this.#t){n?(this.remove(),this.#T=null):e&&(e.deleted?this.remove():(this.#V(),this.#T=e.text)),t&&(this.#y=null,this.#R(),this.#I());return}if(n||e?.deleted){this.remove();return}this.#D(),this.#A||={contentsObj:this.#o,richText:this.#S},t&&(this.#u=null),e&&e.text&&(this.#S=this.#O(e.text),this.#c=z_.toDateObject(e.date),this.#o=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#A&&({contentsObj:this.#o,richText:this.#S}=this.#A,this.#A=null,this.#g?.remove(),this.#g=null,this.#u=null)}remove(){if(this.#m?.abort(),this.#m=null,this.#g?.remove(),this.#g=null,this.#x=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#C(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:s,pageY:a}}}=this.#d;let l=!!this.#h,c=l?this.#h:this.#v;for(const w of this.#l)if(!c||ft.intersect(w.data.rect,c)!==null){c=w.data.rect,l=!0;break}const h=ft.normalizeRect([c[0],t[3]-c[1]+t[1],c[2],t[3]-c[3]+t[1]]),p=l?c[2]-c[0]+5:0,m=h[0]+p,v=h[1];this.#u=[100*(m-s)/e,100*(v-a)/n];const{style:b}=this.#s;b.left=`${this.#u[0]}%`,b.top=`${this.#u[1]}%`}#E(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#k(),this.#s.addEventListener("click",this.#a),this.#s.addEventListener("keydown",this.#e)):(this.#F(),this.#s.removeEventListener("click",this.#a),this.#s.removeEventListener("keydown",this.#e))}#k(){this.#g||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#C(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#F(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#x=this.isVisible,this.#x&&(this.#s.hidden=!0)}maybeShow(){this.#t||(this.#D(),this.#x&&(this.#g||this.#k(),this.#x=!1,this.#s.hidden=!1))}get isVisible(){return this.#t?!1:this.#s.hidden===!1}}class m2 extends Ie{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Vt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class W8 extends Ie{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:n}=this,s=this.svgFactory.create(e,n,!0),a=this.#t=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class K8 extends Ie{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:n}=this,s=this.svgFactory.create(e,n,!0),a=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",a/2),l.setAttribute("y",a/2),l.setAttribute("width",e-a),l.setAttribute("height",n-a),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Y8 extends Ie{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:n}=this,s=this.svgFactory.create(e,n,!0),a=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",e/2),l.setAttribute("cy",n/2),l.setAttribute("rx",e/2-a/2),l.setAttribute("ry",n/2-a/2),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class g2 extends Ie{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:n,popupRef:s},width:a,height:l}=this;if(!e)return this.container;const c=this.svgFactory.create(a,l,!0);let h=[];for(let p=0,m=e.length;p<m;p+=2){const v=e[p]-t[0],b=t[3]-e[p+1];h.push(`${v},${b}`)}h=h.join(" ");const d=this.#t=this.svgFactory.createElement(this.svgElementName);return d.setAttribute("points",h),d.setAttribute("stroke-width",n.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),c.append(d),this.container.append(c),!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class X8 extends g2{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Q8 extends Ie{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class Gb extends Ie{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Vt.HIGHLIGHT:Vt.INK}#i(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:n,borderStyle:s,popupRef:a}}=this,{transform:l,width:c,height:h}=this.#i(e,t),d=this.svgFactory.create(c,h,!0),p=this.#t=this.svgFactory.createElement("svg:g");d.append(p),p.setAttribute("stroke-width",s.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",l);for(let m=0,v=n.length;m<v;m++){const b=this.svgFactory.createElement(this.svgElementName);this.#e.push(b),b.setAttribute("points",n[m].join(",")),p.append(b)}return!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:n,rect:s}=t,a=this.#t;if(e>=0&&a.setAttribute("stroke-width",e||1),n)for(let l=0,c=this.#e.length;l<c;l++)this.#e[l].setAttribute("points",n[l].join(","));if(s){const{transform:l,width:c,height:h}=this.#i(this.data.rotation,s);a.parentElement.setAttribute("viewBox",`0 0 ${c} ${h}`),a.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class y2 extends Ie{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Vt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class J8 extends Ie{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class Z8 extends Ie{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class tq extends Ie{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class v2 extends Ie{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Vt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class eq extends Ie{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let n;e.hasAppearance||e.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#e.bind(this)),this.#t=n;const{isMac:s}=cn.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(s?a.metaKey:a.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):n.classList.add("popupTriggerArea"),t.append(n),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class $b{#t=null;#e=null;#i=null;#n=new Map;#a=null;#r=null;#s=[];#o=!1;constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:s,page:a,viewport:l,structTreeLayer:c,commentManager:h,linkService:d,annotationStorage:p}){this.div=t,this.#t=e,this.#e=n,this.#a=c||null,this.#r=d||null,this.#i=p||new Fb,this.page=a,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=h||null}hasEditableAnnotations(){return this.#n.size>0}async render(t){const{annotations:e}=t,n=this.div;Ho(n,this.viewport);const s=new Map,a=[],l={data:null,layer:n,linkService:this.#r,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new dm,annotationStorage:this.#i,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const c of e){if(c.noHTML)continue;const h=c.annotationType===Qe.POPUP;if(h){const m=s.get(c.id);if(!m)continue;if(!this._commentManager){a.push(c);continue}l.elements=m}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;l.data=c;const d=Bv.create(l);if(!d.isRenderable)continue;if(!h&&(this.#s.push(d),c.popupRef)){const m=s.get(c.popupRef);m?m.push(d):s.set(c.popupRef,[d])}const p=d.render();c.hidden&&(p.style.visibility="hidden"),d._isEditable&&(this.#n.set(d.data.id,d),this._annotationEditorUIManager?.renderAnnotationElement(d))}await this.#c();for(const c of a){const h=l.elements=s.get(c.id);l.data=c;const d=Bv.create(l);if(!d.isRenderable)continue;const p=d.render();d.contentElement.id=`${tc}${c.id}`,c.hidden&&(p.style.visibility="hidden"),h.at(-1).container.after(p)}this.#l()}async#c(){if(this.#s.length===0)return;this.div.replaceChildren();const t=[];if(!this.#o){this.#o=!0;for(const{contentElement:n,data:{id:s}}of this.#s){const a=n.id=`${tc}${s}`;t.push(this.#a?.getAriaAttributes(a).then(l=>{if(l)for(const[c,h]of l)n.setAttribute(c,h)}))}}this.#s.sort(({data:{rect:[n,s,a,l]}},{data:{rect:[c,h,d,p]}})=>{if(n===a&&s===l)return 1;if(c===d&&h===p)return-1;const m=l,v=s,b=(s+l)/2,w=p,E=h,S=(h+p)/2;if(b>=w&&S<=v)return-1;if(S>=m&&b<=E)return 1;const C=(n+a)/2,R=(c+d)/2;return C-R});const e=document.createDocumentFragment();for(const n of this.#s)e.append(n.container),this._commentManager?(n.extraPopupElement?.popup||n.popup)?.renderCommentButton():n.extraPopupElement&&e.append(n.extraPopupElement.render());if(this.div.append(e),await Promise.all(t),this.#t)for(const n of this.#s)this.#t.addPointerInTextLayer(n.contentElement,!1)}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#r,svgFactory:new dm,parent:this};for(const n of t){n.borderStyle||=$b._defaultBorderStyle,e.data=n;const s=Bv.create(e);s.isRenderable&&(s.render(),s.contentElement.id=`${tc}${n.id}`,this.#s.push(s))}await this.#c()}update({viewport:t}){const e=this.div;this.viewport=t,Ho(e,{rotation:t.rotation}),this.#l(),e.hidden=!1}#l(){if(!this.#e)return;const t=this.div;for(const[e,n]of this.#e){const s=t.querySelector(`[data-annotation-id="${e}"]`);if(!s)continue;n.className="annotationContent";const{firstChild:a}=s;a?a.nodeName==="CANVAS"?a.replaceWith(n):a.classList.contains("annotationContent")?a.after(n):a.before(n):s.append(n);const l=this.#n.get(e);l&&(l._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,s.id,n),l._hasNoCanvas=!1):l.canvas=n)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:n,rotation:s}=t,a=new F8({data:{id:n,rect:t.getPDFRect(),rotation:s},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#r,annotationStorage:this.#i});return a.render(),a.contentElement.id=`${tc}${n}`,a.createOrUpdatePopup(),this.#s.push(a),a}removeAnnotation(t){const e=this.#s.findIndex(s=>s.data.id===t);if(e<0)return;const[n]=this.#s.splice(e,1);this.#t?.removePointerInTextLayer(n.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const e of t)e.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return Ot(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Wl.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const cp=/\r\n?|\n/g;class mn extends Ct{#t="";#e=`${this.id}-editor`;#i=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=mn.prototype,e=a=>a.isEmpty(),n=Ua.TRANSLATE_SMALL,s=Ua.TRANSLATE_BIG;return Ot(this,"_keyboardManager",new ud([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:e}]]))}static _type="freetext";static _editorType=Vt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||mn._defaultColor||Ct._defaultLineColor,this.#n=t.fontSize||mn._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,e){Ct.initialize(t,e);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case Yt.FREETEXT_SIZE:mn._defaultFontSize=e;break;case Yt.FREETEXT_COLOR:mn._defaultColor=e;break}}updateParams(t,e){switch(t){case Yt.FREETEXT_SIZE:this.#a(e);break;case Yt.FREETEXT_COLOR:this.#r(e);break}}static get defaultPropertiesToUpdate(){return[[Yt.FREETEXT_SIZE,mn._defaultFontSize],[Yt.FREETEXT_COLOR,mn._defaultColor||Ct._defaultLineColor]]}get propertiesToUpdate(){return[[Yt.FREETEXT_SIZE,this.#n],[Yt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Uh(this),[["colorPicker",this._colorPicker]]}get colorType(){return Yt.FREETEXT_COLOR}#a(t){const e=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-this.#n)*this.parentScale),this.#n=s,this.#o()},n=this.#n;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Yt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#r(t){const e=s=>{this.color=s,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Yt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-mn._internalPadding*t,-(mn._internalPadding+this.#n)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#s(){const t=[];this.editorDiv.normalize();let e=null;for(const n of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(t.push(mn.#c(n)),e=n);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:s,div:a}=this,l=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",s.div.append(this.div),n=a.getBoundingClientRect(),a.remove(),a.style.display=l,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=n.width/t,this.height=n.height/e):(this.width=n.height/t,this.height=n.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#s().trimEnd();if(t===e)return;const n=s=>{if(this.#t=s,!s){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{n(e)},undo:()=>{n(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){mn._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,a]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[c,h]=this.getInitialTranslation();[c,h]=this.pageTranslationToScreen(c,h);const[d,p]=this.pageDimensions,[m,v]=this.pageTranslation;let b,w;switch(this.rotation){case 0:b=t+(l[0]-m)/d,w=e+this.height-(l[1]-v)/p;break;case 90:b=t+(l[0]-m)/d,w=e-(l[1]-v)/p,[c,h]=[h,-c];break;case 180:b=t-this.width+(l[0]-m)/d,w=e-(l[1]-v)/p,[c,h]=[-c,-h];break;case 270:b=t+(l[0]-m-this.height*p)/d,w=e+(l[1]-v-this.width*d)/p,[c,h]=[-h,c];break}this.setAt(b*s,w*a,c,h)}else this._moveAfterPaste(t,e);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(cp,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:n}=e;if(n.length===1&&n[0]==="text/plain")return;t.preventDefault();const s=mn.#h(e.getData("text")||"").replaceAll(cp,`
`);if(!s)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const l=a.getRangeAt(0);if(!s.includes(`
`)){l.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:h}=l,d=[],p=[];if(c.nodeType===Node.TEXT_NODE){const b=c.parentElement;if(p.push(c.nodeValue.slice(h).replaceAll(cp,"")),b!==this.editorDiv){let w=d;for(const E of this.editorDiv.childNodes){if(E===b){w=p;continue}w.push(mn.#c(E))}}d.push(c.nodeValue.slice(0,h).replaceAll(cp,""))}else if(c===this.editorDiv){let b=d,w=0;for(const E of this.editorDiv.childNodes)w++===h&&(b=p),b.push(mn.#c(E))}this.#t=`${d.join(`
`)}${s}${p.join(`
`)}`,this.#l();const m=new Range;let v=Math.sumPrecise(d.map(b=>b.length));for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const w=b.nodeValue.length;if(v<=w){m.setStart(b,v),m.setEnd(b,v);break}v-=w}a.removeAllRanges(),a.addRange(m)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=mn._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,n){let s=null;if(t instanceof m2){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:h,rotation:d,id:p,popupRef:m,richText:v,contentsObj:b,creationDate:w,modificationDate:E},textContent:S,textPosition:C,parent:{page:{pageNumber:R}}}=t;if(!S||S.length===0)return null;s=t={annotationType:Vt.FREETEXT,color:Array.from(c),fontSize:l,value:S.join(`
`),position:C,pageIndex:R-1,rect:h.slice(0),rotation:d,annotationElementId:p,id:p,deleted:!1,popupRef:m,comment:b?.str||null,richText:v,creationDate:w,modificationDate:E}}const a=await super.deserialize(t,e,n);return a.#n=t.fontSize,a.color=ft.makeHexColor(...t.color),a.#t=mn.#h(t.value),a._initialData=s,t.comment&&a.setCommentData(t),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=Ct._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(t),{color:e,fontSize:this.#n,value:this.#d()});return this.addComment(n),t?(n.isCopy=!0,n):this.annotationElementId&&!this.#f(n)?null:(n.id=this.annotationElementId,n)}#f(t){const{value:e,fontSize:n,color:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==n||t.color.some((l,c)=>l!==s[c])||t.pageIndex!==a}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:n}=e;n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,e.replaceChildren();for(const s of this.#t.split(`
`)){const a=document.createElement("div");a.append(s?document.createTextNode(s):document.createElement("br")),e.append(a)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class yt{static PRECISION=1e-4;toSVGPath(){me("Abstract method `toSVGPath` must be implemented.")}get box(){me("Abstract getter `box` must be implemented.")}serialize(t,e){me("Abstract method `serialize` must be implemented.")}static _rescale(t,e,n,s,a,l){l||=new Float32Array(t.length);for(let c=0,h=t.length;c<h;c+=2)l[c]=e+t[c]*s,l[c+1]=n+t[c+1]*a;return l}static _rescaleAndSwap(t,e,n,s,a,l){l||=new Float32Array(t.length);for(let c=0,h=t.length;c<h;c+=2)l[c]=e+t[c+1]*s,l[c+1]=n+t[c]*a;return l}static _translate(t,e,n,s){s||=new Float32Array(t.length);for(let a=0,l=t.length;a<l;a+=2)s[a]=e+t[a],s[a+1]=n+t[a+1];return s}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,n,s,a){switch(a){case 90:return[1-e/n,t/s];case 180:return[1-t/n,1-e/s];case 270:return[e/n,1-t/s];default:return[t/n,e/s]}}static _normalizePagePoint(t,e,n){switch(n){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,n,s,a,l){return[(t+5*n)/6,(e+5*s)/6,(5*n+a)/6,(5*s+l)/6,(n+a)/2,(s+l)/2]}}class Do{#t;#e=[];#i;#n;#a=[];#r=new Float32Array(18);#s;#o;#c;#l;#d;#h;#f=[];static#g=8;static#m=2;static#u=Do.#g+Do.#m;constructor({x:t,y:e},n,s,a,l,c=0){this.#t=n,this.#h=a*s,this.#n=l,this.#r.set([NaN,NaN,NaN,NaN,t,e],6),this.#i=c,this.#l=Do.#g*s,this.#c=Do.#u*s,this.#d=s,this.#f.push(t,e)}isEmpty(){return isNaN(this.#r[8])}#p(){const t=this.#r.subarray(4,6),e=this.#r.subarray(16,18),[n,s,a,l]=this.#t;return[(this.#s+(t[0]-e[0])/2-n)/a,(this.#o+(t[1]-e[1])/2-s)/l,(this.#s+(e[0]-t[0])/2-n)/a,(this.#o+(e[1]-t[1])/2-s)/l]}add({x:t,y:e}){this.#s=t,this.#o=e;const[n,s,a,l]=this.#t;let[c,h,d,p]=this.#r.subarray(8,12);const m=t-d,v=e-p,b=Math.hypot(m,v);if(b<this.#c)return!1;const w=b-this.#l,E=w/b,S=E*m,C=E*v;let R=c,I=h;c=d,h=p,d+=S,p+=C,this.#f?.push(t,e);const B=-C/w,F=S/w,j=B*this.#h,P=F*this.#h;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([d+j,p+P],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([d-j,p-P],16),isNaN(this.#r[6])?(this.#a.length===0&&(this.#r.set([c+j,h+P],2),this.#a.push(NaN,NaN,NaN,NaN,(c+j-n)/a,(h+P-s)/l),this.#r.set([c-j,h-P],14),this.#e.push(NaN,NaN,NaN,NaN,(c-j-n)/a,(h-P-s)/l)),this.#r.set([R,I,c,h,d,p],6),!this.isEmpty()):(this.#r.set([R,I,c,h,d,p],6),Math.abs(Math.atan2(I-h,R-c)-Math.atan2(C,S))<Math.PI/2?([c,h,d,p]=this.#r.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((c+d)/2-n)/a,((h+p)/2-s)/l),[c,h,R,I]=this.#r.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((R+c)/2-n)/a,((I+h)/2-s)/l),!0):([R,I,c,h,d,p]=this.#r.subarray(0,6),this.#a.push(((R+5*c)/6-n)/a,((I+5*h)/6-s)/l,((5*c+d)/6-n)/a,((5*h+p)/6-s)/l,((c+d)/2-n)/a,((h+p)/2-s)/l),[d,p,c,h,R,I]=this.#r.subarray(12,18),this.#e.push(((R+5*c)/6-n)/a,((I+5*h)/6-s)/l,((5*c+d)/6-n)/a,((5*h+p)/6-s)/l,((c+d)/2-n)/a,((h+p)/2-s)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#a,e=this.#e;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#y();const n=[];n.push(`M${t[4]} ${t[5]}`);for(let s=6;s<t.length;s+=6)isNaN(t[s])?n.push(`L${t[s+4]} ${t[s+5]}`):n.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);this.#v(n);for(let s=e.length-6;s>=6;s-=6)isNaN(e[s])?n.push(`L${e[s+4]} ${e[s+5]}`):n.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);return this.#_(n),n.join(" ")}#y(){const[t,e,n,s]=this.#t,[a,l,c,h]=this.#p();return`M${(this.#r[2]-t)/n} ${(this.#r[3]-e)/s} L${(this.#r[4]-t)/n} ${(this.#r[5]-e)/s} L${a} ${l} L${c} ${h} L${(this.#r[16]-t)/n} ${(this.#r[17]-e)/s} L${(this.#r[14]-t)/n} ${(this.#r[15]-e)/s} Z`}#_(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#v(t){const[e,n,s,a]=this.#t,l=this.#r.subarray(4,6),c=this.#r.subarray(16,18),[h,d,p,m]=this.#p();t.push(`L${(l[0]-e)/s} ${(l[1]-n)/a} L${h} ${d} L${p} ${m} L${(c[0]-e)/s} ${(c[1]-n)/a}`)}newFreeDrawOutline(t,e,n,s,a,l){return new _2(t,e,n,s,a,l)}getOutlines(){const t=this.#a,e=this.#e,n=this.#r,[s,a,l,c]=this.#t,h=new Float32Array((this.#f?.length??0)+2);for(let m=0,v=h.length-2;m<v;m+=2)h[m]=(this.#f[m]-s)/l,h[m+1]=(this.#f[m+1]-a)/c;if(h[h.length-2]=(this.#s-s)/l,h[h.length-1]=(this.#o-a)/c,isNaN(n[6])&&!this.isEmpty())return this.#S(h);const d=new Float32Array(this.#a.length+24+this.#e.length);let p=t.length;for(let m=0;m<p;m+=2){if(isNaN(t[m])){d[m]=d[m+1]=NaN;continue}d[m]=t[m],d[m+1]=t[m+1]}p=this.#A(d,p);for(let m=e.length-6;m>=6;m-=6)for(let v=0;v<6;v+=2){if(isNaN(e[m+v])){d[p]=d[p+1]=NaN,p+=2;continue}d[p]=e[m+v],d[p+1]=e[m+v+1],p+=2}return this.#w(d,p),this.newFreeDrawOutline(d,h,this.#t,this.#d,this.#i,this.#n)}#S(t){const e=this.#r,[n,s,a,l]=this.#t,[c,h,d,p]=this.#p(),m=new Float32Array(36);return m.set([NaN,NaN,NaN,NaN,(e[2]-n)/a,(e[3]-s)/l,NaN,NaN,NaN,NaN,(e[4]-n)/a,(e[5]-s)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,(e[16]-n)/a,(e[17]-s)/l,NaN,NaN,NaN,NaN,(e[14]-n)/a,(e[15]-s)/l],0),this.newFreeDrawOutline(m,t,this.#t,this.#d,this.#i,this.#n)}#w(t,e){const n=this.#e;return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+=6}#A(t,e){const n=this.#r.subarray(4,6),s=this.#r.subarray(16,18),[a,l,c,h]=this.#t,[d,p,m,v]=this.#p();return t.set([NaN,NaN,NaN,NaN,(n[0]-a)/c,(n[1]-l)/h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,m,v,NaN,NaN,NaN,NaN,(s[0]-a)/c,(s[1]-l)/h],e),e+=24}}class _2 extends yt{#t;#e=new Float32Array(4);#i;#n;#a;#r;#s;constructor(t,e,n,s,a,l){super(),this.#s=t,this.#a=e,this.#t=n,this.#r=s,this.#i=a,this.#n=l,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(l);const[c,h,d,p]=this.#e;for(let m=0,v=t.length;m<v;m+=2)t[m]=(t[m]-c)/d,t[m+1]=(t[m+1]-h)/p;for(let m=0,v=e.length;m<v;m+=2)e[m]=(e[m]-c)/d,e[m+1]=(e[m+1]-h)/p}toSVGPath(){const t=[`M${this.#s[4]} ${this.#s[5]}`];for(let e=6,n=this.#s.length;e<n;e+=6){if(isNaN(this.#s[e])){t.push(`L${this.#s[e+4]} ${this.#s[e+5]}`);continue}t.push(`C${this.#s[e]} ${this.#s[e+1]} ${this.#s[e+2]} ${this.#s[e+3]} ${this.#s[e+4]} ${this.#s[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,n,s],a){const l=n-t,c=s-e;let h,d;switch(a){case 0:h=yt._rescale(this.#s,t,s,l,-c),d=yt._rescale(this.#a,t,s,l,-c);break;case 90:h=yt._rescaleAndSwap(this.#s,t,e,l,c),d=yt._rescaleAndSwap(this.#a,t,e,l,c);break;case 180:h=yt._rescale(this.#s,n,e,-l,c),d=yt._rescale(this.#a,n,e,-l,c);break;case 270:h=yt._rescaleAndSwap(this.#s,n,s,-l,-c),d=yt._rescaleAndSwap(this.#a,n,s,-l,-c);break}return{outline:Array.from(h),points:[Array.from(d)]}}#o(t){const e=this.#s;let n=e[4],s=e[5];const a=[n,s,n,s];let l=n,c=s,h=n,d=s;const p=t?Math.max:Math.min,m=new Float32Array(4);for(let b=6,w=e.length;b<w;b+=6){const E=e[b+4],S=e[b+5];isNaN(e[b])?(ft.pointBoundingBox(E,S,a),c>S?(l=E,c=S):c===S&&(l=p(l,E)),d<S?(h=E,d=S):d===S&&(h=p(h,E))):(m[0]=m[1]=1/0,m[2]=m[3]=-1/0,ft.bezierBoundingBox(n,s,...e.slice(b,b+6),m),ft.rectBoundingBox(m[0],m[1],m[2],m[3],a),c>m[1]?(l=m[0],c=m[1]):c===m[1]&&(l=p(l,m[0])),d<m[3]?(h=m[2],d=m[3]):d===m[3]&&(h=p(h,m[2]))),n=E,s=S}const v=this.#e;v[0]=a[0]-this.#i,v[1]=a[1]-this.#i,v[2]=a[2]-a[0]+2*this.#i,v[3]=a[3]-a[1]+2*this.#i,this.firstPoint=[l,c],this.lastPoint=[h,d]}get box(){return this.#e}newOutliner(t,e,n,s,a,l=0){return new Do(t,e,n,s,a,l)}getNewOutline(t,e){const[n,s,a,l]=this.#e,[c,h,d,p]=this.#t,m=a*d,v=l*p,b=n*d+c,w=s*p+h,E=this.newOutliner({x:this.#a[0]*m+b,y:this.#a[1]*v+w},this.#t,this.#r,t,this.#n,e??this.#i);for(let S=2;S<this.#a.length;S+=2)E.add({x:this.#a[S]*m+b,y:this.#a[S+1]*v+w});return E.getOutlines()}}class X_{#t;#e;#i;#n=[];#a=[];constructor(t,e=0,n=0,s=!0){const a=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:E,y:S,width:C,height:R}of t){const I=Math.floor((E-e)/l)*l,B=Math.ceil((E+C+e)/l)*l,F=Math.floor((S-e)/l)*l,j=Math.ceil((S+R+e)/l)*l,P=[I,F,j,!0],D=[B,F,j,!1];this.#n.push(P,D),ft.rectBoundingBox(I,F,B,j,a)}const c=a[2]-a[0]+2*n,h=a[3]-a[1]+2*n,d=a[0]-n,p=a[1]-n;let m=s?-1/0:1/0,v=1/0;const b=this.#n.at(s?-1:-2),w=[b[0],b[2]];for(const E of this.#n){const[S,C,R,I]=E;!I&&s?C<v?(v=C,m=S):C===v&&(m=Math.max(m,S)):I&&!s&&(C<v?(v=C,m=S):C===v&&(m=Math.min(m,S))),E[0]=(S-d)/c,E[1]=(C-p)/h,E[2]=(R-p)/h}this.#t=new Float32Array([d,p,c,h]),this.#e=[m,v],this.#i=w}getOutlines(){this.#n.sort((e,n)=>e[0]-n[0]||e[1]-n[1]||e[2]-n[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#l(e)),this.#o(e)):(this.#c(e),t.push(...this.#l(e)));return this.#r(t)}#r(t){const e=[],n=new Set;for(const l of t){const[c,h,d]=l;e.push([c,h,l],[c,d,l])}e.sort((l,c)=>l[1]-c[1]||l[0]-c[0]);for(let l=0,c=e.length;l<c;l+=2){const h=e[l][2],d=e[l+1][2];h.push(d),d.push(h),n.add(h),n.add(d)}const s=[];let a;for(;n.size>0;){const l=n.values().next().value;let[c,h,d,p,m]=l;n.delete(l);let v=c,b=h;for(a=[c,d],s.push(a);;){let w;if(n.has(p))w=p;else if(n.has(m))w=m;else break;n.delete(w),[c,h,d,p,m]=w,v!==c&&(a.push(v,b,c,b===h?h:d),v=c),b=b===h?d:h}a.push(v,b)}return new nq(s,this.#t,this.#e,this.#i)}#s(t){const e=this.#a;let n=0,s=e.length-1;for(;n<=s;){const a=n+s>>1,l=e[a][0];if(l===t)return a;l<t?n=a+1:s=a-1}return s+1}#o([,t,e]){const n=this.#s(t);this.#a.splice(n,0,[t,e])}#c([,t,e]){const n=this.#s(t);for(let s=n;s<this.#a.length;s++){const[a,l]=this.#a[s];if(a!==t)break;if(a===t&&l===e){this.#a.splice(s,1);return}}for(let s=n-1;s>=0;s--){const[a,l]=this.#a[s];if(a!==t)break;if(a===t&&l===e){this.#a.splice(s,1);return}}}#l(t){const[e,n,s]=t,a=[[e,n,s]],l=this.#s(s);for(let c=0;c<l;c++){const[h,d]=this.#a[c];for(let p=0,m=a.length;p<m;p++){const[,v,b]=a[p];if(!(d<=v||b<=h)){if(v>=h){if(b>d)a[p][1]=d;else{if(m===1)return[];a.splice(p,1),p--,m--}continue}a[p][2]=h,b>d&&a.push([e,d,b])}}}return a}}class nq extends yt{#t;#e;constructor(t,e,n,s){super(),this.#e=t,this.#t=e,this.firstPoint=n,this.lastPoint=s}toSVGPath(){const t=[];for(const e of this.#e){let[n,s]=e;t.push(`M${n} ${s}`);for(let a=2;a<e.length;a+=2){const l=e[a],c=e[a+1];l===n?(t.push(`V${c}`),s=c):c===s&&(t.push(`H${l}`),n=l)}t.push("Z")}return t.join(" ")}serialize([t,e,n,s],a){const l=[],c=n-t,h=s-e;for(const d of this.#e){const p=new Array(d.length);for(let m=0;m<d.length;m+=2)p[m]=t+d[m]*c,p[m+1]=s-d[m+1]*h;l.push(p)}return l}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class Q_ extends Do{newFreeDrawOutline(t,e,n,s,a,l){return new iq(t,e,n,s,a,l)}}class iq extends _2{newOutliner(t,e,n,s,a,l=0){return new Q_(t,e,n,s,a,l)}}class Fe extends Ct{#t=null;#e=0;#i;#n=null;#a=null;#r=null;#s=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#g=null;#m=null;#u="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Vt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=Fe.prototype;return Ot(this,"_keyboardManager",new ud([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||Fe._defaultColor,this.#p=t.thickness||Fe._defaultThickness,this.opacity=t.opacity||Fe._defaultOpacity,this.#i=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#v(t),this.#b()):this.#i&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#s=t.focusNode,this.#o=t.focusOffset,this.#_(),this.#b(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#_(){const t=new X_(this.#i,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new X_(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#r=e.getOutlines();const{firstPoint:n}=this.#l;this.#f=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height];const{lastPoint:s}=this.#r;this.#g=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#v({highlightOutlines:t,highlightId:e,clipPathId:n}){this.#l=t;const s=1.5;if(this.#r=t.getNewOutline(this.#p/2+s,.0025),e>=0)this.#d=e,this.#n=n,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#m=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:Fe.#T(this.#l.box,(m-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#m,{bbox:Fe.#T(this.#r.box,m),path:{d:this.#r.toSVGPath()}})}const[a,l,c,h]=t.box;switch(this.rotation){case 0:this.x=a,this.y=l,this.width=c,this.height=h;break;case 90:{const[m,v]=this.parentDimensions;this.x=l,this.y=1-a,this.width=c*v/m,this.height=h*m/v;break}case 180:this.x=1-a,this.y=1-l,this.width=c,this.height=h;break;case 270:{const[m,v]=this.parentDimensions;this.x=1-l,this.y=a,this.width=c*v/m,this.height=h*m/v;break}}const{firstPoint:d}=t;this.#f=[(d[0]-a)/c,(d[1]-l)/h];const{lastPoint:p}=this.#r;this.#g=[(p[0]-a)/c,(p[1]-l)/h]}static initialize(t,e){Ct.initialize(t,e),Fe._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case Yt.HIGHLIGHT_COLOR:Fe._defaultColor=e;break;case Yt.HIGHLIGHT_THICKNESS:Fe._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#g}get commentButtonPosition(){return this.#f}updateParams(t,e){switch(t){case Yt.HIGHLIGHT_COLOR:this.#S(e);break;case Yt.HIGHLIGHT_THICKNESS:this.#w(e);break}}static get defaultPropertiesToUpdate(){return[[Yt.HIGHLIGHT_COLOR,Fe._defaultColor],[Yt.HIGHLIGHT_THICKNESS,Fe._defaultThickness]]}get propertiesToUpdate(){return[[Yt.HIGHLIGHT_COLOR,this.color||Fe._defaultColor],[Yt.HIGHLIGHT_THICKNESS,this.#p||Fe._defaultThickness],[Yt.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#S(t){const e=(a,l)=>{this.color=a,this.opacity=l,this.onUpdatedColor()},n=this.color,s=this.opacity;this.addCommands({cmd:e.bind(this,t,Fe._defaultOpacity),undo:e.bind(this,n,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Yt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#w(t){const e=this.#p,n=s=>{this.#p=s,this.#A(s)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Yt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new Ni({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#I())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#I())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#x(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#b(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#x():t&&(this.#b(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#A(t){this.#h&&(this.#v({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#x(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#m),this.#m=null)}#b(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#n}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#m=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#n))}static#T([t,e,n,s],a){switch(a){case 90:return[1-e-s,t,s,n];case 180:return[1-t-n,1-e-s,n,s];case 270:return[e,1-t-n,s,n]}return[t,e,n,s]}rotate(t){const{drawLayer:e}=this.parent;let n;this.#h?(t=(t-this.rotation+360)%360,n=Fe.#T(this.#l.box,t)):n=Fe.#T([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:n,root:{"data-main-rotation":t}}),e.updateProperties(this.#m,{bbox:Fe.#T(this.#r.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#D.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#n,this.setDims(),KP(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1}})}#D(t){Fe._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#R(!0);break;case 1:case 3:this.#R(!1);break}}#R(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#s,this.#o)}select(){super.select(),this.#m&&this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#m&&(this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{selected:!1}}),this.#h||this.#R(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#m,{rootClass:{hidden:!t}}))}#I(){return this.#h?this.rotation:0}#V(){if(this.#h)return null;const[t,e]=this.pageDimensions,[n,s]=this.pageTranslation,a=this.#i,l=new Float32Array(a.length*8);let c=0;for(const{x:h,y:d,width:p,height:m}of a){const v=h*t+n,b=(1-d)*e+s;l[c]=l[c+4]=v,l[c+1]=l[c+3]=b,l[c+2]=l[c+6]=v+p*t,l[c+5]=l[c+7]=b-m*e,c+=8}return l}#M(t){return this.#l.serialize(t,this.#I())}static startHighlighting(t,e,{target:n,x:s,y:a}){const{x:l,y:c,width:h,height:d}=n.getBoundingClientRect(),p=new AbortController,m=t.combinedSignal(p),v=b=>{p.abort(),this.#B(t,b)};window.addEventListener("blur",v,{signal:m}),window.addEventListener("pointerup",v,{signal:m}),window.addEventListener("pointerdown",Ne,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",Ui,{signal:m}),n.addEventListener("pointermove",this.#N.bind(this,t),{signal:m}),this._freeHighlight=new Q_({x:s,y:a},[l,c,h,d],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#N(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#B(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,n){let s=null;if(t instanceof y2){const{data:{quadPoints:w,rect:E,rotation:S,id:C,color:R,opacity:I,popupRef:B,richText:F,contentsObj:j,creationDate:P,modificationDate:D},parent:{page:{pageNumber:M}}}=t;s=t={annotationType:Vt.HIGHLIGHT,color:Array.from(R),opacity:I,quadPoints:w,boxes:null,pageIndex:M-1,rect:E.slice(0),rotation:S,annotationElementId:C,id:C,deleted:!1,popupRef:B,richText:F,comment:j?.str||null,creationDate:P,modificationDate:D}}else if(t instanceof Gb){const{data:{inkLists:w,rect:E,rotation:S,id:C,color:R,borderStyle:{rawWidth:I},popupRef:B,richText:F,contentsObj:j,creationDate:P,modificationDate:D},parent:{page:{pageNumber:M}}}=t;s=t={annotationType:Vt.HIGHLIGHT,color:Array.from(R),thickness:I,inkLists:w,boxes:null,pageIndex:M-1,rect:E.slice(0),rotation:S,annotationElementId:C,id:C,deleted:!1,popupRef:B,richText:F,comment:j?.str||null,creationDate:P,modificationDate:D}}const{color:a,quadPoints:l,inkLists:c,opacity:h}=t,d=await super.deserialize(t,e,n);d.color=ft.makeHexColor(...a),d.opacity=h||1,c&&(d.#p=t.thickness),d._initialData=s,t.comment&&d.setCommentData(t);const[p,m]=d.pageDimensions,[v,b]=d.pageTranslation;if(l){const w=d.#i=[];for(let E=0;E<l.length;E+=8)w.push({x:(l[E]-v)/p,y:1-(l[E+1]-b)/m,width:(l[E+2]-l[E])/p,height:(l[E+1]-l[E+5])/m});d.#_(),d.#b(),d.rotate(d.rotation)}else if(c){d.#h=!0;const w=c[0],E={x:w[0]-v,y:m-(w[1]-b)},S=new Q_(E,[0,0,p,m],1,d.#p/2,!0,.001);for(let I=0,B=w.length;I<B;I+=2)E.x=w[I]-v,E.y=m-(w[I+1]-b),S.add(E);const{id:C,clipPathId:R}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:S.toSVGPath()}},!0,!0);d.#v({highlightOutlines:S.getOutlines(),highlightId:C,clipPathId:R}),d.#b(),d.rotate(d.parentRotation)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=Ct._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(t);return Object.assign(n,{color:e,opacity:this.opacity,thickness:this.#p,quadPoints:this.#V(),outlines:this.#M(n.rect)}),this.addComment(n),this.annotationElementId&&!this.#O(n)?null:(n.id=this.annotationElementId,n)}#O(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((n,s)=>n!==e[s])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class b2{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,n]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,n)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){me("Not implemented")}}class ne extends Ct{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#a=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#r(t),this.#c())}#r({drawOutlines:t,drawId:e,drawingOptions:n}){this.#t=t,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#s(t,this.parent),this.#h(t.box)}#s(t,e){const{id:n}=e.drawLayer.draw(ne._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(t,e){const n=new Set(Object.keys(t));for(const[s,a]of Object.entries(e))n.has(s)?Object.assign(t[s],a):t[s]=a;return t}static getDefaultDrawingOptions(t){me("Not implemented")}static get typesMap(){me("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const n=this.typesMap.get(t);n&&this._defaultDrawingOptions.updateProperty(n,e),this._currentParent&&(ne.#i.updateProperty(n,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const n=this.constructor.typesMap.get(t);n&&this._updateProperty(t,n,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[n,s]of this.typesMap)t.push([n,e[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[n,s]of this.constructor.typesMap)t.push([n,e[s]]);return t}_updateProperty(t,e,n){const s=this._drawingOptions,a=s[e],l=c=>{s.updateProperty(e,c);const h=this.#t.updateProperty(e,c);h&&this.#h(h),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:l.bind(this,n),undo:l.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,ne._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,ne._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,ne._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#o()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#s(this.#t,t)}}#l([t,e,n,s]){const{parentDimensions:[a,l],rotation:c}=this;switch(c){case 90:return[e,1-t,n*(l/a),s*(a/l)];case 180:return[1-t,1-e,n,s];case 270:return[1-e,t,n*(l/a),s*(a/l)];default:return[t,e,n,s]}}#d(){const{x:t,y:e,width:n,height:s,parentDimensions:[a,l],rotation:c}=this;switch(c){case 90:return[1-e,t,n*(a/l),s*(l/a)];case 180:return[1-t,1-e,n,s];case 270:return[e,1-t,n*(a/l),s*(l/a)];default:return[t,e,n,s]}}#h(t){[this.x,this.y,this.width,this.height]=this.#l(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:e,width:n,height:s,rotation:a,parentRotation:l,parentDimensions:[c,h]}=this;switch((a*4+l)/90){case 1:return[1-e-s,t,s,n];case 2:return[1-t-n,1-e-s,n,s];case 3:return[e,1-t-n,s,n];case 4:return[t,e-n*(c/h),s*(h/c),n*(c/h)];case 5:return[1-e,t,n*(c/h),s*(h/c)];case 6:return[1-t-s*(h/c),1-e,s*(h/c),n*(c/h)];case 7:return[e-n*(c/h),1-t-s*(h/c),n*(c/h),s*(h/c)];case 8:return[t-n,e-s,n,s];case 9:return[1-e,t-n,s,n];case 10:return[1-t,1-e,n,s];case 11:return[e-s,1-t,s,n];case 12:return[t-s*(h/c),e,s*(h/c),n*(c/h)];case 13:return[1-e-n*(c/h),t-s*(h/c),n*(c/h),s*(h/c)];case 14:return[1-t,1-e-n*(c/h),s*(h/c),n*(c/h)];case 15:return[e,1-t,n*(c/h),s*(h/c)];default:return[t,e,n,s]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,ne._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const n=super.render();n.classList.add("draw");const s=document.createElement("div");return n.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),n}static createDrawerInstance(t,e,n,s,a){me("Not implemented")}static startDrawing(t,e,n,s){const{target:a,offsetX:l,offsetY:c,pointerId:h,pointerType:d}=s;if(ie.isInitializedAndDifferentPointerType(d))return;const{viewport:{rotation:p}}=t,{width:m,height:v}=a.getBoundingClientRect(),b=ne.#n=new AbortController,w=t.combinedSignal(b);if(ie.setPointer(d,h),window.addEventListener("pointerup",E=>{ie.isSamePointerIdOrRemove(E.pointerId)&&this._endDraw(E)},{signal:w}),window.addEventListener("pointercancel",E=>{ie.isSamePointerIdOrRemove(E.pointerId)&&this._currentParent.endDrawingSession()},{signal:w}),window.addEventListener("pointerdown",E=>{ie.isSamePointerType(E.pointerType)&&(ie.initializeAndAddPointerId(E.pointerId),ne.#i.isCancellable()&&(ne.#i.removeLastElement(),ne.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",Ui,{signal:w}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),a.addEventListener("touchmove",E=>{ie.isSameTimeStamp(E.timeStamp)&&Ne(E)},{signal:w}),t.toggleDrawing(),e._editorUndoBar?.hide(),ne.#i){t.drawLayer.updateProperties(this._currentDrawId,ne.#i.startNew(l,c,m,v,p));return}e.updateUIForDefaultProperties(this),ne.#i=this.createDrawerInstance(l,c,m,v,p),ne.#a=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(ne.#a.toSVGProperties(),ne.#i.defaultSVGProperties),!0,!1)}static _drawMove(t){if(ie.isSameTimeStamp(t.timeStamp),!ne.#i)return;const{offsetX:e,offsetY:n,pointerId:s}=t;if(ie.isSamePointerId(s)){if(ie.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,ne.#i.add(e,n)),ie.setTimeStamp(t.timeStamp),Ne(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,ne.#i=null,ne.#a=null,ie.clearTimeStamp()),ne.#n&&(ne.#n.abort(),ne.#n=null,ie.clearPointerIds())}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,ne.#i.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const n=ne.#i,s=this._currentDrawId,a=n.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(s,n.setLastElement(a))},undo:()=>{e.drawLayer.updateProperties(s,n.removeLastElement())},mustExec:!1,type:Yt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(Yt.DRAW_STEP),!ne.#i.isEmpty()){const{pageDimensions:[n,s],scale:a}=e,l=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:ne.#i.getOutlines(n*a,s*a,a,this._INNER_MARGIN),drawingOptions:ne.#a,mustBeCommitted:!t});return this._cleanup(!0),l}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,n,s,a,l){me("Not implemented")}static async deserialize(t,e,n){const{rawDims:{pageWidth:s,pageHeight:a,pageX:l,pageY:c}}=e.viewport,h=this.deserializeDraw(l,c,s,a,this._INNER_MARGIN,t),d=await super.deserialize(t,e,n);return d.createDrawingOptions(t),d.#r({drawOutlines:h}),d.#c(),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[e,n]=this.pageTranslation,[s,a]=this.pageDimensions;return this.#t.serialize([e,n,s,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class sq{#t=new Float64Array(6);#e;#i;#n;#a;#r;#s="";#o=0;#c=new dd;#l;#d;constructor(t,e,n,s,a,l){this.#l=n,this.#d=s,this.#n=a,this.#a=l,[t,e]=this.#h(t,e);const c=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e],this.#i=[{line:c,points:this.#r}],this.#t.set(c,0)}updateProperty(t,e){t==="stroke-width"&&(this.#a=e)}#h(t,e){return yt._normalizePoint(t,e,this.#l,this.#d,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#r.length<=10}add(t,e){[t,e]=this.#h(t,e);const[n,s,a,l]=this.#t.subarray(2,6),c=t-a,h=e-l;return Math.hypot(this.#l*c,this.#d*h)<=2?null:(this.#r.push(t,e),isNaN(n)?(this.#t.set([a,l,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([n,s,a,l,t,e],0),this.#e.push(...yt.createBezierPoints(n,s,a,l,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const n=this.add(t,e);return n||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,n,s,a){this.#l=n,this.#d=s,this.#n=a,[t,e]=this.#h(t,e);const l=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e];const c=this.#i.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#i.push({line:l,points:this.#r}),this.#t.set(l,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(t){return this.#i?(this.#i.push(t),this.#e=t.line,this.#r=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#i)return this.#c.removeLastElement();this.#i.pop(),this.#s="";for(let t=0,e=this.#i.length;t<e;t++){const{line:n,points:s}=this.#i[t];this.#e=n,this.#r=s,this.#o=0,this.toSVGPath()}return{path:{d:this.#s}}}toSVGPath(){const t=yt.svgRound(this.#e[4]),e=yt.svgRound(this.#e[5]);if(this.#r.length===2)return this.#s=`${this.#s} M ${t} ${e} Z`,this.#s;if(this.#r.length<=6){const s=this.#s.lastIndexOf("M");this.#s=`${this.#s.slice(0,s)} M ${t} ${e}`,this.#o=6}if(this.#r.length===4){const s=yt.svgRound(this.#e[10]),a=yt.svgRound(this.#e[11]);return this.#s=`${this.#s} L ${s} ${a}`,this.#o=12,this.#s}const n=[];this.#o===0&&(n.push(`M ${t} ${e}`),this.#o=6);for(let s=this.#o,a=this.#e.length;s<a;s+=6){const[l,c,h,d,p,m]=this.#e.slice(s,s+6).map(yt.svgRound);n.push(`C${l} ${c} ${h} ${d} ${p} ${m}`)}return this.#s+=n.join(" "),this.#o=this.#e.length,this.#s}getOutlines(t,e,n,s){const a=this.#i.at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),this.#c.build(this.#i,t,e,n,this.#n,this.#a,s),this.#t=null,this.#e=null,this.#i=null,this.#s=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class dd extends yt{#t;#e=0;#i;#n;#a;#r;#s;#o;#c;build(t,e,n,s,a,l,c){this.#a=e,this.#r=n,this.#s=s,this.#o=a,this.#c=l,this.#i=c??0,this.#n=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#n.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#n){if(t.push(`M${yt.svgRound(e[4])} ${yt.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${yt.svgRound(e[10])} ${yt.svgRound(e[11])}`);continue}for(let n=6,s=e.length;n<s;n+=6){const[a,l,c,h,d,p]=e.subarray(n,n+6).map(yt.svgRound);t.push(`C${a} ${l} ${c} ${h} ${d} ${p}`)}}return t.join("")}serialize([t,e,n,s],a){const l=[],c=[],[h,d,p,m]=this.#d();let v,b,w,E,S,C,R,I,B;switch(this.#o){case 0:B=yt._rescale,v=t,b=e+s,w=n,E=-s,S=t+h*n,C=e+(1-d-m)*s,R=t+(h+p)*n,I=e+(1-d)*s;break;case 90:B=yt._rescaleAndSwap,v=t,b=e,w=n,E=s,S=t+d*n,C=e+h*s,R=t+(d+m)*n,I=e+(h+p)*s;break;case 180:B=yt._rescale,v=t+n,b=e,w=-n,E=s,S=t+(1-h-p)*n,C=e+d*s,R=t+(1-h)*n,I=e+(d+m)*s;break;case 270:B=yt._rescaleAndSwap,v=t+n,b=e+s,w=-n,E=-s,S=t+(1-d-m)*n,C=e+(1-h-p)*s,R=t+(1-d)*n,I=e+(1-h)*s;break}for(const{line:F,points:j}of this.#n)l.push(B(F,v,b,w,E,a?new Array(F.length):null)),c.push(B(j,v,b,w,E,a?new Array(j.length):null));return{lines:l,points:c,rect:[S,C,R,I]}}static deserialize(t,e,n,s,a,{paths:{lines:l,points:c},rotation:h,thickness:d}){const p=[];let m,v,b,w,E;switch(h){case 0:E=yt._rescale,m=-t/n,v=e/s+1,b=1/n,w=-1/s;break;case 90:E=yt._rescaleAndSwap,m=-e/s,v=-t/n,b=1/s,w=1/n;break;case 180:E=yt._rescale,m=t/n+1,v=-e/s,b=-1/n,w=1/s;break;case 270:E=yt._rescaleAndSwap,m=e/s+1,v=t/n+1,b=-1/s,w=-1/n;break}if(!l){l=[];for(const C of c){const R=C.length;if(R===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,C[0],C[1]]));continue}if(R===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,C[0],C[1],NaN,NaN,NaN,NaN,C[2],C[3]]));continue}const I=new Float32Array(3*(R-2));l.push(I);let[B,F,j,P]=C.subarray(0,4);I.set([NaN,NaN,NaN,NaN,B,F],0);for(let D=4;D<R;D+=2){const M=C[D],V=C[D+1];I.set(yt.createBezierPoints(B,F,j,P,M,V),(D-2)*3),[B,F,j,P]=[j,P,M,V]}}}for(let C=0,R=l.length;C<R;C++)p.push({line:E(l[C].map(I=>I??NaN),m,v,b,w),points:E(c[C].map(I=>I??NaN),m,v,b,w)});const S=new this.prototype.constructor;return S.build(p,n,s,1,h,d,a),S}#l(t=this.#c){const e=this.#i+t/2*this.#s;return this.#o%180===0?[e/this.#a,e/this.#r]:[e/this.#r,e/this.#a]}#d(){const[t,e,n,s]=this.#t,[a,l]=this.#l(0);return[t+a,e+l,n-2*a,s-2*l]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:s}of this.#n){if(s.length<=12){for(let c=4,h=s.length;c<h;c+=6)ft.pointBoundingBox(s[c],s[c+1],t);continue}let a=s[4],l=s[5];for(let c=6,h=s.length;c<h;c+=6){const[d,p,m,v,b,w]=s.subarray(c,c+6);ft.bezierBoundingBox(a,l,d,p,m,v,b,w,t),a=b,l=w}}const[e,n]=this.#l();t[0]=Fn(t[0]-e,0,1),t[1]=Fn(t[1]-n,0,1),t[2]=Fn(t[2]+e,0,1),t[3]=Fn(t[3]+n,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,n]=this.#l();this.#c=t;const[s,a]=this.#l(),[l,c]=[s-e,a-n],h=this.#t;return h[0]-=l,h[1]-=c,h[2]+=2*l,h[3]+=2*c,h}updateParentDimensions([t,e],n){const[s,a]=this.#l();this.#a=t,this.#r=e,this.#s=n;const[l,c]=this.#l(),h=l-s,d=c-a,p=this.#t;return p[0]-=h,p[1]-=d,p[2]+=2*h,p[3]+=2*d,p}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(yt.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${yt.svgRound(t)} ${yt.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let n=0,s=0,a=0,l=0,c=0,h=0;switch(this.#e){case 90:s=e/t,a=-t/e,c=t;break;case 180:n=-1,l=-1,c=t,h=e;break;case 270:s=-e/t,a=t/e,h=e;break;default:return""}return`matrix(${n} ${s} ${a} ${l} ${yt.svgRound(c)} ${yt.svgRound(h)})`}getPathResizingSVGProperties([t,e,n,s]){const[a,l]=this.#l(),[c,h,d,p]=this.#t;if(Math.abs(d-a)<=yt.PRECISION||Math.abs(p-l)<=yt.PRECISION){const E=t+n/2-(c+d/2),S=e+s/2-(h+p/2);return{path:{"transform-origin":`${yt.svgRound(t)} ${yt.svgRound(e)}`,transform:`${this.rotationTransform} translate(${E} ${S})`}}}const m=(n-2*a)/(d-2*a),v=(s-2*l)/(p-2*l),b=d/n,w=p/s;return{path:{"transform-origin":`${yt.svgRound(c)} ${yt.svgRound(h)}`,transform:`${this.rotationTransform} scale(${b} ${w}) translate(${yt.svgRound(a)} ${yt.svgRound(l)}) scale(${m} ${v}) translate(${yt.svgRound(-a)} ${yt.svgRound(-l)})`}}}getPathResizedSVGProperties([t,e,n,s]){const[a,l]=this.#l(),c=this.#t,[h,d,p,m]=c;if(c[0]=t,c[1]=e,c[2]=n,c[3]=s,Math.abs(p-a)<=yt.PRECISION||Math.abs(m-l)<=yt.PRECISION){const S=t+n/2-(h+p/2),C=e+s/2-(d+m/2);for(const{line:R,points:I}of this.#n)yt._translate(R,S,C,R),yt._translate(I,S,C,I);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${yt.svgRound(t)} ${yt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(n-2*a)/(p-2*a),b=(s-2*l)/(m-2*l),w=-v*(h+a)+t+a,E=-b*(d+l)+e+l;if(v!==1||b!==1||w!==0||E!==0)for(const{line:S,points:C}of this.#n)yt._rescale(S,w,E,v,b,S),yt._rescale(C,w,E,v,b,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${yt.svgRound(t)} ${yt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],n){const[s,a]=n,l=this.#t,c=t-l[0],h=e-l[1];if(this.#a===s&&this.#r===a)for(const{line:d,points:p}of this.#n)yt._translate(d,c,h,d),yt._translate(p,c,h,p);else{const d=this.#a/s,p=this.#r/a;this.#a=s,this.#r=a;for(const{line:m,points:v}of this.#n)yt._rescale(m,c,h,d,p,m),yt._rescale(v,c,h,d,p,v);l[2]*=d,l[3]*=p}return l[0]=t,l[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${yt.svgRound(t)} ${yt.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${yt.svgRound(t[0])} ${yt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class $m extends b2{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Ct._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new $m(this._viewParameters);return t.updateAll(this),t}}class Wb extends ne{static _type="ink";static _editorType=Vt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){Ct.initialize(t,e),this._defaultDrawingOptions=new $m(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ot(this,"typesMap",new Map([[Yt.INK_THICKNESS,"stroke-width"],[Yt.INK_COLOR,"stroke"],[Yt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,n,s,a){return new sq(t,e,n,s,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,n,s,a,l){return dd.deserialize(t,e,n,s,a,l)}static async deserialize(t,e,n){let s=null;if(t instanceof Gb){const{data:{inkLists:l,rect:c,rotation:h,id:d,color:p,opacity:m,borderStyle:{rawWidth:v},popupRef:b,richText:w,contentsObj:E,creationDate:S,modificationDate:C},parent:{page:{pageNumber:R}}}=t;s=t={annotationType:Vt.INK,color:Array.from(p),thickness:v,opacity:m,paths:{points:l},boxes:null,pageIndex:R-1,rect:c.slice(0),rotation:h,annotationElementId:d,id:d,deleted:!1,popupRef:b,richText:w,comment:E?.str||null,creationDate:S,modificationDate:C}}const a=await super.deserialize(t,e,n);return a._initialData=s,t.comment&&a.setCommentData(t),a}get toolbarButtons(){return this._colorPicker||=new Uh(this),[["colorPicker",this._colorPicker]]}get colorType(){return Yt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:n}=this;e.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:n}){this._drawingOptions=Wb.getDefaultDrawingOptions({stroke:ft.makeHexColor(...t),"stroke-width":e,"stroke-opacity":n})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:n}=this.serializeDraw(t),{_drawingOptions:{stroke:s,"stroke-opacity":a,"stroke-width":l}}=this,c=Object.assign(super.serialize(t),{color:Ct._colorManager.convert(s),opacity:a,thickness:l,paths:{lines:e,points:n}});return this.addComment(c),t?(c.isCopy=!0,c):this.annotationElementId&&!this.#t(c)?null:(c.id=this.annotationElementId,c)}#t(t){const{color:e,thickness:n,opacity:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((l,c)=>l!==e[c])||t.thickness!==n||t.opacity!==s||t.pageIndex!==a}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:n}=this.serializeDraw(!1);return t.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}}class J_ extends dd{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const up=8,Xu=3;class Yl{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,n,s){return n-=t,s-=e,n===0?s>0?0:4:n===1?s+6:2-s}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(t,e,n,s,a,l,c){const h=this.#e(n,s,a,l);for(let d=0;d<8;d++){const p=(-d+h-c+16)%8,m=this.#i[2*p],v=this.#i[2*p+1];if(t[(n+m)*e+(s+v)]!==0)return p}return-1}static#a(t,e,n,s,a,l,c){const h=this.#e(n,s,a,l);for(let d=0;d<8;d++){const p=(d+h+c+16)%8,m=this.#i[2*p],v=this.#i[2*p+1];if(t[(n+m)*e+(s+v)]!==0)return p}return-1}static#r(t,e,n,s){const a=t.length,l=new Int32Array(a);for(let p=0;p<a;p++)l[p]=t[p]<=s?1:0;for(let p=1;p<n-1;p++)l[p*e]=l[p*e+e-1]=0;for(let p=0;p<e;p++)l[p]=l[e*n-1-p]=0;let c=1,h;const d=[];for(let p=1;p<n-1;p++){h=1;for(let m=1;m<e-1;m++){const v=p*e+m,b=l[v];if(b===0)continue;let w=p,E=m;if(b===1&&l[v-1]===0)c+=1,E-=1;else if(b>=1&&l[v+1]===0)c+=1,E+=1,b>1&&(h=b);else{b!==1&&(h=Math.abs(b));continue}const S=[m,p],C=E===m+1,R={isHole:C,points:S,id:c,parent:0};d.push(R);let I;for(const O of d)if(O.id===h){I=O;break}I?I.isHole?R.parent=C?I.parent:h:R.parent=C?h:I.parent:R.parent=C?h:0;const B=this.#n(l,e,p,m,w,E,0);if(B===-1){l[v]=-c,l[v]!==1&&(h=Math.abs(l[v]));continue}let F=this.#i[2*B],j=this.#i[2*B+1];const P=p+F,D=m+j;w=P,E=D;let M=p,V=m;for(;;){const O=this.#a(l,e,M,V,w,E,1);F=this.#i[2*O],j=this.#i[2*O+1];const G=M+F,U=V+j;S.push(U,G);const gt=M*e+V;if(l[gt+1]===0?l[gt]=-c:l[gt]===1&&(l[gt]=c),G===p&&U===m&&M===P&&V===D){l[v]!==1&&(h=Math.abs(l[v]));break}else w=M,E=V,M=G,V=U}}}return d}static#s(t,e,n,s){if(n-e<=4){for(let P=e;P<n-2;P+=2)s.push(t[P],t[P+1]);return}const a=t[e],l=t[e+1],c=t[n-4]-a,h=t[n-3]-l,d=Math.hypot(c,h),p=c/d,m=h/d,v=p*l-m*a,b=h/c,w=1/d,E=Math.atan(b),S=Math.cos(E),C=Math.sin(E),R=w*(Math.abs(S)+Math.abs(C)),I=w*(1-R+R**2),B=Math.max(Math.atan(Math.abs(C+S)*I),Math.atan(Math.abs(C-S)*I));let F=0,j=e;for(let P=e+2;P<n-2;P+=2){const D=Math.abs(v-p*t[P+1]+m*t[P]);D>F&&(j=P,F=D)}F>(d*B)**2?(this.#s(t,e,j+2,s),this.#s(t,j,n,s)):s.push(a,l)}static#o(t){const e=[],n=t.length;return this.#s(t,0,n,e),e.push(t[n-2],t[n-1]),e.length<=4?null:e}static#c(t,e,n,s,a,l){const c=new Float32Array(l**2),h=-2*s**2,d=l>>1;for(let E=0;E<l;E++){const S=(E-d)**2;for(let C=0;C<l;C++)c[E*l+C]=Math.exp((S+(C-d)**2)/h)}const p=new Float32Array(256),m=-2*a**2;for(let E=0;E<256;E++)p[E]=Math.exp(E**2/m);const v=t.length,b=new Uint8Array(v),w=new Uint32Array(256);for(let E=0;E<n;E++)for(let S=0;S<e;S++){const C=E*e+S,R=t[C];let I=0,B=0;for(let j=0;j<l;j++){const P=E+j-d;if(!(P<0||P>=n))for(let D=0;D<l;D++){const M=S+D-d;if(M<0||M>=e)continue;const V=t[P*e+M],O=c[j*l+D]*p[Math.abs(V-R)];I+=V*O,B+=O}}const F=b[C]=Math.round(I/B);w[F]++}return[b,w]}static#l(t){const e=new Uint32Array(256);for(const n of t)e[n]++;return e}static#d(t){const e=t.length,n=new Uint8ClampedArray(e>>2);let s=-1/0,a=1/0;for(let c=0,h=n.length;c<h;c++){const d=n[c]=t[c<<2];s=Math.max(s,d),a=Math.min(a,d)}const l=255/(s-a);for(let c=0,h=n.length;c<h;c++)n[c]=(n[c]-a)*l;return n}static#h(t){let e,n=-1/0,s=-1/0;const a=t.findIndex(h=>h!==0);let l=a,c=a;for(e=a;e<256;e++){const h=t[e];h>n&&(e-l>s&&(s=e-l,c=e-1),n=h,l=e)}for(e=c-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:n,height:s}=t,{maxDim:a}=this.#t;let l=n,c=s;if(n>a||s>a){let v=n,b=s,w=Math.log2(Math.max(n,s)/a);const E=Math.floor(w);w=w===E?E-1:E;for(let C=0;C<w;C++){l=Math.ceil(v/2),c=Math.ceil(b/2);const R=new OffscreenCanvas(l,c);R.getContext("2d").drawImage(t,0,0,v,b,0,0,l,c),v=l,b=c,t!==e&&t.close(),t=R.transferToImageBitmap()}const S=Math.min(a/l,a/c);l=Math.round(l*S),c=Math.round(c*S)}const d=new OffscreenCanvas(l,c).getContext("2d",{willReadFrequently:!0});d.fillStyle="white",d.fillRect(0,0,l,c),d.filter="grayscale(1)",d.drawImage(t,0,0,t.width,t.height,0,0,l,c);const p=d.getImageData(0,0,l,c).data;return[this.#d(p),l,c]}static extractContoursFromText(t,{fontFamily:e,fontStyle:n,fontWeight:s},a,l,c,h){let d=new OffscreenCanvas(1,1),p=d.getContext("2d",{alpha:!1});const m=200,v=p.font=`${n} ${s} ${m}px ${e}`,{actualBoundingBoxLeft:b,actualBoundingBoxRight:w,actualBoundingBoxAscent:E,actualBoundingBoxDescent:S,fontBoundingBoxAscent:C,fontBoundingBoxDescent:R,width:I}=p.measureText(t),B=1.5,F=Math.ceil(Math.max(Math.abs(b)+Math.abs(w)||0,I)*B),j=Math.ceil(Math.max(Math.abs(E)+Math.abs(S)||m,Math.abs(C)+Math.abs(R)||m)*B);d=new OffscreenCanvas(F,j),p=d.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=v,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,F,j),p.fillStyle="black",p.fillText(t,F*(B-1)/2,j*(3-B)/2);const P=this.#d(p.getImageData(0,0,F,j).data),D=this.#l(P),M=this.#h(D),V=this.#r(P,F,j,M);return this.processDrawnLines({lines:{curves:V,width:F,height:j},pageWidth:a,pageHeight:l,rotation:c,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,e,n,s,a){const[l,c,h]=this.#f(t),[d,p]=this.#c(l,c,h,Math.hypot(c,h)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),m=this.#h(p),v=this.#r(d,c,h,m);return this.processDrawnLines({lines:{curves:v,width:c,height:h},pageWidth:e,pageHeight:n,rotation:s,innerMargin:a,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:s,innerMargin:a,mustSmooth:l,areContours:c}){s%180!==0&&([e,n]=[n,e]);const{curves:h,width:d,height:p}=t,m=t.thickness??0,v=[],b=Math.min(e/d,n/p),w=b/e,E=b/n,S=[];for(const{points:R}of h){const I=l?this.#o(R):R;if(!I)continue;S.push(I);const B=I.length,F=new Float32Array(B),j=new Float32Array(3*(B===2?2:B-2));if(v.push({line:j,points:F}),B===2){F[0]=I[0]*w,F[1]=I[1]*E,j.set([NaN,NaN,NaN,NaN,F[0],F[1]],0);continue}let[P,D,M,V]=I;P*=w,D*=E,M*=w,V*=E,F.set([P,D,M,V],0),j.set([NaN,NaN,NaN,NaN,P,D],0);for(let O=4;O<B;O+=2){const G=F[O]=I[O]*w,U=F[O+1]=I[O+1]*E;j.set(yt.createBezierPoints(P,D,M,V,G,U),(O-2)*3),[P,D,M,V]=[M,V,G,U]}}if(v.length===0)return null;const C=c?new J_:new dd;return C.build(v,e,n,1,s,c?0:m,a),{outline:C,newCurves:S,areContours:c,thickness:m,width:d,height:p}}static async compressSignature({outlines:t,areContours:e,thickness:n,width:s,height:a}){let l=1/0,c=-1/0,h=0;for(const I of t){h+=I.length;for(let B=2,F=I.length;B<F;B++){const j=I[B]-I[B-2];l=Math.min(l,j),c=Math.max(c,j)}}let d;l>=-128&&c<=127?d=Int8Array:l>=-32768&&c<=32767?d=Int16Array:d=Int32Array;const p=t.length,m=up+Xu*p,v=new Uint32Array(m);let b=0;v[b++]=m*Uint32Array.BYTES_PER_ELEMENT+(h-2*p)*d.BYTES_PER_ELEMENT,v[b++]=0,v[b++]=s,v[b++]=a,v[b++]=e?0:1,v[b++]=Math.max(0,Math.floor(n??0)),v[b++]=p,v[b++]=d.BYTES_PER_ELEMENT;for(const I of t)v[b++]=I.length-2,v[b++]=I[0],v[b++]=I[1];const w=new CompressionStream("deflate-raw"),E=w.writable.getWriter();await E.ready,E.write(v);const S=d.prototype.constructor;for(const I of t){const B=new S(I.length-2);for(let F=2,j=I.length;F<j;F++)B[F-2]=I[F]-I[F-2];E.write(B)}E.close();const C=await new Response(w.readable).arrayBuffer(),R=new Uint8Array(C);return qP(R)}static async decompressSignature(t){try{const e=b9(t),{readable:n,writable:s}=new DecompressionStream("deflate-raw"),a=s.getWriter();await a.ready,a.write(e).then(async()=>{await a.ready,await a.close()}).catch(()=>{});let l=null,c=0;for await(const I of n)l||=new Uint8Array(new Uint32Array(I.buffer,0,4)[0]),l.set(I,c),c+=I.length;const h=new Uint32Array(l.buffer,0,l.length>>2),d=h[1];if(d!==0)throw new Error(`Invalid version: ${d}`);const p=h[2],m=h[3],v=h[4]===0,b=h[5],w=h[6],E=h[7],S=[],C=(up+Xu*w)*Uint32Array.BYTES_PER_ELEMENT;let R;switch(E){case Int8Array.BYTES_PER_ELEMENT:R=new Int8Array(l.buffer,C);break;case Int16Array.BYTES_PER_ELEMENT:R=new Int16Array(l.buffer,C);break;case Int32Array.BYTES_PER_ELEMENT:R=new Int32Array(l.buffer,C);break}c=0;for(let I=0;I<w;I++){const B=h[Xu*I+up],F=new Float32Array(B+2);S.push(F);for(let j=0;j<Xu-1;j++)F[j]=h[Xu*I+up+j+1];for(let j=0;j<B;j++)F[j+2]=F[j]+R[c++]}return{areContours:v,thickness:b,outlines:S,width:p,height:m}}catch(e){return Nt(`decompressSignature: ${e}`),null}}}class Kb extends b2{constructor(){super(),super.updateProperties({fill:Ct._defaultLineColor,"stroke-width":0})}clone(){const t=new Kb;return t.updateAll(this),t}}class Yb extends $m{constructor(t){super(t),super.updateProperties({stroke:Ct._defaultLineColor,"stroke-width":1})}clone(){const t=new Yb(this._viewParameters);return t.updateAll(this),t}}class Vs extends ne{#t=!1;#e=null;#i=null;#n=null;static _type="signature";static _editorType=Vt.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){Ct.initialize(t,e),this._defaultDrawingOptions=new Kb,this._defaultDrawnSignatureOptions=new Yb(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return Ot(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:s,mustSmooth:a,areContours:l,description:c,uuid:h,heightInPage:d}=this.#i,{rawDims:{pageWidth:p,pageHeight:m},rotation:v}=this.parent.viewport,b=Yl.processDrawnLines({lines:s,pageWidth:p,pageHeight:m,rotation:v,innerMargin:Vs._INNER_MARGIN,mustSmooth:a,areContours:l});this.addSignature(b,d,c,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#n=t,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:n,width:s,height:a}=this.#i,l=Math.max(s,a),c=Yl.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:n,width:s,height:a},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,n,s){const{x:a,y:l}=this,{outline:c}=this.#i=t;this.#t=c instanceof J_,this.description=n;let h;this.#t?h=Vs.getDefaultDrawingOptions():(h=Vs._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:h});const[,d]=this.pageDimensions;let p=e/d;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=a,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:n},rotation:s}=this.parent.viewport;return Yl.process(t,e,n,s,Vs._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:n,pageHeight:s},rotation:a}=this.parent.viewport;return Yl.extractContoursFromText(t,e,n,s,a,Vs._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:n},rotation:s}=this.parent.viewport;return Yl.processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:s,innerMargin:Vs._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Vs.getDefaultDrawingOptions():(this._drawingOptions=Vs._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:n}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":s}}=this,a=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:s});return this.addComment(a),t?(a.paths={lines:e,points:n},a.uuid=this.#n,a.isCopy=!0):a.lines=e,this.#e&&(a.accessibilityData={type:"Figure",alt:this.#e}),a}static deserializeDraw(t,e,n,s,a,l){return l.areContours?J_.deserialize(t,e,n,s,a,l):dd.deserialize(t,e,n,s,a,l)}static async deserialize(t,e,n){const s=await super.deserialize(t,e,n);return s.#t=t.areContours,s.description=t.accessibilityData?.alt||"",s.#n=t.uuid,s}}class rq extends Ct{#t=null;#e=null;#i=null;#n=null;#a=null;#r="";#s=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=Vt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#n=t.bitmapUrl,this.#a=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){Ct.initialize(t,e)}static isHandlingMimeForPasting(t){return H_.includes(t)}static paste(t,e){e.pasteEditor({mode:Vt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#h(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#r=t.file.name),this.#m()}#f(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#s){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:a,height:l}=t||this.copyCanvas(null,null,!0).imageData,c=await n.guess({name:"altText",request:{data:s,width:a,height:l,channels:s.length/(a*l)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const h=c.output;return await this.setGuessedAltText(h),e&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#g(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(n=>this.#h(n,!0)).finally(()=>this.#f());return}if(this.#n){const n=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(n).then(s=>this.#h(s)).finally(()=>this.#f());return}if(this.#a){const n=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(n).then(s=>this.#h(s)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=H_.join(",");const e=this._uiManager._signal;this.#i=new Promise(n=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(s)}n()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),n()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#s?.remove(),this.#s=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#g();return}super.rebuild(),this.div!==null&&(this.#e&&this.#s===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#n||this.#a||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#m():this.#g()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:n,bitmap:s}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#e=n,s&&(this.#t=s),this.#o=!1,this.#m())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},t)}#m(){const{div:t}=this;let{width:e,height:n}=this.#t;const[s,a]=this.pageDimensions,l=.75;if(this.width)e=this.width*s,n=this.height*a;else if(e>l*s||n>l*a){const h=Math.min(l*s/e,l*a/n);e*=h,n*=h}this._uiManager.enableWaiting(!1);const c=this.#s=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),this.width=e/s,this.height=n/a,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,n=!1){t||(t=224);const{width:s,height:a}=this.#t,l=new Ys;let c=this.#t,h=s,d=a,p=null;if(e){if(s>e||a>e){const j=Math.min(e/s,e/a);h=Math.floor(s*j),d=Math.floor(a*j)}p=document.createElement("canvas");const v=p.width=Math.ceil(h*l.sx),b=p.height=Math.ceil(d*l.sy);this.#l||(c=this.#u(v,b));const w=p.getContext("2d");w.filter=this._uiManager.hcmFilter;let E="white",S="#cfcfd8";this._uiManager.hcmFilter!=="none"?S="black":C9.isDarkMode&&(E="#8f8f9d",S="#42414d");const C=15,R=C*l.sx,I=C*l.sy,B=new OffscreenCanvas(R*2,I*2),F=B.getContext("2d");F.fillStyle=E,F.fillRect(0,0,R*2,I*2),F.fillStyle=S,F.fillRect(0,0,R,I),F.fillRect(R,I,R,I),w.fillStyle=w.createPattern(B,"repeat"),w.fillRect(0,0,v,b),w.drawImage(c,0,0,c.width,c.height,0,0,v,b)}let m=null;if(n){let v,b;if(l.symmetric&&c.width<t&&c.height<t)v=c.width,b=c.height;else if(c=this.#t,s>t||a>t){const S=Math.min(t/s,t/a);v=Math.floor(s*S),b=Math.floor(a*S),this.#l||(c=this.#u(v,b))}const E=new OffscreenCanvas(v,b).getContext("2d",{willReadFrequently:!0});E.drawImage(c,0,0,c.width,c.height,0,0,v,b),m={width:v,height:b,data:E.getImageData(0,0,v,b).data}}return{canvas:p,width:h,height:d,imageData:m}}#u(t,e){const{width:n,height:s}=this.#t;let a=n,l=s,c=this.#t;for(;a>2*t||l>2*e;){const h=a,d=l;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),l>2*e&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const p=new OffscreenCanvas(a,l);p.getContext("2d").drawImage(c,0,0,h,d,0,0,a,l),c=p.transferToImageBitmap()}return c}#p(){const[t,e]=this.parentDimensions,{width:n,height:s}=this,a=new Ys,l=Math.ceil(n*t*a.sx),c=Math.ceil(s*e*a.sy),h=this.#s;if(!h||h.width===l&&h.height===c)return;h.width=l,h.height=c;const d=this.#l?this.#t:this.#u(l,c),p=h.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(d,0,0,d.width,d.height,0,0,l,c)}#y(t){if(t){if(this.#l){const s=this._uiManager.imageManager.getSvgUrl(this.#e);if(s)return s}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,n]=this.pageDimensions,s=Math.round(this.width*e*Tc.PDF_TO_CSS_UNITS),a=Math.round(this.height*n*Tc.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(s,a);return l.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,s,a),l.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,n){let s=null,a=!1;if(t instanceof v2){const{data:{rect:E,rotation:S,id:C,structParent:R,popupRef:I,richText:B,contentsObj:F,creationDate:j,modificationDate:P},container:D,parent:{page:{pageNumber:M}},canvas:V}=t;let O,G;V?(delete t.canvas,{id:O,bitmap:G}=n.imageManager.getFromCanvas(D.id,V),V.remove()):(a=!0,t._hasNoCanvas=!0);const U=(await e._structTree.getAriaAttributes(`${tc}${C}`))?.get("aria-label")||"";s=t={annotationType:Vt.STAMP,bitmapId:O,bitmap:G,pageIndex:M-1,rect:E.slice(0),rotation:S,annotationElementId:C,id:C,deleted:!1,accessibilityData:{decorative:!1,altText:U},isSvg:!1,structParent:R,popupRef:I,richText:B,comment:F?.str||null,creationDate:j,modificationDate:P}}const l=await super.deserialize(t,e,n),{rect:c,bitmap:h,bitmapUrl:d,bitmapId:p,isSvg:m,accessibilityData:v}=t;a?(n.addMissingCanvas(t.id,l),l.#o=!0):p&&n.imageManager.isValidId(p)?(l.#e=p,h&&(l.#t=h)):l.#n=d,l.#l=m;const[b,w]=l.pageDimensions;return l.width=(c[2]-c[0])/b,l.height=(c[3]-c[1])/w,v&&(l.altTextData=v),l._initialData=s,t.comment&&l.setCommentData(t),l.#d=!!s,l}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(n),t)return n.bitmapUrl=this.#y(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:s,altText:a}=this.serializeAltText(!1);if(!s&&a&&(n.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const c=this.#_(n);return c.isSame?null:(c.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1,n.id=this.annotationElementId,delete n.bitmapId,n)}if(e===null)return n;e.stamps||=new Map;const l=this.#l?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:l,serialized:n}),n.bitmap=this.#y(!1);else if(this.#l){const c=e.stamps.get(this.#e);l>c.area&&(c.area=l,c.serialized.bitmap.close(),c.serialized.bitmap=this.#y(!1))}return n}#_(t){const{pageIndex:e,accessibilityData:{altText:n}}=this._initialData,s=t.pageIndex===e,a=(t.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&a,isSameAltText:a}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class br{#t;#e=!1;#i=null;#n=null;#a=null;#r=new Map;#s=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#g=null;#m=-1;#u;static _initialized=!1;static#p=new Map([mn,Wb,rq,Fe,Vs].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:s,accessibilityManager:a,annotationLayer:l,drawLayer:c,textLayer:h,viewport:d,l10n:p}){const m=[...br.#p.values()];if(!br._initialized){br._initialized=!0;for(const v of m)v.initialize(p,t)}t.registerEditorTypes(m),this.#u=t,this.pageIndex=e,this.div=n,this.#t=a,this.#i=l,this.viewport=d,this.#h=h,this.drawLayer=c,this._structTree=s,this.#u.addLayer(this)}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===Vt.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#A(),t){case Vt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Vt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Vt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===Vt.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const n of br.#p.values())e.toggle(`${n._type}Editing`,t===n._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#i?.togglePointerEvents(t)}get#y(){return this.#r.size!==0?this.#r.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#g?.abort(),this.#g=null;const t=new Set;for(const n of this.#y)n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#u.removeChangedExistingAnnotation(n),t.add(n.annotationElementId));const e=this.#i;if(e)for(const n of e.getEditableAnnotations()){if(n.hide(),this.#u.isDeletedAnnotationElement(n.data.id)||t.has(n.data.id))continue;const s=await this.deserialize(n);s&&(this.addOrRebuild(s),s.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#g){this.#g=new AbortController;const s=this.#u.combinedSignal(this.#g);this.#h.div.addEventListener("pointerdown",a=>{const{clientX:c,clientY:h,timeStamp:d}=a,p=this.#m;if(d-p>500){this.#m=d;return}this.#m=-1;const{classList:m}=this.div;m.toggle("getElements",!0);const v=document.elementsFromPoint(c,h);if(m.toggle("getElements",!1),!this.div.contains(v[0]))return;let b;const w=new RegExp(`^${Lh}[0-9]+$`);for(const S of v)if(w.test(S.id)){b=S.id;break}if(!b)return;const E=this.#r.get(b);E?.annotationElementId===null&&(a.stopPropagation(),a.preventDefault(),E.dblclick(a))},{signal:s,capture:!0})}const t=this.#i,e=[];if(t){const s=new Map,a=new Map;for(const c of this.#y){if(c.disableEditing(),!c.annotationElementId){e.push(c);continue}if(c.serialize()!==null){s.set(c.annotationElementId,c);continue}else a.set(c.annotationElementId,c);this.getEditableAnnotation(c.annotationElementId)?.show(),c.remove()}const l=t.getEditableAnnotations();for(const c of l){const{id:h}=c.data;if(this.#u.isDeletedAnnotationElement(h)){c.updateEdited({deleted:!0});continue}let d=a.get(h);if(d){d.resetAnnotationElement(c),d.show(!1),c.show();continue}d=s.get(h),d&&(this.#u.addChangedExistingAnnotation(d),d.renderAnnotationElement(c)&&d.show(!1)),c.show()}}this.#A(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const s of br.#p.values())n.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(e),this.#o=!1}getEditableAnnotation(t){return this.#i?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#_.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#_(t){this.#u.unselectAll();const{target:e}=t;if(e===this.#h.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#h.div.contains(e)){const{isMac:n}=cn.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),Fe.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const t=this.#u.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#n?.abort(),this.#n=null}attach(t){this.#r.set(t.id,t);const{annotationElementId:e}=t;e&&this.#u.isDeletedAnnotationElement(e)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#r.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t),Ct.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#a&&(t._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:e,undo:n,mustExec:!1})}getEditorByUID(t){for(const e of this.#r.values())if(e.uid===t)return e;return null}getNextId(){return this.#u.getId()}get#v(){return br.#p.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#S(t){const e=this.#v;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#v?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:n,offsetY:s}=this.#w(),a=this.getNextId(),l=this.#S({parent:this,id:a,x:n,y:s,uiManager:this.#u,isCentered:!0,...e});l&&this.add(l)}async deserialize(t){return await br.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,e,n={}){const s=this.getNextId(),a=this.#S({parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:e,...n});return a&&this.add(a),a}get boundingClientRect(){return this.div.getBoundingClientRect()}#w(){const{x:t,y:e,width:n,height:s}=this.boundingClientRect,a=Math.max(0,t),l=Math.max(0,e),c=Math.min(window.innerWidth,t+n),h=Math.min(window.innerHeight,e+s),d=(a+c)/2-t,p=(l+h)/2-e,[m,v]=this.viewport.rotation%180===0?[d,p]:[p,d];return{offsetX:m,offsetY:v}}addNewEditor(t={}){this.createAndAddNewEditor(this.#w(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:e}=cn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#s||(this.#s=!1,this.#v?.isDrawer&&this.#v.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const n=this.#u.getMode();if(n===Vt.STAMP||n===Vt.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===Vt.HIGHLIGHT&&this.enableTextSelection(),this.#s){this.#s=!1;return}const{isMac:e}=cn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#s=!0,this.#v?.isDrawer){this.startDrawingSession(t);return}const n=this.#u.getActive();this.#e=!n||n.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#v.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#v.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#v.endDrawing(t)):null}findNewParent(t,e,n){const s=this.#u.findParent(e,n);return s===null||s===this?!1:(s.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#v.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const t of this.#r.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#r.clear(),this.#u.removeLayer(this)}#A(){for(const t of this.#r.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,Ho(this.div,t);for(const e of this.#u.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#A();const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,Ho(this.div,{rotation:n}),e!==n)for(const s of this.#r.values())s.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#u.viewParameters.realScale}}class wn{#t=null;#e=new Map;#i=new Map;static#n=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return Ot(this,"_svgFactory",new dm)}static#a(t,[e,n,s,a]){const{style:l}=t;l.top=`${100*n}%`,l.left=`${100*e}%`,l.width=`${100*s}%`,l.height=`${100*a}%`}#r(){const t=wn._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#s(t,e){const n=wn._svgFactory.createElement("clipPath");t.append(n);const s=`clip_${e}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const a=wn._svgFactory.createElement("use");return n.append(a),a.setAttribute("href",`#${e}`),a.classList.add("clip"),s}#o(t,e){for(const[n,s]of Object.entries(e))s===null?t.removeAttribute(n):t.setAttribute(n,s)}draw(t,e=!1,n=!1){const s=wn.#n++,a=this.#r(),l=wn._svgFactory.createElement("defs");a.append(l);const c=wn._svgFactory.createElement("path");l.append(c);const h=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#i.set(s,c);const d=n?this.#s(l,h):null,p=wn._svgFactory.createElement("use");return a.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(a,t),this.#e.set(s,a),{id:s,clipPathId:`url(#${d})`}}drawOutline(t,e){const n=wn.#n++,s=this.#r(),a=wn._svgFactory.createElement("defs");s.append(a);const l=wn._svgFactory.createElement("path");a.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(e){const m=wn._svgFactory.createElement("mask");a.append(m),h=`mask_p${this.pageIndex}_${n}`,m.setAttribute("id",h),m.setAttribute("maskUnits","objectBoundingBox");const v=wn._svgFactory.createElement("rect");m.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const b=wn._svgFactory.createElement("use");m.append(b),b.setAttribute("href",`#${c}`),b.setAttribute("stroke","none"),b.setAttribute("fill","black"),b.setAttribute("fill-rule","nonzero"),b.classList.add("mask")}const d=wn._svgFactory.createElement("use");s.append(d),d.setAttribute("href",`#${c}`),h&&d.setAttribute("mask",`url(#${h})`);const p=d.cloneNode();return s.append(p),d.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(s,t),this.#e.set(n,s),n}finalizeDraw(t,e){this.#i.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:n,bbox:s,rootClass:a,path:l}=e,c=typeof t=="number"?this.#e.get(t):t;if(c){if(n&&this.#o(c,n),s&&wn.#a(c,s),a){const{classList:h}=c;for(const[d,p]of Object.entries(a))h.toggle(d,p)}if(l){const d=c.firstElementChild.firstElementChild;this.#o(d,l)}}}updateParent(t,e){if(e===this)return;const n=this.#e.get(t);n&&(e.#t.append(n),this.#e.delete(t),e.#e.set(t,n))}remove(t){this.#i.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:X_};globalThis.pdfjsLib={AbortException:Fa,AnnotationEditorLayer:br,AnnotationEditorParamsType:Yt,AnnotationEditorType:Vt,AnnotationEditorUIManager:Ua,AnnotationLayer:$b,AnnotationMode:Aa,AnnotationType:Qe,applyOpacity:R9,build:O8,ColorPicker:Ni,createValidAbsoluteUrl:UP,CSSConstants:x9,DOMSVGFactory:dm,DrawLayer:wn,FeatureTest:cn,fetchData:od,findContrastColor:I9,getDocument:c2,getFilenameFromUrl:A9,getPdfFilenameFromUrl:E9,getRGB:cd,getUuid:HP,getXfaPageViewport:T9,GlobalWorkerOptions:fc,ImageKind:Ip,InvalidPDFException:j_,isDataScheme:Hm,isPdfFile:Lb,isValidExplicitDest:U9,MathClamp:Fn,noContextMenu:Ui,normalizeUnicode:v9,OPS:Vh,OutputScale:Ys,PasswordResponses:c9,PDFDataRangeTransport:u2,PDFDateString:z_,PDFWorker:Fh,PermissionFlag:l9,PixelsPerInch:Tc,RenderingCancelledException:Ob,renderRichText:$P,ResponseException:um,setLayerDimensions:Ho,shadow:Ot,SignatureExtractor:Yl,stopEvent:Ne,SupportedImageMimeTypes:H_,TextLayer:fi,TouchManager:qm,updateUrlHash:jP,Util:ft,VerbosityLevel:Um,version:f2,XfaLayer:GP};fc.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${f2}/pdf.worker.min.js`;const aq=()=>{const{store:i}=eD(),t=zh(),[e,n]=z.useState("manual"),[s,a]=z.useState(!1),[l,c]=z.useState(""),[h,d]=z.useState(""),[p,m]=z.useState(""),[v,b]=z.useState(""),[w,E]=z.useState(null),[S,C]=z.useState([]),[R,I]=z.useState(""),[B,F]=z.useState(null),[j,P]=z.useState(""),[D,M]=z.useState([]),[V,O]=z.useState(!1),G=tt=>{const ut=parseFloat(tt)||0;return V?ut+50:ut},U=async tt=>{if(tt.preventDefault(),!w)return alert("Please select an image");a(!0);try{const ut=await B_(w,800,.7),At=await Rp(ut);await _p(xr(Un,"products"),{storeId:i.id,name:l,price:G(h),description:p,category:v.toLowerCase().trim(),image:At,createdAt:new Date().toISOString()}),t("/dashboard")}catch(ut){console.error(ut)}finally{a(!1)}},gt=async()=>{if(S.length===0)return alert("Select images");if(!R)return alert("Set a price for all");a(!0);try{for(let tt=0;tt<S.length;tt++){const ut=S[tt],At=await B_(ut,800,.7),H=await Rp(At);await _p(xr(Un,"products"),{storeId:i.id,name:ut.name.split(".")[0],price:G(R),description:"",image:H,createdAt:new Date().toISOString()})}t("/dashboard")}catch(tt){console.error(tt)}finally{a(!1)}},Pt=async tt=>{const ut=tt.target.files[0];if(ut){F(ut),a(!0);try{const At=await ut.arrayBuffer(),H=await c2({data:At}).promise,et=[];for(let ct=1;ct<=H.numPages;ct++){const dt=await H.getPage(ct),Et=dt.getViewport({scale:.5}),Tt=document.createElement("canvas"),wt=Tt.getContext("2d");Tt.height=Et.height,Tt.width=Et.width,await dt.render({canvasContext:wt,viewport:Et}).promise,et.push(Tt.toDataURL("image/jpeg",.8))}M(et)}catch(At){console.error("PDF Error:",At)}finally{a(!1)}}},W=async()=>{if(D.length!==0){a(!0);try{for(let tt=0;tt<D.length;tt++){const ut=D[tt],H=await(await fetch(ut)).blob(),et=await Rp(H);await _p(xr(Un,"products"),{storeId:i.id,name:`Catalog Item ${tt+1}`,price:G(j),description:`Page ${tt+1} of ${B.name}`,image:et,createdAt:new Date().toISOString()})}t("/dashboard")}catch(tt){console.error(tt)}finally{a(!1)}}},K=tt=>{C(S.filter((ut,At)=>At!==tt))};return L.jsxs("div",{style:{padding:"2rem 5%",maxWidth:"800px",margin:"0 auto"},children:[L.jsxs("button",{onClick:()=>t("/dashboard"),style:{background:"none",border:"none",color:"var(--text-muted)",display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",marginBottom:"2rem"},children:[L.jsx(q4,{size:18})," Back to Dashboard"]}),L.jsx("h1",{style:{marginBottom:"2rem"},children:"Add Products"}),L.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"2rem"},children:[L.jsxs("button",{className:`btn ${e==="manual"?"btn-primary":"btn-secondary"}`,onClick:()=>n("manual"),children:[L.jsx(_6,{size:18})," Manual"]}),L.jsxs("button",{className:`btn ${e==="bulk"?"btn-primary":"btn-secondary"}`,onClick:()=>n("bulk"),children:[L.jsx(s6,{size:18})," Bulk Images"]}),L.jsxs("button",{className:`btn ${e==="pdf"?"btn-primary":"btn-secondary"}`,onClick:()=>n("pdf"),children:[L.jsx(J4,{size:18})," PDF Catalog"]})]}),L.jsxs("div",{className:"glass glass-card",children:[e==="manual"&&L.jsxs("form",{onSubmit:U,children:[L.jsxs("div",{className:"input-group",children:[L.jsx("label",{className:"label",children:"Product Name"}),L.jsx("input",{className:"input",value:l,onChange:tt=>c(tt.target.value),required:!0})]}),L.jsxs("div",{className:"input-group",children:[L.jsx("label",{className:"label",children:"Price ()"}),L.jsx("input",{type:"number",className:"input",value:h,onChange:tt=>d(tt.target.value),required:!0})]}),L.jsxs("div",{className:"input-group",children:[L.jsx("label",{className:"label",children:"Category (e.g. Shirts, Pants)"}),L.jsx("input",{className:"input",placeholder:"e.g. Shirts",value:v,onChange:tt=>b(tt.target.value)})]}),L.jsxs("div",{className:"input-group",children:[L.jsx("label",{className:"label",children:"Description"}),L.jsx("textarea",{className:"input",rows:"3",value:p,onChange:tt=>m(tt.target.value)})]}),L.jsxs("div",{className:"input-group",children:[L.jsx("label",{className:"label",children:"Product Image"}),L.jsx("input",{type:"file",className:"input",accept:"image/*",onChange:tt=>E(tt.target.files[0]),required:!0})]}),L.jsx("button",{className:"btn btn-primary",style:{width:"100%"},disabled:s,children:s?"Uploading...":"Add Product"})]}),e==="bulk"&&L.jsxs("div",{children:[L.jsxs("div",{className:"input-group",children:[L.jsx("label",{className:"label",children:"Set Price for All ()"}),L.jsx("input",{type:"number",className:"input",value:R,onChange:tt=>I(tt.target.value)})]}),L.jsxs("div",{className:"input-group",children:[L.jsx("label",{className:"label",children:"Select Images"}),L.jsx("input",{type:"file",className:"input",multiple:!0,accept:"image/*",onChange:tt=>C([...S,...Array.from(tt.target.files)])})]}),S.length>0&&L.jsx("div",{style:{display:"flex",gap:"1rem",overflowX:"auto",padding:"1rem 0",marginBottom:"1.5rem",scrollSnapType:"x mandatory"},children:S.map((tt,ut)=>L.jsxs("div",{style:{position:"relative",minWidth:"120px",height:"120px",scrollSnapAlign:"start"},children:[L.jsx("img",{src:URL.createObjectURL(tt),alt:"preview",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"8px"}}),L.jsx("button",{onClick:()=>K(ut),style:{position:"absolute",top:-5,right:-5,background:"var(--error)",border:"none",borderRadius:"50%",color:"white",padding:"4px",cursor:"pointer"},children:L.jsx(iD,{size:12})})]},ut))}),L.jsx("button",{onClick:gt,className:"btn btn-primary",style:{width:"100%"},disabled:s||S.length===0,children:s?"Uploading Batch...":`Upload ${S.length} Products`})]}),e==="pdf"&&L.jsxs("div",{children:[L.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1.5rem",fontSize:"0.875rem"},children:"Upload a PDF catalog. Each page will be converted into a product with the same price."}),L.jsxs("div",{className:"input-group",children:[L.jsx("label",{className:"label",children:"Price per Page ()"}),L.jsx("input",{type:"number",className:"input",value:j,onChange:tt=>P(tt.target.value)})]}),L.jsxs("div",{className:"input-group",children:[L.jsx("label",{className:"label",children:"Select PDF"}),L.jsx("input",{type:"file",className:"input",accept:"application/pdf",onChange:Pt})]}),D.length>0&&L.jsx("div",{style:{display:"flex",gap:"1rem",overflowX:"auto",padding:"1rem 0",marginBottom:"1.5rem"},children:D.map((tt,ut)=>L.jsxs("div",{style:{minWidth:"150px",border:"1px solid var(--surface-border)",borderRadius:"8px",overflow:"hidden"},children:[L.jsx("img",{src:tt,alt:`Page ${ut+1}`,style:{width:"100%",height:"200px",objectFit:"contain"}}),L.jsxs("div",{style:{padding:"0.5rem",fontSize:"0.75rem",textAlign:"center"},children:["Page ",ut+1]})]},ut))}),L.jsx("button",{onClick:W,className:"btn btn-primary",style:{width:"100%"},disabled:s||D.length===0,children:s?"Processing PDF...":`Import ${D.length} Products from PDF`})]})]})]})},oq=()=>{const{storeId:i}=Gk(),[t,e]=z.useState(null),[n,s]=z.useState([]),[a,l]=z.useState(!0),[c,h]=z.useState(""),[d,p]=z.useState("all"),[m,v]=z.useState("newest");z.useEffect(()=>{b()},[i]);const b=async()=>{try{let R=await gI(No(Un,"stores",i)),I=null,B=i;if(R.exists())I=R.data();else{const F=Wp(xr(Un,"stores"),Kp("handle","==",i)),j=await Rh(F);j.empty||(R=j.docs[0],I=R.data(),B=R.id)}if(I){e({id:B,...I}),document.documentElement.style.setProperty("--primary",I.themeColor||"#6366f1");const F=Wp(xr(Un,"products"),Kp("storeId","==",B)),j=await Rh(F);s(j.docs.map(P=>({id:P.id,...P.data()})))}}catch(R){console.error(R)}finally{l(!1)}},w=R=>{const I=`Hi ${t.name}, I want to order:

*${R.name}*
Price: ${R.price}

Link: ${window.location.href}`,B=encodeURIComponent(I);window.location.href=`https://wa.me/${t.whatsapp}?text=${B}`},E=["all",...new Set(n.map(R=>R.category).filter(Boolean))],C=[...n.filter(R=>{const I=R.name.toLowerCase().includes(c.toLowerCase())||R.description&&R.description.toLowerCase().includes(c.toLowerCase()),B=d==="all"||R.category===d;return I&&B})].sort((R,I)=>{if(m==="price-asc")return parseFloat(R.price)-parseFloat(I.price);if(m==="price-desc")return parseFloat(I.price)-parseFloat(R.price);if(m==="newest"){const B=R.createdAt?new Date(R.createdAt).getTime():0;return(I.createdAt?new Date(I.createdAt).getTime():0)-B}return 0});return a?L.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading Store..."}):t?L.jsxs("div",{style:{minHeight:"100vh",background:"var(--background)"},children:[L.jsx("header",{className:"glass",style:{padding:"1rem 5%",position:"sticky",top:0,zIndex:100,borderBottom:"1px solid var(--surface-border)"},children:L.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",maxWidth:"1200px",margin:"0 auto",gap:"1rem"},children:[L.jsxs("h1",{style:{fontSize:"1.25rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[t.logo?L.jsx("img",{src:t.logo,style:{width:"32px",height:"32px",borderRadius:"6px",objectFit:"cover"},alt:"Logo"}):L.jsx(Ac,{size:24,color:"var(--primary)"}),L.jsx("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"150px"},children:t.name})]}),L.jsxs("div",{style:{position:"relative",flex:1,maxWidth:"300px"},children:[L.jsx(h6,{size:16,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),L.jsx("input",{type:"text",className:"input",placeholder:"Search catalog...",style:{paddingLeft:"2.5rem",borderRadius:"20px",fontSize:"0.875rem",height:"36px"},value:c,onChange:R=>h(R.target.value)})]})]})}),L.jsxs("div",{style:{background:`linear-gradient(135deg, ${t.themeColor}33, transparent)`,padding:"4rem 5%",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem"},children:[t.logo&&L.jsx(wc.img,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},src:t.logo,style:{width:"100px",height:"100px",borderRadius:"20px",objectFit:"cover",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},alt:"Store Logo"}),L.jsxs("div",{children:[L.jsxs("h2",{style:{fontSize:"2.5rem",marginBottom:"0.5rem"},children:["Welcome to ",t.name]}),L.jsx("p",{style:{color:"var(--text-muted)"},children:"Browse our catalog and order directly on WhatsApp"})]})]}),E.length>1&&L.jsx("div",{style:{padding:"1rem 5%",display:"flex",gap:"0.75rem",overflowX:"auto",maxWidth:"1200px",margin:"0 auto",scrollbarWidth:"none",alignItems:"center"},children:E.map(R=>L.jsx("button",{onClick:()=>p(R),className:`btn ${d===R?"btn-primary":"btn-secondary"}`,style:{padding:"0.5rem 1.25rem",fontSize:"0.875rem",whiteSpace:"nowrap",textTransform:"capitalize"},children:R},R))}),L.jsx("div",{style:{padding:"0 5%",maxWidth:"1200px",margin:"1rem auto 0",display:"flex",justifyContent:"flex-end",gap:"1rem"},children:L.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center",gap:"0.5rem"},children:[L.jsx(t6,{size:16,color:"var(--text-muted)"}),L.jsxs("select",{value:m,onChange:R=>v(R.target.value),className:"input",style:{padding:"0.5rem",paddingRight:"2rem",borderRadius:"8px",border:"1px solid var(--surface-border)",background:"rgba(255,255,255,0.05)",color:"var(--text)",cursor:"pointer",appearance:"none"},children:[L.jsx("option",{value:"newest",style:{color:"#000000",background:"#ffffff"},children:"Latest Arrivals"}),L.jsx("option",{value:"price-asc",style:{color:"#000000",background:"#ffffff"},children:"Price: Low to High"}),L.jsx("option",{value:"price-desc",style:{color:"#000000",background:"#ffffff"},children:"Price: High to Low"})]}),L.jsx(z4,{size:14,style:{position:"absolute",right:"10px",pointerEvents:"none",color:"var(--text-muted)"}})]})}),L.jsx("main",{style:{padding:"2rem 5%",maxWidth:"1200px",margin:"0 auto"},children:C.length===0?L.jsx("div",{style:{textAlign:"center",padding:"4rem",color:"var(--text-muted)"},children:"No products found matching your search."}):L.jsx("div",{className:"grid grid-cols-2",style:{gridTemplateColumns:"repeat(auto-fill, minmax(160px, 1fr))",gap:"1rem"},children:L.jsx(Qz,{children:C.map(R=>L.jsxs(wc.div,{layout:!0,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"glass glass-card",style:{display:"flex",flexDirection:"column",padding:"0.75rem",gap:"0.75rem"},children:[L.jsxs("div",{style:{position:"relative",overflow:"hidden",borderRadius:"8px",aspectRatio:"1/1"},children:[L.jsx("img",{src:R.image,alt:R.name,style:{width:"100%",height:"100%",objectFit:"cover"}}),R.createdAt&&new Date(R.createdAt)>new Date(Date.now()-10080*60*1e3)&&L.jsx("span",{style:{position:"absolute",top:"8px",right:"8px",background:"var(--primary)",color:"#fff",fontSize:"0.7rem",padding:"2px 6px",borderRadius:"4px",fontWeight:"bold"},children:"NEW"})]}),L.jsxs("div",{style:{flex:1},children:[L.jsx("h3",{style:{fontSize:"0.9rem",marginBottom:"0.25rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:R.name}),L.jsxs("p",{style:{color:"var(--primary)",fontWeight:"700",fontSize:"1.1rem"},children:["",R.price]})]}),L.jsxs("button",{onClick:()=>w(R),className:"btn btn-primary",style:{width:"100%",padding:"0.5rem",fontSize:"0.875rem",background:"#22c55e"},children:[L.jsx(p_,{size:16})," Order"]})]},R.id))})})}),L.jsx("a",{href:`https://wa.me/${t.whatsapp}`,style:{position:"fixed",bottom:"2rem",right:"2rem",background:"#22c55e",color:"white",padding:"1rem",borderRadius:"50%",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",display:"flex",zIndex:1e3},children:L.jsx(p_,{size:24})})]}):L.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Store not found"})},nx=({children:i})=>{const{user:t}=nb();return t?i:L.jsx(rN,{to:"/login"})};function lq(){return L.jsx(PN,{children:L.jsx(N4,{children:L.jsx(O4,{children:L.jsxs(oN,{children:[L.jsx(zl,{path:"/",element:L.jsx(s9,{})}),L.jsx(zl,{path:"/login",element:L.jsx(a9,{})}),L.jsx(zl,{path:"/dashboard",element:L.jsx(nx,{children:L.jsx(o9,{})})}),L.jsx(zl,{path:"/dashboard/add",element:L.jsx(nx,{children:L.jsx(aq,{})})}),L.jsx(zl,{path:"/s/:storeId",element:L.jsx(oq,{})})]})})})})}lk.createRoot(document.getElementById("root")).render(L.jsx(tk.StrictMode,{children:L.jsx(lq,{})}));
